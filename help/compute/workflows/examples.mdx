---
title: "Low-code workflow example and tutorial"
sidebar_position: 4
---

Let's make some multistep analysis using the low-code workflows.
For example task we pick an **Air Quality Risk Analysis**.
We'll make a workflow that can make the following:

1. Load a public dataset with air pollution data (e.g. PM2.5, NO₂, O₃ levels),
2. Edit data (e.g. filtering by city or time),
3. Perform two separate calculations:
    * Clustering to group cities by pollution profile,
    * Linear regression to estimate health risk (e.g. respiratory disease rate) based on pollutants,
4. Combine results into a risk dashboard (e.g. color-coded city map, bar charts).


## Development setup and making the workflow

Setup a dev environment as described
[here](../develop/dev-process/set-up-environment).

To create a package for workflow, run the following commands:

```shell
grok create airqualityanalysis
cd airqualityanalysis
npm i @datagrok-libraries/compute-api
```

Go to the package.json file and change package dependencies:

```json
"dependencies": {
    "@datagrok-libraries/compute-api": "^0.6.3",
    "@datagrok-libraries/utils": "^4.4.0",
    "cash-dom": "^8.1.4",
    "datagrok-api": "^1.21.3",
    "dayjs": "=1.11.10"
  },

```

Place the following code to the `src/package.ts` file:
```typescript
/* Do not change these import lines to match external modules in webpack configuration */
import * as grok from 'datagrok-api/grok';
import * as ui from 'datagrok-api/ui';
import * as DG from 'datagrok-api/dg';
import type { PipelineConfiguration } from '@datagrok-libraries/compute-api';
import dayjs from 'dayjs';
import utc from 'dayjs/plugin/utc';
import timezone from 'dayjs/plugin/timezone';

dayjs.extend(utc);
dayjs.extend(timezone);

export const _package = new DG.Package();

//tags: model
//editor: Compute2:TreeWizardEditor
//input: object params
//output: object result
export async function AirQualityAnalysis(params: any) {
  const c: PipelineConfiguration = {
    id: 'airqualityanalysis_main',
    nqName: 'airqualityanalysis:AirQualityAnalysis',
    version: '1.0',
    type: 'static',
    steps: [{
      id: 'step1',
      nqName: 'airqualityanalysis:MyAddScript',
    }]
  };
  return c;
}

//input: double a
//input: double b
//output: double c
export function MyAddScript(a: number, b: number) {
  return a + b;
}

```

The imports of `utc`, `timezone` and `daysjs` are required for the `TreeWizardEditor` to work.

Tn the main part of scripts we define the `AirQualityAnalysis` function, that created and returns
a big JSON with the `PipelineConfiguration` type, that defines our workflow.
The `nqName:` key of the configuration should always contain the name of the main function and main script.
In our case this is `airqualityanalysis:AirQualityAnalysis`

The `steps` array defines steps of our workflow.
For now, this is a mock step that adds two numbers.
The `nqName: 'myworkflowpackage:MyAddScript'` key maps the workflow step 1
to the custom function `MyAddScript`.

After run the following from the package root directory (change local to
the actual Datagrok instance if needed).

```shell
npm i && npm run build && grok publish local --release
```

Note that publish `--release` flag is mandatory for workflow.

Reload Datagrok page, open the **ModelHub** in the **Apps->Compute** sections,
and run the `MyWorkflow` model.
You will see the following interface:

![Minumal workflow example](pics/example-workflow.png)


