import * as grok from 'datagrok-api/grok';
import * as ui from 'datagrok-api/ui';
import * as DG from 'datagrok-api/dg';

import wu from 'wu';

import {
  after, before, category, delay, expect, test, expectArray, testEvent, expectFloat, timeout
} from '@datagrok-libraries/utils/src/test';
import {getHelmHelper, getMonomerHandleArgs} from '@datagrok-libraries/bio/src/helm/helm-helper';
import {errInfo} from '@datagrok-libraries/bio/src/utils/err-info';
import {Atom, HelmType, IJsAtom, GetMonomerFunc, HelmAtom} from '@datagrok-libraries/bio/src/helm/types';
import {MonomerLibSummaryType} from '@datagrok-libraries/bio/src/types';
import {IHelmHelper} from '@datagrok-libraries/bio/src/helm/helm-helper';
import {getMonomerLibHelper, IMonomerLibHelper} from '@datagrok-libraries/bio/src/monomer-works/monomer-utils';
import {UserLibSettings} from '@datagrok-libraries/bio/src/monomer-works/types';
import {
  getUserLibSettings, setUserLibSettings,
} from '@datagrok-libraries/bio/src/monomer-works/lib-settings';
import {expectMonomerLib} from '@datagrok-libraries/bio/src/tests/monomer-lib-tests';

import {rewriteLibraries} from '../utils/get-monomer';
import {JSDraw2Module, OrgHelmModule} from '../types';

import {initHelmMainPackage} from './utils';

import {_package} from '../package-test';
import {PolymerTypes} from '@datagrok-libraries/bio/src/helm/consts';

declare const org: OrgHelmModule;
declare const JSDraw2: JSDraw2Module;

type TestDataType = { args: { a: any, name?: string }, tgt: any };

const getResultDf = false;

const tests: { [testName: string]: TestDataType } =
  /* eslint-disable */
  //@formatter:off
  {
    t0:{"args":{"a":"HELM_BASE","name":"A"},"tgt":{"id":"A","m":"\n     RDKit          2D\n\n 11 12  0  0  0  0  0  0  0  0999 V2000\n   -3.1265    0.5194    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.8274   -0.2306    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.8274   -1.7306    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.5284   -2.4806    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.7707   -1.7306    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n    0.7707   -0.2306    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.5284    0.5194    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.2165    1.9866    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n    1.2753    2.1434    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    1.8854    0.7731    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n    3.3526    0.4612    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  1  0\n  2  3  2  0\n  3  4  1  0\n  4  5  2  0\n  5  6  1  0\n  6  7  2  0\n  7  8  1  0\n  8  9  2  0\n  9 10  1  0\n 10 11  1  0\n  7  2  1  0\n 10  6  1  0\nM  RGP  1  11   1\nM  END\n","n":"Adenine","na":"A","rs":1,"at":{"R1":"H"}}},
t1:{"args":{"a":"HELM_BASE","name":"C"},"tgt":{"id":"C","m":"\n     RDKit          2D\n\n  9  9  0  0  0  0  0  0  0  0999 V2000\n    2.8868    1.3333    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n    1.5877    0.5833    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    1.5877   -0.9167    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.2887   -1.6667    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.0104   -0.9167    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.3094   -1.6667    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n   -1.0104    0.5833    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.3094    1.3333    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n    0.2887    1.3333    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  1  0\n  2  3  1  0\n  3  4  2  0\n  4  5  1  0\n  5  6  1  0\n  5  7  1  0\n  7  8  2  0\n  7  9  1  0\n  9  2  2  0\nM  RGP  1   6   1\nM  END\n","n":"Cytosine","na":"C","rs":1,"at":{"R1":"H"}}},
t2:{"args":{"a":"HELM_BASE","name":"G"},"tgt":{"id":"G","m":"\n     RDKit          2D\n\n 12 13  0  0  0  0  0  0  0  0999 V2000\n    3.4022   -1.4050    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n    2.1032   -0.6550    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.8041   -1.4050    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.4949   -0.6550    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.4949    0.8450    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.9215    1.3085    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.8032    0.0950    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.9215   -1.1185    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.3850   -2.5451    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n    0.8041    1.5950    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.8041    3.0950    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n    2.1032    0.8450    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  1  0\n  2  3  2  0\n  3  4  1  0\n  4  5  2  0\n  5  6  1  0\n  6  7  2  0\n  7  8  1  0\n  8  9  1  0\n  5 10  1  0\n 10 11  2  0\n 10 12  1  0\n 12  2  1  0\n  8  4  1  0\nM  RGP  1   9   1\nM  END\n","n":"Guanine","na":"G","rs":1,"at":{"R1":"H"}}},
t3:{"args":{"a":"HELM_LINKER","name":"p"},"tgt":{"id":"p","m":"\n     RDKit          2D\n\n  5  4  0  0  0  0  0  0  0  0999 V2000\n   -1.2990    0.7500    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n    0.0000    0.0000    0.0000 P   0  0  0  0  0  0  0  0  0  0  0  0\n    1.2990   -0.7500    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.7500   -1.2990    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n    0.7500    1.2990    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  2  0\n  2  3  1  0\n  2  4  1  0\n  2  5  1  0\nM  RGP  2   4   1   5   2\nM  END\n","n":"Phosphate","na":"p","rs":2,"at":{"R1":"OH","R2":"OH"}}},
t4:{"args":{"a":"HELM_SUGAR","name":"p"},"tgt":null},
t5:{"args":{"a":"HELM_SUGAR","name":"r"},"tgt":{"id":"r","m":"\n     RDKit          2D\n\n 12 12  0  0  0  0  0  0  0  0999 V2000\n    3.0807    1.3822    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n    1.8672    0.5005    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.4406    0.9640    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.0229    2.3906    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.4901    2.7025    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n   -0.4410   -0.2495    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.9410   -0.2495    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.6910   -1.5485    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.1910   -1.5485    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n    0.4406   -1.4630    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n    1.8672   -0.9995    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.0807   -1.8812    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n  2  1  1  6\n  2  3  1  0\n  3  4  1  1\n  4  5  1  0\n  3  6  1  0\n  6  7  1  6\n  7  8  1  0\n  8  9  1  0\n  6 10  1  0\n 10 11  1  0\n 11 12  1  6\n 11  2  1  0\nM  RGP  3   5   2   9   1  12   3\nM  END\n","n":"Ribose","na":"r","rs":3,"at":{"R1":"H","R2":"H","R3":"OH"}}},
t6:{"args":{"a":{"T":"ATOM","p":{"x":144,"y":0},"charge":0,"isotope":null,"radical":null,"group":null,"alias":null,"superatom":null,"attachpoints":[],"rgroup":null,"bio":{"type":"HELM_SUGAR","id":null,"ambiguity":null},"locked":false,"hidden":null,"_rect":null,"elem":"r","color":null,"hcount":null,"selected":false,"f":null,"bonds":null,"id":null,"atommapid":null,"query":null,"hasError":null,"hs":null,"val":null,"_parent":"[object Object]","_aaid":4}},"tgt":{"id":"r","m":"\n     RDKit          2D\n\n 12 12  0  0  0  0  0  0  0  0999 V2000\n    3.0807    1.3822    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n    1.8672    0.5005    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.4406    0.9640    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.0229    2.3906    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.4901    2.7025    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n   -0.4410   -0.2495    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.9410   -0.2495    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.6910   -1.5485    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.1910   -1.5485    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n    0.4406   -1.4630    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n    1.8672   -0.9995    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.0807   -1.8812    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n  2  1  1  6\n  2  3  1  0\n  3  4  1  1\n  4  5  1  0\n  3  6  1  0\n  6  7  1  6\n  7  8  1  0\n  8  9  1  0\n  6 10  1  0\n 10 11  1  0\n 11 12  1  6\n 11  2  1  0\nM  RGP  3   5   2   9   1  12   3\nM  END\n","n":"Ribose","na":"r","rs":3,"at":{"R1":"H","R2":"H","R3":"OH"}}},
t7:{"args":{"a":{"T":"ATOM","p":{"x":144,"y":0},"charge":0,"isotope":null,"radical":null,"group":null,"alias":null,"superatom":null,"attachpoints":[],"rgroup":null,"bio":{"type":"HELM_SUGAR","id":null,"ambiguity":null},"locked":false,"hidden":null,"_rect":null,"elem":"r","color":null,"hcount":null,"selected":false,"f":null,"bonds":null,"id":null,"atommapid":null,"query":null,"hasError":null,"hs":null,"val":null,"tag":null,"_parent":"[object Object]","_aaid":4}},"tgt":{"id":"r","m":"\n     RDKit          2D\n\n 12 12  0  0  0  0  0  0  0  0999 V2000\n    3.0807    1.3822    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n    1.8672    0.5005    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.4406    0.9640    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.0229    2.3906    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.4901    2.7025    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n   -0.4410   -0.2495    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.9410   -0.2495    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.6910   -1.5485    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.1910   -1.5485    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n    0.4406   -1.4630    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n    1.8672   -0.9995    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.0807   -1.8812    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n  2  1  1  6\n  2  3  1  0\n  3  4  1  1\n  4  5  1  0\n  3  6  1  0\n  6  7  1  6\n  7  8  1  0\n  8  9  1  0\n  6 10  1  0\n 10 11  1  0\n 11 12  1  6\n 11  2  1  0\nM  RGP  3   5   2   9   1  12   3\nM  END\n","n":"Ribose","na":"r","rs":3,"at":{"R1":"H","R2":"H","R3":"OH"}}},
t8:{"args":{"a":{"T":"ATOM","p":{"x":144,"y":48},"charge":0,"isotope":null,"radical":null,"group":null,"alias":null,"superatom":null,"attachpoints":[],"rgroup":null,"bio":{"type":"HELM_BASE","id":null,"ambiguity":null},"locked":false,"hidden":null,"_rect":null,"elem":"G","color":null,"hcount":null,"selected":false,"f":null,"bonds":null,"id":null,"atommapid":null,"query":null,"hasError":null,"hs":null,"val":null,"tag":null,"_parent":"[object Object]","_aaid":5}},"tgt":{"id":"G","m":"\n     RDKit          2D\n\n 12 13  0  0  0  0  0  0  0  0999 V2000\n    3.4022   -1.4050    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n    2.1032   -0.6550    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.8041   -1.4050    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.4949   -0.6550    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.4949    0.8450    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.9215    1.3085    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.8032    0.0950    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.9215   -1.1185    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.3850   -2.5451    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n    0.8041    1.5950    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.8041    3.0950    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n    2.1032    0.8450    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  1  0\n  2  3  2  0\n  3  4  1  0\n  4  5  2  0\n  5  6  1  0\n  6  7  2  0\n  7  8  1  0\n  8  9  1  0\n  5 10  1  0\n 10 11  2  0\n 10 12  1  0\n 12  2  1  0\n  8  4  1  0\nM  RGP  1   9   1\nM  END\n","n":"Guanine","na":"G","rs":1,"at":{"R1":"H"}}},
t9:{"args":{"a":{"T":"ATOM","p":{"x":192,"y":0},"charge":0,"isotope":null,"radical":null,"group":null,"alias":null,"superatom":null,"attachpoints":[],"rgroup":null,"bio":{"type":"HELM_LINKER","id":null,"ambiguity":null},"locked":false,"hidden":null,"_rect":null,"elem":"p","color":null,"hcount":null,"selected":false,"f":null,"bonds":null,"id":null,"atommapid":null,"query":null,"hasError":null,"hs":null,"val":null,"_parent":"[object Object]","_aaid":6}},"tgt":{"id":"p","m":"\n     RDKit          2D\n\n  5  4  0  0  0  0  0  0  0  0999 V2000\n   -1.2990    0.7500    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n    0.0000    0.0000    0.0000 P   0  0  0  0  0  0  0  0  0  0  0  0\n    1.2990   -0.7500    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.7500   -1.2990    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n    0.7500    1.2990    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  2  0\n  2  3  1  0\n  2  4  1  0\n  2  5  1  0\nM  RGP  2   4   1   5   2\nM  END\n","n":"Phosphate","na":"p","rs":2,"at":{"R1":"OH","R2":"OH"}}},
t10:{"args":{"a":{"T":"ATOM","p":{"x":192,"y":0},"charge":0,"isotope":null,"radical":null,"group":null,"alias":null,"superatom":null,"attachpoints":[],"rgroup":null,"bio":{"type":"HELM_LINKER","id":null,"ambiguity":null},"locked":false,"hidden":null,"_rect":null,"elem":"p","color":null,"hcount":null,"selected":false,"f":null,"bonds":null,"id":null,"atommapid":null,"query":null,"hasError":null,"hs":null,"val":null,"tag":null,"_parent":"[object Object]","_aaid":6}},"tgt":{"id":"p","m":"\n     RDKit          2D\n\n  5  4  0  0  0  0  0  0  0  0999 V2000\n   -1.2990    0.7500    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n    0.0000    0.0000    0.0000 P   0  0  0  0  0  0  0  0  0  0  0  0\n    1.2990   -0.7500    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.7500   -1.2990    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n    0.7500    1.2990    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  2  0\n  2  3  1  0\n  2  4  1  0\n  2  5  1  0\nM  RGP  2   4   1   5   2\nM  END\n","n":"Phosphate","na":"p","rs":2,"at":{"R1":"OH","R2":"OH"}}},
t11:{"args":{"a":{"T":"ATOM","p":{"x":205,"y":136},"charge":0,"isotope":null,"radical":null,"group":null,"alias":null,"superatom":null,"attachpoints":[],"rgroup":null,"bio":{"type":"HELM_SUGAR","id":null,"ambiguity":null,"annotation":"5'","annotationshowright":null},"locked":false,"hidden":null,"_rect":null,"elem":"r","color":null,"hcount":null,"selected":false,"f":0,"bonds":null,"id":null,"atommapid":null,"query":null,"hasError":null,"hs":null,"val":null,"_parent":"[object Object]","_aaid":1,"ringclosures":null,"_outside":false,"_haslabel":false},"name":"r"},"tgt":{"id":"r","m":"\n     RDKit          2D\n\n 12 12  0  0  0  0  0  0  0  0999 V2000\n    3.0807    1.3822    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n    1.8672    0.5005    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.4406    0.9640    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.0229    2.3906    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.4901    2.7025    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n   -0.4410   -0.2495    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.9410   -0.2495    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.6910   -1.5485    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.1910   -1.5485    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n    0.4406   -1.4630    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n    1.8672   -0.9995    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.0807   -1.8812    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n  2  1  1  6\n  2  3  1  0\n  3  4  1  1\n  4  5  1  0\n  3  6  1  0\n  6  7  1  6\n  7  8  1  0\n  8  9  1  0\n  6 10  1  0\n 10 11  1  0\n 11 12  1  6\n 11  2  1  0\nM  RGP  3   5   2   9   1  12   3\nM  END\n","n":"Ribose","na":"r","rs":3,"at":{"R1":"H","R2":"H","R3":"OH"}}},
t12:{"args":{"a":{"T":"ATOM","p":{"x":205,"y":184},"charge":0,"isotope":null,"radical":null,"group":null,"alias":null,"superatom":null,"attachpoints":[],"rgroup":null,"bio":{"type":"HELM_BASE","id":1,"ambiguity":null},"locked":false,"hidden":null,"_rect":null,"elem":"A","color":null,"hcount":null,"selected":false,"f":0,"bonds":null,"id":null,"atommapid":null,"query":null,"hasError":null,"hs":null,"val":null,"tag":null,"_parent":"[object Object]","_aaid":2,"ringclosures":null,"_outside":false,"_haslabel":false},"name":"A"},"tgt":{"id":"A","m":"\n     RDKit          2D\n\n 11 12  0  0  0  0  0  0  0  0999 V2000\n   -3.1265    0.5194    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.8274   -0.2306    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.8274   -1.7306    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.5284   -2.4806    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.7707   -1.7306    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n    0.7707   -0.2306    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.5284    0.5194    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.2165    1.9866    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n    1.2753    2.1434    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    1.8854    0.7731    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n    3.3526    0.4612    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  1  0\n  2  3  2  0\n  3  4  1  0\n  4  5  2  0\n  5  6  1  0\n  6  7  2  0\n  7  8  1  0\n  8  9  2  0\n  9 10  1  0\n 10 11  1  0\n  7  2  1  0\n 10  6  1  0\nM  RGP  1  11   1\nM  END\n","n":"Adenine","na":"A","rs":1,"at":{"R1":"H"}}},
t13:{"args":{"a":{"T":"ATOM","p":{"x":240,"y":0},"charge":0,"isotope":null,"radical":null,"group":null,"alias":null,"superatom":null,"attachpoints":[],"rgroup":null,"bio":{"type":"HELM_SUGAR","id":null,"ambiguity":null},"locked":false,"hidden":null,"_rect":null,"elem":"r","color":null,"hcount":null,"selected":false,"f":null,"bonds":null,"id":null,"atommapid":null,"query":null,"hasError":null,"hs":null,"val":null,"_parent":"[object Object]","_aaid":7}},"tgt":{"id":"r","m":"\n     RDKit          2D\n\n 12 12  0  0  0  0  0  0  0  0999 V2000\n    3.0807    1.3822    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n    1.8672    0.5005    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.4406    0.9640    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.0229    2.3906    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.4901    2.7025    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n   -0.4410   -0.2495    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.9410   -0.2495    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.6910   -1.5485    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.1910   -1.5485    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n    0.4406   -1.4630    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n    1.8672   -0.9995    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.0807   -1.8812    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n  2  1  1  6\n  2  3  1  0\n  3  4  1  1\n  4  5  1  0\n  3  6  1  0\n  6  7  1  6\n  7  8  1  0\n  8  9  1  0\n  6 10  1  0\n 10 11  1  0\n 11 12  1  6\n 11  2  1  0\nM  RGP  3   5   2   9   1  12   3\nM  END\n","n":"Ribose","na":"r","rs":3,"at":{"R1":"H","R2":"H","R3":"OH"}}},
t14:{"args":{"a":{"T":"ATOM","p":{"x":240,"y":0},"charge":0,"isotope":null,"radical":null,"group":null,"alias":null,"superatom":null,"attachpoints":[],"rgroup":null,"bio":{"type":"HELM_SUGAR","id":null,"ambiguity":null},"locked":false,"hidden":null,"_rect":null,"elem":"r","color":null,"hcount":null,"selected":false,"f":null,"bonds":null,"id":null,"atommapid":null,"query":null,"hasError":null,"hs":null,"val":null,"tag":null,"_parent":"[object Object]","_aaid":7}},"tgt":{"id":"r","m":"\n     RDKit          2D\n\n 12 12  0  0  0  0  0  0  0  0999 V2000\n    3.0807    1.3822    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n    1.8672    0.5005    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.4406    0.9640    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.0229    2.3906    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.4901    2.7025    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n   -0.4410   -0.2495    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.9410   -0.2495    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.6910   -1.5485    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.1910   -1.5485    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n    0.4406   -1.4630    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n    1.8672   -0.9995    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.0807   -1.8812    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n  2  1  1  6\n  2  3  1  0\n  3  4  1  1\n  4  5  1  0\n  3  6  1  0\n  6  7  1  6\n  7  8  1  0\n  8  9  1  0\n  6 10  1  0\n 10 11  1  0\n 11 12  1  6\n 11  2  1  0\nM  RGP  3   5   2   9   1  12   3\nM  END\n","n":"Ribose","na":"r","rs":3,"at":{"R1":"H","R2":"H","R3":"OH"}}},
t15:{"args":{"a":{"T":"ATOM","p":{"x":240,"y":48},"charge":0,"isotope":null,"radical":null,"group":null,"alias":null,"superatom":null,"attachpoints":[],"rgroup":null,"bio":{"type":"HELM_BASE","id":null,"ambiguity":null},"locked":false,"hidden":null,"_rect":null,"elem":"C","color":null,"hcount":null,"selected":false,"f":null,"bonds":null,"id":null,"atommapid":null,"query":null,"hasError":null,"hs":null,"val":null,"tag":null,"_parent":"[object Object]","_aaid":8}},"tgt":{"id":"C","m":"\n     RDKit          2D\n\n  9  9  0  0  0  0  0  0  0  0999 V2000\n    2.8868    1.3333    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n    1.5877    0.5833    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    1.5877   -0.9167    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.2887   -1.6667    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.0104   -0.9167    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.3094   -1.6667    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n   -1.0104    0.5833    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.3094    1.3333    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n    0.2887    1.3333    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  1  0\n  2  3  1  0\n  3  4  2  0\n  4  5  1  0\n  5  6  1  0\n  5  7  1  0\n  7  8  2  0\n  7  9  1  0\n  9  2  2  0\nM  RGP  1   6   1\nM  END\n","n":"Cytosine","na":"C","rs":1,"at":{"R1":"H"}}},
t16:{"args":{"a":{"T":"ATOM","p":{"x":253,"y":136},"charge":0,"isotope":null,"radical":null,"group":null,"alias":null,"superatom":null,"attachpoints":[],"rgroup":null,"bio":{"type":"HELM_LINKER","id":null,"ambiguity":null},"locked":false,"hidden":null,"_rect":null,"elem":"p","color":null,"hcount":null,"selected":false,"f":0,"bonds":null,"id":null,"atommapid":null,"query":null,"hasError":null,"hs":null,"val":null,"_parent":"[object Object]","_aaid":3,"ringclosures":null,"_outside":false,"_haslabel":false},"name":"p"},"tgt":{"id":"p","m":"\n     RDKit          2D\n\n  5  4  0  0  0  0  0  0  0  0999 V2000\n   -1.2990    0.7500    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n    0.0000    0.0000    0.0000 P   0  0  0  0  0  0  0  0  0  0  0  0\n    1.2990   -0.7500    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.7500   -1.2990    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n    0.7500    1.2990    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  2  0\n  2  3  1  0\n  2  4  1  0\n  2  5  1  0\nM  RGP  2   4   1   5   2\nM  END\n","n":"Phosphate","na":"p","rs":2,"at":{"R1":"OH","R2":"OH"}}},
t17:{"args":{"a":{"T":"ATOM","p":{"x":288,"y":0},"charge":0,"isotope":null,"radical":null,"group":null,"alias":null,"superatom":null,"attachpoints":[],"rgroup":null,"bio":{"type":"HELM_LINKER","id":null,"ambiguity":null},"locked":false,"hidden":null,"_rect":null,"elem":"p","color":null,"hcount":null,"selected":false,"f":null,"bonds":null,"id":null,"atommapid":null,"query":null,"hasError":null,"hs":null,"val":null,"tag":null,"_parent":"[object Object]","_aaid":9}},"tgt":{"id":"p","m":"\n     RDKit          2D\n\n  5  4  0  0  0  0  0  0  0  0999 V2000\n   -1.2990    0.7500    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n    0.0000    0.0000    0.0000 P   0  0  0  0  0  0  0  0  0  0  0  0\n    1.2990   -0.7500    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.7500   -1.2990    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n    0.7500    1.2990    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  2  0\n  2  3  1  0\n  2  4  1  0\n  2  5  1  0\nM  RGP  2   4   1   5   2\nM  END\n","n":"Phosphate","na":"p","rs":2,"at":{"R1":"OH","R2":"OH"}}},
t18:{"args":{"a":{"T":"ATOM","p":{"x":301,"y":136},"charge":0,"isotope":null,"radical":null,"group":null,"alias":null,"superatom":null,"attachpoints":[],"rgroup":null,"bio":{"type":"HELM_SUGAR","id":null,"ambiguity":null,"annotation":null},"locked":false,"hidden":null,"_rect":null,"elem":"r","color":null,"hcount":null,"selected":false,"f":0,"bonds":null,"id":null,"atommapid":null,"query":null,"hasError":null,"hs":null,"val":null,"_parent":"[object Object]","_aaid":1,"ringclosures":null,"_outside":false,"_haslabel":false},"name":"r"},"tgt":{"id":"r","m":"\n     RDKit          2D\n\n 12 12  0  0  0  0  0  0  0  0999 V2000\n    3.0807    1.3822    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n    1.8672    0.5005    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.4406    0.9640    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.0229    2.3906    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.4901    2.7025    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n   -0.4410   -0.2495    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.9410   -0.2495    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.6910   -1.5485    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.1910   -1.5485    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n    0.4406   -1.4630    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n    1.8672   -0.9995    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.0807   -1.8812    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n  2  1  1  6\n  2  3  1  0\n  3  4  1  1\n  4  5  1  0\n  3  6  1  0\n  6  7  1  6\n  7  8  1  0\n  8  9  1  0\n  6 10  1  0\n 10 11  1  0\n 11 12  1  6\n 11  2  1  0\nM  RGP  3   5   2   9   1  12   3\nM  END\n","n":"Ribose","na":"r","rs":3,"at":{"R1":"H","R2":"H","R3":"OH"}}},
t19:{"args":{"a":{"T":"ATOM","p":{"x":301,"y":184},"charge":0,"isotope":null,"radical":null,"group":null,"alias":null,"superatom":null,"attachpoints":[],"rgroup":null,"bio":{"type":"HELM_BASE","id":2,"ambiguity":null},"locked":false,"hidden":null,"_rect":null,"elem":"G","color":null,"hcount":null,"selected":false,"f":0,"bonds":null,"id":null,"atommapid":null,"query":null,"hasError":null,"hs":null,"val":null,"tag":null,"_parent":"[object Object]","_aaid":2,"ringclosures":null,"_outside":false,"_haslabel":false},"name":"G"},"tgt":{"id":"G","m":"\n     RDKit          2D\n\n 12 13  0  0  0  0  0  0  0  0999 V2000\n    3.4022   -1.4050    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n    2.1032   -0.6550    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.8041   -1.4050    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.4949   -0.6550    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.4949    0.8450    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.9215    1.3085    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.8032    0.0950    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.9215   -1.1185    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.3850   -2.5451    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n    0.8041    1.5950    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.8041    3.0950    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n    2.1032    0.8450    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  1  0\n  2  3  2  0\n  3  4  1  0\n  4  5  2  0\n  5  6  1  0\n  6  7  2  0\n  7  8  1  0\n  8  9  1  0\n  5 10  1  0\n 10 11  2  0\n 10 12  1  0\n 12  2  1  0\n  8  4  1  0\nM  RGP  1   9   1\nM  END\n","n":"Guanine","na":"G","rs":1,"at":{"R1":"H"}}},
t20:{"args":{"a":{"T":"ATOM","p":{"x":349,"y":136},"charge":0,"isotope":null,"radical":null,"group":null,"alias":null,"superatom":null,"attachpoints":[],"rgroup":null,"bio":{"type":"HELM_LINKER","id":null,"ambiguity":null},"locked":false,"hidden":null,"_rect":null,"elem":"p","color":null,"hcount":null,"selected":false,"f":0,"bonds":null,"id":null,"atommapid":null,"query":null,"hasError":null,"hs":null,"val":null,"_parent":"[object Object]","_aaid":6,"ringclosures":null,"_outside":false,"_haslabel":false},"name":"p"},"tgt":{"id":"p","m":"\n     RDKit          2D\n\n  5  4  0  0  0  0  0  0  0  0999 V2000\n   -1.2990    0.7500    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n    0.0000    0.0000    0.0000 P   0  0  0  0  0  0  0  0  0  0  0  0\n    1.2990   -0.7500    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.7500   -1.2990    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n    0.7500    1.2990    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  2  0\n  2  3  1  0\n  2  4  1  0\n  2  5  1  0\nM  RGP  2   4   1   5   2\nM  END\n","n":"Phosphate","na":"p","rs":2,"at":{"R1":"OH","R2":"OH"}}},
t21:{"args":{"a":{"T":"ATOM","p":{"x":397,"y":136},"charge":0,"isotope":null,"radical":null,"group":null,"alias":null,"superatom":null,"attachpoints":[],"rgroup":null,"bio":{"type":"HELM_SUGAR","id":null,"ambiguity":null,"annotation":null},"locked":false,"hidden":null,"_rect":null,"elem":"r","color":null,"hcount":null,"selected":false,"f":0,"bonds":null,"id":null,"atommapid":null,"query":null,"hasError":null,"hs":null,"val":null,"_parent":"[object Object]","_aaid":1,"ringclosures":null,"_outside":false,"_haslabel":false},"name":"r"},"tgt":{"id":"r","m":"\n     RDKit          2D\n\n 12 12  0  0  0  0  0  0  0  0999 V2000\n    3.0807    1.3822    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n    1.8672    0.5005    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.4406    0.9640    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.0229    2.3906    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.4901    2.7025    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n   -0.4410   -0.2495    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.9410   -0.2495    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.6910   -1.5485    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.1910   -1.5485    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n    0.4406   -1.4630    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n    1.8672   -0.9995    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.0807   -1.8812    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n  2  1  1  6\n  2  3  1  0\n  3  4  1  1\n  4  5  1  0\n  3  6  1  0\n  6  7  1  6\n  7  8  1  0\n  8  9  1  0\n  6 10  1  0\n 10 11  1  0\n 11 12  1  6\n 11  2  1  0\nM  RGP  3   5   2   9   1  12   3\nM  END\n","n":"Ribose","na":"r","rs":3,"at":{"R1":"H","R2":"H","R3":"OH"}}},
t22:{"args":{"a":{"T":"ATOM","p":{"x":397,"y":184},"charge":0,"isotope":null,"radical":null,"group":null,"alias":null,"superatom":null,"attachpoints":[],"rgroup":null,"bio":{"type":"HELM_BASE","id":3,"ambiguity":null},"locked":false,"hidden":null,"_rect":null,"elem":"C","color":null,"hcount":null,"selected":false,"f":0,"bonds":null,"id":null,"atommapid":null,"query":null,"hasError":null,"hs":null,"val":null,"tag":null,"_parent":"[object Object]","_aaid":2,"ringclosures":null,"_outside":false,"_haslabel":false},"name":"C"},"tgt":{"id":"C","m":"\n     RDKit          2D\n\n  9  9  0  0  0  0  0  0  0  0999 V2000\n    2.8868    1.3333    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n    1.5877    0.5833    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    1.5877   -0.9167    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.2887   -1.6667    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.0104   -0.9167    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.3094   -1.6667    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n   -1.0104    0.5833    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.3094    1.3333    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n    0.2887    1.3333    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  1  0\n  2  3  1  0\n  3  4  2  0\n  4  5  1  0\n  5  6  1  0\n  5  7  1  0\n  7  8  2  0\n  7  9  1  0\n  9  2  2  0\nM  RGP  1   6   1\nM  END\n","n":"Cytosine","na":"C","rs":1,"at":{"R1":"H"}}},
t23:{"args":{"a":{"T":"ATOM","p":{"x":445,"y":136},"charge":0,"isotope":null,"radical":null,"group":null,"alias":null,"superatom":null,"attachpoints":[],"rgroup":null,"bio":{"type":"HELM_LINKER","id":null,"ambiguity":null},"locked":false,"hidden":null,"_rect":null,"elem":"p","color":null,"hcount":null,"selected":false,"f":0,"bonds":null,"id":null,"atommapid":null,"query":null,"hasError":null,"hs":null,"val":null,"_parent":"[object Object]","_aaid":9,"ringclosures":null,"_outside":false,"_haslabel":false},"name":"p"},"tgt":{"id":"p","m":"\n     RDKit          2D\n\n  5  4  0  0  0  0  0  0  0  0999 V2000\n   -1.2990    0.7500    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n    0.0000    0.0000    0.0000 P   0  0  0  0  0  0  0  0  0  0  0  0\n    1.2990   -0.7500    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.7500   -1.2990    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n    0.7500    1.2990    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  2  0\n  2  3  1  0\n  2  4  1  0\n  2  5  1  0\nM  RGP  2   4   1   5   2\nM  END\n","n":"Phosphate","na":"p","rs":2,"at":{"R1":"OH","R2":"OH"}}},
t24:{"args":{"a":{"T":"ATOM","p":{"x":48,"y":0},"charge":0,"isotope":null,"radical":null,"group":null,"alias":null,"superatom":null,"attachpoints":[],"rgroup":null,"bio":{"type":"HELM_SUGAR","id":null,"ambiguity":null},"locked":false,"hidden":null,"_rect":null,"elem":"r","color":null,"hcount":null,"selected":false,"f":null,"bonds":null,"id":null,"atommapid":null,"query":null,"hasError":null,"hs":null,"val":null,"_parent":"[object Object]","_aaid":1}},"tgt":{"id":"r","m":"\n     RDKit          2D\n\n 12 12  0  0  0  0  0  0  0  0999 V2000\n    3.0807    1.3822    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n    1.8672    0.5005    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.4406    0.9640    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.0229    2.3906    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.4901    2.7025    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n   -0.4410   -0.2495    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.9410   -0.2495    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.6910   -1.5485    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.1910   -1.5485    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n    0.4406   -1.4630    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n    1.8672   -0.9995    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.0807   -1.8812    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n  2  1  1  6\n  2  3  1  0\n  3  4  1  1\n  4  5  1  0\n  3  6  1  0\n  6  7  1  6\n  7  8  1  0\n  8  9  1  0\n  6 10  1  0\n 10 11  1  0\n 11 12  1  6\n 11  2  1  0\nM  RGP  3   5   2   9   1  12   3\nM  END\n","n":"Ribose","na":"r","rs":3,"at":{"R1":"H","R2":"H","R3":"OH"}}},
t25:{"args":{"a":{"T":"ATOM","p":{"x":48,"y":0},"charge":0,"isotope":null,"radical":null,"group":null,"alias":null,"superatom":null,"attachpoints":[],"rgroup":null,"bio":{"type":"HELM_SUGAR","id":null,"ambiguity":null},"locked":false,"hidden":null,"_rect":null,"elem":"r","color":null,"hcount":null,"selected":false,"f":null,"bonds":null,"id":null,"atommapid":null,"query":null,"hasError":null,"hs":null,"val":null,"tag":null,"_parent":"[object Object]","_aaid":1}},"tgt":{"id":"r","m":"\n     RDKit          2D\n\n 12 12  0  0  0  0  0  0  0  0999 V2000\n    3.0807    1.3822    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n    1.8672    0.5005    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.4406    0.9640    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.0229    2.3906    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.4901    2.7025    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n   -0.4410   -0.2495    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.9410   -0.2495    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.6910   -1.5485    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.1910   -1.5485    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n    0.4406   -1.4630    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n    1.8672   -0.9995    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.0807   -1.8812    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n  2  1  1  6\n  2  3  1  0\n  3  4  1  1\n  4  5  1  0\n  3  6  1  0\n  6  7  1  6\n  7  8  1  0\n  8  9  1  0\n  6 10  1  0\n 10 11  1  0\n 11 12  1  6\n 11  2  1  0\nM  RGP  3   5   2   9   1  12   3\nM  END\n","n":"Ribose","na":"r","rs":3,"at":{"R1":"H","R2":"H","R3":"OH"}}},
t26:{"args":{"a":{"T":"ATOM","p":{"x":48,"y":48},"charge":0,"isotope":null,"radical":null,"group":null,"alias":null,"superatom":null,"attachpoints":[],"rgroup":null,"bio":{"type":"HELM_BASE","id":null,"ambiguity":null},"locked":false,"hidden":null,"_rect":null,"elem":"A","color":null,"hcount":null,"selected":false,"f":null,"bonds":null,"id":null,"atommapid":null,"query":null,"hasError":null,"hs":null,"val":null,"tag":null,"_parent":"[object Object]","_aaid":2}},"tgt":{"id":"A","m":"\n     RDKit          2D\n\n 11 12  0  0  0  0  0  0  0  0999 V2000\n   -3.1265    0.5194    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.8274   -0.2306    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.8274   -1.7306    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.5284   -2.4806    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.7707   -1.7306    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n    0.7707   -0.2306    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.5284    0.5194    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.2165    1.9866    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n    1.2753    2.1434    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    1.8854    0.7731    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n    3.3526    0.4612    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  1  0\n  2  3  2  0\n  3  4  1  0\n  4  5  2  0\n  5  6  1  0\n  6  7  2  0\n  7  8  1  0\n  8  9  2  0\n  9 10  1  0\n 10 11  1  0\n  7  2  1  0\n 10  6  1  0\nM  RGP  1  11   1\nM  END\n","n":"Adenine","na":"A","rs":1,"at":{"R1":"H"}}},
t27:{"args":{"a":{"T":"ATOM","p":{"x":96,"y":0},"charge":0,"isotope":null,"radical":null,"group":null,"alias":null,"superatom":null,"attachpoints":[],"rgroup":null,"bio":{"type":"HELM_LINKER","id":null,"ambiguity":null},"locked":false,"hidden":null,"_rect":null,"elem":"p","color":null,"hcount":null,"selected":false,"f":null,"bonds":null,"id":null,"atommapid":null,"query":null,"hasError":null,"hs":null,"val":null,"_parent":"[object Object]","_aaid":3}},"tgt":{"id":"p","m":"\n     RDKit          2D\n\n  5  4  0  0  0  0  0  0  0  0999 V2000\n   -1.2990    0.7500    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n    0.0000    0.0000    0.0000 P   0  0  0  0  0  0  0  0  0  0  0  0\n    1.2990   -0.7500    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.7500   -1.2990    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n    0.7500    1.2990    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  2  0\n  2  3  1  0\n  2  4  1  0\n  2  5  1  0\nM  RGP  2   4   1   5   2\nM  END\n","n":"Phosphate","na":"p","rs":2,"at":{"R1":"OH","R2":"OH"}}},
t28:{"args":{"a":{"T":"ATOM","p":{"x":96,"y":0},"charge":0,"isotope":null,"radical":null,"group":null,"alias":null,"superatom":null,"attachpoints":[],"rgroup":null,"bio":{"type":"HELM_LINKER","id":null,"ambiguity":null},"locked":false,"hidden":null,"_rect":null,"elem":"p","color":null,"hcount":null,"selected":false,"f":null,"bonds":null,"id":null,"atommapid":null,"query":null,"hasError":null,"hs":null,"val":null,"tag":null,"_parent":"[object Object]","_aaid":3}},"tgt":{"id":"p","m":"\n     RDKit          2D\n\n  5  4  0  0  0  0  0  0  0  0999 V2000\n   -1.2990    0.7500    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n    0.0000    0.0000    0.0000 P   0  0  0  0  0  0  0  0  0  0  0  0\n    1.2990   -0.7500    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.7500   -1.2990    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n    0.7500    1.2990    0.0000 R#  0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  2  0\n  2  3  1  0\n  2  4  1  0\n  2  5  1  0\nM  RGP  2   4   1   5   2\nM  END\n","n":"Phosphate","na":"p","rs":2,"at":{"R1":"OH","R2":"OH"}}}
    //@formatter:off
  /* eslint-enable */
};

category('getMonomer', ()=> {
  let helmHelper: IHelmHelper;
  let monomerLibHelper: IMonomerLibHelper;
  /** Backup actual user's monomer libraries settings */
  let userLibSettings: UserLibSettings;

  before(async ()=>{
    await initHelmMainPackage();

    [monomerLibHelper, helmHelper, userLibSettings] = await Promise.all(
      [getMonomerLibHelper(), getHelmHelper(), getUserLibSettings()]);

    await monomerLibHelper.loadMonomerLibForTests(); // load default libraries for tests
  });

  after(async ()=>{
    await setUserLibSettings(userLibSettings);
    await monomerLibHelper.loadMonomerLib(true);
  });

  test('original', async () =>{
    const monomerLib = monomerLibHelper.getMonomerLib();
    rewriteLibraries(monomerLib);

    const helmHelper: IHelmHelper = await getHelmHelper();
    expect(helmHelper != null, true);
    const getMonomerFunc: GetMonomerFunc = helmHelper.originalMonomersFuncs!.getMonomer!;
    const res = _testAll('original', getMonomerFunc);
    return getResultDf ? (res ?? DG.DataFrame.create(0)) : null;
  }, {isAggregated: getResultDf});

  test('monomerLib', async () =>{
    const getMonomerFunc = org.helm.webeditor.Monomers.getMonomer;
    const res = _testAll('monomerLib', getMonomerFunc);
    return getResultDf ? (res ?? DG.DataFrame.create(0)) : null;
  }, {isAggregated: getResultDf});

  function _testAll(prefix: string, getMonomerFunc: GetMonomerFunc): DG.DataFrame {
    const resDf = DG.DataFrame.fromColumns([
      DG.Column.fromStrings('subTest', []),
      DG.Column.fromList(DG.COLUMN_TYPE.BOOL, 'success', []),
      DG.Column.fromStrings('res', []),
      DG.Column.fromStrings('tgt', []),
      DG.Column.fromStrings('error', []),
      DG.Column.fromStrings('stack', []),
    ]);

    // const testCount: number = Object.keys(tests).length + 1;
    // //* eslint-disable no-array-constructor */
    // const subTestList: string[] = new Array<string>(testCount);
    // const successList: boolean[] = new Array<boolean>(testCount);
    // const resList: string[] = new Array<string>(testCount);
    // const tgtList:string[] = new Array<string>(testCount);
    // const errorList: string[] = new Array<string>(testCount);
    // const stackList: string[] = new Array<string>(testCount);
    // /* eslint-enable no-array-constructor */

    const resI = resDf.rows.addNew().idx;
    resDf.set('subTest', resI, 'Monomer lib');
    resDf.set('res', resI, '');
    resDf.set('tgt', resI, '');
    try {
      resDf.set('success', resI, true);
    } catch (err) {
      const [errMsg, errStack] = errInfo(err);
      resDf.set('error', resI, errMsg);
      resDf.set('stack', resI, errStack);
      resDf.set('success', resI, false);
      throw err;
    }

    for (const [[testName, testData], testI] of wu.enumerate(Object.entries(tests))) {
      const a: HelmAtom | HelmType = getAtomFromJson(testData.args.a);
      const [biotype, elem] = getMonomerHandleArgs(a, testData.args.name);
      const tgt = testData.tgt;

      const resI = resDf.rows.addNew().idx;
      resDf.set('subTest', resI, `${prefix}-${testName}-${biotype}-${elem}`);
      resDf.set('tgt', resI, JSON.stringify(tgt ? {id: tgt.id, n: tgt.n, rs: tgt.rs} : null));
      try {
        const res: any = getMonomerFunc(a, testData.args.name);
        resDf.set('res', resI, JSON.stringify(res ? {id: res.id, n: res.n, rs: res.rs} : null));
        expectObjectWithNull(res, tgt);
        resDf.set('success', resI, true);
      } catch (err) {
        const [errMsg, errStack] = errInfo(err);
        resDf.set('error', resI, errMsg);
        resDf.set('stack', resI, errStack);
        resDf.set('success', resI, false);
        throw err;
      }
    }
    return resDf;
  }

  test('missing', async ()=> {
    const monomerLib = monomerLibHelper.getMonomerLib();
    /* Tests getMonomer function adding missing monomers. */
    const helmStr = 'PEPTIDE1{[mis1].R.[mis2].T.C.F}$$$$;';

    const libSummary = monomerLib.getSummaryObj();
    const editor = new JSDraw2.Editor(ui.div(), {viewonly: true});
    editor.setHelm(helmStr);
    libSummary[PolymerTypes.PEPTIDE] += 2;
    expectMonomerLib(monomerLib, libSummary);
  });
});

function getAtomFromJson(argA: IJsAtom<HelmType> | HelmType): HelmAtom | HelmType {
  let res: HelmAtom | HelmType;
  const a = argA as IJsAtom<HelmType>;
  if (a.T === 'ATOM')
    res = new JSDraw2.Atom(a.p, a.elem, a.bio);
  else
    res = argA as HelmType;
  return res;
}

export function expectObjectWithNull(actual: { [key: string]: any }, expected: { [key: string]: any }) {
  if (actual == null && expected == null)
    return;
  else if (actual == null && expected != null)
    throw new Error('actual is null, but expected is not null');
  else if (actual!= null && expected == null)
    throw new Error('actual is not null, but expected is null');
  else {
    for (const [expectedKey, expectedValue] of Object.entries(expected)) {
      if (!(expectedKey in actual || actual.hasOwnProperty(expectedKey)))
        throw new Error(`Expected property "${expectedKey}" not found`);

      const actualValue = actual[expectedKey];
      if (actualValue instanceof Array && expectedValue instanceof Array)
        expectArray(actualValue, expectedValue);
      else if (actualValue instanceof Object && expectedValue instanceof Object)
        expectObjectWithNull(actualValue, expectedValue);
      else if (Number.isFinite(actualValue) && Number.isFinite(expectedValue))
        expectFloat(actualValue, expectedValue);
      else if (actualValue != expectedValue)
        throw new Error(`Expected (${expectedValue}) for key '${expectedKey}', got (${actualValue})`);
    }
  }
}
