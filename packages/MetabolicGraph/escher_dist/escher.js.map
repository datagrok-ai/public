{"version":3,"file":"escher.js","mappings":"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","sources":["webpack://escher/webpack/universalModuleDefinition","webpack://escher/./src/css/Picker.css","webpack://escher/./node_modules/rc-slider-preact/lib/util.js","webpack://escher/./src/css/Builder.css","webpack://escher/./node_modules/rc-slider-preact/lib/Track.js","webpack://escher/./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js","webpack://escher/./src/css/Dropdown.css","webpack://escher/./node_modules/rc-slider-preact/lib/Slider.js","webpack://escher/./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js","webpack://escher/./node_modules/add-dom-event-listener/lib/EventObject.js","webpack://escher/./node_modules/style-loader/dist/runtime/styleTagTransform.js","webpack://escher/./node_modules/preact/dist/preact.mjs","webpack://escher/./src/css/SettingsMenu.css","webpack://escher/./node_modules/rc-slider-preact/lib/Marks.js","webpack://escher/./node_modules/rc-slider-preact/lib/main.js","webpack://escher/./node_modules/add-dom-event-listener/lib/index.js","webpack://escher/./node_modules/object-assign/index.js","webpack://escher/./src/css/DistributionTooltipComponent.css","webpack://escher/./node_modules/invariant/browser.js","webpack://escher/./node_modules/css-loader/dist/runtime/api.js","webpack://escher/./node_modules/css-loader/dist/runtime/sourceMaps.js","webpack://escher/./icons/css/fontello.css","webpack://escher/./src/css/SearchBar.css","webpack://escher/./node_modules/mousetrap/mousetrap.js","webpack://escher/./node_modules/css-loader/dist/runtime/getUrl.js","webpack://escher/./src/css/ButtonPanel.css","webpack://escher/./node_modules/style-loader/dist/runtime/insertStyleElement.js","webpack://escher/./node_modules/vkbeautify/index.js","webpack://escher/./node_modules/rc-slider-preact/lib/Range.js","webpack://escher/./node_modules/style-loader/dist/runtime/insertBySelector.js","webpack://escher/./node_modules/rc-slider-preact/lib/index.css","webpack://escher/./node_modules/rc-slider-preact/lib/createSlider.js","webpack://escher/./node_modules/add-dom-event-listener/lib/EventBaseObject.js","webpack://escher/./node_modules/style-loader/dist/runtime/styleDomAPI.js","webpack://escher/./node_modules/rc-slider-preact/lib/Handle.js","webpack://escher/./node_modules/shallowequal/index.js","webpack://escher/./src/css/ScaleSlider.css","webpack://escher/./node_modules/rc-slider-preact/lib/Steps.js","webpack://escher/./node_modules/immutability-helper/index.js","webpack://escher/./node_modules/rc-slider-preact/lib/KeyCode.js","webpack://escher/./node_modules/file-saver/FileSaver.js","webpack://escher/./node_modules/classnames/index.js","webpack://escher/webpack/bootstrap","webpack://escher/webpack/runtime/amd define","webpack://escher/webpack/runtime/amd options","webpack://escher/webpack/runtime/compat get default export","webpack://escher/webpack/runtime/define property getters","webpack://escher/webpack/runtime/global","webpack://escher/webpack/runtime/hasOwnProperty shorthand","webpack://escher/webpack/runtime/make namespace object","webpack://escher/webpack/runtime/publicPath","webpack://escher/webpack/runtime/jsonp chunk loading","webpack://escher/webpack/runtime/nonce","webpack://escher/./node_modules/underscore/modules/_setup.js","webpack://escher/./node_modules/underscore/modules/restArguments.js","webpack://escher/./node_modules/underscore/modules/isObject.js","webpack://escher/./node_modules/underscore/modules/isNull.js","webpack://escher/./node_modules/underscore/modules/isUndefined.js","webpack://escher/./node_modules/underscore/modules/isBoolean.js","webpack://escher/./node_modules/underscore/modules/isElement.js","webpack://escher/./node_modules/underscore/modules/_tagTester.js","webpack://escher/./node_modules/underscore/modules/isString.js","webpack://escher/./node_modules/underscore/modules/isNumber.js","webpack://escher/./node_modules/underscore/modules/isDate.js","webpack://escher/./node_modules/underscore/modules/isRegExp.js","webpack://escher/./node_modules/underscore/modules/isError.js","webpack://escher/./node_modules/underscore/modules/isSymbol.js","webpack://escher/./node_modules/underscore/modules/isArrayBuffer.js","webpack://escher/./node_modules/underscore/modules/isFunction.js","webpack://escher/./node_modules/underscore/modules/_hasObjectTag.js","webpack://escher/./node_modules/underscore/modules/_stringTagBug.js","webpack://escher/./node_modules/underscore/modules/isDataView.js","webpack://escher/./node_modules/underscore/modules/isArray.js","webpack://escher/./node_modules/underscore/modules/_has.js","webpack://escher/./node_modules/underscore/modules/isArguments.js","webpack://escher/./node_modules/underscore/modules/isFinite.js","webpack://escher/./node_modules/underscore/modules/isNaN.js","webpack://escher/./node_modules/underscore/modules/constant.js","webpack://escher/./node_modules/underscore/modules/_createSizePropertyCheck.js","webpack://escher/./node_modules/underscore/modules/_shallowProperty.js","webpack://escher/./node_modules/underscore/modules/_getByteLength.js","webpack://escher/./node_modules/underscore/modules/_isBufferLike.js","webpack://escher/./node_modules/underscore/modules/isTypedArray.js","webpack://escher/./node_modules/underscore/modules/_getLength.js","webpack://escher/./node_modules/underscore/modules/_collectNonEnumProps.js","webpack://escher/./node_modules/underscore/modules/keys.js","webpack://escher/./node_modules/underscore/modules/isEmpty.js","webpack://escher/./node_modules/underscore/modules/isMatch.js","webpack://escher/./node_modules/underscore/modules/underscore.js","webpack://escher/./node_modules/underscore/modules/_toBufferView.js","webpack://escher/./node_modules/underscore/modules/isEqual.js","webpack://escher/./node_modules/underscore/modules/allKeys.js","webpack://escher/./node_modules/underscore/modules/_methodFingerprint.js","webpack://escher/./node_modules/underscore/modules/isMap.js","webpack://escher/./node_modules/underscore/modules/isWeakMap.js","webpack://escher/./node_modules/underscore/modules/isSet.js","webpack://escher/./node_modules/underscore/modules/isWeakSet.js","webpack://escher/./node_modules/underscore/modules/values.js","webpack://escher/./node_modules/underscore/modules/pairs.js","webpack://escher/./node_modules/underscore/modules/invert.js","webpack://escher/./node_modules/underscore/modules/functions.js","webpack://escher/./node_modules/underscore/modules/_createAssigner.js","webpack://escher/./node_modules/underscore/modules/extend.js","webpack://escher/./node_modules/underscore/modules/extendOwn.js","webpack://escher/./node_modules/underscore/modules/defaults.js","webpack://escher/./node_modules/underscore/modules/_baseCreate.js","webpack://escher/./node_modules/underscore/modules/create.js","webpack://escher/./node_modules/underscore/modules/clone.js","webpack://escher/./node_modules/underscore/modules/tap.js","webpack://escher/./node_modules/underscore/modules/toPath.js","webpack://escher/./node_modules/underscore/modules/_toPath.js","webpack://escher/./node_modules/underscore/modules/_deepGet.js","webpack://escher/./node_modules/underscore/modules/get.js","webpack://escher/./node_modules/underscore/modules/has.js","webpack://escher/./node_modules/underscore/modules/identity.js","webpack://escher/./node_modules/underscore/modules/matcher.js","webpack://escher/./node_modules/underscore/modules/property.js","webpack://escher/./node_modules/underscore/modules/_optimizeCb.js","webpack://escher/./node_modules/underscore/modules/_baseIteratee.js","webpack://escher/./node_modules/underscore/modules/iteratee.js","webpack://escher/./node_modules/underscore/modules/_cb.js","webpack://escher/./node_modules/underscore/modules/mapObject.js","webpack://escher/./node_modules/underscore/modules/noop.js","webpack://escher/./node_modules/underscore/modules/propertyOf.js","webpack://escher/./node_modules/underscore/modules/times.js","webpack://escher/./node_modules/underscore/modules/random.js","webpack://escher/./node_modules/underscore/modules/now.js","webpack://escher/./node_modules/underscore/modules/_createEscaper.js","webpack://escher/./node_modules/underscore/modules/_escapeMap.js","webpack://escher/./node_modules/underscore/modules/escape.js","webpack://escher/./node_modules/underscore/modules/unescape.js","webpack://escher/./node_modules/underscore/modules/_unescapeMap.js","webpack://escher/./node_modules/underscore/modules/templateSettings.js","webpack://escher/./node_modules/underscore/modules/template.js","webpack://escher/./node_modules/underscore/modules/result.js","webpack://escher/./node_modules/underscore/modules/uniqueId.js","webpack://escher/./node_modules/underscore/modules/chain.js","webpack://escher/./node_modules/underscore/modules/_executeBound.js","webpack://escher/./node_modules/underscore/modules/partial.js","webpack://escher/./node_modules/underscore/modules/bind.js","webpack://escher/./node_modules/underscore/modules/_isArrayLike.js","webpack://escher/./node_modules/underscore/modules/_flatten.js","webpack://escher/./node_modules/underscore/modules/bindAll.js","webpack://escher/./node_modules/underscore/modules/memoize.js","webpack://escher/./node_modules/underscore/modules/delay.js","webpack://escher/./node_modules/underscore/modules/defer.js","webpack://escher/./node_modules/underscore/modules/throttle.js","webpack://escher/./node_modules/underscore/modules/debounce.js","webpack://escher/./node_modules/underscore/modules/wrap.js","webpack://escher/./node_modules/underscore/modules/negate.js","webpack://escher/./node_modules/underscore/modules/compose.js","webpack://escher/./node_modules/underscore/modules/after.js","webpack://escher/./node_modules/underscore/modules/before.js","webpack://escher/./node_modules/underscore/modules/once.js","webpack://escher/./node_modules/underscore/modules/findKey.js","webpack://escher/./node_modules/underscore/modules/_createPredicateIndexFinder.js","webpack://escher/./node_modules/underscore/modules/findIndex.js","webpack://escher/./node_modules/underscore/modules/findLastIndex.js","webpack://escher/./node_modules/underscore/modules/sortedIndex.js","webpack://escher/./node_modules/underscore/modules/_createIndexFinder.js","webpack://escher/./node_modules/underscore/modules/indexOf.js","webpack://escher/./node_modules/underscore/modules/lastIndexOf.js","webpack://escher/./node_modules/underscore/modules/find.js","webpack://escher/./node_modules/underscore/modules/findWhere.js","webpack://escher/./node_modules/underscore/modules/each.js","webpack://escher/./node_modules/underscore/modules/map.js","webpack://escher/./node_modules/underscore/modules/_createReduce.js","webpack://escher/./node_modules/underscore/modules/reduce.js","webpack://escher/./node_modules/underscore/modules/reduceRight.js","webpack://escher/./node_modules/underscore/modules/filter.js","webpack://escher/./node_modules/underscore/modules/reject.js","webpack://escher/./node_modules/underscore/modules/every.js","webpack://escher/./node_modules/underscore/modules/some.js","webpack://escher/./node_modules/underscore/modules/contains.js","webpack://escher/./node_modules/underscore/modules/invoke.js","webpack://escher/./node_modules/underscore/modules/pluck.js","webpack://escher/./node_modules/underscore/modules/where.js","webpack://escher/./node_modules/underscore/modules/max.js","webpack://escher/./node_modules/underscore/modules/min.js","webpack://escher/./node_modules/underscore/modules/toArray.js","webpack://escher/./node_modules/underscore/modules/sample.js","webpack://escher/./node_modules/underscore/modules/shuffle.js","webpack://escher/./node_modules/underscore/modules/sortBy.js","webpack://escher/./node_modules/underscore/modules/_group.js","webpack://escher/./node_modules/underscore/modules/groupBy.js","webpack://escher/./node_modules/underscore/modules/indexBy.js","webpack://escher/./node_modules/underscore/modules/countBy.js","webpack://escher/./node_modules/underscore/modules/partition.js","webpack://escher/./node_modules/underscore/modules/size.js","webpack://escher/./node_modules/underscore/modules/_keyInObj.js","webpack://escher/./node_modules/underscore/modules/pick.js","webpack://escher/./node_modules/underscore/modules/omit.js","webpack://escher/./node_modules/underscore/modules/initial.js","webpack://escher/./node_modules/underscore/modules/first.js","webpack://escher/./node_modules/underscore/modules/rest.js","webpack://escher/./node_modules/underscore/modules/last.js","webpack://escher/./node_modules/underscore/modules/compact.js","webpack://escher/./node_modules/underscore/modules/flatten.js","webpack://escher/./node_modules/underscore/modules/difference.js","webpack://escher/./node_modules/underscore/modules/without.js","webpack://escher/./node_modules/underscore/modules/uniq.js","webpack://escher/./node_modules/underscore/modules/union.js","webpack://escher/./node_modules/underscore/modules/intersection.js","webpack://escher/./node_modules/underscore/modules/unzip.js","webpack://escher/./node_modules/underscore/modules/zip.js","webpack://escher/./node_modules/underscore/modules/object.js","webpack://escher/./node_modules/underscore/modules/range.js","webpack://escher/./node_modules/underscore/modules/chunk.js","webpack://escher/./node_modules/underscore/modules/_chainResult.js","webpack://escher/./node_modules/underscore/modules/mixin.js","webpack://escher/./node_modules/underscore/modules/underscore-array-methods.js","webpack://escher/./node_modules/underscore/modules/index-default.js","webpack://escher/./node_modules/baconjs/dist/Bacon.mjs","webpack://escher/./node_modules/d3-selection/src/selector.js","webpack://escher/./node_modules/d3-selection/src/selectorAll.js","webpack://escher/./node_modules/d3-selection/src/matcher.js","webpack://escher/./node_modules/d3-selection/src/selection/sparse.js","webpack://escher/./node_modules/d3-selection/src/selection/enter.js","webpack://escher/./node_modules/d3-selection/src/selection/data.js","webpack://escher/./node_modules/d3-selection/src/selection/sort.js","webpack://escher/./node_modules/d3-selection/src/namespaces.js","webpack://escher/./node_modules/d3-selection/src/namespace.js","webpack://escher/./node_modules/d3-selection/src/selection/attr.js","webpack://escher/./node_modules/d3-selection/src/window.js","webpack://escher/./node_modules/d3-selection/src/selection/style.js","webpack://escher/./node_modules/d3-selection/src/selection/property.js","webpack://escher/./node_modules/d3-selection/src/selection/classed.js","webpack://escher/./node_modules/d3-selection/src/selection/text.js","webpack://escher/./node_modules/d3-selection/src/selection/html.js","webpack://escher/./node_modules/d3-selection/src/selection/raise.js","webpack://escher/./node_modules/d3-selection/src/selection/lower.js","webpack://escher/./node_modules/d3-selection/src/creator.js","webpack://escher/./node_modules/d3-selection/src/selection/insert.js","webpack://escher/./node_modules/d3-selection/src/selection/remove.js","webpack://escher/./node_modules/d3-selection/src/selection/clone.js","webpack://escher/./node_modules/d3-selection/src/selection/on.js","webpack://escher/./node_modules/d3-selection/src/selection/dispatch.js","webpack://escher/./node_modules/d3-selection/src/selection/index.js","webpack://escher/./node_modules/d3-selection/src/selection/select.js","webpack://escher/./node_modules/d3-selection/src/selection/selectAll.js","webpack://escher/./node_modules/d3-selection/src/selection/filter.js","webpack://escher/./node_modules/d3-selection/src/constant.js","webpack://escher/./node_modules/d3-selection/src/selection/exit.js","webpack://escher/./node_modules/d3-selection/src/selection/join.js","webpack://escher/./node_modules/d3-selection/src/selection/merge.js","webpack://escher/./node_modules/d3-selection/src/selection/order.js","webpack://escher/./node_modules/d3-selection/src/selection/call.js","webpack://escher/./node_modules/d3-selection/src/selection/nodes.js","webpack://escher/./node_modules/d3-selection/src/selection/node.js","webpack://escher/./node_modules/d3-selection/src/selection/size.js","webpack://escher/./node_modules/d3-selection/src/selection/empty.js","webpack://escher/./node_modules/d3-selection/src/selection/each.js","webpack://escher/./node_modules/d3-selection/src/selection/append.js","webpack://escher/./node_modules/d3-selection/src/selection/datum.js","webpack://escher/./node_modules/d3-selection/src/select.js","webpack://escher/./node_modules/d3-collection/src/map.js","webpack://escher/./node_modules/d3-collection/src/set.js","webpack://escher/./node_modules/d3-dispatch/src/dispatch.js","webpack://escher/./node_modules/d3-request/src/request.js","webpack://escher/./node_modules/d3-request/src/type.js","webpack://escher/./node_modules/d3-request/src/html.js","webpack://escher/./node_modules/d3-request/src/json.js","webpack://escher/./node_modules/d3-request/src/text.js","webpack://escher/./node_modules/d3-request/src/xml.js","webpack://escher/./node_modules/d3-dsv/src/dsv.js","webpack://escher/./node_modules/d3-dsv/src/csv.js","webpack://escher/./node_modules/d3-request/src/dsv.js","webpack://escher/./node_modules/d3-request/src/csv.js","webpack://escher/./node_modules/d3-dsv/src/tsv.js","webpack://escher/./node_modules/d3-request/src/tsv.js","webpack://escher/./src/ts/utils.ts","webpack://escher/./src/ts/PlacedDiv.ts","webpack://escher/./src/ts/completely.ts","webpack://escher/./node_modules/d3-selection/src/sourceEvent.js","webpack://escher/./node_modules/d3-selection/src/point.js","webpack://escher/./node_modules/d3-selection/src/mouse.js","webpack://escher/./node_modules/d3-selection/src/touch.js","webpack://escher/./node_modules/d3-drag/src/noevent.js","webpack://escher/./node_modules/d3-drag/src/nodrag.js","webpack://escher/./node_modules/d3-drag/src/constant.js","webpack://escher/./node_modules/d3-drag/src/event.js","webpack://escher/./node_modules/d3-drag/src/drag.js","webpack://escher/./src/ts/DirectionArrow.ts","webpack://escher/./node_modules/d3-format/src/formatDecimal.js","webpack://escher/./node_modules/d3-format/src/exponent.js","webpack://escher/./node_modules/d3-format/src/formatSpecifier.js","webpack://escher/./node_modules/d3-format/src/formatPrefixAuto.js","webpack://escher/./node_modules/d3-format/src/formatRounded.js","webpack://escher/./node_modules/d3-format/src/formatTypes.js","webpack://escher/./node_modules/d3-format/src/identity.js","webpack://escher/./node_modules/d3-format/src/locale.js","webpack://escher/./node_modules/d3-format/src/defaultLocale.js","webpack://escher/./node_modules/d3-format/src/formatGroup.js","webpack://escher/./node_modules/d3-format/src/formatNumerals.js","webpack://escher/./node_modules/d3-format/src/formatTrim.js","webpack://escher/./src/ts/dataStyles.ts","webpack://escher/./src/ts/CobraModel.ts","webpack://escher/./src/ts/BuildInput.ts","webpack://escher/./src/ts/CallbackManager.ts","webpack://escher/./node_modules/d3-interpolate/src/zoom.js","webpack://escher/./node_modules/d3-timer/src/timer.js","webpack://escher/./node_modules/d3-timer/src/timeout.js","webpack://escher/./node_modules/d3-transition/src/transition/schedule.js","webpack://escher/./node_modules/d3-transition/src/interrupt.js","webpack://escher/./node_modules/d3-interpolate/src/number.js","webpack://escher/./node_modules/d3-interpolate/src/transform/decompose.js","webpack://escher/./node_modules/d3-interpolate/src/transform/parse.js","webpack://escher/./node_modules/d3-interpolate/src/transform/index.js","webpack://escher/./node_modules/d3-transition/src/transition/tween.js","webpack://escher/./node_modules/d3-color/src/define.js","webpack://escher/./node_modules/d3-color/src/color.js","webpack://escher/./node_modules/d3-interpolate/src/basis.js","webpack://escher/./node_modules/d3-interpolate/src/constant.js","webpack://escher/./node_modules/d3-interpolate/src/color.js","webpack://escher/./node_modules/d3-interpolate/src/rgb.js","webpack://escher/./node_modules/d3-interpolate/src/basisClosed.js","webpack://escher/./node_modules/d3-interpolate/src/string.js","webpack://escher/./node_modules/d3-transition/src/transition/interpolate.js","webpack://escher/./node_modules/d3-transition/src/transition/attr.js","webpack://escher/./node_modules/d3-transition/src/transition/attrTween.js","webpack://escher/./node_modules/d3-transition/src/transition/delay.js","webpack://escher/./node_modules/d3-transition/src/transition/duration.js","webpack://escher/./node_modules/d3-transition/src/transition/selection.js","webpack://escher/./node_modules/d3-transition/src/transition/style.js","webpack://escher/./node_modules/d3-transition/src/transition/index.js","webpack://escher/./node_modules/d3-transition/src/transition/select.js","webpack://escher/./node_modules/d3-transition/src/transition/selectAll.js","webpack://escher/./node_modules/d3-transition/src/transition/filter.js","webpack://escher/./node_modules/d3-transition/src/transition/merge.js","webpack://escher/./node_modules/d3-transition/src/transition/transition.js","webpack://escher/./node_modules/d3-transition/src/transition/on.js","webpack://escher/./node_modules/d3-transition/src/transition/styleTween.js","webpack://escher/./node_modules/d3-transition/src/transition/text.js","webpack://escher/./node_modules/d3-transition/src/transition/textTween.js","webpack://escher/./node_modules/d3-transition/src/transition/remove.js","webpack://escher/./node_modules/d3-transition/src/transition/ease.js","webpack://escher/./node_modules/d3-transition/src/transition/end.js","webpack://escher/./node_modules/d3-transition/src/selection/transition.js","webpack://escher/./node_modules/d3-ease/src/cubic.js","webpack://escher/./node_modules/d3-zoom/src/constant.js","webpack://escher/./node_modules/d3-zoom/src/event.js","webpack://escher/./node_modules/d3-zoom/src/transform.js","webpack://escher/./node_modules/d3-transition/src/selection/index.js","webpack://escher/./node_modules/d3-transition/src/selection/interrupt.js","webpack://escher/./node_modules/d3-zoom/src/noevent.js","webpack://escher/./node_modules/d3-zoom/src/zoom.js","webpack://escher/./src/ts/ZoomContainer.ts","webpack://escher/./src/ts/Draw.ts","webpack://escher/./src/ts/build.ts","webpack://escher/./src/ts/Behavior.ts","webpack://escher/./src/ts/scalePresets.ts","webpack://escher/./node_modules/d3-array/src/ascending.js","webpack://escher/./node_modules/d3-array/src/bisect.js","webpack://escher/./node_modules/d3-array/src/bisector.js","webpack://escher/./node_modules/d3-array/src/array.js","webpack://escher/./node_modules/d3-array/src/ticks.js","webpack://escher/./node_modules/d3-scale/src/array.js","webpack://escher/./node_modules/d3-interpolate/src/array.js","webpack://escher/./node_modules/d3-interpolate/src/date.js","webpack://escher/./node_modules/d3-interpolate/src/object.js","webpack://escher/./node_modules/d3-interpolate/src/numberArray.js","webpack://escher/./node_modules/d3-interpolate/src/value.js","webpack://escher/./node_modules/d3-interpolate/src/round.js","webpack://escher/./node_modules/d3-scale/src/number.js","webpack://escher/./node_modules/d3-scale/src/continuous.js","webpack://escher/./node_modules/d3-scale/src/constant.js","webpack://escher/./node_modules/d3-scale/src/linear.js","webpack://escher/./node_modules/d3-scale/src/tickFormat.js","webpack://escher/./node_modules/d3-format/src/precisionPrefix.js","webpack://escher/./node_modules/d3-format/src/precisionRound.js","webpack://escher/./node_modules/d3-format/src/precisionFixed.js","webpack://escher/./node_modules/d3-scale/src/colors.js","webpack://escher/./node_modules/d3-scale/src/category10.js","webpack://escher/./node_modules/d3-scale/src/category20b.js","webpack://escher/./node_modules/d3-scale/src/category20c.js","webpack://escher/./node_modules/d3-scale/src/category20.js","webpack://escher/./node_modules/d3-color/src/math.js","webpack://escher/./node_modules/d3-color/src/cubehelix.js","webpack://escher/./node_modules/d3-interpolate/src/cubehelix.js","webpack://escher/./node_modules/d3-scale/src/viridis.js","webpack://escher/./node_modules/d3-scale/src/cubehelix.js","webpack://escher/./node_modules/d3-scale/src/rainbow.js","webpack://escher/./src/ts/Scale.ts","webpack://escher/./src/ts/UndoStack.ts","webpack://escher/./src/ts/KeyManager.ts","webpack://escher/./src/ts/Canvas.ts","webpack://escher/./src/ts/SearchIndex.ts","webpack://escher/./src/ts/algo.ts","webpack://escher/./src/ts/escherMap.ts","webpack://escher/./node_modules/d3-brush/src/constant.js","webpack://escher/./node_modules/d3-brush/src/event.js","webpack://escher/./node_modules/d3-brush/src/noevent.js","webpack://escher/./node_modules/d3-brush/src/brush.js","webpack://escher/./src/ts/Brush.ts","webpack://escher/./src/ts/Settings.ts","webpack://escher/./src/ts/TextEditInput.ts","webpack://escher/./src/renderWrapper.tsx","webpack://escher/./src/ScaleSelector.tsx","webpack://escher/./src/css/Picker.css?bdb3","webpack://escher/./src/Picker.tsx","webpack://escher/./src/css/ScaleSlider.css?071d","webpack://escher/./src/ScaleSlider.tsx","webpack://escher/./src/ScaleSelection.tsx","webpack://escher/./src/css/SettingsMenu.css?e9cc","webpack://escher/./src/SettingsMenu.tsx","webpack://escher/./src/css/Dropdown.css?6243","webpack://escher/./src/Dropdown.tsx","webpack://escher/./src/MenuButton.tsx","webpack://escher/./src/MenuBar.tsx","webpack://escher/./src/css/SearchBar.css?7909","webpack://escher/./src/SearchBar.tsx","webpack://escher/./src/css/ButtonPanel.css?0782","webpack://escher/./src/ButtonPanel.tsx","webpack://escher/./src/TooltipContainer.tsx","webpack://escher/./node_modules/rc-slider-preact/lib/index.css?6ae1","webpack://escher/./src/css/DistributionTooltipComponent.css?09a5","webpack://escher/./src/DistributionTooltip.tsx","webpack://escher/./icons/css/fontello.css?9947","webpack://escher/./src/css/Builder.css?fffb","webpack://escher/./src/Builder.tsx","webpack://escher/./src/css/Builder-embed.css","webpack://escher/./src/ts/DataMenu.ts","webpack://escher/./src/ts/main.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"escher\"] = factory();\n\telse\n\t\troot[\"escher\"] = factory();\n})(self, () => {\nreturn ","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.escher-container .picker {\r\n  top: 35px;\r\n  margin-left: -7px;\r\n  position: absolute;\r\n  -webkit-user-select: none;\r\n  -moz-user-select: none;\r\n  -ms-user-select: none;\r\n  user-select: none;\r\n}\r\n\r\n.escher-container .pickerBox {\r\n  position: absolute;\r\n  cursor: pointer;\r\n  background: rgba(0, 0, 0, 0.375);\r\n  width: 14px;\r\n  height: 35px;\r\n  top: -35px\r\n}\r\n\r\n.escher-container .scaleTrack .rightOptions {\r\n  position: absolute;\r\n  left: -76px;\r\n}\r\n\r\n.escher-container .pickerOptions {\r\n  box-shadow: 0 2px 14px #c5c5c5;\r\n  margin-top: 1px;\r\n  display: inline-flex;\r\n  flex-direction: column;\r\n  width: 90px;\r\n}\r\n\r\n.escher-container .pickerOptions * {\r\n  font-size: 12px;\r\n}\r\n\r\n.escher-container .pickerOptions .option {\r\n  padding: 3px 0px;\r\n}\r\n\r\n.escher-container .pickerOptions .typePicker {\r\n  width: 20px;\r\n  position: absolute;\r\n  left: 70px;\r\n  top: 1px;\r\n  right: 0px;\r\n  height: 14px;\r\n  background-color: rgb(232, 232, 232);\r\n}\r\n\r\n.escher-container .pickerOptions .colorOptions {\r\n  display: inline-flex;\r\n}\r\n\r\n.escher-container .colorOptions .colorText {\r\n  padding: 3px 0px;\r\n  width: 100%;\r\n}\r\n\r\n.escher-container .colorOptions .colorWheel {\r\n  padding: 0px;\r\n  position: absolute;\r\n  right: 0;\r\n  height: 24px;\r\n  width: 21px;\r\n  border: 1px solid black;\r\n}\r\n\r\n.escher-container .picker .trashDiv {\r\n  position: absolute;\r\n  top: -56px;\r\n  font-size: 17px;\r\n}\r\n\r\n.escher-container .picker .trashDiv * {\r\n  font-size: 17px;\r\n  cursor: pointer;\r\n}\r\n\r\n.escher-container .picker .icon-trash-empty {\r\n  margin: -5px;\r\n}\r\n\r\n.escher-container .scaleEditor :disabled {\r\n  background: #f1ecfa;\r\n}\r\n\r\n.escher-container .scaleEditor input[type=color]:disabled {\r\n  margin-top: 1px;\r\n}\r\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/css/Picker.css\"],\"names\":[],\"mappings\":\"AAAA;EACE,SAAS;EACT,iBAAiB;EACjB,kBAAkB;EAClB,yBAAyB;EACzB,sBAAsB;EACtB,qBAAqB;EACrB,iBAAiB;AACnB;;AAEA;EACE,kBAAkB;EAClB,eAAe;EACf,gCAAgC;EAChC,WAAW;EACX,YAAY;EACZ;AACF;;AAEA;EACE,kBAAkB;EAClB,WAAW;AACb;;AAEA;EACE,8BAA8B;EAC9B,eAAe;EACf,oBAAoB;EACpB,sBAAsB;EACtB,WAAW;AACb;;AAEA;EACE,eAAe;AACjB;;AAEA;EACE,gBAAgB;AAClB;;AAEA;EACE,WAAW;EACX,kBAAkB;EAClB,UAAU;EACV,QAAQ;EACR,UAAU;EACV,YAAY;EACZ,oCAAoC;AACtC;;AAEA;EACE,oBAAoB;AACtB;;AAEA;EACE,gBAAgB;EAChB,WAAW;AACb;;AAEA;EACE,YAAY;EACZ,kBAAkB;EAClB,QAAQ;EACR,YAAY;EACZ,WAAW;EACX,uBAAuB;AACzB;;AAEA;EACE,kBAAkB;EAClB,UAAU;EACV,eAAe;AACjB;;AAEA;EACE,eAAe;EACf,eAAe;AACjB;;AAEA;EACE,YAAY;AACd;;AAEA;EACE,mBAAmB;AACrB;;AAEA;EACE,eAAe;AACjB\",\"sourcesContent\":[\".escher-container .picker {\\r\\n  top: 35px;\\r\\n  margin-left: -7px;\\r\\n  position: absolute;\\r\\n  -webkit-user-select: none;\\r\\n  -moz-user-select: none;\\r\\n  -ms-user-select: none;\\r\\n  user-select: none;\\r\\n}\\r\\n\\r\\n.escher-container .pickerBox {\\r\\n  position: absolute;\\r\\n  cursor: pointer;\\r\\n  background: rgba(0, 0, 0, 0.375);\\r\\n  width: 14px;\\r\\n  height: 35px;\\r\\n  top: -35px\\r\\n}\\r\\n\\r\\n.escher-container .scaleTrack .rightOptions {\\r\\n  position: absolute;\\r\\n  left: -76px;\\r\\n}\\r\\n\\r\\n.escher-container .pickerOptions {\\r\\n  box-shadow: 0 2px 14px #c5c5c5;\\r\\n  margin-top: 1px;\\r\\n  display: inline-flex;\\r\\n  flex-direction: column;\\r\\n  width: 90px;\\r\\n}\\r\\n\\r\\n.escher-container .pickerOptions * {\\r\\n  font-size: 12px;\\r\\n}\\r\\n\\r\\n.escher-container .pickerOptions .option {\\r\\n  padding: 3px 0px;\\r\\n}\\r\\n\\r\\n.escher-container .pickerOptions .typePicker {\\r\\n  width: 20px;\\r\\n  position: absolute;\\r\\n  left: 70px;\\r\\n  top: 1px;\\r\\n  right: 0px;\\r\\n  height: 14px;\\r\\n  background-color: rgb(232, 232, 232);\\r\\n}\\r\\n\\r\\n.escher-container .pickerOptions .colorOptions {\\r\\n  display: inline-flex;\\r\\n}\\r\\n\\r\\n.escher-container .colorOptions .colorText {\\r\\n  padding: 3px 0px;\\r\\n  width: 100%;\\r\\n}\\r\\n\\r\\n.escher-container .colorOptions .colorWheel {\\r\\n  padding: 0px;\\r\\n  position: absolute;\\r\\n  right: 0;\\r\\n  height: 24px;\\r\\n  width: 21px;\\r\\n  border: 1px solid black;\\r\\n}\\r\\n\\r\\n.escher-container .picker .trashDiv {\\r\\n  position: absolute;\\r\\n  top: -56px;\\r\\n  font-size: 17px;\\r\\n}\\r\\n\\r\\n.escher-container .picker .trashDiv * {\\r\\n  font-size: 17px;\\r\\n  cursor: pointer;\\r\\n}\\r\\n\\r\\n.escher-container .picker .icon-trash-empty {\\r\\n  margin: -5px;\\r\\n}\\r\\n\\r\\n.escher-container .scaleEditor :disabled {\\r\\n  background: #f1ecfa;\\r\\n}\\r\\n\\r\\n.escher-container .scaleEditor input[type=color]:disabled {\\r\\n  margin-top: 1px;\\r\\n}\\r\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","'use strict';\n\nexports.__esModule = true;\nexports.isEventFromHandle = isEventFromHandle;\nexports.isValueOutOfRange = isValueOutOfRange;\nexports.isNotTouchEvent = isNotTouchEvent;\nexports.getClosestPoint = getClosestPoint;\nexports.getPrecision = getPrecision;\nexports.getMousePosition = getMousePosition;\nexports.getTouchPosition = getTouchPosition;\nexports.getHandleCenterPosition = getHandleCenterPosition;\nexports.ensureValueInRange = ensureValueInRange;\nexports.ensureValuePrecision = ensureValuePrecision;\nexports.pauseEvent = pauseEvent;\nexports.getKeyboardValueMutator = getKeyboardValueMutator;\n\nvar _KeyCode = require('./KeyCode');\n\nvar _KeyCode2 = _interopRequireDefault(_KeyCode);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction isEventFromHandle(e, handles) {\n  return Object.keys(handles).some(function (key) {\n    return e.target === handles[key].base;\n  });\n}\n\nfunction isValueOutOfRange(value, _ref) {\n  var min = _ref.min,\n      max = _ref.max;\n\n  return value < min || value > max;\n}\n\nfunction isNotTouchEvent(e) {\n  return e.touches.length > 1 || e.type.toLowerCase() === 'touchend' && e.touches.length > 0;\n}\n\nfunction getClosestPoint(val, _ref2) {\n  var marks = _ref2.marks,\n      step = _ref2.step,\n      min = _ref2.min;\n\n  var points = Object.keys(marks).map(parseFloat);\n  if (step !== null) {\n    var closestStep = Math.round((val - min) / step) * step + min;\n    points.push(closestStep);\n  }\n  var diffs = points.map(function (point) {\n    return Math.abs(val - point);\n  });\n  return points[diffs.indexOf(Math.min.apply(Math, diffs))];\n}\n\nfunction getPrecision(step) {\n  var stepString = step.toString();\n  var precision = 0;\n  if (stepString.indexOf('.') >= 0) {\n    precision = stepString.length - stepString.indexOf('.') - 1;\n  }\n  return precision;\n}\n\nfunction getMousePosition(vertical, e) {\n  return vertical ? e.clientY : e.pageX;\n}\n\nfunction getTouchPosition(vertical, e) {\n  return vertical ? e.touches[0].clientY : e.touches[0].pageX;\n}\n\nfunction getHandleCenterPosition(vertical, handle) {\n  var coords = handle.getBoundingClientRect();\n  return vertical ? coords.top + coords.height * 0.5 : coords.left + coords.width * 0.5;\n}\n\nfunction ensureValueInRange(val, _ref3) {\n  var max = _ref3.max,\n      min = _ref3.min;\n\n  if (val <= min) {\n    return min;\n  }\n  if (val >= max) {\n    return max;\n  }\n  return val;\n}\n\nfunction ensureValuePrecision(val, props) {\n  var step = props.step;\n\n  var closestPoint = getClosestPoint(val, props);\n  return step === null ? closestPoint : parseFloat(closestPoint.toFixed(getPrecision(step)));\n}\n\nfunction pauseEvent(e) {\n  e.stopPropagation();\n  e.preventDefault();\n}\n\nfunction getKeyboardValueMutator(e) {\n  switch (e.keyCode) {\n    case _KeyCode2.default.UP:\n    case _KeyCode2.default.RIGHT:\n      return function (value, props) {\n        return value + props.step;\n      };\n\n    case _KeyCode2.default.DOWN:\n    case _KeyCode2.default.LEFT:\n      return function (value, props) {\n        return value - props.step;\n      };\n\n    case _KeyCode2.default.END:\n      return function (value, props) {\n        return props.max;\n      };\n    case _KeyCode2.default.HOME:\n      return function (value, props) {\n        return props.min;\n      };\n    case _KeyCode2.default.PAGE_UP:\n      return function (value, props) {\n        return value + props.step * 2;\n      };\n    case _KeyCode2.default.PAGE_DOWN:\n      return function (value, props) {\n        return value - props.step * 2;\n      };\n\n    default:\n      return undefined;\n  }\n}","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `/* Containers */\r\n\r\n/* The top level container for an Escher Builder */\r\n.escher-container {\r\n  font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif !important;\r\n  background-color: #F3F3F3;\r\n  text-align: center;\r\n  position: relative;\r\n  font-size: 14px;\r\n  color: #333333;\r\n  \r\n}\r\n\r\n/* Applied to the body when Escher fills the screen. This stops browser from\r\nshowing scroll-end animations. */\r\nhtml.fill-screen {\r\n  height: 100%;\r\n  width: 100%;\r\n}\r\nbody.fill-screen {\r\n  margin: 0;\r\n  position: relative;\r\n  overflow: hidden;\r\n  height: 100%;\r\n  width: 100%;\r\n}\r\n\r\n/* Applied to top level container (generally .escher-container) when Escher\r\nfills the screen. These make sure Escher completely fills the screen, even after\r\nresizes. */\r\n.fill-screen-div {\r\n  margin: 0;\r\n  padding: 0;\r\n  position: fixed;\r\n  top: 0px;\r\n  bottom: 0px;\r\n  left: 0px;\r\n  right: 0px;\r\n  width: 100% !important;\r\n  height: 100% !important;\r\n  z-index: 1000;\r\n}\r\n\r\n/* The zoom container classes. */\r\n.escher-container .escher-zoom-container,\r\n.escher-container .escher-3d-transform-container,\r\n.escher-container svg.escher-svg {\r\n  width: 100% !important;\r\n  height: 100% !important;\r\n  overflow: hidden;\r\n}\r\n\r\n.escher-container .escher-zoom-container {\r\n  height: calc(100% - 40px) !important;\r\n  margin-top: 40px !important;\r\n}\r\n\r\n#selection-info-container {\r\n  position: absolute;\r\n  top: 0px;\r\n  left: 0px;\r\n  width: calc(calc(100% - 410px) / 2);\r\n  height: 40px;\r\n  background-color: transparent;\r\n  z-index: 10000;\r\n  text-align: left;\r\n  padding-top: 6px;\r\n  padding-left: 10px;\r\n  box-sizing: border-box;\r\n  align-content: center;\r\n}\r\n\r\n#selection-info-container H3 {\r\n  margin: 0;\r\n  padding: 0;\r\n  display: inline;\r\n}\r\n\r\n/* SVG text should not be selectable */\r\n.escher-container svg text {\r\n  -webkit-user-select: none;\r\n  -moz-user-select: none;\r\n  -ms-user-select: none;\r\n  user-select: none;\r\n}\r\n\r\n/* Status */\r\n.escher-container #status {\r\n  position:absolute;\r\n  bottom:10px;\r\n  left: 20px;\r\n  color: red;\r\n  background-color: white;\r\n  font-size: 16px\r\n}\r\n\r\n/* Search & Menu */\r\n.escher-container .search-menu-container {\r\n  position: absolute;\r\n  width: 100%;\r\n  top: 0px;\r\n  left: 0px;\r\n  margin: 0;\r\n  text-align: center;\r\n  pointer-events: none;\r\n}\r\n.escher-container .search-menu-container-inline {\r\n  box-sizing: border-box;\r\n  width: 320px;\r\n  display: inline-block;\r\n  text-align: left;\r\n  pointer-events: auto;\r\n}\r\n@media (min-width: 550px) {\r\n  .escher-container .search-menu-container-inline {\r\n    width: 410px;\r\n  }\r\n}\r\n\r\n/* Reaction input */\r\n.escher-container #rxn-input {\r\n  z-index: 10;\r\n  width: 200px;\r\n}\r\n.escher-container .input-close-button {\r\n  position: absolute;\r\n  right: 0px;\r\n  width: 18px;\r\n  bottom: 0px;\r\n  padding: 0px;\r\n  border-width: 0px;\r\n  margin: 0px;\r\n  background: none;\r\n  font-size: 20px;\r\n  font-weight: normal;\r\n  top: -8px;\r\n}\r\n.escher-container .input-close-button:hover {\r\n  color: #ff3333;\r\n  font-weight: bold;\r\n}\r\n\r\n/* text edit input */\r\n.escher-container #text-edit-input input {\r\n  width: 500px;\r\n  border: 1px solid #cccccc;\r\n  font-size: 22px;\r\n}\r\n\r\n.escher-container #tooltip-container {\r\n  -ms-touch-action: none;\r\n  touch-action: none;\r\n}\r\n\r\n/* Buttons */\r\n.escher-container .btn {\r\n  color: white!important;\r\n  border: 1px solid #2E2F2F;\r\n  background-image: linear-gradient(#4F5151, #474949 6%, #3F4141);\r\n  background-color: white;\r\n  cursor: pointer;\r\n}\r\n\r\n.escher-container .btn:active {\r\n  background-image: linear-gradient(#3F4141, #474949 6%, #4F5151);\r\n}\r\n\r\n.escher-container g.reaction path.segment {\r\n  \r\n  stroke-width: 3px;\r\n}\r\n/* first shortest */\r\n.escher-container g.segment-group.shortest-path path.segment, .escher-container g.segment-group.shortest-path-1 path.segment {\r\n  stroke: rgb(0, 0, 0) !important;\r\n  stroke-width: 14px !important;\r\n}\r\n\r\n.escher-container g.segment-group.shortest-path path.arrowhead, .escher-container g.segment-group.shortest-path-1 path.arrowhead {\r\n  fill: rgb(0, 0, 0) !important;\r\n}\r\n\r\n/* second shortest */\r\n.escher-container g.segment-group.shortest-path.shortest-path-2 path.segment {\r\n  stroke: rgb(59, 59, 59);\r\n  stroke-width: 14px;\r\n}\r\n\r\n.escher-container g.segment-group.shortest-path.shortest-path-2 path.arrowhead {\r\n  fill: rgb(59, 59, 59);\r\n}\r\n\r\n/* third shortest */\r\n.escher-container g.segment-group.shortest-path.shortest-path-3 path.segment {\r\n  stroke: rgb(87, 79, 79);\r\n  stroke-width: 14px;\r\n}\r\n\r\n.escher-container g.segment-group.shortest-path.shortest-path-3 path.arrowhead {\r\n  fill: rgb(87, 79, 79);\r\n}\r\n\r\n/* fourth shortest */\r\n.escher-container g.segment-group.shortest-path.shortest-path-4 path.segment {\r\n  stroke: rgb(150, 150, 150);\r\n  stroke-width: 14px;\r\n}\r\n\r\n.escher-container g.segment-group.shortest-path.shortest-path-4 path.arrowhead {\r\n  fill: rgb(150, 150, 150);\r\n}\r\n\r\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/css/Builder.css\"],\"names\":[],\"mappings\":\"AAAA,eAAe;;AAEf,kDAAkD;AAClD;EACE,sEAAsE;EACtE,yBAAyB;EACzB,kBAAkB;EAClB,kBAAkB;EAClB,eAAe;EACf,cAAc;;AAEhB;;AAEA;gCACgC;AAChC;EACE,YAAY;EACZ,WAAW;AACb;AACA;EACE,SAAS;EACT,kBAAkB;EAClB,gBAAgB;EAChB,YAAY;EACZ,WAAW;AACb;;AAEA;;UAEU;AACV;EACE,SAAS;EACT,UAAU;EACV,eAAe;EACf,QAAQ;EACR,WAAW;EACX,SAAS;EACT,UAAU;EACV,sBAAsB;EACtB,uBAAuB;EACvB,aAAa;AACf;;AAEA,gCAAgC;AAChC;;;EAGE,sBAAsB;EACtB,uBAAuB;EACvB,gBAAgB;AAClB;;AAEA;EACE,oCAAoC;EACpC,2BAA2B;AAC7B;;AAEA;EACE,kBAAkB;EAClB,QAAQ;EACR,SAAS;EACT,mCAAmC;EACnC,YAAY;EACZ,6BAA6B;EAC7B,cAAc;EACd,gBAAgB;EAChB,gBAAgB;EAChB,kBAAkB;EAClB,sBAAsB;EACtB,qBAAqB;AACvB;;AAEA;EACE,SAAS;EACT,UAAU;EACV,eAAe;AACjB;;AAEA,sCAAsC;AACtC;EACE,yBAAyB;EACzB,sBAAsB;EACtB,qBAAqB;EACrB,iBAAiB;AACnB;;AAEA,WAAW;AACX;EACE,iBAAiB;EACjB,WAAW;EACX,UAAU;EACV,UAAU;EACV,uBAAuB;EACvB;AACF;;AAEA,kBAAkB;AAClB;EACE,kBAAkB;EAClB,WAAW;EACX,QAAQ;EACR,SAAS;EACT,SAAS;EACT,kBAAkB;EAClB,oBAAoB;AACtB;AACA;EACE,sBAAsB;EACtB,YAAY;EACZ,qBAAqB;EACrB,gBAAgB;EAChB,oBAAoB;AACtB;AACA;EACE;IACE,YAAY;EACd;AACF;;AAEA,mBAAmB;AACnB;EACE,WAAW;EACX,YAAY;AACd;AACA;EACE,kBAAkB;EAClB,UAAU;EACV,WAAW;EACX,WAAW;EACX,YAAY;EACZ,iBAAiB;EACjB,WAAW;EACX,gBAAgB;EAChB,eAAe;EACf,mBAAmB;EACnB,SAAS;AACX;AACA;EACE,cAAc;EACd,iBAAiB;AACnB;;AAEA,oBAAoB;AACpB;EACE,YAAY;EACZ,yBAAyB;EACzB,eAAe;AACjB;;AAEA;EACE,sBAAsB;EACtB,kBAAkB;AACpB;;AAEA,YAAY;AACZ;EACE,sBAAsB;EACtB,yBAAyB;EACzB,+DAA+D;EAC/D,uBAAuB;EACvB,eAAe;AACjB;;AAEA;EACE,+DAA+D;AACjE;;AAEA;;EAEE,iBAAiB;AACnB;AACA,mBAAmB;AACnB;EACE,+BAA+B;EAC/B,6BAA6B;AAC/B;;AAEA;EACE,6BAA6B;AAC/B;;AAEA,oBAAoB;AACpB;EACE,uBAAuB;EACvB,kBAAkB;AACpB;;AAEA;EACE,qBAAqB;AACvB;;AAEA,mBAAmB;AACnB;EACE,uBAAuB;EACvB,kBAAkB;AACpB;;AAEA;EACE,qBAAqB;AACvB;;AAEA,oBAAoB;AACpB;EACE,0BAA0B;EAC1B,kBAAkB;AACpB;;AAEA;EACE,wBAAwB;AAC1B\",\"sourcesContent\":[\"/* Containers */\\r\\n\\r\\n/* The top level container for an Escher Builder */\\r\\n.escher-container {\\r\\n  font-family: \\\"Helvetica Neue\\\", Helvetica, Arial, sans-serif !important;\\r\\n  background-color: #F3F3F3;\\r\\n  text-align: center;\\r\\n  position: relative;\\r\\n  font-size: 14px;\\r\\n  color: #333333;\\r\\n  \\r\\n}\\r\\n\\r\\n/* Applied to the body when Escher fills the screen. This stops browser from\\r\\nshowing scroll-end animations. */\\r\\nhtml.fill-screen {\\r\\n  height: 100%;\\r\\n  width: 100%;\\r\\n}\\r\\nbody.fill-screen {\\r\\n  margin: 0;\\r\\n  position: relative;\\r\\n  overflow: hidden;\\r\\n  height: 100%;\\r\\n  width: 100%;\\r\\n}\\r\\n\\r\\n/* Applied to top level container (generally .escher-container) when Escher\\r\\nfills the screen. These make sure Escher completely fills the screen, even after\\r\\nresizes. */\\r\\n.fill-screen-div {\\r\\n  margin: 0;\\r\\n  padding: 0;\\r\\n  position: fixed;\\r\\n  top: 0px;\\r\\n  bottom: 0px;\\r\\n  left: 0px;\\r\\n  right: 0px;\\r\\n  width: 100% !important;\\r\\n  height: 100% !important;\\r\\n  z-index: 1000;\\r\\n}\\r\\n\\r\\n/* The zoom container classes. */\\r\\n.escher-container .escher-zoom-container,\\r\\n.escher-container .escher-3d-transform-container,\\r\\n.escher-container svg.escher-svg {\\r\\n  width: 100% !important;\\r\\n  height: 100% !important;\\r\\n  overflow: hidden;\\r\\n}\\r\\n\\r\\n.escher-container .escher-zoom-container {\\r\\n  height: calc(100% - 40px) !important;\\r\\n  margin-top: 40px !important;\\r\\n}\\r\\n\\r\\n#selection-info-container {\\r\\n  position: absolute;\\r\\n  top: 0px;\\r\\n  left: 0px;\\r\\n  width: calc(calc(100% - 410px) / 2);\\r\\n  height: 40px;\\r\\n  background-color: transparent;\\r\\n  z-index: 10000;\\r\\n  text-align: left;\\r\\n  padding-top: 6px;\\r\\n  padding-left: 10px;\\r\\n  box-sizing: border-box;\\r\\n  align-content: center;\\r\\n}\\r\\n\\r\\n#selection-info-container H3 {\\r\\n  margin: 0;\\r\\n  padding: 0;\\r\\n  display: inline;\\r\\n}\\r\\n\\r\\n/* SVG text should not be selectable */\\r\\n.escher-container svg text {\\r\\n  -webkit-user-select: none;\\r\\n  -moz-user-select: none;\\r\\n  -ms-user-select: none;\\r\\n  user-select: none;\\r\\n}\\r\\n\\r\\n/* Status */\\r\\n.escher-container #status {\\r\\n  position:absolute;\\r\\n  bottom:10px;\\r\\n  left: 20px;\\r\\n  color: red;\\r\\n  background-color: white;\\r\\n  font-size: 16px\\r\\n}\\r\\n\\r\\n/* Search & Menu */\\r\\n.escher-container .search-menu-container {\\r\\n  position: absolute;\\r\\n  width: 100%;\\r\\n  top: 0px;\\r\\n  left: 0px;\\r\\n  margin: 0;\\r\\n  text-align: center;\\r\\n  pointer-events: none;\\r\\n}\\r\\n.escher-container .search-menu-container-inline {\\r\\n  box-sizing: border-box;\\r\\n  width: 320px;\\r\\n  display: inline-block;\\r\\n  text-align: left;\\r\\n  pointer-events: auto;\\r\\n}\\r\\n@media (min-width: 550px) {\\r\\n  .escher-container .search-menu-container-inline {\\r\\n    width: 410px;\\r\\n  }\\r\\n}\\r\\n\\r\\n/* Reaction input */\\r\\n.escher-container #rxn-input {\\r\\n  z-index: 10;\\r\\n  width: 200px;\\r\\n}\\r\\n.escher-container .input-close-button {\\r\\n  position: absolute;\\r\\n  right: 0px;\\r\\n  width: 18px;\\r\\n  bottom: 0px;\\r\\n  padding: 0px;\\r\\n  border-width: 0px;\\r\\n  margin: 0px;\\r\\n  background: none;\\r\\n  font-size: 20px;\\r\\n  font-weight: normal;\\r\\n  top: -8px;\\r\\n}\\r\\n.escher-container .input-close-button:hover {\\r\\n  color: #ff3333;\\r\\n  font-weight: bold;\\r\\n}\\r\\n\\r\\n/* text edit input */\\r\\n.escher-container #text-edit-input input {\\r\\n  width: 500px;\\r\\n  border: 1px solid #cccccc;\\r\\n  font-size: 22px;\\r\\n}\\r\\n\\r\\n.escher-container #tooltip-container {\\r\\n  -ms-touch-action: none;\\r\\n  touch-action: none;\\r\\n}\\r\\n\\r\\n/* Buttons */\\r\\n.escher-container .btn {\\r\\n  color: white!important;\\r\\n  border: 1px solid #2E2F2F;\\r\\n  background-image: linear-gradient(#4F5151, #474949 6%, #3F4141);\\r\\n  background-color: white;\\r\\n  cursor: pointer;\\r\\n}\\r\\n\\r\\n.escher-container .btn:active {\\r\\n  background-image: linear-gradient(#3F4141, #474949 6%, #4F5151);\\r\\n}\\r\\n\\r\\n.escher-container g.reaction path.segment {\\r\\n  \\r\\n  stroke-width: 3px;\\r\\n}\\r\\n/* first shortest */\\r\\n.escher-container g.segment-group.shortest-path path.segment, .escher-container g.segment-group.shortest-path-1 path.segment {\\r\\n  stroke: rgb(0, 0, 0) !important;\\r\\n  stroke-width: 14px !important;\\r\\n}\\r\\n\\r\\n.escher-container g.segment-group.shortest-path path.arrowhead, .escher-container g.segment-group.shortest-path-1 path.arrowhead {\\r\\n  fill: rgb(0, 0, 0) !important;\\r\\n}\\r\\n\\r\\n/* second shortest */\\r\\n.escher-container g.segment-group.shortest-path.shortest-path-2 path.segment {\\r\\n  stroke: rgb(59, 59, 59);\\r\\n  stroke-width: 14px;\\r\\n}\\r\\n\\r\\n.escher-container g.segment-group.shortest-path.shortest-path-2 path.arrowhead {\\r\\n  fill: rgb(59, 59, 59);\\r\\n}\\r\\n\\r\\n/* third shortest */\\r\\n.escher-container g.segment-group.shortest-path.shortest-path-3 path.segment {\\r\\n  stroke: rgb(87, 79, 79);\\r\\n  stroke-width: 14px;\\r\\n}\\r\\n\\r\\n.escher-container g.segment-group.shortest-path.shortest-path-3 path.arrowhead {\\r\\n  fill: rgb(87, 79, 79);\\r\\n}\\r\\n\\r\\n/* fourth shortest */\\r\\n.escher-container g.segment-group.shortest-path.shortest-path-4 path.segment {\\r\\n  stroke: rgb(150, 150, 150);\\r\\n  stroke-width: 14px;\\r\\n}\\r\\n\\r\\n.escher-container g.segment-group.shortest-path.shortest-path-4 path.arrowhead {\\r\\n  fill: rgb(150, 150, 150);\\r\\n}\\r\\n\\r\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","'use strict';\n\nexports.__esModule = true;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; /** @jsx h */\n\n\nvar _preact = require('preact');\n\nvar Track = function Track(props) {\n  var className = props.className,\n      included = props.included,\n      vertical = props.vertical,\n      offset = props.offset,\n      length = props.length,\n      style = props.style;\n\n\n  var positonStyle = vertical ? {\n    bottom: offset + '%',\n    height: length + '%'\n  } : {\n    left: offset + '%',\n    width: length + '%'\n  };\n\n  var elStyle = _extends({\n    visibility: included ? 'visible' : 'hidden'\n  }, style, positonStyle);\n  return (0, _preact.h)('div', { className: className, style: elStyle });\n};\n\nexports.default = Track;","\"use strict\";\n\n/* istanbul ignore next  */\nfunction setAttributesWithoutAttributes(styleElement) {\n  var nonce = typeof __webpack_nonce__ !== \"undefined\" ? __webpack_nonce__ : null;\n  if (nonce) {\n    styleElement.setAttribute(\"nonce\", nonce);\n  }\n}\nmodule.exports = setAttributesWithoutAttributes;","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.escher-container .menu-bar {\r\n  box-sizing: border-box;\r\n  list-style-type: none;\r\n  padding: 0;\r\n  padding-right: 20px;\r\n  position: relative;\r\n  margin: 5px 0px;\r\n  background-color: white;\r\n  border: 1px solid #ddd;\r\n  display: inline-flex;\r\n  box-sizing: border-box;\r\n  width: 100%;\r\n  justify-content: space-between;\r\n}\r\n\r\n.escher-container .dropdown {\r\n  position: relative;\r\n  float: left;\r\n  box-sizing: border-box;\r\n  font-size: 12px;\r\n  border-radius: 3px;\r\n\r\n  /* these sometimes get overridden */\r\n  margin: 0 !important;\r\n  font-weight: normal !important;\r\n\r\n  text-align: center;\r\n  vertical-align: middle;\r\n  -ms-touch-action: none;\r\n  touch-action: none;\r\n  cursor: pointer;\r\n  -webkit-touch-callout: none;\r\n  -webkit-user-select: none;\r\n  -khtml-user-select: none;\r\n  -moz-user-select: none;\r\n  -ms-user-select: none;\r\n  user-select: none;\r\n}\r\n\r\n.escher-container .dropdownButton {\r\n  color: #d9230f!important;\r\n  border: 1px solid transparent;\r\n  padding: 6px 9px;\r\n}\r\n\r\n.escher-container .helpButton {\r\n  color: #d9230f!important;\r\n  padding: 0px 5px;\r\n  background-color: #f5f5f5!important;\r\n  border: 0!important;\r\n  text-decoration: unset;\r\n  height: fit-content;\r\n  position: absolute;\r\n  right: 0;\r\n  font-size: 12px;\r\n  -webkit-user-select: none;\r\n  -moz-user-select: none;\r\n  -ms-user-select: none;\r\n  user-select: none;\r\n}\r\n\r\n.escher-container .dropdownButton:focus, .escher-container .helpButton:focus {\r\n  color: #91170a!important;\r\n  text-decoration: underline;\r\n}\r\n\r\n.escher-container .dropdownButton:hover, .escher-container .helpButton:hover {\r\n  color: #91170a!important;\r\n  text-decoration: underline;\r\n}\r\n\r\n.escher-container .menu-bar .icon-sort-down {\r\n  position: absolute;\r\n  font-size: 10px;\r\n  margin-left: -5px;\r\n}\r\n\r\n@media (min-width: 550px) {\r\n  .escher-container .menu-bar {\r\n    padding-right: 25px;\r\n  }\r\n\r\n  .escher-container .dropdown {\r\n    font-size: 18px;\r\n  }\r\n\r\n  .escher-container .dropdownButton {\r\n    padding: 6px 10px;\r\n    padding-right: 16px;\r\n  }\r\n\r\n  .escher-container .helpButton {\r\n    font-size: 16px;\r\n  }\r\n\r\n  .escher-container .menu-bar .icon-sort-down {\r\n    font-size: 14px;\r\n  }\r\n}\r\n\r\n.escher-container .menu {\r\n  box-sizing: border-box;\r\n  font-weight: normal!important;\r\n  word-spacing: 0;\r\n  position: absolute;\r\n  white-space: nowrap;\r\n  top: 103%;\r\n  left: -1%;\r\n  z-index: 1000;\r\n  display: block;\r\n  float: none;\r\n  min-width: 160px;\r\n  padding: 5px 0;\r\n  list-style: none;\r\n  font-size: 13px;\r\n  box-shadow: 0 6px 12px rgba(0,0,0,0.175);\r\n  background-clip: padding-box;\r\n  border: 1px solid #ddd;\r\n  background-color: rgba(255, 255, 255, 0.95);\r\n  border-radius: 0;\r\n  margin: 0;\r\n  text-align: left;\r\n}\r\n\r\n.escher-container #rightMenu {\r\n  left: auto;\r\n  right: -2%;\r\n}\r\n\r\n.escher-container .menu li:hover {\r\n  background-color: #d9230f;\r\n  color: #FFFFFF;\r\n}\r\n\r\n.escher-container .menu li, .menu label {\r\n  font-size: 15px;\r\n  display: block;\r\n  color: #444444;\r\n\r\n  /* these sometimes get overridden */\r\n  font-weight: normal !important;\r\n  margin: 0 !important;\r\n}\r\n\r\n.escher-container .menu.ul.li {\r\n  background-color: rgba(255, 255, 255, 0.95);\r\n}\r\n\r\n.escher-container .menuButton {\r\n  box-sizing: border-box;\r\n  width: 100%;\r\n  padding: 5px 20px;\r\n  margin: 0;\r\n  cursor: pointer;\r\n  -webkit-user-select: none;\r\n  -moz-user-select: none;\r\n  -ms-user-select: none;\r\n  user-select: none;\r\n}\r\n\r\n.escher-container label:focus, .menuButton:focus {\r\n  background-color: #d9230f;\r\n  color: #FFFFFF;\r\n}\r\n\r\n.escher-container .menuButton:hover {\r\n  background-color: #d9230f;\r\n  color: #FFFFFF;\r\n}\r\n\r\n.escher-container input[type=\"file\"] {\r\n  display: none;\r\n}\r\n\r\n.escher-container #disabled {\r\n  color: #e0e0e0;\r\n}\r\n\r\n.escher-container #disabled:hover, #disabled:focus {\r\n  background-color: rgba(255, 255, 255, 0.95);\r\n  cursor: default;\r\n}\r\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/css/Dropdown.css\"],\"names\":[],\"mappings\":\"AAAA;EACE,sBAAsB;EACtB,qBAAqB;EACrB,UAAU;EACV,mBAAmB;EACnB,kBAAkB;EAClB,eAAe;EACf,uBAAuB;EACvB,sBAAsB;EACtB,oBAAoB;EACpB,sBAAsB;EACtB,WAAW;EACX,8BAA8B;AAChC;;AAEA;EACE,kBAAkB;EAClB,WAAW;EACX,sBAAsB;EACtB,eAAe;EACf,kBAAkB;;EAElB,mCAAmC;EACnC,oBAAoB;EACpB,8BAA8B;;EAE9B,kBAAkB;EAClB,sBAAsB;EACtB,sBAAsB;EACtB,kBAAkB;EAClB,eAAe;EACf,2BAA2B;EAC3B,yBAAyB;EACzB,wBAAwB;EACxB,sBAAsB;EACtB,qBAAqB;EACrB,iBAAiB;AACnB;;AAEA;EACE,wBAAwB;EACxB,6BAA6B;EAC7B,gBAAgB;AAClB;;AAEA;EACE,wBAAwB;EACxB,gBAAgB;EAChB,mCAAmC;EACnC,mBAAmB;EACnB,sBAAsB;EACtB,mBAAmB;EACnB,kBAAkB;EAClB,QAAQ;EACR,eAAe;EACf,yBAAyB;EACzB,sBAAsB;EACtB,qBAAqB;EACrB,iBAAiB;AACnB;;AAEA;EACE,wBAAwB;EACxB,0BAA0B;AAC5B;;AAEA;EACE,wBAAwB;EACxB,0BAA0B;AAC5B;;AAEA;EACE,kBAAkB;EAClB,eAAe;EACf,iBAAiB;AACnB;;AAEA;EACE;IACE,mBAAmB;EACrB;;EAEA;IACE,eAAe;EACjB;;EAEA;IACE,iBAAiB;IACjB,mBAAmB;EACrB;;EAEA;IACE,eAAe;EACjB;;EAEA;IACE,eAAe;EACjB;AACF;;AAEA;EACE,sBAAsB;EACtB,6BAA6B;EAC7B,eAAe;EACf,kBAAkB;EAClB,mBAAmB;EACnB,SAAS;EACT,SAAS;EACT,aAAa;EACb,cAAc;EACd,WAAW;EACX,gBAAgB;EAChB,cAAc;EACd,gBAAgB;EAChB,eAAe;EACf,wCAAwC;EACxC,4BAA4B;EAC5B,sBAAsB;EACtB,2CAA2C;EAC3C,gBAAgB;EAChB,SAAS;EACT,gBAAgB;AAClB;;AAEA;EACE,UAAU;EACV,UAAU;AACZ;;AAEA;EACE,yBAAyB;EACzB,cAAc;AAChB;;AAEA;EACE,eAAe;EACf,cAAc;EACd,cAAc;;EAEd,mCAAmC;EACnC,8BAA8B;EAC9B,oBAAoB;AACtB;;AAEA;EACE,2CAA2C;AAC7C;;AAEA;EACE,sBAAsB;EACtB,WAAW;EACX,iBAAiB;EACjB,SAAS;EACT,eAAe;EACf,yBAAyB;EACzB,sBAAsB;EACtB,qBAAqB;EACrB,iBAAiB;AACnB;;AAEA;EACE,yBAAyB;EACzB,cAAc;AAChB;;AAEA;EACE,yBAAyB;EACzB,cAAc;AAChB;;AAEA;EACE,aAAa;AACf;;AAEA;EACE,cAAc;AAChB;;AAEA;EACE,2CAA2C;EAC3C,eAAe;AACjB\",\"sourcesContent\":[\".escher-container .menu-bar {\\r\\n  box-sizing: border-box;\\r\\n  list-style-type: none;\\r\\n  padding: 0;\\r\\n  padding-right: 20px;\\r\\n  position: relative;\\r\\n  margin: 5px 0px;\\r\\n  background-color: white;\\r\\n  border: 1px solid #ddd;\\r\\n  display: inline-flex;\\r\\n  box-sizing: border-box;\\r\\n  width: 100%;\\r\\n  justify-content: space-between;\\r\\n}\\r\\n\\r\\n.escher-container .dropdown {\\r\\n  position: relative;\\r\\n  float: left;\\r\\n  box-sizing: border-box;\\r\\n  font-size: 12px;\\r\\n  border-radius: 3px;\\r\\n\\r\\n  /* these sometimes get overridden */\\r\\n  margin: 0 !important;\\r\\n  font-weight: normal !important;\\r\\n\\r\\n  text-align: center;\\r\\n  vertical-align: middle;\\r\\n  -ms-touch-action: none;\\r\\n  touch-action: none;\\r\\n  cursor: pointer;\\r\\n  -webkit-touch-callout: none;\\r\\n  -webkit-user-select: none;\\r\\n  -khtml-user-select: none;\\r\\n  -moz-user-select: none;\\r\\n  -ms-user-select: none;\\r\\n  user-select: none;\\r\\n}\\r\\n\\r\\n.escher-container .dropdownButton {\\r\\n  color: #d9230f!important;\\r\\n  border: 1px solid transparent;\\r\\n  padding: 6px 9px;\\r\\n}\\r\\n\\r\\n.escher-container .helpButton {\\r\\n  color: #d9230f!important;\\r\\n  padding: 0px 5px;\\r\\n  background-color: #f5f5f5!important;\\r\\n  border: 0!important;\\r\\n  text-decoration: unset;\\r\\n  height: fit-content;\\r\\n  position: absolute;\\r\\n  right: 0;\\r\\n  font-size: 12px;\\r\\n  -webkit-user-select: none;\\r\\n  -moz-user-select: none;\\r\\n  -ms-user-select: none;\\r\\n  user-select: none;\\r\\n}\\r\\n\\r\\n.escher-container .dropdownButton:focus, .escher-container .helpButton:focus {\\r\\n  color: #91170a!important;\\r\\n  text-decoration: underline;\\r\\n}\\r\\n\\r\\n.escher-container .dropdownButton:hover, .escher-container .helpButton:hover {\\r\\n  color: #91170a!important;\\r\\n  text-decoration: underline;\\r\\n}\\r\\n\\r\\n.escher-container .menu-bar .icon-sort-down {\\r\\n  position: absolute;\\r\\n  font-size: 10px;\\r\\n  margin-left: -5px;\\r\\n}\\r\\n\\r\\n@media (min-width: 550px) {\\r\\n  .escher-container .menu-bar {\\r\\n    padding-right: 25px;\\r\\n  }\\r\\n\\r\\n  .escher-container .dropdown {\\r\\n    font-size: 18px;\\r\\n  }\\r\\n\\r\\n  .escher-container .dropdownButton {\\r\\n    padding: 6px 10px;\\r\\n    padding-right: 16px;\\r\\n  }\\r\\n\\r\\n  .escher-container .helpButton {\\r\\n    font-size: 16px;\\r\\n  }\\r\\n\\r\\n  .escher-container .menu-bar .icon-sort-down {\\r\\n    font-size: 14px;\\r\\n  }\\r\\n}\\r\\n\\r\\n.escher-container .menu {\\r\\n  box-sizing: border-box;\\r\\n  font-weight: normal!important;\\r\\n  word-spacing: 0;\\r\\n  position: absolute;\\r\\n  white-space: nowrap;\\r\\n  top: 103%;\\r\\n  left: -1%;\\r\\n  z-index: 1000;\\r\\n  display: block;\\r\\n  float: none;\\r\\n  min-width: 160px;\\r\\n  padding: 5px 0;\\r\\n  list-style: none;\\r\\n  font-size: 13px;\\r\\n  box-shadow: 0 6px 12px rgba(0,0,0,0.175);\\r\\n  background-clip: padding-box;\\r\\n  border: 1px solid #ddd;\\r\\n  background-color: rgba(255, 255, 255, 0.95);\\r\\n  border-radius: 0;\\r\\n  margin: 0;\\r\\n  text-align: left;\\r\\n}\\r\\n\\r\\n.escher-container #rightMenu {\\r\\n  left: auto;\\r\\n  right: -2%;\\r\\n}\\r\\n\\r\\n.escher-container .menu li:hover {\\r\\n  background-color: #d9230f;\\r\\n  color: #FFFFFF;\\r\\n}\\r\\n\\r\\n.escher-container .menu li, .menu label {\\r\\n  font-size: 15px;\\r\\n  display: block;\\r\\n  color: #444444;\\r\\n\\r\\n  /* these sometimes get overridden */\\r\\n  font-weight: normal !important;\\r\\n  margin: 0 !important;\\r\\n}\\r\\n\\r\\n.escher-container .menu.ul.li {\\r\\n  background-color: rgba(255, 255, 255, 0.95);\\r\\n}\\r\\n\\r\\n.escher-container .menuButton {\\r\\n  box-sizing: border-box;\\r\\n  width: 100%;\\r\\n  padding: 5px 20px;\\r\\n  margin: 0;\\r\\n  cursor: pointer;\\r\\n  -webkit-user-select: none;\\r\\n  -moz-user-select: none;\\r\\n  -ms-user-select: none;\\r\\n  user-select: none;\\r\\n}\\r\\n\\r\\n.escher-container label:focus, .menuButton:focus {\\r\\n  background-color: #d9230f;\\r\\n  color: #FFFFFF;\\r\\n}\\r\\n\\r\\n.escher-container .menuButton:hover {\\r\\n  background-color: #d9230f;\\r\\n  color: #FFFFFF;\\r\\n}\\r\\n\\r\\n.escher-container input[type=\\\"file\\\"] {\\r\\n  display: none;\\r\\n}\\r\\n\\r\\n.escher-container #disabled {\\r\\n  color: #e0e0e0;\\r\\n}\\r\\n\\r\\n.escher-container #disabled:hover, #disabled:focus {\\r\\n  background-color: rgba(255, 255, 255, 0.95);\\r\\n  cursor: default;\\r\\n}\\r\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","'use strict';\n\nexports.__esModule = true;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _preact = require('preact');\n\nvar _Track = require('./Track');\n\nvar _Track2 = _interopRequireDefault(_Track);\n\nvar _createSlider = require('./createSlider');\n\nvar _createSlider2 = _interopRequireDefault(_createSlider);\n\nvar _util = require('./util');\n\nvar util = _interopRequireWildcard(_util);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /** @jsx h */\n\n\nvar Slider = function (_Component) {\n  _inherits(Slider, _Component);\n\n  function Slider(props) {\n    _classCallCheck(this, Slider);\n\n    var _this = _possibleConstructorReturn(this, _Component.call(this, props));\n\n    _this.onEnd = function () {\n      _this.setState({ dragging: false });\n      _this.removeDocumentEvents();\n      _this.props.onAfterChange(_this.getValue());\n    };\n\n    var defaultValue = props.defaultValue !== undefined ? props.defaultValue : props.min;\n    var value = props.value !== undefined ? props.value : defaultValue;\n\n    _this.state = {\n      value: _this.trimAlignValue(value),\n      dragging: false\n    };\n    return _this;\n  }\n\n  Slider.prototype.componentWillReceiveProps = function componentWillReceiveProps(nextProps) {\n    if (!('value' in nextProps || 'min' in nextProps || 'max' in nextProps)) return;\n\n    var prevValue = this.state.value;\n    var value = nextProps.value !== undefined ? nextProps.value : prevValue;\n    var nextValue = this.trimAlignValue(value, nextProps);\n    if (nextValue === prevValue) return;\n\n    this.setState({ value: nextValue });\n    if (util.isValueOutOfRange(value, nextProps)) {\n      this.props.onChange(nextValue);\n    }\n  };\n\n  Slider.prototype.onChange = function onChange(state) {\n    var props = this.props;\n    var isNotControlled = !('value' in props);\n    if (isNotControlled) {\n      this.setState(state);\n    }\n\n    var changedValue = state.value;\n    props.onChange(changedValue);\n  };\n\n  Slider.prototype.onStart = function onStart(position) {\n    this.setState({ dragging: true });\n    var props = this.props;\n    var prevValue = this.getValue();\n    props.onBeforeChange(prevValue);\n\n    var value = this.calcValueByPos(position);\n    this.startValue = value;\n    this.startPosition = position;\n\n    if (value === prevValue) return;\n\n    this.onChange({ value: value });\n  };\n\n  Slider.prototype.onMove = function onMove(e, position) {\n    util.pauseEvent(e);\n    var oldValue = this.state.value;\n\n    var value = this.calcValueByPos(position);\n    if (value === oldValue) return;\n\n    this.onChange({ value: value });\n  };\n\n  Slider.prototype.onKeyboard = function onKeyboard(e) {\n    var valueMutator = util.getKeyboardValueMutator(e);\n\n    if (valueMutator) {\n      util.pauseEvent(e);\n      var state = this.state;\n      var oldValue = state.value;\n      var mutatedValue = valueMutator(oldValue, this.props);\n      var value = this.trimAlignValue(mutatedValue);\n      if (value === oldValue) return;\n\n      this.onChange({ value: value });\n    }\n  };\n\n  Slider.prototype.getValue = function getValue() {\n    return this.state.value;\n  };\n\n  Slider.prototype.getLowerBound = function getLowerBound() {\n    return this.props.min;\n  };\n\n  Slider.prototype.getUpperBound = function getUpperBound() {\n    return this.state.value;\n  };\n\n  Slider.prototype.trimAlignValue = function trimAlignValue(v) {\n    var nextProps = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    var mergedProps = _extends({}, this.props, nextProps);\n    var val = util.ensureValueInRange(v, mergedProps);\n    return util.ensureValuePrecision(val, mergedProps);\n  };\n\n  Slider.prototype.render = function render() {\n    var _this2 = this;\n\n    var _props = this.props,\n        prefixCls = _props.prefixCls,\n        vertical = _props.vertical,\n        included = _props.included,\n        disabled = _props.disabled,\n        minimumTrackStyle = _props.minimumTrackStyle,\n        trackStyle = _props.trackStyle,\n        handleStyle = _props.handleStyle,\n        min = _props.min,\n        max = _props.max,\n        handleGenerator = _props.handle;\n    var _state = this.state,\n        value = _state.value,\n        dragging = _state.dragging;\n\n    var offset = this.calcOffset(value);\n    var handle = handleGenerator({\n      className: prefixCls + '-handle',\n      vertical: vertical,\n      offset: offset,\n      value: value,\n      dragging: dragging,\n      disabled: disabled,\n      min: min,\n      max: max,\n      style: handleStyle[0] || handleStyle,\n      ref: function ref(h) {\n        return _this2.saveHandle(0, h);\n      }\n    });\n\n    var _trackStyle = trackStyle[0] || trackStyle;\n    var track = (0, _preact.h)(_Track2.default, {\n      className: prefixCls + '-track',\n      vertical: vertical,\n      included: included,\n      offset: 0,\n      length: offset,\n      style: _extends({}, minimumTrackStyle, _trackStyle)\n    });\n\n    return { tracks: track, handles: handle };\n  };\n\n  return Slider;\n}(_preact.Component);\n\nexports.default = (0, _createSlider2.default)(Slider);","\"use strict\";\n\nvar stylesInDOM = [];\nfunction getIndexByIdentifier(identifier) {\n  var result = -1;\n  for (var i = 0; i < stylesInDOM.length; i++) {\n    if (stylesInDOM[i].identifier === identifier) {\n      result = i;\n      break;\n    }\n  }\n  return result;\n}\nfunction modulesToDom(list, options) {\n  var idCountMap = {};\n  var identifiers = [];\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i];\n    var id = options.base ? item[0] + options.base : item[0];\n    var count = idCountMap[id] || 0;\n    var identifier = \"\".concat(id, \" \").concat(count);\n    idCountMap[id] = count + 1;\n    var indexByIdentifier = getIndexByIdentifier(identifier);\n    var obj = {\n      css: item[1],\n      media: item[2],\n      sourceMap: item[3],\n      supports: item[4],\n      layer: item[5]\n    };\n    if (indexByIdentifier !== -1) {\n      stylesInDOM[indexByIdentifier].references++;\n      stylesInDOM[indexByIdentifier].updater(obj);\n    } else {\n      var updater = addElementStyle(obj, options);\n      options.byIndex = i;\n      stylesInDOM.splice(i, 0, {\n        identifier: identifier,\n        updater: updater,\n        references: 1\n      });\n    }\n    identifiers.push(identifier);\n  }\n  return identifiers;\n}\nfunction addElementStyle(obj, options) {\n  var api = options.domAPI(options);\n  api.update(obj);\n  var updater = function updater(newObj) {\n    if (newObj) {\n      if (newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap && newObj.supports === obj.supports && newObj.layer === obj.layer) {\n        return;\n      }\n      api.update(obj = newObj);\n    } else {\n      api.remove();\n    }\n  };\n  return updater;\n}\nmodule.exports = function (list, options) {\n  options = options || {};\n  list = list || [];\n  var lastIdentifiers = modulesToDom(list, options);\n  return function update(newList) {\n    newList = newList || [];\n    for (var i = 0; i < lastIdentifiers.length; i++) {\n      var identifier = lastIdentifiers[i];\n      var index = getIndexByIdentifier(identifier);\n      stylesInDOM[index].references--;\n    }\n    var newLastIdentifiers = modulesToDom(newList, options);\n    for (var _i = 0; _i < lastIdentifiers.length; _i++) {\n      var _identifier = lastIdentifiers[_i];\n      var _index = getIndexByIdentifier(_identifier);\n      if (stylesInDOM[_index].references === 0) {\n        stylesInDOM[_index].updater();\n        stylesInDOM.splice(_index, 1);\n      }\n    }\n    lastIdentifiers = newLastIdentifiers;\n  };\n};","/**\n * @ignore\n * event object for dom\n * @author yiminghe@gmail.com\n */\n\n'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _EventBaseObject = require('./EventBaseObject');\n\nvar _EventBaseObject2 = _interopRequireDefault(_EventBaseObject);\n\nvar _objectAssign = require('object-assign');\n\nvar _objectAssign2 = _interopRequireDefault(_objectAssign);\n\nvar TRUE = true;\nvar FALSE = false;\nvar commonProps = ['altKey', 'bubbles', 'cancelable', 'ctrlKey', 'currentTarget', 'eventPhase', 'metaKey', 'shiftKey', 'target', 'timeStamp', 'view', 'type'];\n\nfunction isNullOrUndefined(w) {\n  return w === null || w === undefined;\n}\n\nvar eventNormalizers = [{\n  reg: /^key/,\n  props: ['char', 'charCode', 'key', 'keyCode', 'which'],\n  fix: function fix(event, nativeEvent) {\n    if (isNullOrUndefined(event.which)) {\n      event.which = !isNullOrUndefined(nativeEvent.charCode) ? nativeEvent.charCode : nativeEvent.keyCode;\n    }\n\n    // add metaKey to non-Mac browsers (use ctrl for PC 's and Meta for Macs)\n    if (event.metaKey === undefined) {\n      event.metaKey = event.ctrlKey;\n    }\n  }\n}, {\n  reg: /^touch/,\n  props: ['touches', 'changedTouches', 'targetTouches']\n}, {\n  reg: /^hashchange$/,\n  props: ['newURL', 'oldURL']\n}, {\n  reg: /^gesturechange$/i,\n  props: ['rotation', 'scale']\n}, {\n  reg: /^(mousewheel|DOMMouseScroll)$/,\n  props: [],\n  fix: function fix(event, nativeEvent) {\n    var deltaX = undefined;\n    var deltaY = undefined;\n    var delta = undefined;\n    var wheelDelta = nativeEvent.wheelDelta;\n    var axis = nativeEvent.axis;\n    var wheelDeltaY = nativeEvent.wheelDeltaY;\n    var wheelDeltaX = nativeEvent.wheelDeltaX;\n    var detail = nativeEvent.detail;\n\n    // ie/webkit\n    if (wheelDelta) {\n      delta = wheelDelta / 120;\n    }\n\n    // gecko\n    if (detail) {\n      // press control e.detail == 1 else e.detail == 3\n      delta = 0 - (detail % 3 === 0 ? detail / 3 : detail);\n    }\n\n    // Gecko\n    if (axis !== undefined) {\n      if (axis === event.HORIZONTAL_AXIS) {\n        deltaY = 0;\n        deltaX = 0 - delta;\n      } else if (axis === event.VERTICAL_AXIS) {\n        deltaX = 0;\n        deltaY = delta;\n      }\n    }\n\n    // Webkit\n    if (wheelDeltaY !== undefined) {\n      deltaY = wheelDeltaY / 120;\n    }\n    if (wheelDeltaX !== undefined) {\n      deltaX = -1 * wheelDeltaX / 120;\n    }\n\n    // 默认 deltaY (ie)\n    if (!deltaX && !deltaY) {\n      deltaY = delta;\n    }\n\n    if (deltaX !== undefined) {\n      /**\n       * deltaX of mousewheel event\n       * @property deltaX\n       * @member Event.DomEvent.Object\n       */\n      event.deltaX = deltaX;\n    }\n\n    if (deltaY !== undefined) {\n      /**\n       * deltaY of mousewheel event\n       * @property deltaY\n       * @member Event.DomEvent.Object\n       */\n      event.deltaY = deltaY;\n    }\n\n    if (delta !== undefined) {\n      /**\n       * delta of mousewheel event\n       * @property delta\n       * @member Event.DomEvent.Object\n       */\n      event.delta = delta;\n    }\n  }\n}, {\n  reg: /^mouse|contextmenu|click|mspointer|(^DOMMouseScroll$)/i,\n  props: ['buttons', 'clientX', 'clientY', 'button', 'offsetX', 'relatedTarget', 'which', 'fromElement', 'toElement', 'offsetY', 'pageX', 'pageY', 'screenX', 'screenY'],\n  fix: function fix(event, nativeEvent) {\n    var eventDoc = undefined;\n    var doc = undefined;\n    var body = undefined;\n    var target = event.target;\n    var button = nativeEvent.button;\n\n    // Calculate pageX/Y if missing and clientX/Y available\n    if (target && isNullOrUndefined(event.pageX) && !isNullOrUndefined(nativeEvent.clientX)) {\n      eventDoc = target.ownerDocument || document;\n      doc = eventDoc.documentElement;\n      body = eventDoc.body;\n      event.pageX = nativeEvent.clientX + (doc && doc.scrollLeft || body && body.scrollLeft || 0) - (doc && doc.clientLeft || body && body.clientLeft || 0);\n      event.pageY = nativeEvent.clientY + (doc && doc.scrollTop || body && body.scrollTop || 0) - (doc && doc.clientTop || body && body.clientTop || 0);\n    }\n\n    // which for click: 1 === left; 2 === middle; 3 === right\n    // do not use button\n    if (!event.which && button !== undefined) {\n      if (button & 1) {\n        event.which = 1;\n      } else if (button & 2) {\n        event.which = 3;\n      } else if (button & 4) {\n        event.which = 2;\n      } else {\n        event.which = 0;\n      }\n    }\n\n    // add relatedTarget, if necessary\n    if (!event.relatedTarget && event.fromElement) {\n      event.relatedTarget = event.fromElement === target ? event.toElement : event.fromElement;\n    }\n\n    return event;\n  }\n}];\n\nfunction retTrue() {\n  return TRUE;\n}\n\nfunction retFalse() {\n  return FALSE;\n}\n\nfunction DomEventObject(nativeEvent) {\n  var type = nativeEvent.type;\n\n  var isNative = typeof nativeEvent.stopPropagation === 'function' || typeof nativeEvent.cancelBubble === 'boolean';\n\n  _EventBaseObject2['default'].call(this);\n\n  this.nativeEvent = nativeEvent;\n\n  // in case dom event has been mark as default prevented by lower dom node\n  var isDefaultPrevented = retFalse;\n  if ('defaultPrevented' in nativeEvent) {\n    isDefaultPrevented = nativeEvent.defaultPrevented ? retTrue : retFalse;\n  } else if ('getPreventDefault' in nativeEvent) {\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=691151\n    isDefaultPrevented = nativeEvent.getPreventDefault() ? retTrue : retFalse;\n  } else if ('returnValue' in nativeEvent) {\n    isDefaultPrevented = nativeEvent.returnValue === FALSE ? retTrue : retFalse;\n  }\n\n  this.isDefaultPrevented = isDefaultPrevented;\n\n  var fixFns = [];\n  var fixFn = undefined;\n  var l = undefined;\n  var prop = undefined;\n  var props = commonProps.concat();\n\n  eventNormalizers.forEach(function (normalizer) {\n    if (type.match(normalizer.reg)) {\n      props = props.concat(normalizer.props);\n      if (normalizer.fix) {\n        fixFns.push(normalizer.fix);\n      }\n    }\n  });\n\n  l = props.length;\n\n  // clone properties of the original event object\n  while (l) {\n    prop = props[--l];\n    this[prop] = nativeEvent[prop];\n  }\n\n  // fix target property, if necessary\n  if (!this.target && isNative) {\n    this.target = nativeEvent.srcElement || document; // srcElement might not be defined either\n  }\n\n  // check if target is a text node (safari)\n  if (this.target && this.target.nodeType === 3) {\n    this.target = this.target.parentNode;\n  }\n\n  l = fixFns.length;\n\n  while (l) {\n    fixFn = fixFns[--l];\n    fixFn(this, nativeEvent);\n  }\n\n  this.timeStamp = nativeEvent.timeStamp || Date.now();\n}\n\nvar EventBaseObjectProto = _EventBaseObject2['default'].prototype;\n\n(0, _objectAssign2['default'])(DomEventObject.prototype, EventBaseObjectProto, {\n  constructor: DomEventObject,\n\n  preventDefault: function preventDefault() {\n    var e = this.nativeEvent;\n\n    // if preventDefault exists run it on the original event\n    if (e.preventDefault) {\n      e.preventDefault();\n    } else {\n      // otherwise set the returnValue property of the original event to FALSE (IE)\n      e.returnValue = FALSE;\n    }\n\n    EventBaseObjectProto.preventDefault.call(this);\n  },\n\n  stopPropagation: function stopPropagation() {\n    var e = this.nativeEvent;\n\n    // if stopPropagation exists run it on the original event\n    if (e.stopPropagation) {\n      e.stopPropagation();\n    } else {\n      // otherwise set the cancelBubble property of the original event to TRUE (IE)\n      e.cancelBubble = TRUE;\n    }\n\n    EventBaseObjectProto.stopPropagation.call(this);\n  }\n});\n\nexports['default'] = DomEventObject;\nmodule.exports = exports['default'];","\"use strict\";\n\n/* istanbul ignore next  */\nfunction styleTagTransform(css, styleElement) {\n  if (styleElement.styleSheet) {\n    styleElement.styleSheet.cssText = css;\n  } else {\n    while (styleElement.firstChild) {\n      styleElement.removeChild(styleElement.firstChild);\n    }\n    styleElement.appendChild(document.createTextNode(css));\n  }\n}\nmodule.exports = styleTagTransform;","var VNode = function VNode() {};\n\nvar options = {};\n\nvar stack = [];\n\nvar EMPTY_CHILDREN = [];\n\nfunction h(nodeName, attributes) {\n\tvar children = EMPTY_CHILDREN,\n\t    lastSimple,\n\t    child,\n\t    simple,\n\t    i;\n\tfor (i = arguments.length; i-- > 2;) {\n\t\tstack.push(arguments[i]);\n\t}\n\tif (attributes && attributes.children != null) {\n\t\tif (!stack.length) stack.push(attributes.children);\n\t\tdelete attributes.children;\n\t}\n\twhile (stack.length) {\n\t\tif ((child = stack.pop()) && child.pop !== undefined) {\n\t\t\tfor (i = child.length; i--;) {\n\t\t\t\tstack.push(child[i]);\n\t\t\t}\n\t\t} else {\n\t\t\tif (typeof child === 'boolean') child = null;\n\n\t\t\tif (simple = typeof nodeName !== 'function') {\n\t\t\t\tif (child == null) child = '';else if (typeof child === 'number') child = String(child);else if (typeof child !== 'string') simple = false;\n\t\t\t}\n\n\t\t\tif (simple && lastSimple) {\n\t\t\t\tchildren[children.length - 1] += child;\n\t\t\t} else if (children === EMPTY_CHILDREN) {\n\t\t\t\tchildren = [child];\n\t\t\t} else {\n\t\t\t\tchildren.push(child);\n\t\t\t}\n\n\t\t\tlastSimple = simple;\n\t\t}\n\t}\n\n\tvar p = new VNode();\n\tp.nodeName = nodeName;\n\tp.children = children;\n\tp.attributes = attributes == null ? undefined : attributes;\n\tp.key = attributes == null ? undefined : attributes.key;\n\n\tif (options.vnode !== undefined) options.vnode(p);\n\n\treturn p;\n}\n\nfunction extend(obj, props) {\n  for (var i in props) {\n    obj[i] = props[i];\n  }return obj;\n}\n\nfunction applyRef(ref, value) {\n  if (ref) {\n    if (typeof ref == 'function') ref(value);else ref.current = value;\n  }\n}\n\nvar defer = typeof Promise == 'function' ? Promise.resolve().then.bind(Promise.resolve()) : setTimeout;\n\nfunction cloneElement(vnode, props) {\n  return h(vnode.nodeName, extend(extend({}, vnode.attributes), props), arguments.length > 2 ? [].slice.call(arguments, 2) : vnode.children);\n}\n\nvar IS_NON_DIMENSIONAL = /acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i;\n\nvar items = [];\n\nfunction enqueueRender(component) {\n\tif (!component._dirty && (component._dirty = true) && items.push(component) == 1) {\n\t\t(options.debounceRendering || defer)(rerender);\n\t}\n}\n\nfunction rerender() {\n\tvar p;\n\twhile (p = items.pop()) {\n\t\tif (p._dirty) renderComponent(p);\n\t}\n}\n\nfunction isSameNodeType(node, vnode, hydrating) {\n\tif (typeof vnode === 'string' || typeof vnode === 'number') {\n\t\treturn node.splitText !== undefined;\n\t}\n\tif (typeof vnode.nodeName === 'string') {\n\t\treturn !node._componentConstructor && isNamedNode(node, vnode.nodeName);\n\t}\n\treturn hydrating || node._componentConstructor === vnode.nodeName;\n}\n\nfunction isNamedNode(node, nodeName) {\n\treturn node.normalizedNodeName === nodeName || node.nodeName.toLowerCase() === nodeName.toLowerCase();\n}\n\nfunction getNodeProps(vnode) {\n\tvar props = extend({}, vnode.attributes);\n\tprops.children = vnode.children;\n\n\tvar defaultProps = vnode.nodeName.defaultProps;\n\tif (defaultProps !== undefined) {\n\t\tfor (var i in defaultProps) {\n\t\t\tif (props[i] === undefined) {\n\t\t\t\tprops[i] = defaultProps[i];\n\t\t\t}\n\t\t}\n\t}\n\n\treturn props;\n}\n\nfunction createNode(nodeName, isSvg) {\n\tvar node = isSvg ? document.createElementNS('http://www.w3.org/2000/svg', nodeName) : document.createElement(nodeName);\n\tnode.normalizedNodeName = nodeName;\n\treturn node;\n}\n\nfunction removeNode(node) {\n\tvar parentNode = node.parentNode;\n\tif (parentNode) parentNode.removeChild(node);\n}\n\nfunction setAccessor(node, name, old, value, isSvg) {\n\tif (name === 'className') name = 'class';\n\n\tif (name === 'key') {} else if (name === 'ref') {\n\t\tapplyRef(old, null);\n\t\tapplyRef(value, node);\n\t} else if (name === 'class' && !isSvg) {\n\t\tnode.className = value || '';\n\t} else if (name === 'style') {\n\t\tif (!value || typeof value === 'string' || typeof old === 'string') {\n\t\t\tnode.style.cssText = value || '';\n\t\t}\n\t\tif (value && typeof value === 'object') {\n\t\t\tif (typeof old !== 'string') {\n\t\t\t\tfor (var i in old) {\n\t\t\t\t\tif (!(i in value)) node.style[i] = '';\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (var i in value) {\n\t\t\t\tnode.style[i] = typeof value[i] === 'number' && IS_NON_DIMENSIONAL.test(i) === false ? value[i] + 'px' : value[i];\n\t\t\t}\n\t\t}\n\t} else if (name === 'dangerouslySetInnerHTML') {\n\t\tif (value) node.innerHTML = value.__html || '';\n\t} else if (name[0] == 'o' && name[1] == 'n') {\n\t\tvar useCapture = name !== (name = name.replace(/Capture$/, ''));\n\t\tname = name.toLowerCase().substring(2);\n\t\tif (value) {\n\t\t\tif (!old) node.addEventListener(name, eventProxy, useCapture);\n\t\t} else {\n\t\t\tnode.removeEventListener(name, eventProxy, useCapture);\n\t\t}\n\t\t(node._listeners || (node._listeners = {}))[name] = value;\n\t} else if (name !== 'list' && name !== 'type' && !isSvg && name in node) {\n\t\ttry {\n\t\t\tnode[name] = value == null ? '' : value;\n\t\t} catch (e) {}\n\t\tif ((value == null || value === false) && name != 'spellcheck') node.removeAttribute(name);\n\t} else {\n\t\tvar ns = isSvg && name !== (name = name.replace(/^xlink:?/, ''));\n\n\t\tif (value == null || value === false) {\n\t\t\tif (ns) node.removeAttributeNS('http://www.w3.org/1999/xlink', name.toLowerCase());else node.removeAttribute(name);\n\t\t} else if (typeof value !== 'function') {\n\t\t\tif (ns) node.setAttributeNS('http://www.w3.org/1999/xlink', name.toLowerCase(), value);else node.setAttribute(name, value);\n\t\t}\n\t}\n}\n\nfunction eventProxy(e) {\n\treturn this._listeners[e.type](options.event && options.event(e) || e);\n}\n\nvar mounts = [];\n\nvar diffLevel = 0;\n\nvar isSvgMode = false;\n\nvar hydrating = false;\n\nfunction flushMounts() {\n\tvar c;\n\twhile (c = mounts.shift()) {\n\t\tif (options.afterMount) options.afterMount(c);\n\t\tif (c.componentDidMount) c.componentDidMount();\n\t}\n}\n\nfunction diff(dom, vnode, context, mountAll, parent, componentRoot) {\n\tif (!diffLevel++) {\n\t\tisSvgMode = parent != null && parent.ownerSVGElement !== undefined;\n\n\t\thydrating = dom != null && !('__preactattr_' in dom);\n\t}\n\n\tvar ret = idiff(dom, vnode, context, mountAll, componentRoot);\n\n\tif (parent && ret.parentNode !== parent) parent.appendChild(ret);\n\n\tif (! --diffLevel) {\n\t\thydrating = false;\n\n\t\tif (!componentRoot) flushMounts();\n\t}\n\n\treturn ret;\n}\n\nfunction idiff(dom, vnode, context, mountAll, componentRoot) {\n\tvar out = dom,\n\t    prevSvgMode = isSvgMode;\n\n\tif (vnode == null || typeof vnode === 'boolean') vnode = '';\n\n\tif (typeof vnode === 'string' || typeof vnode === 'number') {\n\t\tif (dom && dom.splitText !== undefined && dom.parentNode && (!dom._component || componentRoot)) {\n\t\t\tif (dom.nodeValue != vnode) {\n\t\t\t\tdom.nodeValue = vnode;\n\t\t\t}\n\t\t} else {\n\t\t\tout = document.createTextNode(vnode);\n\t\t\tif (dom) {\n\t\t\t\tif (dom.parentNode) dom.parentNode.replaceChild(out, dom);\n\t\t\t\trecollectNodeTree(dom, true);\n\t\t\t}\n\t\t}\n\n\t\tout['__preactattr_'] = true;\n\n\t\treturn out;\n\t}\n\n\tvar vnodeName = vnode.nodeName;\n\tif (typeof vnodeName === 'function') {\n\t\treturn buildComponentFromVNode(dom, vnode, context, mountAll);\n\t}\n\n\tisSvgMode = vnodeName === 'svg' ? true : vnodeName === 'foreignObject' ? false : isSvgMode;\n\n\tvnodeName = String(vnodeName);\n\tif (!dom || !isNamedNode(dom, vnodeName)) {\n\t\tout = createNode(vnodeName, isSvgMode);\n\n\t\tif (dom) {\n\t\t\twhile (dom.firstChild) {\n\t\t\t\tout.appendChild(dom.firstChild);\n\t\t\t}\n\t\t\tif (dom.parentNode) dom.parentNode.replaceChild(out, dom);\n\n\t\t\trecollectNodeTree(dom, true);\n\t\t}\n\t}\n\n\tvar fc = out.firstChild,\n\t    props = out['__preactattr_'],\n\t    vchildren = vnode.children;\n\n\tif (props == null) {\n\t\tprops = out['__preactattr_'] = {};\n\t\tfor (var a = out.attributes, i = a.length; i--;) {\n\t\t\tprops[a[i].name] = a[i].value;\n\t\t}\n\t}\n\n\tif (!hydrating && vchildren && vchildren.length === 1 && typeof vchildren[0] === 'string' && fc != null && fc.splitText !== undefined && fc.nextSibling == null) {\n\t\tif (fc.nodeValue != vchildren[0]) {\n\t\t\tfc.nodeValue = vchildren[0];\n\t\t}\n\t} else if (vchildren && vchildren.length || fc != null) {\n\t\t\tinnerDiffNode(out, vchildren, context, mountAll, hydrating || props.dangerouslySetInnerHTML != null);\n\t\t}\n\n\tdiffAttributes(out, vnode.attributes, props);\n\n\tisSvgMode = prevSvgMode;\n\n\treturn out;\n}\n\nfunction innerDiffNode(dom, vchildren, context, mountAll, isHydrating) {\n\tvar originalChildren = dom.childNodes,\n\t    children = [],\n\t    keyed = {},\n\t    keyedLen = 0,\n\t    min = 0,\n\t    len = originalChildren.length,\n\t    childrenLen = 0,\n\t    vlen = vchildren ? vchildren.length : 0,\n\t    j,\n\t    c,\n\t    f,\n\t    vchild,\n\t    child;\n\n\tif (len !== 0) {\n\t\tfor (var i = 0; i < len; i++) {\n\t\t\tvar _child = originalChildren[i],\n\t\t\t    props = _child['__preactattr_'],\n\t\t\t    key = vlen && props ? _child._component ? _child._component.__key : props.key : null;\n\t\t\tif (key != null) {\n\t\t\t\tkeyedLen++;\n\t\t\t\tkeyed[key] = _child;\n\t\t\t} else if (props || (_child.splitText !== undefined ? isHydrating ? _child.nodeValue.trim() : true : isHydrating)) {\n\t\t\t\tchildren[childrenLen++] = _child;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (vlen !== 0) {\n\t\tfor (var i = 0; i < vlen; i++) {\n\t\t\tvchild = vchildren[i];\n\t\t\tchild = null;\n\n\t\t\tvar key = vchild.key;\n\t\t\tif (key != null) {\n\t\t\t\tif (keyedLen && keyed[key] !== undefined) {\n\t\t\t\t\tchild = keyed[key];\n\t\t\t\t\tkeyed[key] = undefined;\n\t\t\t\t\tkeyedLen--;\n\t\t\t\t}\n\t\t\t} else if (min < childrenLen) {\n\t\t\t\t\tfor (j = min; j < childrenLen; j++) {\n\t\t\t\t\t\tif (children[j] !== undefined && isSameNodeType(c = children[j], vchild, isHydrating)) {\n\t\t\t\t\t\t\tchild = c;\n\t\t\t\t\t\t\tchildren[j] = undefined;\n\t\t\t\t\t\t\tif (j === childrenLen - 1) childrenLen--;\n\t\t\t\t\t\t\tif (j === min) min++;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\tchild = idiff(child, vchild, context, mountAll);\n\n\t\t\tf = originalChildren[i];\n\t\t\tif (child && child !== dom && child !== f) {\n\t\t\t\tif (f == null) {\n\t\t\t\t\tdom.appendChild(child);\n\t\t\t\t} else if (child === f.nextSibling) {\n\t\t\t\t\tremoveNode(f);\n\t\t\t\t} else {\n\t\t\t\t\tdom.insertBefore(child, f);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tif (keyedLen) {\n\t\tfor (var i in keyed) {\n\t\t\tif (keyed[i] !== undefined) recollectNodeTree(keyed[i], false);\n\t\t}\n\t}\n\n\twhile (min <= childrenLen) {\n\t\tif ((child = children[childrenLen--]) !== undefined) recollectNodeTree(child, false);\n\t}\n}\n\nfunction recollectNodeTree(node, unmountOnly) {\n\tvar component = node._component;\n\tif (component) {\n\t\tunmountComponent(component);\n\t} else {\n\t\tif (node['__preactattr_'] != null) applyRef(node['__preactattr_'].ref, null);\n\n\t\tif (unmountOnly === false || node['__preactattr_'] == null) {\n\t\t\tremoveNode(node);\n\t\t}\n\n\t\tremoveChildren(node);\n\t}\n}\n\nfunction removeChildren(node) {\n\tnode = node.lastChild;\n\twhile (node) {\n\t\tvar next = node.previousSibling;\n\t\trecollectNodeTree(node, true);\n\t\tnode = next;\n\t}\n}\n\nfunction diffAttributes(dom, attrs, old) {\n\tvar name;\n\n\tfor (name in old) {\n\t\tif (!(attrs && attrs[name] != null) && old[name] != null) {\n\t\t\tsetAccessor(dom, name, old[name], old[name] = undefined, isSvgMode);\n\t\t}\n\t}\n\n\tfor (name in attrs) {\n\t\tif (name !== 'children' && name !== 'innerHTML' && (!(name in old) || attrs[name] !== (name === 'value' || name === 'checked' ? dom[name] : old[name]))) {\n\t\t\tsetAccessor(dom, name, old[name], old[name] = attrs[name], isSvgMode);\n\t\t}\n\t}\n}\n\nvar recyclerComponents = [];\n\nfunction createComponent(Ctor, props, context) {\n\tvar inst,\n\t    i = recyclerComponents.length;\n\n\tif (Ctor.prototype && Ctor.prototype.render) {\n\t\tinst = new Ctor(props, context);\n\t\tComponent.call(inst, props, context);\n\t} else {\n\t\tinst = new Component(props, context);\n\t\tinst.constructor = Ctor;\n\t\tinst.render = doRender;\n\t}\n\n\twhile (i--) {\n\t\tif (recyclerComponents[i].constructor === Ctor) {\n\t\t\tinst.nextBase = recyclerComponents[i].nextBase;\n\t\t\trecyclerComponents.splice(i, 1);\n\t\t\treturn inst;\n\t\t}\n\t}\n\n\treturn inst;\n}\n\nfunction doRender(props, state, context) {\n\treturn this.constructor(props, context);\n}\n\nfunction setComponentProps(component, props, renderMode, context, mountAll) {\n\tif (component._disable) return;\n\tcomponent._disable = true;\n\n\tcomponent.__ref = props.ref;\n\tcomponent.__key = props.key;\n\tdelete props.ref;\n\tdelete props.key;\n\n\tif (typeof component.constructor.getDerivedStateFromProps === 'undefined') {\n\t\tif (!component.base || mountAll) {\n\t\t\tif (component.componentWillMount) component.componentWillMount();\n\t\t} else if (component.componentWillReceiveProps) {\n\t\t\tcomponent.componentWillReceiveProps(props, context);\n\t\t}\n\t}\n\n\tif (context && context !== component.context) {\n\t\tif (!component.prevContext) component.prevContext = component.context;\n\t\tcomponent.context = context;\n\t}\n\n\tif (!component.prevProps) component.prevProps = component.props;\n\tcomponent.props = props;\n\n\tcomponent._disable = false;\n\n\tif (renderMode !== 0) {\n\t\tif (renderMode === 1 || options.syncComponentUpdates !== false || !component.base) {\n\t\t\trenderComponent(component, 1, mountAll);\n\t\t} else {\n\t\t\tenqueueRender(component);\n\t\t}\n\t}\n\n\tapplyRef(component.__ref, component);\n}\n\nfunction renderComponent(component, renderMode, mountAll, isChild) {\n\tif (component._disable) return;\n\n\tvar props = component.props,\n\t    state = component.state,\n\t    context = component.context,\n\t    previousProps = component.prevProps || props,\n\t    previousState = component.prevState || state,\n\t    previousContext = component.prevContext || context,\n\t    isUpdate = component.base,\n\t    nextBase = component.nextBase,\n\t    initialBase = isUpdate || nextBase,\n\t    initialChildComponent = component._component,\n\t    skip = false,\n\t    snapshot = previousContext,\n\t    rendered,\n\t    inst,\n\t    cbase;\n\n\tif (component.constructor.getDerivedStateFromProps) {\n\t\tstate = extend(extend({}, state), component.constructor.getDerivedStateFromProps(props, state));\n\t\tcomponent.state = state;\n\t}\n\n\tif (isUpdate) {\n\t\tcomponent.props = previousProps;\n\t\tcomponent.state = previousState;\n\t\tcomponent.context = previousContext;\n\t\tif (renderMode !== 2 && component.shouldComponentUpdate && component.shouldComponentUpdate(props, state, context) === false) {\n\t\t\tskip = true;\n\t\t} else if (component.componentWillUpdate) {\n\t\t\tcomponent.componentWillUpdate(props, state, context);\n\t\t}\n\t\tcomponent.props = props;\n\t\tcomponent.state = state;\n\t\tcomponent.context = context;\n\t}\n\n\tcomponent.prevProps = component.prevState = component.prevContext = component.nextBase = null;\n\tcomponent._dirty = false;\n\n\tif (!skip) {\n\t\trendered = component.render(props, state, context);\n\n\t\tif (component.getChildContext) {\n\t\t\tcontext = extend(extend({}, context), component.getChildContext());\n\t\t}\n\n\t\tif (isUpdate && component.getSnapshotBeforeUpdate) {\n\t\t\tsnapshot = component.getSnapshotBeforeUpdate(previousProps, previousState);\n\t\t}\n\n\t\tvar childComponent = rendered && rendered.nodeName,\n\t\t    toUnmount,\n\t\t    base;\n\n\t\tif (typeof childComponent === 'function') {\n\n\t\t\tvar childProps = getNodeProps(rendered);\n\t\t\tinst = initialChildComponent;\n\n\t\t\tif (inst && inst.constructor === childComponent && childProps.key == inst.__key) {\n\t\t\t\tsetComponentProps(inst, childProps, 1, context, false);\n\t\t\t} else {\n\t\t\t\ttoUnmount = inst;\n\n\t\t\t\tcomponent._component = inst = createComponent(childComponent, childProps, context);\n\t\t\t\tinst.nextBase = inst.nextBase || nextBase;\n\t\t\t\tinst._parentComponent = component;\n\t\t\t\tsetComponentProps(inst, childProps, 0, context, false);\n\t\t\t\trenderComponent(inst, 1, mountAll, true);\n\t\t\t}\n\n\t\t\tbase = inst.base;\n\t\t} else {\n\t\t\tcbase = initialBase;\n\n\t\t\ttoUnmount = initialChildComponent;\n\t\t\tif (toUnmount) {\n\t\t\t\tcbase = component._component = null;\n\t\t\t}\n\n\t\t\tif (initialBase || renderMode === 1) {\n\t\t\t\tif (cbase) cbase._component = null;\n\t\t\t\tbase = diff(cbase, rendered, context, mountAll || !isUpdate, initialBase && initialBase.parentNode, true);\n\t\t\t}\n\t\t}\n\n\t\tif (initialBase && base !== initialBase && inst !== initialChildComponent) {\n\t\t\tvar baseParent = initialBase.parentNode;\n\t\t\tif (baseParent && base !== baseParent) {\n\t\t\t\tbaseParent.replaceChild(base, initialBase);\n\n\t\t\t\tif (!toUnmount) {\n\t\t\t\t\tinitialBase._component = null;\n\t\t\t\t\trecollectNodeTree(initialBase, false);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (toUnmount) {\n\t\t\tunmountComponent(toUnmount);\n\t\t}\n\n\t\tcomponent.base = base;\n\t\tif (base && !isChild) {\n\t\t\tvar componentRef = component,\n\t\t\t    t = component;\n\t\t\twhile (t = t._parentComponent) {\n\t\t\t\t(componentRef = t).base = base;\n\t\t\t}\n\t\t\tbase._component = componentRef;\n\t\t\tbase._componentConstructor = componentRef.constructor;\n\t\t}\n\t}\n\n\tif (!isUpdate || mountAll) {\n\t\tmounts.push(component);\n\t} else if (!skip) {\n\n\t\tif (component.componentDidUpdate) {\n\t\t\tcomponent.componentDidUpdate(previousProps, previousState, snapshot);\n\t\t}\n\t\tif (options.afterUpdate) options.afterUpdate(component);\n\t}\n\n\twhile (component._renderCallbacks.length) {\n\t\tcomponent._renderCallbacks.pop().call(component);\n\t}if (!diffLevel && !isChild) flushMounts();\n}\n\nfunction buildComponentFromVNode(dom, vnode, context, mountAll) {\n\tvar c = dom && dom._component,\n\t    originalComponent = c,\n\t    oldDom = dom,\n\t    isDirectOwner = c && dom._componentConstructor === vnode.nodeName,\n\t    isOwner = isDirectOwner,\n\t    props = getNodeProps(vnode);\n\twhile (c && !isOwner && (c = c._parentComponent)) {\n\t\tisOwner = c.constructor === vnode.nodeName;\n\t}\n\n\tif (c && isOwner && (!mountAll || c._component)) {\n\t\tsetComponentProps(c, props, 3, context, mountAll);\n\t\tdom = c.base;\n\t} else {\n\t\tif (originalComponent && !isDirectOwner) {\n\t\t\tunmountComponent(originalComponent);\n\t\t\tdom = oldDom = null;\n\t\t}\n\n\t\tc = createComponent(vnode.nodeName, props, context);\n\t\tif (dom && !c.nextBase) {\n\t\t\tc.nextBase = dom;\n\n\t\t\toldDom = null;\n\t\t}\n\t\tsetComponentProps(c, props, 1, context, mountAll);\n\t\tdom = c.base;\n\n\t\tif (oldDom && dom !== oldDom) {\n\t\t\toldDom._component = null;\n\t\t\trecollectNodeTree(oldDom, false);\n\t\t}\n\t}\n\n\treturn dom;\n}\n\nfunction unmountComponent(component) {\n\tif (options.beforeUnmount) options.beforeUnmount(component);\n\n\tvar base = component.base;\n\n\tcomponent._disable = true;\n\n\tif (component.componentWillUnmount) component.componentWillUnmount();\n\n\tcomponent.base = null;\n\n\tvar inner = component._component;\n\tif (inner) {\n\t\tunmountComponent(inner);\n\t} else if (base) {\n\t\tif (base['__preactattr_'] != null) applyRef(base['__preactattr_'].ref, null);\n\n\t\tcomponent.nextBase = base;\n\n\t\tremoveNode(base);\n\t\trecyclerComponents.push(component);\n\n\t\tremoveChildren(base);\n\t}\n\n\tapplyRef(component.__ref, null);\n}\n\nfunction Component(props, context) {\n\tthis._dirty = true;\n\n\tthis.context = context;\n\n\tthis.props = props;\n\n\tthis.state = this.state || {};\n\n\tthis._renderCallbacks = [];\n}\n\nextend(Component.prototype, {\n\tsetState: function setState(state, callback) {\n\t\tif (!this.prevState) this.prevState = this.state;\n\t\tthis.state = extend(extend({}, this.state), typeof state === 'function' ? state(this.state, this.props) : state);\n\t\tif (callback) this._renderCallbacks.push(callback);\n\t\tenqueueRender(this);\n\t},\n\tforceUpdate: function forceUpdate(callback) {\n\t\tif (callback) this._renderCallbacks.push(callback);\n\t\trenderComponent(this, 2);\n\t},\n\trender: function render() {}\n});\n\nfunction render(vnode, parent, merge) {\n  return diff(merge, vnode, {}, false, parent, false);\n}\n\nfunction createRef() {\n\treturn {};\n}\n\nvar preact = {\n\th: h,\n\tcreateElement: h,\n\tcloneElement: cloneElement,\n\tcreateRef: createRef,\n\tComponent: Component,\n\trender: render,\n\trerender: rerender,\n\toptions: options\n};\n\nexport default preact;\nexport { h, h as createElement, cloneElement, createRef, Component, render, rerender, options };\n//# sourceMappingURL=preact.mjs.map\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.escher-container .settingsBackground {\r\n  box-sizing: border-box;\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  z-index: 9;\r\n  background: rgba(0,0,0,.4);\r\n  padding: 5% 0 80px;\r\n  text-align: center;\r\n}\r\n\r\n.escher-container .scale-editor .domain-input {\r\n  color: #333;\r\n}\r\n\r\n.escher-container .settingsBoxContainer button {\r\n  position: absolute;\r\n  top: 5px;\r\n  right: 20px;\r\n  z-index: 10;\r\n  text-align: center;\r\n  vertical-align: middle;\r\n  font-weight: normal!important;\r\n  width: 34px;\r\n  height: 30px;\r\n  margin: 0;\r\n  padding: unset;\r\n  font-size: 14px!important;\r\n  border-radius: 3px;\r\n  -ms-touch-action: none;\r\n  touch-action: none;\r\n}\r\n\r\n.escher-container .settingsBoxContainer button:active {\r\n  background-image: linear-gradient(#3F4141, #474949 6%, #4F5151);\r\n}\r\n\r\n.escher-container .settingsBoxContainer .discardChanges {\r\n  right: 60px;\r\n}\r\n\r\n.escher-container .settingsBoxContainer {\r\n  color: rgb(119, 119, 119);\r\n  display: inline-block;\r\n  position: relative;\r\n  width: 90%;\r\n  max-width: 520px;\r\n  height: 100%;\r\n  z-index: 10;\r\n}\r\n\r\n.escher-container .settingsBox {\r\n  font-size: 13px;\r\n  box-sizing: border-box;\r\n  display: inline-block;\r\n  max-height: 100%;\r\n  width: 100%;\r\n  overflow-y: scroll;\r\n  overflow-x: hidden;\r\n  background: rgba(255, 255, 255, 0.953);\r\n  padding: 8px;\r\n  margin: 0;\r\n  border: 1px solid #ddd;\r\n  text-align: left;\r\n}\r\n\r\n.escher-container .settingsBox * {\r\n  box-sizing: border-box;\r\n}\r\n\r\n.escher-container .settingsBox .title {\r\n  font-size: 17px;\r\n  font-weight: 700;\r\n  color: #777777;\r\n}\r\n\r\n.escher-container .settingsBox .subheading {\r\n  font-size: 13px;\r\n  font-weight: 700;\r\n  margin-top: 15px;\r\n  color: #777777;\r\n}\r\n\r\n.escher-container .settingsBox table {\r\n  border-collapse: collapse;\r\n}\r\n\r\n.escher-container .settingsBox label {\r\n  display: inline;\r\n}\r\n\r\n.escher-container .settingsBox .radioSelection {\r\n  cursor: default;\r\n}\r\n\r\n.escher-container .radioSelection td {\r\n  padding: 3px 5px;\r\n}\r\n\r\n.escher-container .radioSelection input[type=radio] {\r\n  margin: 0;\r\n  margin-top: 4px;\r\n  margin-right: 4px;\r\n}\r\n\r\n.escher-container .radioSelection .optionLabel {\r\n  width: 88px;\r\n}\r\n\r\n.escher-container .radioSelection .optionLabelWide {\r\n  width: 192px;\r\n}\r\n\r\n.escher-container .radioSelection .optionGroup {\r\n  margin-right: 10px\r\n}\r\n\r\n.escher-container .settingsBox .singleLine {\r\n  display: flex;\r\n}\r\n\r\n.escher-container .settingsContainer label {\r\n  display: block;\r\n  margin-bottom: 0;\r\n}\r\n\r\n.escher-container .settingsBoxContainer input[type=checkbox] {\r\n  margin: 0;\r\n  margin-top: 4px;\r\n  margin-right: 4px;\r\n}\r\n\r\n.escher-container .settingsTip {\r\n  font-size: 13px;\r\n}\r\n\r\n.escher-container .settingsBoxContainer hr {\r\n  margin: 18px 0;\r\n  border: 0;\r\n  border-top: 1px solid #dddddd;\r\n}\r\n\r\n.escher-container .scaleTitle {\r\n  margin-top: 15px;\r\n  display: flex;\r\n  justify-content: space-between;\r\n}\r\n\r\n.escher-container .selector {\r\n  position: relative;\r\n  -webkit-user-select: none;\r\n  -moz-user-select: none;\r\n  -ms-user-select: none;\r\n  user-select: none;\r\n  padding-top: 2px;\r\n}\r\n\r\n.escher-container .selectorTitle {\r\n  background-color: white;\r\n  border: 1px solid #a9a9a9;\r\n  padding-left: 4px;\r\n  cursor: default;\r\n  width: 162px;\r\n}\r\n\r\n.escher-container .selectorTitle:hover:not(.disabled) {\r\n  border-color: black;\r\n}\r\n\r\n.escher-container .selectorTitle.disabled {\r\n  background-color: #f1ecfa;\r\n}\r\n\r\n.escher-container .selectorMenu {\r\n  position: absolute;\r\n  z-index: 4;\r\n  background-color: white;\r\n  border: 1px solid #a9a9a9;\r\n  min-width: 162px;\r\n}\r\n\r\n.escher-container .scaleSelection {\r\n  cursor: default;\r\n  padding: 0 6px;\r\n  display: flex;\r\n  justify-content: space-between;\r\n}\r\n\r\n.escher-container .scaleSelection:hover {\r\n  background-color: dodgerblue;\r\n  color: white;\r\n}\r\n\r\n.escher-container .settingsBox .icon-sort-down {\r\n  position: absolute;\r\n  top: 0;\r\n}\r\n\r\n.escher-container .settingsBox .tooltipOption {\r\n  margin-left: 10px;\r\n}\r\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/css/SettingsMenu.css\"],\"names\":[],\"mappings\":\"AAAA;EACE,sBAAsB;EACtB,kBAAkB;EAClB,MAAM;EACN,OAAO;EACP,WAAW;EACX,YAAY;EACZ,UAAU;EACV,0BAA0B;EAC1B,kBAAkB;EAClB,kBAAkB;AACpB;;AAEA;EACE,WAAW;AACb;;AAEA;EACE,kBAAkB;EAClB,QAAQ;EACR,WAAW;EACX,WAAW;EACX,kBAAkB;EAClB,sBAAsB;EACtB,6BAA6B;EAC7B,WAAW;EACX,YAAY;EACZ,SAAS;EACT,cAAc;EACd,yBAAyB;EACzB,kBAAkB;EAClB,sBAAsB;EACtB,kBAAkB;AACpB;;AAEA;EACE,+DAA+D;AACjE;;AAEA;EACE,WAAW;AACb;;AAEA;EACE,yBAAyB;EACzB,qBAAqB;EACrB,kBAAkB;EAClB,UAAU;EACV,gBAAgB;EAChB,YAAY;EACZ,WAAW;AACb;;AAEA;EACE,eAAe;EACf,sBAAsB;EACtB,qBAAqB;EACrB,gBAAgB;EAChB,WAAW;EACX,kBAAkB;EAClB,kBAAkB;EAClB,sCAAsC;EACtC,YAAY;EACZ,SAAS;EACT,sBAAsB;EACtB,gBAAgB;AAClB;;AAEA;EACE,sBAAsB;AACxB;;AAEA;EACE,eAAe;EACf,gBAAgB;EAChB,cAAc;AAChB;;AAEA;EACE,eAAe;EACf,gBAAgB;EAChB,gBAAgB;EAChB,cAAc;AAChB;;AAEA;EACE,yBAAyB;AAC3B;;AAEA;EACE,eAAe;AACjB;;AAEA;EACE,eAAe;AACjB;;AAEA;EACE,gBAAgB;AAClB;;AAEA;EACE,SAAS;EACT,eAAe;EACf,iBAAiB;AACnB;;AAEA;EACE,WAAW;AACb;;AAEA;EACE,YAAY;AACd;;AAEA;EACE;AACF;;AAEA;EACE,aAAa;AACf;;AAEA;EACE,cAAc;EACd,gBAAgB;AAClB;;AAEA;EACE,SAAS;EACT,eAAe;EACf,iBAAiB;AACnB;;AAEA;EACE,eAAe;AACjB;;AAEA;EACE,cAAc;EACd,SAAS;EACT,6BAA6B;AAC/B;;AAEA;EACE,gBAAgB;EAChB,aAAa;EACb,8BAA8B;AAChC;;AAEA;EACE,kBAAkB;EAClB,yBAAyB;EACzB,sBAAsB;EACtB,qBAAqB;EACrB,iBAAiB;EACjB,gBAAgB;AAClB;;AAEA;EACE,uBAAuB;EACvB,yBAAyB;EACzB,iBAAiB;EACjB,eAAe;EACf,YAAY;AACd;;AAEA;EACE,mBAAmB;AACrB;;AAEA;EACE,yBAAyB;AAC3B;;AAEA;EACE,kBAAkB;EAClB,UAAU;EACV,uBAAuB;EACvB,yBAAyB;EACzB,gBAAgB;AAClB;;AAEA;EACE,eAAe;EACf,cAAc;EACd,aAAa;EACb,8BAA8B;AAChC;;AAEA;EACE,4BAA4B;EAC5B,YAAY;AACd;;AAEA;EACE,kBAAkB;EAClB,MAAM;AACR;;AAEA;EACE,iBAAiB;AACnB\",\"sourcesContent\":[\".escher-container .settingsBackground {\\r\\n  box-sizing: border-box;\\r\\n  position: absolute;\\r\\n  top: 0;\\r\\n  left: 0;\\r\\n  width: 100%;\\r\\n  height: 100%;\\r\\n  z-index: 9;\\r\\n  background: rgba(0,0,0,.4);\\r\\n  padding: 5% 0 80px;\\r\\n  text-align: center;\\r\\n}\\r\\n\\r\\n.escher-container .scale-editor .domain-input {\\r\\n  color: #333;\\r\\n}\\r\\n\\r\\n.escher-container .settingsBoxContainer button {\\r\\n  position: absolute;\\r\\n  top: 5px;\\r\\n  right: 20px;\\r\\n  z-index: 10;\\r\\n  text-align: center;\\r\\n  vertical-align: middle;\\r\\n  font-weight: normal!important;\\r\\n  width: 34px;\\r\\n  height: 30px;\\r\\n  margin: 0;\\r\\n  padding: unset;\\r\\n  font-size: 14px!important;\\r\\n  border-radius: 3px;\\r\\n  -ms-touch-action: none;\\r\\n  touch-action: none;\\r\\n}\\r\\n\\r\\n.escher-container .settingsBoxContainer button:active {\\r\\n  background-image: linear-gradient(#3F4141, #474949 6%, #4F5151);\\r\\n}\\r\\n\\r\\n.escher-container .settingsBoxContainer .discardChanges {\\r\\n  right: 60px;\\r\\n}\\r\\n\\r\\n.escher-container .settingsBoxContainer {\\r\\n  color: rgb(119, 119, 119);\\r\\n  display: inline-block;\\r\\n  position: relative;\\r\\n  width: 90%;\\r\\n  max-width: 520px;\\r\\n  height: 100%;\\r\\n  z-index: 10;\\r\\n}\\r\\n\\r\\n.escher-container .settingsBox {\\r\\n  font-size: 13px;\\r\\n  box-sizing: border-box;\\r\\n  display: inline-block;\\r\\n  max-height: 100%;\\r\\n  width: 100%;\\r\\n  overflow-y: scroll;\\r\\n  overflow-x: hidden;\\r\\n  background: rgba(255, 255, 255, 0.953);\\r\\n  padding: 8px;\\r\\n  margin: 0;\\r\\n  border: 1px solid #ddd;\\r\\n  text-align: left;\\r\\n}\\r\\n\\r\\n.escher-container .settingsBox * {\\r\\n  box-sizing: border-box;\\r\\n}\\r\\n\\r\\n.escher-container .settingsBox .title {\\r\\n  font-size: 17px;\\r\\n  font-weight: 700;\\r\\n  color: #777777;\\r\\n}\\r\\n\\r\\n.escher-container .settingsBox .subheading {\\r\\n  font-size: 13px;\\r\\n  font-weight: 700;\\r\\n  margin-top: 15px;\\r\\n  color: #777777;\\r\\n}\\r\\n\\r\\n.escher-container .settingsBox table {\\r\\n  border-collapse: collapse;\\r\\n}\\r\\n\\r\\n.escher-container .settingsBox label {\\r\\n  display: inline;\\r\\n}\\r\\n\\r\\n.escher-container .settingsBox .radioSelection {\\r\\n  cursor: default;\\r\\n}\\r\\n\\r\\n.escher-container .radioSelection td {\\r\\n  padding: 3px 5px;\\r\\n}\\r\\n\\r\\n.escher-container .radioSelection input[type=radio] {\\r\\n  margin: 0;\\r\\n  margin-top: 4px;\\r\\n  margin-right: 4px;\\r\\n}\\r\\n\\r\\n.escher-container .radioSelection .optionLabel {\\r\\n  width: 88px;\\r\\n}\\r\\n\\r\\n.escher-container .radioSelection .optionLabelWide {\\r\\n  width: 192px;\\r\\n}\\r\\n\\r\\n.escher-container .radioSelection .optionGroup {\\r\\n  margin-right: 10px\\r\\n}\\r\\n\\r\\n.escher-container .settingsBox .singleLine {\\r\\n  display: flex;\\r\\n}\\r\\n\\r\\n.escher-container .settingsContainer label {\\r\\n  display: block;\\r\\n  margin-bottom: 0;\\r\\n}\\r\\n\\r\\n.escher-container .settingsBoxContainer input[type=checkbox] {\\r\\n  margin: 0;\\r\\n  margin-top: 4px;\\r\\n  margin-right: 4px;\\r\\n}\\r\\n\\r\\n.escher-container .settingsTip {\\r\\n  font-size: 13px;\\r\\n}\\r\\n\\r\\n.escher-container .settingsBoxContainer hr {\\r\\n  margin: 18px 0;\\r\\n  border: 0;\\r\\n  border-top: 1px solid #dddddd;\\r\\n}\\r\\n\\r\\n.escher-container .scaleTitle {\\r\\n  margin-top: 15px;\\r\\n  display: flex;\\r\\n  justify-content: space-between;\\r\\n}\\r\\n\\r\\n.escher-container .selector {\\r\\n  position: relative;\\r\\n  -webkit-user-select: none;\\r\\n  -moz-user-select: none;\\r\\n  -ms-user-select: none;\\r\\n  user-select: none;\\r\\n  padding-top: 2px;\\r\\n}\\r\\n\\r\\n.escher-container .selectorTitle {\\r\\n  background-color: white;\\r\\n  border: 1px solid #a9a9a9;\\r\\n  padding-left: 4px;\\r\\n  cursor: default;\\r\\n  width: 162px;\\r\\n}\\r\\n\\r\\n.escher-container .selectorTitle:hover:not(.disabled) {\\r\\n  border-color: black;\\r\\n}\\r\\n\\r\\n.escher-container .selectorTitle.disabled {\\r\\n  background-color: #f1ecfa;\\r\\n}\\r\\n\\r\\n.escher-container .selectorMenu {\\r\\n  position: absolute;\\r\\n  z-index: 4;\\r\\n  background-color: white;\\r\\n  border: 1px solid #a9a9a9;\\r\\n  min-width: 162px;\\r\\n}\\r\\n\\r\\n.escher-container .scaleSelection {\\r\\n  cursor: default;\\r\\n  padding: 0 6px;\\r\\n  display: flex;\\r\\n  justify-content: space-between;\\r\\n}\\r\\n\\r\\n.escher-container .scaleSelection:hover {\\r\\n  background-color: dodgerblue;\\r\\n  color: white;\\r\\n}\\r\\n\\r\\n.escher-container .settingsBox .icon-sort-down {\\r\\n  position: absolute;\\r\\n  top: 0;\\r\\n}\\r\\n\\r\\n.escher-container .settingsBox .tooltipOption {\\r\\n  margin-left: 10px;\\r\\n}\\r\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","'use strict';\n\nexports.__esModule = true;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; /** @jsx h */\n\n\nvar _preact = require('preact');\n\nvar _classnames = require('classnames');\n\nvar _classnames2 = _interopRequireDefault(_classnames);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar Marks = function Marks(_ref) {\n  var className = _ref.className,\n      vertical = _ref.vertical,\n      marks = _ref.marks,\n      included = _ref.included,\n      upperBound = _ref.upperBound,\n      lowerBound = _ref.lowerBound,\n      max = _ref.max,\n      min = _ref.min;\n\n  var marksKeys = Object.keys(marks);\n  var marksCount = marksKeys.length;\n  var unit = marksCount > 1 ? 100 / (marksCount - 1) : 100;\n  var markWidth = unit * 0.9;\n\n  var range = max - min;\n  var elements = marksKeys.map(parseFloat).sort(function (a, b) {\n    return a - b;\n  }).map(function (point) {\n    var _classNames;\n\n    var isActive = !included && point === upperBound || included && point <= upperBound && point >= lowerBound;\n    var markClassName = (0, _classnames2.default)((_classNames = {}, _classNames[className + '-text'] = true, _classNames[className + '-text-active'] = isActive, _classNames));\n\n    var bottomStyle = {\n      marginBottom: '-50%',\n      bottom: (point - min) / range * 100 + '%'\n    };\n\n    var leftStyle = {\n      width: markWidth + '%',\n      marginLeft: -markWidth / 2 + '%',\n      left: (point - min) / range * 100 + '%'\n    };\n\n    var style = vertical ? bottomStyle : leftStyle;\n\n    var markPoint = marks[point];\n    var markPointIsObject = (typeof markPoint === 'undefined' ? 'undefined' : _typeof(markPoint)) === 'object';\n    var markLabel = markPointIsObject ? markPoint.label : markPoint;\n    var markStyle = markPointIsObject ? _extends({}, style, markPoint.style) : style;\n    return (0, _preact.h)(\n      'span',\n      {\n        className: markClassName,\n        style: markStyle,\n        key: point\n      },\n      markLabel\n    );\n  });\n\n  return (0, _preact.h)(\n    'div',\n    { className: className },\n    elements\n  );\n};\n\nexports.default = Marks;","'use strict';\n\nexports.__esModule = true;\n\nvar _Slider = require('./Slider');\n\nObject.defineProperty(exports, 'Slider', {\n  enumerable: true,\n  get: function get() {\n    return _interopRequireDefault(_Slider).default;\n  }\n});\n\nvar _Range = require('./Range');\n\nObject.defineProperty(exports, 'Range', {\n  enumerable: true,\n  get: function get() {\n    return _interopRequireDefault(_Range).default;\n  }\n});\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }","'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports['default'] = addEventListener;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _EventObject = require('./EventObject');\n\nvar _EventObject2 = _interopRequireDefault(_EventObject);\n\nfunction addEventListener(target, eventType, callback, option) {\n  function wrapCallback(e) {\n    var ne = new _EventObject2['default'](e);\n    callback.call(target, ne);\n  }\n\n  if (target.addEventListener) {\n    var _ret = (function () {\n      var useCapture = false;\n      if (typeof option === 'object') {\n        useCapture = option.capture || false;\n      } else if (typeof option === 'boolean') {\n        useCapture = option;\n      }\n\n      target.addEventListener(eventType, wrapCallback, option || false);\n\n      return {\n        v: {\n          remove: function remove() {\n            target.removeEventListener(eventType, wrapCallback, useCapture);\n          }\n        }\n      };\n    })();\n\n    if (typeof _ret === 'object') return _ret.v;\n  } else if (target.attachEvent) {\n    target.attachEvent('on' + eventType, wrapCallback);\n    return {\n      remove: function remove() {\n        target.detachEvent('on' + eventType, wrapCallback);\n      }\n    };\n  }\n}\n\nmodule.exports = exports['default'];","/*\nobject-assign\n(c) Sindre Sorhus\n@license MIT\n*/\n\n'use strict';\n/* eslint-disable no-unused-vars */\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nfunction shouldUseNative() {\n\ttry {\n\t\tif (!Object.assign) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Detect buggy property enumeration order in older V8 versions.\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\tvar test1 = new String('abc');  // eslint-disable-line no-new-wrappers\n\t\ttest1[5] = 'de';\n\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test2 = {};\n\t\tfor (var i = 0; i < 10; i++) {\n\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t}\n\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\treturn test2[n];\n\t\t});\n\t\tif (order2.join('') !== '0123456789') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test3 = {};\n\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\ttest3[letter] = letter;\n\t\t});\n\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (err) {\n\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\treturn false;\n\t}\n}\n\nmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (getOwnPropertySymbols) {\n\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.escher-tooltip *{\r\n    line-height: 1.42857143;\r\n    box-sizing: border-box;\r\n  }\r\n  \r\n  .escher-tooltip button {\r\n    color: white;\r\n    border: 1px solid #2E2F2F;\r\n    background-image: linear-gradient(#4F5151, #474949 6%, #3F4141);\r\n    background-color: white;\r\n    border-color: #474949;\r\n    line-height: 1;\r\n    border-radius: 4px;\r\n    text-align: center;\r\n    vertical-align: middle;\r\n    cursor: pointer;\r\n    font-size: 90%;\r\n    font-weight: 400;\r\n    height: 23px;\r\n    width: auto;\r\n  }\r\n  \r\n  .escher-tooltip .buttonBar {\r\n    margin-top: 3px;\r\n    position: static;\r\n  }\r\n  \r\n  .escher-tooltip button.active {\r\n    background-image: linear-gradient(#ffa500, #ff9523 6%, #fc8014);\r\n  }\r\n  \r\n  .escher-tooltip button:disabled {\r\n    border: 1px solid #2E2F2F;\r\n    color: #eee;\r\n    background-color: #ffa500;\r\n    background-image: none;\r\n    cursor: not-allowed;\r\n  }\r\n  \r\n  .escher-tooltip .input {\r\n    line-height: 1;\r\n    border-radius: 4px;\r\n    vertical-align: middle;\r\n    font-size: 90%;\r\n    height: 23px;\r\n    color: black;\r\n    background-color: #F0F0F0;\r\n    border: 1px solid #797979;\r\n    width: 47%;\r\n    text-align: center;\r\n    cursor: text;\r\n  }\r\n  \r\n  .escher-tooltip .biggId {\r\n    font-size: 20px;\r\n    font-weight: bold;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n    white-space: nowrap;\r\n  }\r\n  \r\n  .escher-tooltip .name {\r\n    height: 21px;\r\n    font-size: 15px;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n    white-space: nowrap;\r\n  }\r\n  \r\n  .escher-tooltip .interfacePanel {\r\n    flex-direction: column;\r\n    width: 100%;\r\n  }\r\n  \r\n  .escher-tooltip .labels, .escher-tooltip .inputPanel, .escher-tooltip .buttonBar, .escher-tooltip .interfacePanel {\r\n    display: -webkit-flex;\r\n    display: flex;\r\n    justify-content: space-between;\r\n  }\r\n  \r\n  .escher-tooltip .slider {\r\n    display: -webkit-flex;\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-self: center;\r\n  }\r\n  \r\n  .escher-distribution-histogram {\r\n    width: 100%;\r\n    height: 100px;\r\n  }`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/css/DistributionTooltipComponent.css\"],\"names\":[],\"mappings\":\"AAAA;IACI,uBAAuB;IACvB,sBAAsB;EACxB;;EAEA;IACE,YAAY;IACZ,yBAAyB;IACzB,+DAA+D;IAC/D,uBAAuB;IACvB,qBAAqB;IACrB,cAAc;IACd,kBAAkB;IAClB,kBAAkB;IAClB,sBAAsB;IACtB,eAAe;IACf,cAAc;IACd,gBAAgB;IAChB,YAAY;IACZ,WAAW;EACb;;EAEA;IACE,eAAe;IACf,gBAAgB;EAClB;;EAEA;IACE,+DAA+D;EACjE;;EAEA;IACE,yBAAyB;IACzB,WAAW;IACX,yBAAyB;IACzB,sBAAsB;IACtB,mBAAmB;EACrB;;EAEA;IACE,cAAc;IACd,kBAAkB;IAClB,sBAAsB;IACtB,cAAc;IACd,YAAY;IACZ,YAAY;IACZ,yBAAyB;IACzB,yBAAyB;IACzB,UAAU;IACV,kBAAkB;IAClB,YAAY;EACd;;EAEA;IACE,eAAe;IACf,iBAAiB;IACjB,gBAAgB;IAChB,uBAAuB;IACvB,mBAAmB;EACrB;;EAEA;IACE,YAAY;IACZ,eAAe;IACf,gBAAgB;IAChB,uBAAuB;IACvB,mBAAmB;EACrB;;EAEA;IACE,sBAAsB;IACtB,WAAW;EACb;;EAEA;IACE,qBAAqB;IACrB,aAAa;IACb,8BAA8B;EAChC;;EAEA;IACE,qBAAqB;IACrB,aAAa;IACb,sBAAsB;IACtB,kBAAkB;EACpB;;EAEA;IACE,WAAW;IACX,aAAa;EACf\",\"sourcesContent\":[\".escher-tooltip *{\\r\\n    line-height: 1.42857143;\\r\\n    box-sizing: border-box;\\r\\n  }\\r\\n  \\r\\n  .escher-tooltip button {\\r\\n    color: white;\\r\\n    border: 1px solid #2E2F2F;\\r\\n    background-image: linear-gradient(#4F5151, #474949 6%, #3F4141);\\r\\n    background-color: white;\\r\\n    border-color: #474949;\\r\\n    line-height: 1;\\r\\n    border-radius: 4px;\\r\\n    text-align: center;\\r\\n    vertical-align: middle;\\r\\n    cursor: pointer;\\r\\n    font-size: 90%;\\r\\n    font-weight: 400;\\r\\n    height: 23px;\\r\\n    width: auto;\\r\\n  }\\r\\n  \\r\\n  .escher-tooltip .buttonBar {\\r\\n    margin-top: 3px;\\r\\n    position: static;\\r\\n  }\\r\\n  \\r\\n  .escher-tooltip button.active {\\r\\n    background-image: linear-gradient(#ffa500, #ff9523 6%, #fc8014);\\r\\n  }\\r\\n  \\r\\n  .escher-tooltip button:disabled {\\r\\n    border: 1px solid #2E2F2F;\\r\\n    color: #eee;\\r\\n    background-color: #ffa500;\\r\\n    background-image: none;\\r\\n    cursor: not-allowed;\\r\\n  }\\r\\n  \\r\\n  .escher-tooltip .input {\\r\\n    line-height: 1;\\r\\n    border-radius: 4px;\\r\\n    vertical-align: middle;\\r\\n    font-size: 90%;\\r\\n    height: 23px;\\r\\n    color: black;\\r\\n    background-color: #F0F0F0;\\r\\n    border: 1px solid #797979;\\r\\n    width: 47%;\\r\\n    text-align: center;\\r\\n    cursor: text;\\r\\n  }\\r\\n  \\r\\n  .escher-tooltip .biggId {\\r\\n    font-size: 20px;\\r\\n    font-weight: bold;\\r\\n    overflow: hidden;\\r\\n    text-overflow: ellipsis;\\r\\n    white-space: nowrap;\\r\\n  }\\r\\n  \\r\\n  .escher-tooltip .name {\\r\\n    height: 21px;\\r\\n    font-size: 15px;\\r\\n    overflow: hidden;\\r\\n    text-overflow: ellipsis;\\r\\n    white-space: nowrap;\\r\\n  }\\r\\n  \\r\\n  .escher-tooltip .interfacePanel {\\r\\n    flex-direction: column;\\r\\n    width: 100%;\\r\\n  }\\r\\n  \\r\\n  .escher-tooltip .labels, .escher-tooltip .inputPanel, .escher-tooltip .buttonBar, .escher-tooltip .interfacePanel {\\r\\n    display: -webkit-flex;\\r\\n    display: flex;\\r\\n    justify-content: space-between;\\r\\n  }\\r\\n  \\r\\n  .escher-tooltip .slider {\\r\\n    display: -webkit-flex;\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    align-self: center;\\r\\n  }\\r\\n  \\r\\n  .escher-distribution-histogram {\\r\\n    width: 100%;\\r\\n    height: 100px;\\r\\n  }\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\n/**\n * Use invariant() to assert state which your program assumes to be true.\n *\n * Provide sprintf-style format (only %s is supported) and arguments\n * to provide information about what broke and what you were\n * expecting.\n *\n * The invariant message will be stripped in production, but the invariant\n * will remain to ensure logic does not differ in production.\n */\n\nvar invariant = function(condition, format, a, b, c, d, e, f) {\n  if (process.env.NODE_ENV !== 'production') {\n    if (format === undefined) {\n      throw new Error('invariant requires an error message argument');\n    }\n  }\n\n  if (!condition) {\n    var error;\n    if (format === undefined) {\n      error = new Error(\n        'Minified exception occurred; use the non-minified dev environment ' +\n        'for the full error message and additional helpful warnings.'\n      );\n    } else {\n      var args = [a, b, c, d, e, f];\n      var argIndex = 0;\n      error = new Error(\n        format.replace(/%s/g, function() { return args[argIndex++]; })\n      );\n      error.name = 'Invariant Violation';\n    }\n\n    error.framesToPop = 1; // we don't care about invariant's own frame\n    throw error;\n  }\n};\n\nmodule.exports = invariant;\n","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\nmodule.exports = function (cssWithMappingToString) {\n  var list = [];\n\n  // return the list of modules as css string\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = \"\";\n      var needLayer = typeof item[5] !== \"undefined\";\n      if (item[4]) {\n        content += \"@supports (\".concat(item[4], \") {\");\n      }\n      if (item[2]) {\n        content += \"@media \".concat(item[2], \" {\");\n      }\n      if (needLayer) {\n        content += \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\");\n      }\n      content += cssWithMappingToString(item);\n      if (needLayer) {\n        content += \"}\";\n      }\n      if (item[2]) {\n        content += \"}\";\n      }\n      if (item[4]) {\n        content += \"}\";\n      }\n      return content;\n    }).join(\"\");\n  };\n\n  // import a list of modules into the list\n  list.i = function i(modules, media, dedupe, supports, layer) {\n    if (typeof modules === \"string\") {\n      modules = [[null, modules, undefined]];\n    }\n    var alreadyImportedModules = {};\n    if (dedupe) {\n      for (var k = 0; k < this.length; k++) {\n        var id = this[k][0];\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n    for (var _k = 0; _k < modules.length; _k++) {\n      var item = [].concat(modules[_k]);\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        continue;\n      }\n      if (typeof layer !== \"undefined\") {\n        if (typeof item[5] === \"undefined\") {\n          item[5] = layer;\n        } else {\n          item[1] = \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\").concat(item[1], \"}\");\n          item[5] = layer;\n        }\n      }\n      if (media) {\n        if (!item[2]) {\n          item[2] = media;\n        } else {\n          item[1] = \"@media \".concat(item[2], \" {\").concat(item[1], \"}\");\n          item[2] = media;\n        }\n      }\n      if (supports) {\n        if (!item[4]) {\n          item[4] = \"\".concat(supports);\n        } else {\n          item[1] = \"@supports (\".concat(item[4], \") {\").concat(item[1], \"}\");\n          item[4] = supports;\n        }\n      }\n      list.push(item);\n    }\n  };\n  return list;\n};","\"use strict\";\n\nmodule.exports = function (item) {\n  var content = item[1];\n  var cssMapping = item[3];\n  if (!cssMapping) {\n    return content;\n  }\n  if (typeof btoa === \"function\") {\n    var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(cssMapping))));\n    var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n    var sourceMapping = \"/*# \".concat(data, \" */\");\n    return [content].concat([sourceMapping]).join(\"\\n\");\n  }\n  return [content].join(\"\\n\");\n};","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nimport ___CSS_LOADER_GET_URL_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/getUrl.js\";\nvar ___CSS_LOADER_URL_IMPORT_0___ = new URL(\"../font/fontello.eot?38609741\", import.meta.url);\nvar ___CSS_LOADER_URL_IMPORT_1___ = new URL(\"../font/fontello.woff2?38609741\", import.meta.url);\nvar ___CSS_LOADER_URL_IMPORT_2___ = new URL(\"../font/fontello.woff?38609741\", import.meta.url);\nvar ___CSS_LOADER_URL_IMPORT_3___ = new URL(\"../font/fontello.ttf?38609741\", import.meta.url);\nvar ___CSS_LOADER_URL_IMPORT_4___ = new URL(\"../font/fontello.svg?38609741\", import.meta.url);\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\nvar ___CSS_LOADER_URL_REPLACEMENT_0___ = ___CSS_LOADER_GET_URL_IMPORT___(___CSS_LOADER_URL_IMPORT_0___);\nvar ___CSS_LOADER_URL_REPLACEMENT_1___ = ___CSS_LOADER_GET_URL_IMPORT___(___CSS_LOADER_URL_IMPORT_0___, { hash: \"#iefix\" });\nvar ___CSS_LOADER_URL_REPLACEMENT_2___ = ___CSS_LOADER_GET_URL_IMPORT___(___CSS_LOADER_URL_IMPORT_1___);\nvar ___CSS_LOADER_URL_REPLACEMENT_3___ = ___CSS_LOADER_GET_URL_IMPORT___(___CSS_LOADER_URL_IMPORT_2___);\nvar ___CSS_LOADER_URL_REPLACEMENT_4___ = ___CSS_LOADER_GET_URL_IMPORT___(___CSS_LOADER_URL_IMPORT_3___);\nvar ___CSS_LOADER_URL_REPLACEMENT_5___ = ___CSS_LOADER_GET_URL_IMPORT___(___CSS_LOADER_URL_IMPORT_4___, { hash: \"#fontello\" });\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `@font-face {\r\n  font-family: 'fontello';\r\n  src: url(${___CSS_LOADER_URL_REPLACEMENT_0___});\r\n  src: url(${___CSS_LOADER_URL_REPLACEMENT_1___}) format('embedded-opentype'),\r\n       url(${___CSS_LOADER_URL_REPLACEMENT_2___}) format('woff2'),\r\n       url(${___CSS_LOADER_URL_REPLACEMENT_3___}) format('woff'),\r\n       url(${___CSS_LOADER_URL_REPLACEMENT_4___}) format('truetype'),\r\n       url(${___CSS_LOADER_URL_REPLACEMENT_5___}) format('svg');\r\n  font-weight: normal;\r\n  font-style: normal;\r\n}\r\n/* Chrome hack: SVG is rendered more smooth in Windozze. 100% magic, uncomment if you need it. */\r\n/* Note, that will break hinting! In other OS-es font will be not as sharp as it could be */\r\n/*\r\n@media screen and (-webkit-min-device-pixel-ratio:0) {\r\n  @font-face {\r\n    font-family: 'fontello';\r\n    src: url('../font/fontello.svg?38609741#fontello') format('svg');\r\n  }\r\n}\r\n*/\r\n[class^=\"icon-\"]:before, [class*=\" icon-\"]:before {\r\n  font-family: \"fontello\";\r\n  font-style: normal;\r\n  font-weight: normal;\r\n  speak: never;\r\n\r\n  display: inline-block;\r\n  text-decoration: inherit;\r\n  width: 1em;\r\n  margin-right: .2em;\r\n  text-align: center;\r\n  /* opacity: .8; */\r\n\r\n  /* For safety - reset parent styles, that can break glyph codes*/\r\n  font-variant: normal;\r\n  text-transform: none;\r\n\r\n  /* fix buttons height, for twitter bootstrap */\r\n  line-height: 1em;\r\n\r\n  /* Animation center compensation - margins should be symmetric */\r\n  /* remove if not needed */\r\n  margin-left: .2em;\r\n\r\n  /* you can be more comfortable with increased icons size */\r\n  /* font-size: 120%; */\r\n\r\n  /* Font smoothing. That was taken from TWBS */\r\n  -webkit-font-smoothing: antialiased;\r\n  -moz-osx-font-smoothing: grayscale;\r\n\r\n  /* Uncomment for 3D effect */\r\n  /* text-shadow: 1px 1px 1px rgba(127, 127, 127, 0.3); */\r\n}\r\n\r\n.icon-ok:before { content: '\\\\e800'; } /* '' */\r\n.icon-cancel:before { content: '\\\\e801'; } /* '' */\r\n.icon-plus:before { content: '\\\\e802'; } /* '' */\r\n.icon-down-big:before { content: '\\\\e803'; } /* '' */\r\n.icon-left-big:before { content: '\\\\e804'; } /* '' */\r\n.icon-right-big:before { content: '\\\\e805'; } /* '' */\r\n.icon-up-big:before { content: '\\\\e806'; } /* '' */\r\n.icon-left-open:before { content: '\\\\e807'; } /* '' */\r\n.icon-right-open:before { content: '\\\\e808'; } /* '' */\r\n.icon-wrench:before { content: '\\\\e809'; } /* '' */\r\n.icon-resize-full:before { content: '\\\\e80a'; } /* '' */\r\n.icon-cw:before { content: '\\\\e80b'; } /* '' */\r\n.icon-arrows-outside:before { content: '\\\\e80c'; } /* '' */\r\n.icon-arrows-inside:before { content: '\\\\e80d'; } /* '' */\r\n.icon-trash-empty:before { content: '\\\\e80e'; } /* '' */\r\n.icon-font:before { content: '\\\\e80f'; } /* '' */\r\n.icon-zoom-in:before { content: '\\\\e810'; } /* '' */\r\n.icon-zoom-out:before { content: '\\\\e811'; } /* '' */\r\n.icon-move:before { content: '\\\\f047'; } /* '' */\r\n.icon-resize-full-alt:before { content: '\\\\f0b2'; } /* '' */\r\n.icon-blank:before { content: '\\\\f0c8'; } /* '' */\r\n.icon-sort-down:before { content: '\\\\f0dd'; } /* '' */\r\n.icon-mouse-pointer:before { content: '\\\\f245'; } /* '' */\r\n.icon-merge:before { content: '\\\\26AF'; }\r\n.icon-shortest-path:before { content: ' \\\\1F3F3'; }`, \"\",{\"version\":3,\"sources\":[\"webpack://./icons/css/fontello.css\"],\"names\":[],\"mappings\":\"AAAA;EACE,uBAAuB;EACvB,4CAAyC;EACzC;;;;4DAIgE;EAChE,mBAAmB;EACnB,kBAAkB;AACpB;AACA,gGAAgG;AAChG,2FAA2F;AAC3F;;;;;;;CAOC;AACD;EACE,uBAAuB;EACvB,kBAAkB;EAClB,mBAAmB;EACnB,YAAY;;EAEZ,qBAAqB;EACrB,wBAAwB;EACxB,UAAU;EACV,kBAAkB;EAClB,kBAAkB;EAClB,iBAAiB;;EAEjB,gEAAgE;EAChE,oBAAoB;EACpB,oBAAoB;;EAEpB,8CAA8C;EAC9C,gBAAgB;;EAEhB,gEAAgE;EAChE,yBAAyB;EACzB,iBAAiB;;EAEjB,0DAA0D;EAC1D,qBAAqB;;EAErB,6CAA6C;EAC7C,mCAAmC;EACnC,kCAAkC;;EAElC,4BAA4B;EAC5B,uDAAuD;AACzD;;AAEA,kBAAkB,gBAAgB,EAAE,EAAE,QAAQ;AAC9C,sBAAsB,gBAAgB,EAAE,EAAE,QAAQ;AAClD,oBAAoB,gBAAgB,EAAE,EAAE,QAAQ;AAChD,wBAAwB,gBAAgB,EAAE,EAAE,QAAQ;AACpD,wBAAwB,gBAAgB,EAAE,EAAE,QAAQ;AACpD,yBAAyB,gBAAgB,EAAE,EAAE,QAAQ;AACrD,sBAAsB,gBAAgB,EAAE,EAAE,QAAQ;AAClD,yBAAyB,gBAAgB,EAAE,EAAE,QAAQ;AACrD,0BAA0B,gBAAgB,EAAE,EAAE,QAAQ;AACtD,sBAAsB,gBAAgB,EAAE,EAAE,QAAQ;AAClD,2BAA2B,gBAAgB,EAAE,EAAE,QAAQ;AACvD,kBAAkB,gBAAgB,EAAE,EAAE,QAAQ;AAC9C,8BAA8B,gBAAgB,EAAE,EAAE,QAAQ;AAC1D,6BAA6B,gBAAgB,EAAE,EAAE,QAAQ;AACzD,2BAA2B,gBAAgB,EAAE,EAAE,QAAQ;AACvD,oBAAoB,gBAAgB,EAAE,EAAE,QAAQ;AAChD,uBAAuB,gBAAgB,EAAE,EAAE,QAAQ;AACnD,wBAAwB,gBAAgB,EAAE,EAAE,QAAQ;AACpD,oBAAoB,gBAAgB,EAAE,EAAE,QAAQ;AAChD,+BAA+B,gBAAgB,EAAE,EAAE,QAAQ;AAC3D,qBAAqB,gBAAgB,EAAE,EAAE,QAAQ;AACjD,yBAAyB,gBAAgB,EAAE,EAAE,QAAQ;AACrD,6BAA6B,gBAAgB,EAAE,EAAE,QAAQ;AACzD,qBAAqB,gBAAgB,EAAE;AACvC,6BAA6B,kBAAkB,EAAE\",\"sourcesContent\":[\"@font-face {\\r\\n  font-family: 'fontello';\\r\\n  src: url('../font/fontello.eot?38609741');\\r\\n  src: url('../font/fontello.eot?38609741#iefix') format('embedded-opentype'),\\r\\n       url('../font/fontello.woff2?38609741') format('woff2'),\\r\\n       url('../font/fontello.woff?38609741') format('woff'),\\r\\n       url('../font/fontello.ttf?38609741') format('truetype'),\\r\\n       url('../font/fontello.svg?38609741#fontello') format('svg');\\r\\n  font-weight: normal;\\r\\n  font-style: normal;\\r\\n}\\r\\n/* Chrome hack: SVG is rendered more smooth in Windozze. 100% magic, uncomment if you need it. */\\r\\n/* Note, that will break hinting! In other OS-es font will be not as sharp as it could be */\\r\\n/*\\r\\n@media screen and (-webkit-min-device-pixel-ratio:0) {\\r\\n  @font-face {\\r\\n    font-family: 'fontello';\\r\\n    src: url('../font/fontello.svg?38609741#fontello') format('svg');\\r\\n  }\\r\\n}\\r\\n*/\\r\\n[class^=\\\"icon-\\\"]:before, [class*=\\\" icon-\\\"]:before {\\r\\n  font-family: \\\"fontello\\\";\\r\\n  font-style: normal;\\r\\n  font-weight: normal;\\r\\n  speak: never;\\r\\n\\r\\n  display: inline-block;\\r\\n  text-decoration: inherit;\\r\\n  width: 1em;\\r\\n  margin-right: .2em;\\r\\n  text-align: center;\\r\\n  /* opacity: .8; */\\r\\n\\r\\n  /* For safety - reset parent styles, that can break glyph codes*/\\r\\n  font-variant: normal;\\r\\n  text-transform: none;\\r\\n\\r\\n  /* fix buttons height, for twitter bootstrap */\\r\\n  line-height: 1em;\\r\\n\\r\\n  /* Animation center compensation - margins should be symmetric */\\r\\n  /* remove if not needed */\\r\\n  margin-left: .2em;\\r\\n\\r\\n  /* you can be more comfortable with increased icons size */\\r\\n  /* font-size: 120%; */\\r\\n\\r\\n  /* Font smoothing. That was taken from TWBS */\\r\\n  -webkit-font-smoothing: antialiased;\\r\\n  -moz-osx-font-smoothing: grayscale;\\r\\n\\r\\n  /* Uncomment for 3D effect */\\r\\n  /* text-shadow: 1px 1px 1px rgba(127, 127, 127, 0.3); */\\r\\n}\\r\\n\\r\\n.icon-ok:before { content: '\\\\e800'; } /* '' */\\r\\n.icon-cancel:before { content: '\\\\e801'; } /* '' */\\r\\n.icon-plus:before { content: '\\\\e802'; } /* '' */\\r\\n.icon-down-big:before { content: '\\\\e803'; } /* '' */\\r\\n.icon-left-big:before { content: '\\\\e804'; } /* '' */\\r\\n.icon-right-big:before { content: '\\\\e805'; } /* '' */\\r\\n.icon-up-big:before { content: '\\\\e806'; } /* '' */\\r\\n.icon-left-open:before { content: '\\\\e807'; } /* '' */\\r\\n.icon-right-open:before { content: '\\\\e808'; } /* '' */\\r\\n.icon-wrench:before { content: '\\\\e809'; } /* '' */\\r\\n.icon-resize-full:before { content: '\\\\e80a'; } /* '' */\\r\\n.icon-cw:before { content: '\\\\e80b'; } /* '' */\\r\\n.icon-arrows-outside:before { content: '\\\\e80c'; } /* '' */\\r\\n.icon-arrows-inside:before { content: '\\\\e80d'; } /* '' */\\r\\n.icon-trash-empty:before { content: '\\\\e80e'; } /* '' */\\r\\n.icon-font:before { content: '\\\\e80f'; } /* '' */\\r\\n.icon-zoom-in:before { content: '\\\\e810'; } /* '' */\\r\\n.icon-zoom-out:before { content: '\\\\e811'; } /* '' */\\r\\n.icon-move:before { content: '\\\\f047'; } /* '' */\\r\\n.icon-resize-full-alt:before { content: '\\\\f0b2'; } /* '' */\\r\\n.icon-blank:before { content: '\\\\f0c8'; } /* '' */\\r\\n.icon-sort-down:before { content: '\\\\f0dd'; } /* '' */\\r\\n.icon-mouse-pointer:before { content: '\\\\f245'; } /* '' */\\r\\n.icon-merge:before { content: '\\\\26AF'; }\\r\\n.icon-shortest-path:before { content: ' \\\\1F3F3'; }\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.escher-container .search-container {\r\n  display: flex;\r\n  flex-direction: row;\r\n  background-color: rgba(255, 255, 255, 0.95);\r\n  padding: 3px;\r\n  border: 1px solid #DDD;\r\n}\r\n\r\n.escher-container .search-container .search-field {\r\n  flex: 0 0 auto;\r\n  color: #777;\r\n  border: 1px solid #DDD;\r\n  width: 114px;\r\n  height: 29px;\r\n  border-radius: 3px;\r\n  font-size: 13px;\r\n}\r\n\r\n.escher-container .search-container .search-counter {\r\n  flex: 1;\r\n  color: #777;\r\n  font-size: 13px;\r\n  padding: 9px 0 0 6px;\r\n}\r\n\r\n.escher-container .search-container .search-bar-button {\r\n  flex: 0 0 auto;\r\n  border-radius: 4px;\r\n  text-align: center;\r\n  vertical-align: middle;\r\n  font-size: 14px;\r\n  font-weight: 400;\r\n  height: 29px;\r\n  width: 34px;\r\n  margin: 3px;\r\n}\r\n\r\n.escher-container .search-container .search-bar-button.left {\r\n  border-top-right-radius: 0px;\r\n  border-bottom-right-radius: 0px;\r\n  margin-right: 0;\r\n}\r\n\r\n.escher-container .search-container .search-bar-button.right {\r\n  border-top-left-radius: 0px;\r\n  border-bottom-left-radius: 0px;\r\n  margin-left: 0;\r\n}\r\n\r\n.escher-container .search-container .search-bar-button:active {\r\n  background-image: linear-gradient(#3F4141, #474949 6%, #4F5151);\r\n}\r\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/css/SearchBar.css\"],\"names\":[],\"mappings\":\"AAAA;EACE,aAAa;EACb,mBAAmB;EACnB,2CAA2C;EAC3C,YAAY;EACZ,sBAAsB;AACxB;;AAEA;EACE,cAAc;EACd,WAAW;EACX,sBAAsB;EACtB,YAAY;EACZ,YAAY;EACZ,kBAAkB;EAClB,eAAe;AACjB;;AAEA;EACE,OAAO;EACP,WAAW;EACX,eAAe;EACf,oBAAoB;AACtB;;AAEA;EACE,cAAc;EACd,kBAAkB;EAClB,kBAAkB;EAClB,sBAAsB;EACtB,eAAe;EACf,gBAAgB;EAChB,YAAY;EACZ,WAAW;EACX,WAAW;AACb;;AAEA;EACE,4BAA4B;EAC5B,+BAA+B;EAC/B,eAAe;AACjB;;AAEA;EACE,2BAA2B;EAC3B,8BAA8B;EAC9B,cAAc;AAChB;;AAEA;EACE,+DAA+D;AACjE\",\"sourcesContent\":[\".escher-container .search-container {\\r\\n  display: flex;\\r\\n  flex-direction: row;\\r\\n  background-color: rgba(255, 255, 255, 0.95);\\r\\n  padding: 3px;\\r\\n  border: 1px solid #DDD;\\r\\n}\\r\\n\\r\\n.escher-container .search-container .search-field {\\r\\n  flex: 0 0 auto;\\r\\n  color: #777;\\r\\n  border: 1px solid #DDD;\\r\\n  width: 114px;\\r\\n  height: 29px;\\r\\n  border-radius: 3px;\\r\\n  font-size: 13px;\\r\\n}\\r\\n\\r\\n.escher-container .search-container .search-counter {\\r\\n  flex: 1;\\r\\n  color: #777;\\r\\n  font-size: 13px;\\r\\n  padding: 9px 0 0 6px;\\r\\n}\\r\\n\\r\\n.escher-container .search-container .search-bar-button {\\r\\n  flex: 0 0 auto;\\r\\n  border-radius: 4px;\\r\\n  text-align: center;\\r\\n  vertical-align: middle;\\r\\n  font-size: 14px;\\r\\n  font-weight: 400;\\r\\n  height: 29px;\\r\\n  width: 34px;\\r\\n  margin: 3px;\\r\\n}\\r\\n\\r\\n.escher-container .search-container .search-bar-button.left {\\r\\n  border-top-right-radius: 0px;\\r\\n  border-bottom-right-radius: 0px;\\r\\n  margin-right: 0;\\r\\n}\\r\\n\\r\\n.escher-container .search-container .search-bar-button.right {\\r\\n  border-top-left-radius: 0px;\\r\\n  border-bottom-left-radius: 0px;\\r\\n  margin-left: 0;\\r\\n}\\r\\n\\r\\n.escher-container .search-container .search-bar-button:active {\\r\\n  background-image: linear-gradient(#3F4141, #474949 6%, #4F5151);\\r\\n}\\r\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","/*global define:false */\n/**\n * Copyright 2012-2017 Craig Campbell\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n * Mousetrap is a simple keyboard shortcut library for Javascript with\n * no external dependencies\n *\n * @version 1.6.5\n * @url craig.is/killing/mice\n */\n(function(window, document, undefined) {\n\n    // Check if mousetrap is used inside browser, if not, return\n    if (!window) {\n        return;\n    }\n\n    /**\n     * mapping of special keycodes to their corresponding keys\n     *\n     * everything in this dictionary cannot use keypress events\n     * so it has to be here to map to the correct keycodes for\n     * keyup/keydown events\n     *\n     * @type {Object}\n     */\n    var _MAP = {\n        8: 'backspace',\n        9: 'tab',\n        13: 'enter',\n        16: 'shift',\n        17: 'ctrl',\n        18: 'alt',\n        20: 'capslock',\n        27: 'esc',\n        32: 'space',\n        33: 'pageup',\n        34: 'pagedown',\n        35: 'end',\n        36: 'home',\n        37: 'left',\n        38: 'up',\n        39: 'right',\n        40: 'down',\n        45: 'ins',\n        46: 'del',\n        91: 'meta',\n        93: 'meta',\n        224: 'meta'\n    };\n\n    /**\n     * mapping for special characters so they can support\n     *\n     * this dictionary is only used incase you want to bind a\n     * keyup or keydown event to one of these keys\n     *\n     * @type {Object}\n     */\n    var _KEYCODE_MAP = {\n        106: '*',\n        107: '+',\n        109: '-',\n        110: '.',\n        111 : '/',\n        186: ';',\n        187: '=',\n        188: ',',\n        189: '-',\n        190: '.',\n        191: '/',\n        192: '`',\n        219: '[',\n        220: '\\\\',\n        221: ']',\n        222: '\\''\n    };\n\n    /**\n     * this is a mapping of keys that require shift on a US keypad\n     * back to the non shift equivelents\n     *\n     * this is so you can use keyup events with these keys\n     *\n     * note that this will only work reliably on US keyboards\n     *\n     * @type {Object}\n     */\n    var _SHIFT_MAP = {\n        '~': '`',\n        '!': '1',\n        '@': '2',\n        '#': '3',\n        '$': '4',\n        '%': '5',\n        '^': '6',\n        '&': '7',\n        '*': '8',\n        '(': '9',\n        ')': '0',\n        '_': '-',\n        '+': '=',\n        ':': ';',\n        '\\\"': '\\'',\n        '<': ',',\n        '>': '.',\n        '?': '/',\n        '|': '\\\\'\n    };\n\n    /**\n     * this is a list of special strings you can use to map\n     * to modifier keys when you specify your keyboard shortcuts\n     *\n     * @type {Object}\n     */\n    var _SPECIAL_ALIASES = {\n        'option': 'alt',\n        'command': 'meta',\n        'return': 'enter',\n        'escape': 'esc',\n        'plus': '+',\n        'mod': /Mac|iPod|iPhone|iPad/.test(navigator.platform) ? 'meta' : 'ctrl'\n    };\n\n    /**\n     * variable to store the flipped version of _MAP from above\n     * needed to check if we should use keypress or not when no action\n     * is specified\n     *\n     * @type {Object|undefined}\n     */\n    var _REVERSE_MAP;\n\n    /**\n     * loop through the f keys, f1 to f19 and add them to the map\n     * programatically\n     */\n    for (var i = 1; i < 20; ++i) {\n        _MAP[111 + i] = 'f' + i;\n    }\n\n    /**\n     * loop through to map numbers on the numeric keypad\n     */\n    for (i = 0; i <= 9; ++i) {\n\n        // This needs to use a string cause otherwise since 0 is falsey\n        // mousetrap will never fire for numpad 0 pressed as part of a keydown\n        // event.\n        //\n        // @see https://github.com/ccampbell/mousetrap/pull/258\n        _MAP[i + 96] = i.toString();\n    }\n\n    /**\n     * cross browser add event method\n     *\n     * @param {Element|HTMLDocument} object\n     * @param {string} type\n     * @param {Function} callback\n     * @returns void\n     */\n    function _addEvent(object, type, callback) {\n        if (object.addEventListener) {\n            object.addEventListener(type, callback, false);\n            return;\n        }\n\n        object.attachEvent('on' + type, callback);\n    }\n\n    /**\n     * takes the event and returns the key character\n     *\n     * @param {Event} e\n     * @return {string}\n     */\n    function _characterFromEvent(e) {\n\n        // for keypress events we should return the character as is\n        if (e.type == 'keypress') {\n            var character = String.fromCharCode(e.which);\n\n            // if the shift key is not pressed then it is safe to assume\n            // that we want the character to be lowercase.  this means if\n            // you accidentally have caps lock on then your key bindings\n            // will continue to work\n            //\n            // the only side effect that might not be desired is if you\n            // bind something like 'A' cause you want to trigger an\n            // event when capital A is pressed caps lock will no longer\n            // trigger the event.  shift+a will though.\n            if (!e.shiftKey) {\n                character = character.toLowerCase();\n            }\n\n            return character;\n        }\n\n        // for non keypress events the special maps are needed\n        if (_MAP[e.which]) {\n            return _MAP[e.which];\n        }\n\n        if (_KEYCODE_MAP[e.which]) {\n            return _KEYCODE_MAP[e.which];\n        }\n\n        // if it is not in the special map\n\n        // with keydown and keyup events the character seems to always\n        // come in as an uppercase character whether you are pressing shift\n        // or not.  we should make sure it is always lowercase for comparisons\n        return String.fromCharCode(e.which).toLowerCase();\n    }\n\n    /**\n     * checks if two arrays are equal\n     *\n     * @param {Array} modifiers1\n     * @param {Array} modifiers2\n     * @returns {boolean}\n     */\n    function _modifiersMatch(modifiers1, modifiers2) {\n        return modifiers1.sort().join(',') === modifiers2.sort().join(',');\n    }\n\n    /**\n     * takes a key event and figures out what the modifiers are\n     *\n     * @param {Event} e\n     * @returns {Array}\n     */\n    function _eventModifiers(e) {\n        var modifiers = [];\n\n        if (e.shiftKey) {\n            modifiers.push('shift');\n        }\n\n        if (e.altKey) {\n            modifiers.push('alt');\n        }\n\n        if (e.ctrlKey) {\n            modifiers.push('ctrl');\n        }\n\n        if (e.metaKey) {\n            modifiers.push('meta');\n        }\n\n        return modifiers;\n    }\n\n    /**\n     * prevents default for this event\n     *\n     * @param {Event} e\n     * @returns void\n     */\n    function _preventDefault(e) {\n        if (e.preventDefault) {\n            e.preventDefault();\n            return;\n        }\n\n        e.returnValue = false;\n    }\n\n    /**\n     * stops propogation for this event\n     *\n     * @param {Event} e\n     * @returns void\n     */\n    function _stopPropagation(e) {\n        if (e.stopPropagation) {\n            e.stopPropagation();\n            return;\n        }\n\n        e.cancelBubble = true;\n    }\n\n    /**\n     * determines if the keycode specified is a modifier key or not\n     *\n     * @param {string} key\n     * @returns {boolean}\n     */\n    function _isModifier(key) {\n        return key == 'shift' || key == 'ctrl' || key == 'alt' || key == 'meta';\n    }\n\n    /**\n     * reverses the map lookup so that we can look for specific keys\n     * to see what can and can't use keypress\n     *\n     * @return {Object}\n     */\n    function _getReverseMap() {\n        if (!_REVERSE_MAP) {\n            _REVERSE_MAP = {};\n            for (var key in _MAP) {\n\n                // pull out the numeric keypad from here cause keypress should\n                // be able to detect the keys from the character\n                if (key > 95 && key < 112) {\n                    continue;\n                }\n\n                if (_MAP.hasOwnProperty(key)) {\n                    _REVERSE_MAP[_MAP[key]] = key;\n                }\n            }\n        }\n        return _REVERSE_MAP;\n    }\n\n    /**\n     * picks the best action based on the key combination\n     *\n     * @param {string} key - character for key\n     * @param {Array} modifiers\n     * @param {string=} action passed in\n     */\n    function _pickBestAction(key, modifiers, action) {\n\n        // if no action was picked in we should try to pick the one\n        // that we think would work best for this key\n        if (!action) {\n            action = _getReverseMap()[key] ? 'keydown' : 'keypress';\n        }\n\n        // modifier keys don't work as expected with keypress,\n        // switch to keydown\n        if (action == 'keypress' && modifiers.length) {\n            action = 'keydown';\n        }\n\n        return action;\n    }\n\n    /**\n     * Converts from a string key combination to an array\n     *\n     * @param  {string} combination like \"command+shift+l\"\n     * @return {Array}\n     */\n    function _keysFromString(combination) {\n        if (combination === '+') {\n            return ['+'];\n        }\n\n        combination = combination.replace(/\\+{2}/g, '+plus');\n        return combination.split('+');\n    }\n\n    /**\n     * Gets info for a specific key combination\n     *\n     * @param  {string} combination key combination (\"command+s\" or \"a\" or \"*\")\n     * @param  {string=} action\n     * @returns {Object}\n     */\n    function _getKeyInfo(combination, action) {\n        var keys;\n        var key;\n        var i;\n        var modifiers = [];\n\n        // take the keys from this pattern and figure out what the actual\n        // pattern is all about\n        keys = _keysFromString(combination);\n\n        for (i = 0; i < keys.length; ++i) {\n            key = keys[i];\n\n            // normalize key names\n            if (_SPECIAL_ALIASES[key]) {\n                key = _SPECIAL_ALIASES[key];\n            }\n\n            // if this is not a keypress event then we should\n            // be smart about using shift keys\n            // this will only work for US keyboards however\n            if (action && action != 'keypress' && _SHIFT_MAP[key]) {\n                key = _SHIFT_MAP[key];\n                modifiers.push('shift');\n            }\n\n            // if this key is a modifier then add it to the list of modifiers\n            if (_isModifier(key)) {\n                modifiers.push(key);\n            }\n        }\n\n        // depending on what the key combination is\n        // we will try to pick the best event for it\n        action = _pickBestAction(key, modifiers, action);\n\n        return {\n            key: key,\n            modifiers: modifiers,\n            action: action\n        };\n    }\n\n    function _belongsTo(element, ancestor) {\n        if (element === null || element === document) {\n            return false;\n        }\n\n        if (element === ancestor) {\n            return true;\n        }\n\n        return _belongsTo(element.parentNode, ancestor);\n    }\n\n    function Mousetrap(targetElement) {\n        var self = this;\n\n        targetElement = targetElement || document;\n\n        if (!(self instanceof Mousetrap)) {\n            return new Mousetrap(targetElement);\n        }\n\n        /**\n         * element to attach key events to\n         *\n         * @type {Element}\n         */\n        self.target = targetElement;\n\n        /**\n         * a list of all the callbacks setup via Mousetrap.bind()\n         *\n         * @type {Object}\n         */\n        self._callbacks = {};\n\n        /**\n         * direct map of string combinations to callbacks used for trigger()\n         *\n         * @type {Object}\n         */\n        self._directMap = {};\n\n        /**\n         * keeps track of what level each sequence is at since multiple\n         * sequences can start out with the same sequence\n         *\n         * @type {Object}\n         */\n        var _sequenceLevels = {};\n\n        /**\n         * variable to store the setTimeout call\n         *\n         * @type {null|number}\n         */\n        var _resetTimer;\n\n        /**\n         * temporary state where we will ignore the next keyup\n         *\n         * @type {boolean|string}\n         */\n        var _ignoreNextKeyup = false;\n\n        /**\n         * temporary state where we will ignore the next keypress\n         *\n         * @type {boolean}\n         */\n        var _ignoreNextKeypress = false;\n\n        /**\n         * are we currently inside of a sequence?\n         * type of action (\"keyup\" or \"keydown\" or \"keypress\") or false\n         *\n         * @type {boolean|string}\n         */\n        var _nextExpectedAction = false;\n\n        /**\n         * resets all sequence counters except for the ones passed in\n         *\n         * @param {Object} doNotReset\n         * @returns void\n         */\n        function _resetSequences(doNotReset) {\n            doNotReset = doNotReset || {};\n\n            var activeSequences = false,\n                key;\n\n            for (key in _sequenceLevels) {\n                if (doNotReset[key]) {\n                    activeSequences = true;\n                    continue;\n                }\n                _sequenceLevels[key] = 0;\n            }\n\n            if (!activeSequences) {\n                _nextExpectedAction = false;\n            }\n        }\n\n        /**\n         * finds all callbacks that match based on the keycode, modifiers,\n         * and action\n         *\n         * @param {string} character\n         * @param {Array} modifiers\n         * @param {Event|Object} e\n         * @param {string=} sequenceName - name of the sequence we are looking for\n         * @param {string=} combination\n         * @param {number=} level\n         * @returns {Array}\n         */\n        function _getMatches(character, modifiers, e, sequenceName, combination, level) {\n            var i;\n            var callback;\n            var matches = [];\n            var action = e.type;\n\n            // if there are no events related to this keycode\n            if (!self._callbacks[character]) {\n                return [];\n            }\n\n            // if a modifier key is coming up on its own we should allow it\n            if (action == 'keyup' && _isModifier(character)) {\n                modifiers = [character];\n            }\n\n            // loop through all callbacks for the key that was pressed\n            // and see if any of them match\n            for (i = 0; i < self._callbacks[character].length; ++i) {\n                callback = self._callbacks[character][i];\n\n                // if a sequence name is not specified, but this is a sequence at\n                // the wrong level then move onto the next match\n                if (!sequenceName && callback.seq && _sequenceLevels[callback.seq] != callback.level) {\n                    continue;\n                }\n\n                // if the action we are looking for doesn't match the action we got\n                // then we should keep going\n                if (action != callback.action) {\n                    continue;\n                }\n\n                // if this is a keypress event and the meta key and control key\n                // are not pressed that means that we need to only look at the\n                // character, otherwise check the modifiers as well\n                //\n                // chrome will not fire a keypress if meta or control is down\n                // safari will fire a keypress if meta or meta+shift is down\n                // firefox will fire a keypress if meta or control is down\n                if ((action == 'keypress' && !e.metaKey && !e.ctrlKey) || _modifiersMatch(modifiers, callback.modifiers)) {\n\n                    // when you bind a combination or sequence a second time it\n                    // should overwrite the first one.  if a sequenceName or\n                    // combination is specified in this call it does just that\n                    //\n                    // @todo make deleting its own method?\n                    var deleteCombo = !sequenceName && callback.combo == combination;\n                    var deleteSequence = sequenceName && callback.seq == sequenceName && callback.level == level;\n                    if (deleteCombo || deleteSequence) {\n                        self._callbacks[character].splice(i, 1);\n                    }\n\n                    matches.push(callback);\n                }\n            }\n\n            return matches;\n        }\n\n        /**\n         * actually calls the callback function\n         *\n         * if your callback function returns false this will use the jquery\n         * convention - prevent default and stop propogation on the event\n         *\n         * @param {Function} callback\n         * @param {Event} e\n         * @returns void\n         */\n        function _fireCallback(callback, e, combo, sequence) {\n\n            // if this event should not happen stop here\n            if (self.stopCallback(e, e.target || e.srcElement, combo, sequence)) {\n                return;\n            }\n\n            if (callback(e, combo) === false) {\n                _preventDefault(e);\n                _stopPropagation(e);\n            }\n        }\n\n        /**\n         * handles a character key event\n         *\n         * @param {string} character\n         * @param {Array} modifiers\n         * @param {Event} e\n         * @returns void\n         */\n        self._handleKey = function(character, modifiers, e) {\n            var callbacks = _getMatches(character, modifiers, e);\n            var i;\n            var doNotReset = {};\n            var maxLevel = 0;\n            var processedSequenceCallback = false;\n\n            // Calculate the maxLevel for sequences so we can only execute the longest callback sequence\n            for (i = 0; i < callbacks.length; ++i) {\n                if (callbacks[i].seq) {\n                    maxLevel = Math.max(maxLevel, callbacks[i].level);\n                }\n            }\n\n            // loop through matching callbacks for this key event\n            for (i = 0; i < callbacks.length; ++i) {\n\n                // fire for all sequence callbacks\n                // this is because if for example you have multiple sequences\n                // bound such as \"g i\" and \"g t\" they both need to fire the\n                // callback for matching g cause otherwise you can only ever\n                // match the first one\n                if (callbacks[i].seq) {\n\n                    // only fire callbacks for the maxLevel to prevent\n                    // subsequences from also firing\n                    //\n                    // for example 'a option b' should not cause 'option b' to fire\n                    // even though 'option b' is part of the other sequence\n                    //\n                    // any sequences that do not match here will be discarded\n                    // below by the _resetSequences call\n                    if (callbacks[i].level != maxLevel) {\n                        continue;\n                    }\n\n                    processedSequenceCallback = true;\n\n                    // keep a list of which sequences were matches for later\n                    doNotReset[callbacks[i].seq] = 1;\n                    _fireCallback(callbacks[i].callback, e, callbacks[i].combo, callbacks[i].seq);\n                    continue;\n                }\n\n                // if there were no sequence matches but we are still here\n                // that means this is a regular match so we should fire that\n                if (!processedSequenceCallback) {\n                    _fireCallback(callbacks[i].callback, e, callbacks[i].combo);\n                }\n            }\n\n            // if the key you pressed matches the type of sequence without\n            // being a modifier (ie \"keyup\" or \"keypress\") then we should\n            // reset all sequences that were not matched by this event\n            //\n            // this is so, for example, if you have the sequence \"h a t\" and you\n            // type \"h e a r t\" it does not match.  in this case the \"e\" will\n            // cause the sequence to reset\n            //\n            // modifier keys are ignored because you can have a sequence\n            // that contains modifiers such as \"enter ctrl+space\" and in most\n            // cases the modifier key will be pressed before the next key\n            //\n            // also if you have a sequence such as \"ctrl+b a\" then pressing the\n            // \"b\" key will trigger a \"keypress\" and a \"keydown\"\n            //\n            // the \"keydown\" is expected when there is a modifier, but the\n            // \"keypress\" ends up matching the _nextExpectedAction since it occurs\n            // after and that causes the sequence to reset\n            //\n            // we ignore keypresses in a sequence that directly follow a keydown\n            // for the same character\n            var ignoreThisKeypress = e.type == 'keypress' && _ignoreNextKeypress;\n            if (e.type == _nextExpectedAction && !_isModifier(character) && !ignoreThisKeypress) {\n                _resetSequences(doNotReset);\n            }\n\n            _ignoreNextKeypress = processedSequenceCallback && e.type == 'keydown';\n        };\n\n        /**\n         * handles a keydown event\n         *\n         * @param {Event} e\n         * @returns void\n         */\n        function _handleKeyEvent(e) {\n\n            // normalize e.which for key events\n            // @see http://stackoverflow.com/questions/4285627/javascript-keycode-vs-charcode-utter-confusion\n            if (typeof e.which !== 'number') {\n                e.which = e.keyCode;\n            }\n\n            var character = _characterFromEvent(e);\n\n            // no character found then stop\n            if (!character) {\n                return;\n            }\n\n            // need to use === for the character check because the character can be 0\n            if (e.type == 'keyup' && _ignoreNextKeyup === character) {\n                _ignoreNextKeyup = false;\n                return;\n            }\n\n            self.handleKey(character, _eventModifiers(e), e);\n        }\n\n        /**\n         * called to set a 1 second timeout on the specified sequence\n         *\n         * this is so after each key press in the sequence you have 1 second\n         * to press the next key before you have to start over\n         *\n         * @returns void\n         */\n        function _resetSequenceTimer() {\n            clearTimeout(_resetTimer);\n            _resetTimer = setTimeout(_resetSequences, 1000);\n        }\n\n        /**\n         * binds a key sequence to an event\n         *\n         * @param {string} combo - combo specified in bind call\n         * @param {Array} keys\n         * @param {Function} callback\n         * @param {string=} action\n         * @returns void\n         */\n        function _bindSequence(combo, keys, callback, action) {\n\n            // start off by adding a sequence level record for this combination\n            // and setting the level to 0\n            _sequenceLevels[combo] = 0;\n\n            /**\n             * callback to increase the sequence level for this sequence and reset\n             * all other sequences that were active\n             *\n             * @param {string} nextAction\n             * @returns {Function}\n             */\n            function _increaseSequence(nextAction) {\n                return function() {\n                    _nextExpectedAction = nextAction;\n                    ++_sequenceLevels[combo];\n                    _resetSequenceTimer();\n                };\n            }\n\n            /**\n             * wraps the specified callback inside of another function in order\n             * to reset all sequence counters as soon as this sequence is done\n             *\n             * @param {Event} e\n             * @returns void\n             */\n            function _callbackAndReset(e) {\n                _fireCallback(callback, e, combo);\n\n                // we should ignore the next key up if the action is key down\n                // or keypress.  this is so if you finish a sequence and\n                // release the key the final key will not trigger a keyup\n                if (action !== 'keyup') {\n                    _ignoreNextKeyup = _characterFromEvent(e);\n                }\n\n                // weird race condition if a sequence ends with the key\n                // another sequence begins with\n                setTimeout(_resetSequences, 10);\n            }\n\n            // loop through keys one at a time and bind the appropriate callback\n            // function.  for any key leading up to the final one it should\n            // increase the sequence. after the final, it should reset all sequences\n            //\n            // if an action is specified in the original bind call then that will\n            // be used throughout.  otherwise we will pass the action that the\n            // next key in the sequence should match.  this allows a sequence\n            // to mix and match keypress and keydown events depending on which\n            // ones are better suited to the key provided\n            for (var i = 0; i < keys.length; ++i) {\n                var isFinal = i + 1 === keys.length;\n                var wrappedCallback = isFinal ? _callbackAndReset : _increaseSequence(action || _getKeyInfo(keys[i + 1]).action);\n                _bindSingle(keys[i], wrappedCallback, action, combo, i);\n            }\n        }\n\n        /**\n         * binds a single keyboard combination\n         *\n         * @param {string} combination\n         * @param {Function} callback\n         * @param {string=} action\n         * @param {string=} sequenceName - name of sequence if part of sequence\n         * @param {number=} level - what part of the sequence the command is\n         * @returns void\n         */\n        function _bindSingle(combination, callback, action, sequenceName, level) {\n\n            // store a direct mapped reference for use with Mousetrap.trigger\n            self._directMap[combination + ':' + action] = callback;\n\n            // make sure multiple spaces in a row become a single space\n            combination = combination.replace(/\\s+/g, ' ');\n\n            var sequence = combination.split(' ');\n            var info;\n\n            // if this pattern is a sequence of keys then run through this method\n            // to reprocess each pattern one key at a time\n            if (sequence.length > 1) {\n                _bindSequence(combination, sequence, callback, action);\n                return;\n            }\n\n            info = _getKeyInfo(combination, action);\n\n            // make sure to initialize array if this is the first time\n            // a callback is added for this key\n            self._callbacks[info.key] = self._callbacks[info.key] || [];\n\n            // remove an existing match if there is one\n            _getMatches(info.key, info.modifiers, {type: info.action}, sequenceName, combination, level);\n\n            // add this call back to the array\n            // if it is a sequence put it at the beginning\n            // if not put it at the end\n            //\n            // this is important because the way these are processed expects\n            // the sequence ones to come first\n            self._callbacks[info.key][sequenceName ? 'unshift' : 'push']({\n                callback: callback,\n                modifiers: info.modifiers,\n                action: info.action,\n                seq: sequenceName,\n                level: level,\n                combo: combination\n            });\n        }\n\n        /**\n         * binds multiple combinations to the same callback\n         *\n         * @param {Array} combinations\n         * @param {Function} callback\n         * @param {string|undefined} action\n         * @returns void\n         */\n        self._bindMultiple = function(combinations, callback, action) {\n            for (var i = 0; i < combinations.length; ++i) {\n                _bindSingle(combinations[i], callback, action);\n            }\n        };\n\n        // start!\n        _addEvent(targetElement, 'keypress', _handleKeyEvent);\n        _addEvent(targetElement, 'keydown', _handleKeyEvent);\n        _addEvent(targetElement, 'keyup', _handleKeyEvent);\n    }\n\n    /**\n     * binds an event to mousetrap\n     *\n     * can be a single key, a combination of keys separated with +,\n     * an array of keys, or a sequence of keys separated by spaces\n     *\n     * be sure to list the modifier keys first to make sure that the\n     * correct key ends up getting bound (the last key in the pattern)\n     *\n     * @param {string|Array} keys\n     * @param {Function} callback\n     * @param {string=} action - 'keypress', 'keydown', or 'keyup'\n     * @returns void\n     */\n    Mousetrap.prototype.bind = function(keys, callback, action) {\n        var self = this;\n        keys = keys instanceof Array ? keys : [keys];\n        self._bindMultiple.call(self, keys, callback, action);\n        return self;\n    };\n\n    /**\n     * unbinds an event to mousetrap\n     *\n     * the unbinding sets the callback function of the specified key combo\n     * to an empty function and deletes the corresponding key in the\n     * _directMap dict.\n     *\n     * TODO: actually remove this from the _callbacks dictionary instead\n     * of binding an empty function\n     *\n     * the keycombo+action has to be exactly the same as\n     * it was defined in the bind method\n     *\n     * @param {string|Array} keys\n     * @param {string} action\n     * @returns void\n     */\n    Mousetrap.prototype.unbind = function(keys, action) {\n        var self = this;\n        return self.bind.call(self, keys, function() {}, action);\n    };\n\n    /**\n     * triggers an event that has already been bound\n     *\n     * @param {string} keys\n     * @param {string=} action\n     * @returns void\n     */\n    Mousetrap.prototype.trigger = function(keys, action) {\n        var self = this;\n        if (self._directMap[keys + ':' + action]) {\n            self._directMap[keys + ':' + action]({}, keys);\n        }\n        return self;\n    };\n\n    /**\n     * resets the library back to its initial state.  this is useful\n     * if you want to clear out the current keyboard shortcuts and bind\n     * new ones - for example if you switch to another page\n     *\n     * @returns void\n     */\n    Mousetrap.prototype.reset = function() {\n        var self = this;\n        self._callbacks = {};\n        self._directMap = {};\n        return self;\n    };\n\n    /**\n     * should we stop this event before firing off callbacks\n     *\n     * @param {Event} e\n     * @param {Element} element\n     * @return {boolean}\n     */\n    Mousetrap.prototype.stopCallback = function(e, element) {\n        var self = this;\n\n        // if the element has the class \"mousetrap\" then no need to stop\n        if ((' ' + element.className + ' ').indexOf(' mousetrap ') > -1) {\n            return false;\n        }\n\n        if (_belongsTo(element, self.target)) {\n            return false;\n        }\n\n        // Events originating from a shadow DOM are re-targetted and `e.target` is the shadow host,\n        // not the initial event target in the shadow tree. Note that not all events cross the\n        // shadow boundary.\n        // For shadow trees with `mode: 'open'`, the initial event target is the first element in\n        // the event’s composed path. For shadow trees with `mode: 'closed'`, the initial event\n        // target cannot be obtained.\n        if ('composedPath' in e && typeof e.composedPath === 'function') {\n            // For open shadow trees, update `element` so that the following check works.\n            var initialEventTarget = e.composedPath()[0];\n            if (initialEventTarget !== e.target) {\n                element = initialEventTarget;\n            }\n        }\n\n        // stop for input, select, and textarea\n        return element.tagName == 'INPUT' || element.tagName == 'SELECT' || element.tagName == 'TEXTAREA' || element.isContentEditable;\n    };\n\n    /**\n     * exposes _handleKey publicly so it can be overwritten by extensions\n     */\n    Mousetrap.prototype.handleKey = function() {\n        var self = this;\n        return self._handleKey.apply(self, arguments);\n    };\n\n    /**\n     * allow custom key mappings\n     */\n    Mousetrap.addKeycodes = function(object) {\n        for (var key in object) {\n            if (object.hasOwnProperty(key)) {\n                _MAP[key] = object[key];\n            }\n        }\n        _REVERSE_MAP = null;\n    };\n\n    /**\n     * Init the global mousetrap functions\n     *\n     * This method is needed to allow the global mousetrap functions to work\n     * now that mousetrap is a constructor function.\n     */\n    Mousetrap.init = function() {\n        var documentMousetrap = Mousetrap(document);\n        for (var method in documentMousetrap) {\n            if (method.charAt(0) !== '_') {\n                Mousetrap[method] = (function(method) {\n                    return function() {\n                        return documentMousetrap[method].apply(documentMousetrap, arguments);\n                    };\n                } (method));\n            }\n        }\n    };\n\n    Mousetrap.init();\n\n    // expose mousetrap to the global object\n    window.Mousetrap = Mousetrap;\n\n    // expose as a common js module\n    if (typeof module !== 'undefined' && module.exports) {\n        module.exports = Mousetrap;\n    }\n\n    // expose mousetrap as an AMD module\n    if (typeof define === 'function' && define.amd) {\n        define(function() {\n            return Mousetrap;\n        });\n    }\n}) (typeof window !== 'undefined' ? window : null, typeof  window !== 'undefined' ? document : null);\n","\"use strict\";\n\nmodule.exports = function (url, options) {\n  if (!options) {\n    options = {};\n  }\n  if (!url) {\n    return url;\n  }\n  url = String(url.__esModule ? url.default : url);\n\n  // If url is already wrapped in quotes, remove them\n  if (/^['\"].*['\"]$/.test(url)) {\n    url = url.slice(1, -1);\n  }\n  if (options.hash) {\n    url += options.hash;\n  }\n\n  // Should url be wrapped?\n  // See https://drafts.csswg.org/css-values-3/#urls\n  if (/[\"'() \\t\\n]|(%20)/.test(url) || options.needQuotes) {\n    return \"\\\"\".concat(url.replace(/\"/g, '\\\\\"').replace(/\\n/g, \"\\\\n\"), \"\\\"\");\n  }\n  return url;\n};","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.escher-container .button-panel {\r\n  position: absolute;\r\n  left: 4px;\r\n  top: 20%;\r\n  margin-top: -32px;\r\n  padding-left: 0;\r\n  touch-action: none;\r\n}\r\n\r\n.escher-container .button-panel>li {\r\n  margin-top: 5px;\r\n  display: block;\r\n\r\n  /* these sometimes get overridden */\r\n  margin-left: 0 !important;\r\n}\r\n\r\n.escher-container .grouping {\r\n  display: block;\r\n}\r\n\r\n.escher-container .buttonGroup {\r\n  display: block;\r\n  margin-bottom: -1px;\r\n  padding: 5px 0px;\r\n  border-radius: 0;\r\n}\r\n\r\n.escher-container .grouping>.buttonGroup:first-child {\r\n  border-top-left-radius: 4px;\r\n  border-top-right-radius: 4px;\r\n}\r\n\r\n.escher-container .grouping>.buttonGroup:last-child {\r\n  border-bottom-left-radius: 4px;\r\n  border-bottom-right-radius: 4px;\r\n}\r\n\r\n.escher-container .button-panel>.grouping:last-child {\r\n  margin-top: 4px;\r\n}\r\n\r\n.escher-container #currentMode,\r\n.escher-container .active-button {\r\n  background-image: linear-gradient(#8F4F3F,#834c3c 6%,#8d3a2d) !important;\r\n}\r\n\r\n.escher-container .buttonGroup.btn {\r\n  margin-top: -1px;\r\n}\r\n\r\n.escher-container .button {\r\n  border-radius: 4px;\r\n}\r\n\r\n.escher-container .button.btn, .escher-container .buttonGroup.btn {\r\n  padding: unset;\r\n  color: white!important;\r\n  border: 1px solid #474949;\r\n  background-image: linear-gradient(#4F5151, #474949 6%, #3F4141);\r\n  background-color: white;\r\n  text-align: center;\r\n  vertical-align: middle;\r\n  cursor: pointer;\r\n  font-size: 14px!important;\r\n  font-weight: 400;\r\n  width: 40px;\r\n  height: 40px;\r\n}\r\n\r\n.escher-container .button-panel .button:active, .escher-container .buttonGroup label:active, .escher-container .button-panel .buttonGroup:active {\r\n  background-image: linear-gradient(#3F4141, #474949 6%, #4F5151);\r\n}\r\n\r\n.escher-container .button-panel .fa {\r\n  font-size: 24px;\r\n}\r\n\r\n/* Icons */\r\n.escher-container .button-panel [class^='icon-'] {\r\n  font-size: 23px;\r\n}\r\n\r\n.escher-container .kth-reaction-arrows {\r\n  display: flex;\r\n    width: 40px;\r\n    flex-direction: row;\r\n}\r\n\r\n.escher-container .kth-reaction-arrows button.btn {\r\n  width: 20px;\r\n  height: 20px;\r\n}\r\n\r\n.escher-container .kth-reaction-arrows button.btn i {\r\n  font-size: 12px;\r\n}`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/css/ButtonPanel.css\"],\"names\":[],\"mappings\":\"AAAA;EACE,kBAAkB;EAClB,SAAS;EACT,QAAQ;EACR,iBAAiB;EACjB,eAAe;EACf,kBAAkB;AACpB;;AAEA;EACE,eAAe;EACf,cAAc;;EAEd,mCAAmC;EACnC,yBAAyB;AAC3B;;AAEA;EACE,cAAc;AAChB;;AAEA;EACE,cAAc;EACd,mBAAmB;EACnB,gBAAgB;EAChB,gBAAgB;AAClB;;AAEA;EACE,2BAA2B;EAC3B,4BAA4B;AAC9B;;AAEA;EACE,8BAA8B;EAC9B,+BAA+B;AACjC;;AAEA;EACE,eAAe;AACjB;;AAEA;;EAEE,wEAAwE;AAC1E;;AAEA;EACE,gBAAgB;AAClB;;AAEA;EACE,kBAAkB;AACpB;;AAEA;EACE,cAAc;EACd,sBAAsB;EACtB,yBAAyB;EACzB,+DAA+D;EAC/D,uBAAuB;EACvB,kBAAkB;EAClB,sBAAsB;EACtB,eAAe;EACf,yBAAyB;EACzB,gBAAgB;EAChB,WAAW;EACX,YAAY;AACd;;AAEA;EACE,+DAA+D;AACjE;;AAEA;EACE,eAAe;AACjB;;AAEA,UAAU;AACV;EACE,eAAe;AACjB;;AAEA;EACE,aAAa;IACX,WAAW;IACX,mBAAmB;AACvB;;AAEA;EACE,WAAW;EACX,YAAY;AACd;;AAEA;EACE,eAAe;AACjB\",\"sourcesContent\":[\".escher-container .button-panel {\\r\\n  position: absolute;\\r\\n  left: 4px;\\r\\n  top: 20%;\\r\\n  margin-top: -32px;\\r\\n  padding-left: 0;\\r\\n  touch-action: none;\\r\\n}\\r\\n\\r\\n.escher-container .button-panel>li {\\r\\n  margin-top: 5px;\\r\\n  display: block;\\r\\n\\r\\n  /* these sometimes get overridden */\\r\\n  margin-left: 0 !important;\\r\\n}\\r\\n\\r\\n.escher-container .grouping {\\r\\n  display: block;\\r\\n}\\r\\n\\r\\n.escher-container .buttonGroup {\\r\\n  display: block;\\r\\n  margin-bottom: -1px;\\r\\n  padding: 5px 0px;\\r\\n  border-radius: 0;\\r\\n}\\r\\n\\r\\n.escher-container .grouping>.buttonGroup:first-child {\\r\\n  border-top-left-radius: 4px;\\r\\n  border-top-right-radius: 4px;\\r\\n}\\r\\n\\r\\n.escher-container .grouping>.buttonGroup:last-child {\\r\\n  border-bottom-left-radius: 4px;\\r\\n  border-bottom-right-radius: 4px;\\r\\n}\\r\\n\\r\\n.escher-container .button-panel>.grouping:last-child {\\r\\n  margin-top: 4px;\\r\\n}\\r\\n\\r\\n.escher-container #currentMode,\\r\\n.escher-container .active-button {\\r\\n  background-image: linear-gradient(#8F4F3F,#834c3c 6%,#8d3a2d) !important;\\r\\n}\\r\\n\\r\\n.escher-container .buttonGroup.btn {\\r\\n  margin-top: -1px;\\r\\n}\\r\\n\\r\\n.escher-container .button {\\r\\n  border-radius: 4px;\\r\\n}\\r\\n\\r\\n.escher-container .button.btn, .escher-container .buttonGroup.btn {\\r\\n  padding: unset;\\r\\n  color: white!important;\\r\\n  border: 1px solid #474949;\\r\\n  background-image: linear-gradient(#4F5151, #474949 6%, #3F4141);\\r\\n  background-color: white;\\r\\n  text-align: center;\\r\\n  vertical-align: middle;\\r\\n  cursor: pointer;\\r\\n  font-size: 14px!important;\\r\\n  font-weight: 400;\\r\\n  width: 40px;\\r\\n  height: 40px;\\r\\n}\\r\\n\\r\\n.escher-container .button-panel .button:active, .escher-container .buttonGroup label:active, .escher-container .button-panel .buttonGroup:active {\\r\\n  background-image: linear-gradient(#3F4141, #474949 6%, #4F5151);\\r\\n}\\r\\n\\r\\n.escher-container .button-panel .fa {\\r\\n  font-size: 24px;\\r\\n}\\r\\n\\r\\n/* Icons */\\r\\n.escher-container .button-panel [class^='icon-'] {\\r\\n  font-size: 23px;\\r\\n}\\r\\n\\r\\n.escher-container .kth-reaction-arrows {\\r\\n  display: flex;\\r\\n    width: 40px;\\r\\n    flex-direction: row;\\r\\n}\\r\\n\\r\\n.escher-container .kth-reaction-arrows button.btn {\\r\\n  width: 20px;\\r\\n  height: 20px;\\r\\n}\\r\\n\\r\\n.escher-container .kth-reaction-arrows button.btn i {\\r\\n  font-size: 12px;\\r\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","\"use strict\";\n\n/* istanbul ignore next  */\nfunction insertStyleElement(options) {\n  var element = document.createElement(\"style\");\n  options.setAttributes(element, options.attributes);\n  options.insert(element, options.options);\n  return element;\n}\nmodule.exports = insertStyleElement;","/**\r\n* vkBeautify - javascript plugin to pretty-print or minify text in XML, JSON, CSS and SQL formats.\r\n*\r\n* Copyright (c) 2012 Vadim Kiryukhin\r\n* vkiryukhin @ gmail.com\r\n* http://www.eslinstructor.net/vkbeautify/\r\n*\r\n* Dual licensed under the MIT and GPL licenses:\r\n*   http://www.opensource.org/licenses/mit-license.php\r\n*   http://www.gnu.org/licenses/gpl.html\r\n*\r\n*   Pretty print\r\n*\r\n*        vkbeautify.xml(text [,indent_pattern]);\r\n*        vkbeautify.json(text [,indent_pattern]);\r\n*        vkbeautify.css(text [,indent_pattern]);\r\n*        vkbeautify.sql(text [,indent_pattern]);\r\n*\r\n*        @text - String; text to beatufy;\r\n*        @indent_pattern - Integer | String;\r\n*                Integer:  number of white spaces;\r\n*                String:   character string to visualize indentation ( can also be a set of white spaces )\r\n*   Minify\r\n*\r\n*        vkbeautify.xmlmin(text [,preserve_comments]);\r\n*        vkbeautify.jsonmin(text);\r\n*        vkbeautify.cssmin(text [,preserve_comments]);\r\n*        vkbeautify.sqlmin(text);\r\n*\r\n*        @text - String; text to minify;\r\n*        @preserve_comments - Bool; [optional];\r\n*                Set this flag to true to prevent removing comments from @text ( minxml and mincss functions only. )\r\n*\r\n*   Examples:\r\n*        vkbeautify.xml(text); // pretty print XML\r\n*        vkbeautify.json(text, 4 ); // pretty print JSON\r\n*        vkbeautify.css(text, '. . . .'); // pretty print CSS\r\n*        vkbeautify.sql(text, '----'); // pretty print SQL\r\n*\r\n*        vkbeautify.xmlmin(text, true);// minify XML, preserve comments\r\n*        vkbeautify.jsonmin(text);// minify JSON\r\n*        vkbeautify.cssmin(text);// minify CSS, remove comments ( default )\r\n*        vkbeautify.sqlmin(text);// minify SQL\r\n*\r\n*/\r\nfunction createShiftArr(step) {\r\n\r\n\tvar space = '    ';\r\n\r\n\tif ( isNaN(parseInt(step)) ) {  // argument is string\r\n\t\tspace = step;\r\n\t} else { // argument is integer\r\n\t\tswitch(step) {\r\n\t\t\tcase 1: space = ' '; break;\r\n\t\t\tcase 2: space = '  '; break;\r\n\t\t\tcase 3: space = '   '; break;\r\n\t\t\tcase 4: space = '    '; break;\r\n\t\t\tcase 5: space = '     '; break;\r\n\t\t\tcase 6: space = '      '; break;\r\n\t\t\tcase 7: space = '       '; break;\r\n\t\t\tcase 8: space = '        '; break;\r\n\t\t\tcase 9: space = '         '; break;\r\n\t\t\tcase 10: space = '          '; break;\r\n\t\t\tcase 11: space = '           '; break;\r\n\t\t\tcase 12: space = '            '; break;\r\n\t\t}\r\n\t}\r\n\r\n\tvar shift = ['\\n']; // array of shifts\r\n\tfor(var ix=0;ix<100;ix++) {\r\n\t\tshift.push(shift[ix]+space);\r\n\t}\r\n\treturn shift;\r\n}\r\n\r\nfunction vkbeautify(){\r\n\tthis.step = '    '; // 4 spaces\r\n\tthis.shift = createShiftArr(this.step);\r\n};\r\n\r\nvkbeautify.prototype.xml = function(text,step) {\r\n\r\n\tvar ar = text.replace(/>\\s{0,}</g,\"><\")\r\n\t\t\t\t .replace(/</g,\"~::~<\")\r\n\t\t\t\t .replace(/\\s*xmlns\\:/g,\"~::~xmlns:\")\r\n\t\t\t\t .replace(/\\s*xmlns\\=/g,\"~::~xmlns=\")\r\n\t\t\t\t .split('~::~'),\r\n\t\tlen = ar.length,\r\n\t\tinComment = false,\r\n\t\tdeep = 0,\r\n\t\tstr = '',\r\n\t\tix = 0,\r\n\t\tshift = step ? createShiftArr(step) : this.shift;\r\n\r\n\t\tfor(ix=0;ix<len;ix++) {\r\n\t\t\t// start comment or <![CDATA[...]]> or <!DOCTYPE //\r\n\t\t\tif(ar[ix].search(/<!/) > -1) {\r\n\t\t\t\tstr += shift[deep]+ar[ix];\r\n\t\t\t\tinComment = true;\r\n\t\t\t\t// end comment  or <![CDATA[...]]> //\r\n\t\t\t\tif(ar[ix].search(/-->/) > -1 || ar[ix].search(/\\]>/) > -1 || ar[ix].search(/!DOCTYPE/) > -1 ) {\r\n\t\t\t\t\tinComment = false;\r\n\t\t\t\t}\r\n\t\t\t} else\r\n\t\t\t// end comment  or <![CDATA[...]]> //\r\n\t\t\tif(ar[ix].search(/-->/) > -1 || ar[ix].search(/\\]>/) > -1) {\r\n\t\t\t\tstr += ar[ix];\r\n\t\t\t\tinComment = false;\r\n\t\t\t} else\r\n\t\t\t// <elm></elm> //\r\n\t\t\tif( /^<\\w/.exec(ar[ix-1]) && /^<\\/\\w/.exec(ar[ix]) &&\r\n\t\t\t\t/^<[\\w:\\-\\.\\,]+/.exec(ar[ix-1]) == /^<\\/[\\w:\\-\\.\\,]+/.exec(ar[ix])[0].replace('/','')) {\r\n\t\t\t\tstr += ar[ix];\r\n\t\t\t\tif(!inComment) deep--;\r\n\t\t\t} else\r\n\t\t\t // <elm> //\r\n\t\t\tif(ar[ix].search(/<\\w/) > -1 && ar[ix].search(/<\\//) == -1 && ar[ix].search(/\\/>/) == -1 ) {\r\n\t\t\t\tstr = !inComment ? str += shift[deep++]+ar[ix] : str += ar[ix];\r\n\t\t\t} else\r\n\t\t\t // <elm>...</elm> //\r\n\t\t\tif(ar[ix].search(/<\\w/) > -1 && ar[ix].search(/<\\//) > -1) {\r\n\t\t\t\tstr = !inComment ? str += shift[deep]+ar[ix] : str += ar[ix];\r\n\t\t\t} else\r\n\t\t\t// </elm> //\r\n\t\t\tif(ar[ix].search(/<\\//) > -1) {\r\n\t\t\t\tstr = !inComment ? str += shift[--deep]+ar[ix] : str += ar[ix];\r\n\t\t\t} else\r\n\t\t\t// <elm/> //\r\n\t\t\tif(ar[ix].search(/\\/>/) > -1 ) {\r\n\t\t\t\tstr = !inComment ? str += shift[deep]+ar[ix] : str += ar[ix];\r\n\t\t\t} else\r\n\t\t\t// <? xml ... ?> //\r\n\t\t\tif(ar[ix].search(/<\\?/) > -1) {\r\n\t\t\t\tstr += shift[deep]+ar[ix];\r\n\t\t\t} else\r\n\t\t\t// xmlns //\r\n\t\t\tif( ar[ix].search(/xmlns\\:/) > -1  || ar[ix].search(/xmlns\\=/) > -1) {\r\n\t\t\t\tstr += shift[deep]+ar[ix];\r\n\t\t\t}\r\n\r\n\t\t\telse {\r\n\t\t\t\tstr += ar[ix];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\treturn  (str[0] == '\\n') ? str.slice(1) : str;\r\n}\r\n\r\nvkbeautify.prototype.json = function(text,step) {\r\n\r\n\tvar step = step ? step : this.step;\r\n\r\n\tif (typeof JSON === 'undefined' ) return text;\r\n\r\n\tif ( typeof text === \"string\" ) return JSON.stringify(JSON.parse(text), null, step);\r\n\tif ( typeof text === \"object\" ) return JSON.stringify(text, null, step);\r\n\r\n\treturn text; // text is not string nor object\r\n}\r\n\r\nvkbeautify.prototype.css = function(text, step) {\r\n\r\n\tvar ar = text.replace(/\\s{1,}/g,' ')\r\n\t\t\t\t.replace(/\\{/g,\"{~::~\")\r\n\t\t\t\t.replace(/\\}/g,\"~::~}~::~\")\r\n\t\t\t\t.replace(/\\;/g,\";~::~\")\r\n\t\t\t\t.replace(/\\/\\*/g,\"~::~/*\")\r\n\t\t\t\t.replace(/\\*\\//g,\"*/~::~\")\r\n\t\t\t\t.replace(/~::~\\s{0,}~::~/g,\"~::~\")\r\n\t\t\t\t.split('~::~'),\r\n\t\tlen = ar.length,\r\n\t\tdeep = 0,\r\n\t\tstr = '',\r\n\t\tix = 0,\r\n\t\tshift = step ? createShiftArr(step) : this.shift;\r\n\r\n\t\tfor(ix=0;ix<len;ix++) {\r\n\r\n\t\t\tif( /\\{/.exec(ar[ix]))  {\r\n\t\t\t\tstr += shift[deep++]+ar[ix];\r\n\t\t\t} else\r\n\t\t\tif( /\\}/.exec(ar[ix]))  {\r\n\t\t\t\tstr += shift[--deep]+ar[ix];\r\n\t\t\t} else\r\n\t\t\tif( /\\*\\\\/.exec(ar[ix]))  {\r\n\t\t\t\tstr += shift[deep]+ar[ix];\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tstr += shift[deep]+ar[ix];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn str.replace(/^\\n{1,}/,'');\r\n}\r\n\r\n//----------------------------------------------------------------------------\r\n\r\nfunction isSubquery(str, parenthesisLevel) {\r\n\treturn  parenthesisLevel - (str.replace(/\\(/g,'').length - str.replace(/\\)/g,'').length )\r\n}\r\n\r\nfunction split_sql(str, tab) {\r\n\r\n\treturn str.replace(/\\s{1,}/g,\" \")\r\n\r\n\t\t\t\t.replace(/ AND /ig,\"~::~\"+tab+tab+\"AND \")\r\n\t\t\t\t.replace(/ BETWEEN /ig,\"~::~\"+tab+\"BETWEEN \")\r\n\t\t\t\t.replace(/ CASE /ig,\"~::~\"+tab+\"CASE \")\r\n\t\t\t\t.replace(/ ELSE /ig,\"~::~\"+tab+\"ELSE \")\r\n\t\t\t\t.replace(/ END /ig,\"~::~\"+tab+\"END \")\r\n\t\t\t\t.replace(/ FROM /ig,\"~::~FROM \")\r\n\t\t\t\t.replace(/ GROUP\\s{1,}BY/ig,\"~::~GROUP BY \")\r\n\t\t\t\t.replace(/ HAVING /ig,\"~::~HAVING \")\r\n\t\t\t\t//.replace(/ SET /ig,\" SET~::~\")\r\n\t\t\t\t.replace(/ IN /ig,\" IN \")\r\n\r\n\t\t\t\t.replace(/ JOIN /ig,\"~::~JOIN \")\r\n\t\t\t\t.replace(/ CROSS~::~{1,}JOIN /ig,\"~::~CROSS JOIN \")\r\n\t\t\t\t.replace(/ INNER~::~{1,}JOIN /ig,\"~::~INNER JOIN \")\r\n\t\t\t\t.replace(/ LEFT~::~{1,}JOIN /ig,\"~::~LEFT JOIN \")\r\n\t\t\t\t.replace(/ RIGHT~::~{1,}JOIN /ig,\"~::~RIGHT JOIN \")\r\n\r\n\t\t\t\t.replace(/ ON /ig,\"~::~\"+tab+\"ON \")\r\n\t\t\t\t.replace(/ OR /ig,\"~::~\"+tab+tab+\"OR \")\r\n\t\t\t\t.replace(/ ORDER\\s{1,}BY/ig,\"~::~ORDER BY \")\r\n\t\t\t\t.replace(/ OVER /ig,\"~::~\"+tab+\"OVER \")\r\n\r\n\t\t\t\t.replace(/\\(\\s{0,}SELECT /ig,\"~::~(SELECT \")\r\n\t\t\t\t.replace(/\\)\\s{0,}SELECT /ig,\")~::~SELECT \")\r\n\r\n\t\t\t\t.replace(/ THEN /ig,\" THEN~::~\"+tab+\"\")\r\n\t\t\t\t.replace(/ UNION /ig,\"~::~UNION~::~\")\r\n\t\t\t\t.replace(/ USING /ig,\"~::~USING \")\r\n\t\t\t\t.replace(/ WHEN /ig,\"~::~\"+tab+\"WHEN \")\r\n\t\t\t\t.replace(/ WHERE /ig,\"~::~WHERE \")\r\n\t\t\t\t.replace(/ WITH /ig,\"~::~WITH \")\r\n\r\n\t\t\t\t//.replace(/\\,\\s{0,}\\(/ig,\",~::~( \")\r\n\t\t\t\t//.replace(/\\,/ig,\",~::~\"+tab+tab+\"\")\r\n\r\n\t\t\t\t.replace(/ ALL /ig,\" ALL \")\r\n\t\t\t\t.replace(/ AS /ig,\" AS \")\r\n\t\t\t\t.replace(/ ASC /ig,\" ASC \")\r\n\t\t\t\t.replace(/ DESC /ig,\" DESC \")\r\n\t\t\t\t.replace(/ DISTINCT /ig,\" DISTINCT \")\r\n\t\t\t\t.replace(/ EXISTS /ig,\" EXISTS \")\r\n\t\t\t\t.replace(/ NOT /ig,\" NOT \")\r\n\t\t\t\t.replace(/ NULL /ig,\" NULL \")\r\n\t\t\t\t.replace(/ LIKE /ig,\" LIKE \")\r\n\t\t\t\t.replace(/\\s{0,}SELECT /ig,\"SELECT \")\r\n\t\t\t\t.replace(/\\s{0,}UPDATE /ig,\"UPDATE \")\r\n\t\t\t\t.replace(/ SET /ig,\" SET \")\r\n\r\n\t\t\t\t.replace(/~::~{1,}/g,\"~::~\")\r\n\t\t\t\t.split('~::~');\r\n}\r\n\r\nvkbeautify.prototype.sql = function(text,step) {\r\n\r\n\tvar ar_by_quote = text.replace(/\\s{1,}/g,\" \")\r\n\t\t\t\t\t\t\t.replace(/\\'/ig,\"~::~\\'\")\r\n\t\t\t\t\t\t\t.split('~::~'),\r\n\t\tlen = ar_by_quote.length,\r\n\t\tar = [],\r\n\t\tdeep = 0,\r\n\t\ttab = this.step,//+this.step,\r\n\t\tinComment = true,\r\n\t\tinQuote = false,\r\n\t\tparenthesisLevel = 0,\r\n\t\tstr = '',\r\n\t\tix = 0,\r\n\t\tshift = step ? createShiftArr(step) : this.shift;;\r\n\r\n\t\tfor(ix=0;ix<len;ix++) {\r\n\t\t\tif(ix%2) {\r\n\t\t\t\tar = ar.concat(ar_by_quote[ix]);\r\n\t\t\t} else {\r\n\t\t\t\tar = ar.concat(split_sql(ar_by_quote[ix], tab) );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlen = ar.length;\r\n\t\tfor(ix=0;ix<len;ix++) {\r\n\r\n\t\t\tparenthesisLevel = isSubquery(ar[ix], parenthesisLevel);\r\n\r\n\t\t\tif( /\\s{0,}\\s{0,}SELECT\\s{0,}/.exec(ar[ix]))  {\r\n\t\t\t\tar[ix] = ar[ix].replace(/\\,/g,\",\\n\"+tab+tab+\"\")\r\n\t\t\t}\r\n\r\n\t\t\tif( /\\s{0,}\\s{0,}SET\\s{0,}/.exec(ar[ix]))  {\r\n\t\t\t\tar[ix] = ar[ix].replace(/\\,/g,\",\\n\"+tab+tab+\"\")\r\n\t\t\t}\r\n\r\n\t\t\tif( /\\s{0,}\\(\\s{0,}SELECT\\s{0,}/.exec(ar[ix]))  {\r\n\t\t\t\tdeep++;\r\n\t\t\t\tstr += shift[deep]+ar[ix];\r\n\t\t\t} else\r\n\t\t\tif( /\\'/.exec(ar[ix]) )  {\r\n\t\t\t\tif(parenthesisLevel<1 && deep) {\r\n\t\t\t\t\tdeep--;\r\n\t\t\t\t}\r\n\t\t\t\tstr += ar[ix];\r\n\t\t\t}\r\n\t\t\telse  {\r\n\t\t\t\tstr += shift[deep]+ar[ix];\r\n\t\t\t\tif(parenthesisLevel<1 && deep) {\r\n\t\t\t\t\tdeep--;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar junk = 0;\r\n\t\t}\r\n\r\n\t\tstr = str.replace(/^\\n{1,}/,'').replace(/\\n{1,}/g,\"\\n\");\r\n\t\treturn str;\r\n}\r\n\r\n\r\nvkbeautify.prototype.xmlmin = function(text, preserveComments) {\r\n\r\n\tvar str = preserveComments ? text\r\n\t\t\t\t\t\t\t   : text.replace(/\\<![ \\r\\n\\t]*(--([^\\-]|[\\r\\n]|-[^\\-])*--[ \\r\\n\\t]*)\\>/g,\"\")\r\n\t\t\t\t\t\t\t\t\t .replace(/[ \\r\\n\\t]{1,}xmlns/g, ' xmlns');\r\n\treturn  str.replace(/>\\s{0,}</g,\"><\");\r\n}\r\n\r\nvkbeautify.prototype.jsonmin = function(text) {\r\n\r\n\tif (typeof JSON === 'undefined' ) return text;\r\n\r\n\treturn JSON.stringify(JSON.parse(text), null, 0);\r\n\r\n}\r\n\r\nvkbeautify.prototype.cssmin = function(text, preserveComments) {\r\n\r\n\tvar str = preserveComments ? text\r\n\t\t\t\t\t\t\t   : text.replace(/\\/\\*([^*]|[\\r\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+\\//g,\"\") ;\r\n\r\n\treturn str.replace(/\\s{1,}/g,' ')\r\n\t\t\t  .replace(/\\{\\s{1,}/g,\"{\")\r\n\t\t\t  .replace(/\\}\\s{1,}/g,\"}\")\r\n\t\t\t  .replace(/\\;\\s{1,}/g,\";\")\r\n\t\t\t  .replace(/\\/\\*\\s{1,}/g,\"/*\")\r\n\t\t\t  .replace(/\\*\\/\\s{1,}/g,\"*/\");\r\n}\r\n\r\nvkbeautify.prototype.sqlmin = function(text) {\r\n\treturn text.replace(/\\s{1,}/g,\" \").replace(/\\s{1,}\\(/,\"(\").replace(/\\s{1,}\\)/,\")\");\r\n}\r\n\r\nmodule.exports = new vkbeautify();\r\n","'use strict';\n\nexports.__esModule = true;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _preact = require('preact');\n\nvar _classnames = require('classnames');\n\nvar _classnames2 = _interopRequireDefault(_classnames);\n\nvar _shallowequal = require('shallowequal');\n\nvar _shallowequal2 = _interopRequireDefault(_shallowequal);\n\nvar _Track = require('./Track');\n\nvar _Track2 = _interopRequireDefault(_Track);\n\nvar _createSlider = require('./createSlider');\n\nvar _createSlider2 = _interopRequireDefault(_createSlider);\n\nvar _util = require('./util');\n\nvar util = _interopRequireWildcard(_util);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /** @jsx h */\n\n\nvar Range = function (_Component) {\n  _inherits(Range, _Component);\n\n  function Range(props) {\n    _classCallCheck(this, Range);\n\n    var _this = _possibleConstructorReturn(this, _Component.call(this, props));\n\n    _this.onEnd = function () {\n      _this.setState({ handle: null });\n      _this.removeDocumentEvents();\n      _this.props.onAfterChange(_this.getValue());\n    };\n\n    var count = props.count,\n        min = props.min,\n        max = props.max;\n\n    var initialValue = Array.apply(null, Array(count + 1)).map(function () {\n      return min;\n    });\n    var defaultValue = 'defaultValue' in props ? props.defaultValue : initialValue;\n    var value = props.value !== undefined ? props.value : defaultValue;\n    var bounds = value.map(function (v) {\n      return _this.trimAlignValue(v);\n    });\n    var recent = bounds[0] === max ? 0 : bounds.length - 1;\n\n    _this.state = {\n      handle: null,\n      recent: recent,\n      bounds: bounds\n    };\n    return _this;\n  }\n\n  Range.prototype.componentWillReceiveProps = function componentWillReceiveProps(nextProps) {\n    var _this2 = this;\n\n    if (!('value' in nextProps || 'min' in nextProps || 'max' in nextProps)) return;\n    if (this.props.min === nextProps.min && this.props.max === nextProps.max && (0, _shallowequal2.default)(this.props.value, nextProps.value)) {\n      return;\n    }\n    var bounds = this.state.bounds;\n\n    var value = nextProps.value || bounds;\n    var nextBounds = value.map(function (v) {\n      return _this2.trimAlignValue(v, nextProps);\n    });\n    if (nextBounds.length === bounds.length && nextBounds.every(function (v, i) {\n      return v === bounds[i];\n    })) return;\n\n    this.setState({ bounds: nextBounds });\n    if (bounds.some(function (v) {\n      return util.isValueOutOfRange(v, nextProps);\n    })) {\n      this.props.onChange(nextBounds);\n    }\n  };\n\n  Range.prototype.onChange = function onChange(state) {\n    var props = this.props;\n    var isNotControlled = !('value' in props);\n    if (isNotControlled) {\n      this.setState(state);\n    } else if (state.handle !== undefined) {\n      this.setState({ handle: state.handle });\n    }\n\n    var data = _extends({}, this.state, state);\n    var changedValue = data.bounds;\n    props.onChange(changedValue);\n  };\n\n  Range.prototype.onStart = function onStart(position) {\n    var props = this.props;\n    var state = this.state;\n    var bounds = this.getValue();\n    props.onBeforeChange(bounds);\n\n    var value = this.calcValueByPos(position);\n    this.startValue = value;\n    this.startPosition = position;\n\n    var closestBound = this.getClosestBound(value);\n    var boundNeedMoving = this.getBoundNeedMoving(value, closestBound);\n\n    this.setState({\n      handle: boundNeedMoving,\n      recent: boundNeedMoving\n    });\n\n    var prevValue = bounds[boundNeedMoving];\n    if (value === prevValue) return;\n\n    var nextBounds = [].concat(state.bounds);\n    nextBounds[boundNeedMoving] = value;\n    this.onChange({ bounds: nextBounds });\n  };\n\n  Range.prototype.onMove = function onMove(e, position) {\n    util.pauseEvent(e);\n    var props = this.props;\n    var state = this.state;\n\n    var value = this.calcValueByPos(position);\n    var oldValue = state.bounds[state.handle];\n    if (value === oldValue) return;\n\n    var nextBounds = [].concat(state.bounds);\n    nextBounds[state.handle] = value;\n    var nextHandle = state.handle;\n    if (props.pushable !== false) {\n      var originalValue = state.bounds[nextHandle];\n      this.pushSurroundingHandles(nextBounds, nextHandle, originalValue);\n    } else if (props.allowCross) {\n      nextBounds.sort(function (a, b) {\n        return a - b;\n      });\n      nextHandle = nextBounds.indexOf(value);\n    }\n    this.onChange({\n      handle: nextHandle,\n      bounds: nextBounds\n    });\n  };\n\n  Range.prototype.onKeyboard = function onKeyboard(e) {\n    var _this3 = this;\n\n    var valueMutator = util.getKeyboardValueMutator(e);\n\n    if (valueMutator) {\n      // Get index of current handle\n      var handle = Object.keys(this.handlesRefs).reduce(function (curr, k, i) {\n        if (curr !== null) return curr;\n        return _this3.handlesRefs[k].base === document.activeElement ? i : curr;\n      }, null);\n      if (handle === null) {\n        console.log('No handle ref');\n        return;\n      }\n\n      util.pauseEvent(e);\n\n      var oldValue = this.state.bounds[handle];\n      var mutatedValue = valueMutator(oldValue, this.props);\n      var value = this.trimAlignValue(mutatedValue);\n      if (value === oldValue) return;\n\n      var nextBounds = [].concat(this.state.bounds);\n      nextBounds[handle] = value;\n      var nextHandle = handle;\n      if (this.props.pushable !== false) {\n        var originalValue = this.state.bounds[nextHandle];\n        this.pushSurroundingHandles(nextBounds, nextHandle, originalValue);\n      } else if (this.props.allowCross) {\n        nextBounds.sort(function (a, b) {\n          return a - b;\n        });\n        nextHandle = nextBounds.indexOf(value);\n      }\n\n      this.onChange({\n        handle: nextHandle,\n        bounds: nextBounds\n      });\n    }\n  };\n\n  Range.prototype.getValue = function getValue() {\n    return this.state.bounds;\n  };\n\n  Range.prototype.getClosestBound = function getClosestBound(value) {\n    var bounds = this.state.bounds;\n\n    var closestBound = 0;\n    for (var i = 1; i < bounds.length - 1; ++i) {\n      if (value > bounds[i]) {\n        closestBound = i;\n      }\n    }\n    if (Math.abs(bounds[closestBound + 1] - value) < Math.abs(bounds[closestBound] - value)) {\n      closestBound = closestBound + 1;\n    }\n    return closestBound;\n  };\n\n  Range.prototype.getBoundNeedMoving = function getBoundNeedMoving(value, closestBound) {\n    var _state = this.state,\n        bounds = _state.bounds,\n        recent = _state.recent;\n\n    var boundNeedMoving = closestBound;\n    var isAtTheSamePoint = bounds[closestBound + 1] === bounds[closestBound];\n    if (isAtTheSamePoint) {\n      boundNeedMoving = recent;\n    }\n\n    if (isAtTheSamePoint && value !== bounds[closestBound + 1]) {\n      boundNeedMoving = value < bounds[closestBound + 1] ? closestBound : closestBound + 1;\n    }\n    return boundNeedMoving;\n  };\n\n  Range.prototype.getLowerBound = function getLowerBound() {\n    return this.state.bounds[0];\n  };\n\n  Range.prototype.getUpperBound = function getUpperBound() {\n    var bounds = this.state.bounds;\n\n    return bounds[bounds.length - 1];\n  };\n\n  /**\n   * Returns an array of possible slider points, taking into account both\n   * `marks` and `step`. The result is cached.\n   */\n\n\n  Range.prototype.getPoints = function getPoints() {\n    var _props = this.props,\n        marks = _props.marks,\n        step = _props.step,\n        min = _props.min,\n        max = _props.max;\n\n    var cache = this._getPointsCache;\n    if (!cache || cache.marks !== marks || cache.step !== step) {\n      var pointsObject = _extends({}, marks);\n      if (step !== null) {\n        for (var point = min; point <= max; point += step) {\n          pointsObject[point] = point;\n        }\n      }\n      var points = Object.keys(pointsObject).map(parseFloat);\n      points.sort(function (a, b) {\n        return a - b;\n      });\n      this._getPointsCache = { marks: marks, step: step, points: points };\n    }\n    return this._getPointsCache.points;\n  };\n\n  Range.prototype.pushSurroundingHandles = function pushSurroundingHandles(bounds, handle, originalValue) {\n    var threshold = this.props.pushable;\n\n    var value = bounds[handle];\n\n    var direction = 0;\n    if (bounds[handle + 1] - value < threshold) {\n      direction = +1; // push to right\n    }\n    if (value - bounds[handle - 1] < threshold) {\n      direction = -1; // push to left\n    }\n\n    if (direction === 0) {\n      return;\n    }\n\n    var nextHandle = handle + direction;\n    var diffToNext = direction * (bounds[nextHandle] - value);\n    if (!this.pushHandle(bounds, nextHandle, direction, threshold - diffToNext)) {\n      // revert to original value if pushing is impossible\n      bounds[handle] = originalValue;\n    }\n  };\n\n  Range.prototype.pushHandle = function pushHandle(bounds, handle, direction, amount) {\n    var originalValue = bounds[handle];\n    var currentValue = bounds[handle];\n    while (direction * (currentValue - originalValue) < amount) {\n      if (!this.pushHandleOnePoint(bounds, handle, direction)) {\n        // can't push handle enough to create the needed `amount` gap, so we\n        // revert its position to the original value\n        bounds[handle] = originalValue;\n        return false;\n      }\n      currentValue = bounds[handle];\n    }\n    // the handle was pushed enough to create the needed `amount` gap\n    return true;\n  };\n\n  Range.prototype.pushHandleOnePoint = function pushHandleOnePoint(bounds, handle, direction) {\n    var points = this.getPoints();\n    var pointIndex = points.indexOf(bounds[handle]);\n    var nextPointIndex = pointIndex + direction;\n    if (nextPointIndex >= points.length || nextPointIndex < 0) {\n      // reached the minimum or maximum available point, can't push anymore\n      return false;\n    }\n    var nextHandle = handle + direction;\n    var nextValue = points[nextPointIndex];\n    var threshold = this.props.pushable;\n\n    var diffToNext = direction * (bounds[nextHandle] - nextValue);\n    if (!this.pushHandle(bounds, nextHandle, direction, threshold - diffToNext)) {\n      // couldn't push next handle, so we won't push this one either\n      return false;\n    }\n    // push the handle\n    bounds[handle] = nextValue;\n    return true;\n  };\n\n  Range.prototype.trimAlignValue = function trimAlignValue(v) {\n    var nextProps = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    var mergedProps = _extends({}, this.props, nextProps);\n    var valInRange = util.ensureValueInRange(v, mergedProps);\n    var valNotConflict = this.ensureValueNotConflict(valInRange, mergedProps);\n    return util.ensureValuePrecision(valNotConflict, mergedProps);\n  };\n\n  Range.prototype.ensureValueNotConflict = function ensureValueNotConflict(val, _ref) {\n    var allowCross = _ref.allowCross;\n\n    var state = this.state || {};\n    var handle = state.handle,\n        bounds = state.bounds;\n    /* eslint-disable eqeqeq */\n\n    if (!allowCross && handle != null) {\n      if (handle > 0 && val <= bounds[handle - 1]) {\n        return bounds[handle - 1];\n      }\n      if (handle < bounds.length - 1 && val >= bounds[handle + 1]) {\n        return bounds[handle + 1];\n      }\n    }\n    /* eslint-enable eqeqeq */\n    return val;\n  };\n\n  Range.prototype.render = function render() {\n    var _this4 = this;\n\n    var _state2 = this.state,\n        handle = _state2.handle,\n        bounds = _state2.bounds;\n    var _props2 = this.props,\n        prefixCls = _props2.prefixCls,\n        vertical = _props2.vertical,\n        included = _props2.included,\n        disabled = _props2.disabled,\n        min = _props2.min,\n        max = _props2.max,\n        handleGenerator = _props2.handle,\n        trackStyle = _props2.trackStyle,\n        handleStyle = _props2.handleStyle;\n\n\n    var offsets = bounds.map(function (v) {\n      return _this4.calcOffset(v);\n    });\n\n    var handleClassName = prefixCls + '-handle';\n    var handles = bounds.map(function (v, i) {\n      var _classNames;\n\n      return handleGenerator({\n        className: (0, _classnames2.default)((_classNames = {}, _classNames[handleClassName] = true, _classNames[handleClassName + '-' + (i + 1)] = true, _classNames)),\n        vertical: vertical,\n        offset: offsets[i],\n        value: v,\n        dragging: handle === i,\n        index: i,\n        min: min,\n        max: max,\n        disabled: disabled,\n        style: handleStyle[i],\n        ref: function ref(h) {\n          return _this4.saveHandle(i, h);\n        }\n      });\n    });\n\n    var tracks = bounds.slice(0, -1).map(function (_, index) {\n      var _classNames2;\n\n      var i = index + 1;\n      var trackClassName = (0, _classnames2.default)((_classNames2 = {}, _classNames2[prefixCls + '-track'] = true, _classNames2[prefixCls + '-track-' + i] = true, _classNames2));\n      return (0, _preact.h)(_Track2.default, {\n        className: trackClassName,\n        vertical: vertical,\n        included: included,\n        offset: offsets[i - 1],\n        length: offsets[i] - offsets[i - 1],\n        style: trackStyle[index],\n        key: i\n      });\n    });\n\n    return { tracks: tracks, handles: handles };\n  };\n\n  return Range;\n}(_preact.Component);\n\nRange.defaultProps = {\n  count: 1,\n  allowCross: true,\n  pushable: false\n};\nexports.default = (0, _createSlider2.default)(Range);","\"use strict\";\n\nvar memo = {};\n\n/* istanbul ignore next  */\nfunction getTarget(target) {\n  if (typeof memo[target] === \"undefined\") {\n    var styleTarget = document.querySelector(target);\n\n    // Special case to return head of iframe instead of iframe itself\n    if (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n      try {\n        // This will throw an exception if access to iframe is blocked\n        // due to cross-origin restrictions\n        styleTarget = styleTarget.contentDocument.head;\n      } catch (e) {\n        // istanbul ignore next\n        styleTarget = null;\n      }\n    }\n    memo[target] = styleTarget;\n  }\n  return memo[target];\n}\n\n/* istanbul ignore next  */\nfunction insertBySelector(insert, style) {\n  var target = getTarget(insert);\n  if (!target) {\n    throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");\n  }\n  target.appendChild(style);\n}\nmodule.exports = insertBySelector;","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.rc-slider {\n  position: relative;\n  height: 14px;\n  padding: 5px 0;\n  width: 100%;\n  border-radius: 6px;\n  -ms-touch-action: none;\n      touch-action: none;\n  box-sizing: border-box;\n  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n}\n.rc-slider * {\n  box-sizing: border-box;\n  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n}\n.rc-slider-rail {\n  position: absolute;\n  width: 100%;\n  background-color: #e9e9e9;\n  height: 4px;\n  border-radius: 6px;\n}\n.rc-slider-track {\n  position: absolute;\n  left: 0;\n  height: 4px;\n  border-radius: 6px;\n  background-color: #abe2fb;\n}\n.rc-slider-handle {\n  position: absolute;\n  margin-left: -7px;\n  margin-top: -5px;\n  width: 14px;\n  height: 14px;\n  cursor: pointer;\n  cursor: -webkit-grab;\n  cursor: grab;\n  border-radius: 50%;\n  border: solid 2px #96dbfa;\n  background-color: #fff;\n  -ms-touch-action: pan-x;\n      touch-action: pan-x;\n}\n.rc-slider-handle:hover {\n  border-color: #57c5f7;\n}\n.rc-slider-handle:active {\n  border-color: #57c5f7;\n  box-shadow: 0 0 5px #57c5f7;\n  cursor: -webkit-grabbing;\n  cursor: grabbing;\n}\n.rc-slider-handle:focus {\n  border-color: #57c5f7;\n  box-shadow: 0 0 0 5px #96dbfa;\n  outline: none;\n}\n.rc-slider-mark {\n  position: absolute;\n  top: 18px;\n  left: 0;\n  width: 100%;\n  font-size: 12px;\n}\n.rc-slider-mark-text {\n  position: absolute;\n  display: inline-block;\n  vertical-align: middle;\n  text-align: center;\n  cursor: pointer;\n  color: #999;\n}\n.rc-slider-mark-text-active {\n  color: #666;\n}\n.rc-slider-step {\n  position: absolute;\n  width: 100%;\n  height: 4px;\n  background: transparent;\n}\n.rc-slider-dot {\n  position: absolute;\n  bottom: -2px;\n  margin-left: -4px;\n  width: 8px;\n  height: 8px;\n  border: 2px solid #e9e9e9;\n  background-color: #fff;\n  cursor: pointer;\n  border-radius: 50%;\n  vertical-align: middle;\n}\n.rc-slider-dot:first-child {\n  margin-left: -4px;\n}\n.rc-slider-dot:last-child {\n  margin-left: -4px;\n}\n.rc-slider-dot-active {\n  border-color: #96dbfa;\n}\n.rc-slider-disabled {\n  background-color: #e9e9e9;\n}\n.rc-slider-disabled .rc-slider-track {\n  background-color: #ccc;\n}\n.rc-slider-disabled .rc-slider-handle,\n.rc-slider-disabled .rc-slider-dot {\n  border-color: #ccc;\n  box-shadow: none;\n  background-color: #fff;\n  cursor: not-allowed;\n}\n.rc-slider-disabled .rc-slider-mark-text,\n.rc-slider-disabled .rc-slider-dot {\n  cursor: not-allowed !important;\n}\n.rc-slider-vertical {\n  width: 14px;\n  height: 100%;\n  padding: 0 5px;\n}\n.rc-slider-vertical .rc-slider-rail {\n  height: 100%;\n  width: 4px;\n}\n.rc-slider-vertical .rc-slider-track {\n  left: 5px;\n  bottom: 0;\n  width: 4px;\n}\n.rc-slider-vertical .rc-slider-handle {\n  margin-left: -5px;\n  margin-bottom: -7px;\n  -ms-touch-action: pan-y;\n      touch-action: pan-y;\n}\n.rc-slider-vertical .rc-slider-mark {\n  top: 0;\n  left: 18px;\n  height: 100%;\n}\n.rc-slider-vertical .rc-slider-step {\n  height: 100%;\n  width: 4px;\n}\n.rc-slider-vertical .rc-slider-dot {\n  left: 2px;\n  margin-bottom: -4px;\n}\n.rc-slider-vertical .rc-slider-dot:first-child {\n  margin-bottom: -4px;\n}\n.rc-slider-vertical .rc-slider-dot:last-child {\n  margin-bottom: -4px;\n}\n.rc-slider-tooltip-zoom-down-enter,\n.rc-slider-tooltip-zoom-down-appear {\n  -webkit-animation-duration: .3s;\n          animation-duration: .3s;\n  -webkit-animation-fill-mode: both;\n          animation-fill-mode: both;\n  display: block !important;\n  -webkit-animation-play-state: paused;\n          animation-play-state: paused;\n}\n.rc-slider-tooltip-zoom-down-leave {\n  -webkit-animation-duration: .3s;\n          animation-duration: .3s;\n  -webkit-animation-fill-mode: both;\n          animation-fill-mode: both;\n  display: block !important;\n  -webkit-animation-play-state: paused;\n          animation-play-state: paused;\n}\n.rc-slider-tooltip-zoom-down-enter.rc-slider-tooltip-zoom-down-enter-active,\n.rc-slider-tooltip-zoom-down-appear.rc-slider-tooltip-zoom-down-appear-active {\n  -webkit-animation-name: rcSliderTooltipZoomDownIn;\n          animation-name: rcSliderTooltipZoomDownIn;\n  -webkit-animation-play-state: running;\n          animation-play-state: running;\n}\n.rc-slider-tooltip-zoom-down-leave.rc-slider-tooltip-zoom-down-leave-active {\n  -webkit-animation-name: rcSliderTooltipZoomDownOut;\n          animation-name: rcSliderTooltipZoomDownOut;\n  -webkit-animation-play-state: running;\n          animation-play-state: running;\n}\n.rc-slider-tooltip-zoom-down-enter,\n.rc-slider-tooltip-zoom-down-appear {\n  -webkit-transform: scale(0, 0);\n          transform: scale(0, 0);\n  -webkit-animation-timing-function: cubic-bezier(0.23, 1, 0.32, 1);\n          animation-timing-function: cubic-bezier(0.23, 1, 0.32, 1);\n}\n.rc-slider-tooltip-zoom-down-leave {\n  -webkit-animation-timing-function: cubic-bezier(0.755, 0.05, 0.855, 0.06);\n          animation-timing-function: cubic-bezier(0.755, 0.05, 0.855, 0.06);\n}\n@-webkit-keyframes rcSliderTooltipZoomDownIn {\n  0% {\n    opacity: 0;\n    -webkit-transform-origin: 50% 100%;\n            transform-origin: 50% 100%;\n    -webkit-transform: scale(0, 0);\n            transform: scale(0, 0);\n  }\n  100% {\n    -webkit-transform-origin: 50% 100%;\n            transform-origin: 50% 100%;\n    -webkit-transform: scale(1, 1);\n            transform: scale(1, 1);\n  }\n}\n@keyframes rcSliderTooltipZoomDownIn {\n  0% {\n    opacity: 0;\n    -webkit-transform-origin: 50% 100%;\n            transform-origin: 50% 100%;\n    -webkit-transform: scale(0, 0);\n            transform: scale(0, 0);\n  }\n  100% {\n    -webkit-transform-origin: 50% 100%;\n            transform-origin: 50% 100%;\n    -webkit-transform: scale(1, 1);\n            transform: scale(1, 1);\n  }\n}\n@-webkit-keyframes rcSliderTooltipZoomDownOut {\n  0% {\n    -webkit-transform-origin: 50% 100%;\n            transform-origin: 50% 100%;\n    -webkit-transform: scale(1, 1);\n            transform: scale(1, 1);\n  }\n  100% {\n    opacity: 0;\n    -webkit-transform-origin: 50% 100%;\n            transform-origin: 50% 100%;\n    -webkit-transform: scale(0, 0);\n            transform: scale(0, 0);\n  }\n}\n@keyframes rcSliderTooltipZoomDownOut {\n  0% {\n    -webkit-transform-origin: 50% 100%;\n            transform-origin: 50% 100%;\n    -webkit-transform: scale(1, 1);\n            transform: scale(1, 1);\n  }\n  100% {\n    opacity: 0;\n    -webkit-transform-origin: 50% 100%;\n            transform-origin: 50% 100%;\n    -webkit-transform: scale(0, 0);\n            transform: scale(0, 0);\n  }\n}\n.rc-slider-tooltip {\n  position: absolute;\n  left: -9999px;\n  top: -9999px;\n  visibility: visible;\n  box-sizing: border-box;\n  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n}\n.rc-slider-tooltip * {\n  box-sizing: border-box;\n  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n}\n.rc-slider-tooltip-hidden {\n  display: none;\n}\n.rc-slider-tooltip-placement-top {\n  padding: 4px 0 8px 0;\n}\n.rc-slider-tooltip-inner {\n  padding: 6px 2px;\n  min-width: 24px;\n  height: 24px;\n  font-size: 12px;\n  line-height: 1;\n  color: #fff;\n  text-align: center;\n  text-decoration: none;\n  background-color: #6c6c6c;\n  border-radius: 6px;\n  box-shadow: 0 0 4px #d9d9d9;\n}\n.rc-slider-tooltip-arrow {\n  position: absolute;\n  width: 0;\n  height: 0;\n  border-color: transparent;\n  border-style: solid;\n}\n.rc-slider-tooltip-placement-top .rc-slider-tooltip-arrow {\n  bottom: 4px;\n  left: 50%;\n  margin-left: -4px;\n  border-width: 4px 4px 0;\n  border-top-color: #6c6c6c;\n}\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./node_modules/rc-slider-preact/lib/index.css\"],\"names\":[],\"mappings\":\"AAAA;EACE,kBAAkB;EAClB,YAAY;EACZ,cAAc;EACd,WAAW;EACX,kBAAkB;EAClB,sBAAsB;MAClB,kBAAkB;EACtB,sBAAsB;EACtB,6CAA6C;AAC/C;AACA;EACE,sBAAsB;EACtB,6CAA6C;AAC/C;AACA;EACE,kBAAkB;EAClB,WAAW;EACX,yBAAyB;EACzB,WAAW;EACX,kBAAkB;AACpB;AACA;EACE,kBAAkB;EAClB,OAAO;EACP,WAAW;EACX,kBAAkB;EAClB,yBAAyB;AAC3B;AACA;EACE,kBAAkB;EAClB,iBAAiB;EACjB,gBAAgB;EAChB,WAAW;EACX,YAAY;EACZ,eAAe;EACf,oBAAoB;EACpB,YAAY;EACZ,kBAAkB;EAClB,yBAAyB;EACzB,sBAAsB;EACtB,uBAAuB;MACnB,mBAAmB;AACzB;AACA;EACE,qBAAqB;AACvB;AACA;EACE,qBAAqB;EACrB,2BAA2B;EAC3B,wBAAwB;EACxB,gBAAgB;AAClB;AACA;EACE,qBAAqB;EACrB,6BAA6B;EAC7B,aAAa;AACf;AACA;EACE,kBAAkB;EAClB,SAAS;EACT,OAAO;EACP,WAAW;EACX,eAAe;AACjB;AACA;EACE,kBAAkB;EAClB,qBAAqB;EACrB,sBAAsB;EACtB,kBAAkB;EAClB,eAAe;EACf,WAAW;AACb;AACA;EACE,WAAW;AACb;AACA;EACE,kBAAkB;EAClB,WAAW;EACX,WAAW;EACX,uBAAuB;AACzB;AACA;EACE,kBAAkB;EAClB,YAAY;EACZ,iBAAiB;EACjB,UAAU;EACV,WAAW;EACX,yBAAyB;EACzB,sBAAsB;EACtB,eAAe;EACf,kBAAkB;EAClB,sBAAsB;AACxB;AACA;EACE,iBAAiB;AACnB;AACA;EACE,iBAAiB;AACnB;AACA;EACE,qBAAqB;AACvB;AACA;EACE,yBAAyB;AAC3B;AACA;EACE,sBAAsB;AACxB;AACA;;EAEE,kBAAkB;EAClB,gBAAgB;EAChB,sBAAsB;EACtB,mBAAmB;AACrB;AACA;;EAEE,8BAA8B;AAChC;AACA;EACE,WAAW;EACX,YAAY;EACZ,cAAc;AAChB;AACA;EACE,YAAY;EACZ,UAAU;AACZ;AACA;EACE,SAAS;EACT,SAAS;EACT,UAAU;AACZ;AACA;EACE,iBAAiB;EACjB,mBAAmB;EACnB,uBAAuB;MACnB,mBAAmB;AACzB;AACA;EACE,MAAM;EACN,UAAU;EACV,YAAY;AACd;AACA;EACE,YAAY;EACZ,UAAU;AACZ;AACA;EACE,SAAS;EACT,mBAAmB;AACrB;AACA;EACE,mBAAmB;AACrB;AACA;EACE,mBAAmB;AACrB;AACA;;EAEE,+BAA+B;UACvB,uBAAuB;EAC/B,iCAAiC;UACzB,yBAAyB;EACjC,yBAAyB;EACzB,oCAAoC;UAC5B,4BAA4B;AACtC;AACA;EACE,+BAA+B;UACvB,uBAAuB;EAC/B,iCAAiC;UACzB,yBAAyB;EACjC,yBAAyB;EACzB,oCAAoC;UAC5B,4BAA4B;AACtC;AACA;;EAEE,iDAAiD;UACzC,yCAAyC;EACjD,qCAAqC;UAC7B,6BAA6B;AACvC;AACA;EACE,kDAAkD;UAC1C,0CAA0C;EAClD,qCAAqC;UAC7B,6BAA6B;AACvC;AACA;;EAEE,8BAA8B;UACtB,sBAAsB;EAC9B,iEAAiE;UACzD,yDAAyD;AACnE;AACA;EACE,yEAAyE;UACjE,iEAAiE;AAC3E;AACA;EACE;IACE,UAAU;IACV,kCAAkC;YAC1B,0BAA0B;IAClC,8BAA8B;YACtB,sBAAsB;EAChC;EACA;IACE,kCAAkC;YAC1B,0BAA0B;IAClC,8BAA8B;YACtB,sBAAsB;EAChC;AACF;AACA;EACE;IACE,UAAU;IACV,kCAAkC;YAC1B,0BAA0B;IAClC,8BAA8B;YACtB,sBAAsB;EAChC;EACA;IACE,kCAAkC;YAC1B,0BAA0B;IAClC,8BAA8B;YACtB,sBAAsB;EAChC;AACF;AACA;EACE;IACE,kCAAkC;YAC1B,0BAA0B;IAClC,8BAA8B;YACtB,sBAAsB;EAChC;EACA;IACE,UAAU;IACV,kCAAkC;YAC1B,0BAA0B;IAClC,8BAA8B;YACtB,sBAAsB;EAChC;AACF;AACA;EACE;IACE,kCAAkC;YAC1B,0BAA0B;IAClC,8BAA8B;YACtB,sBAAsB;EAChC;EACA;IACE,UAAU;IACV,kCAAkC;YAC1B,0BAA0B;IAClC,8BAA8B;YACtB,sBAAsB;EAChC;AACF;AACA;EACE,kBAAkB;EAClB,aAAa;EACb,YAAY;EACZ,mBAAmB;EACnB,sBAAsB;EACtB,6CAA6C;AAC/C;AACA;EACE,sBAAsB;EACtB,6CAA6C;AAC/C;AACA;EACE,aAAa;AACf;AACA;EACE,oBAAoB;AACtB;AACA;EACE,gBAAgB;EAChB,eAAe;EACf,YAAY;EACZ,eAAe;EACf,cAAc;EACd,WAAW;EACX,kBAAkB;EAClB,qBAAqB;EACrB,yBAAyB;EACzB,kBAAkB;EAClB,2BAA2B;AAC7B;AACA;EACE,kBAAkB;EAClB,QAAQ;EACR,SAAS;EACT,yBAAyB;EACzB,mBAAmB;AACrB;AACA;EACE,WAAW;EACX,SAAS;EACT,iBAAiB;EACjB,uBAAuB;EACvB,yBAAyB;AAC3B\",\"sourcesContent\":[\".rc-slider {\\n  position: relative;\\n  height: 14px;\\n  padding: 5px 0;\\n  width: 100%;\\n  border-radius: 6px;\\n  -ms-touch-action: none;\\n      touch-action: none;\\n  box-sizing: border-box;\\n  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\\n}\\n.rc-slider * {\\n  box-sizing: border-box;\\n  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\\n}\\n.rc-slider-rail {\\n  position: absolute;\\n  width: 100%;\\n  background-color: #e9e9e9;\\n  height: 4px;\\n  border-radius: 6px;\\n}\\n.rc-slider-track {\\n  position: absolute;\\n  left: 0;\\n  height: 4px;\\n  border-radius: 6px;\\n  background-color: #abe2fb;\\n}\\n.rc-slider-handle {\\n  position: absolute;\\n  margin-left: -7px;\\n  margin-top: -5px;\\n  width: 14px;\\n  height: 14px;\\n  cursor: pointer;\\n  cursor: -webkit-grab;\\n  cursor: grab;\\n  border-radius: 50%;\\n  border: solid 2px #96dbfa;\\n  background-color: #fff;\\n  -ms-touch-action: pan-x;\\n      touch-action: pan-x;\\n}\\n.rc-slider-handle:hover {\\n  border-color: #57c5f7;\\n}\\n.rc-slider-handle:active {\\n  border-color: #57c5f7;\\n  box-shadow: 0 0 5px #57c5f7;\\n  cursor: -webkit-grabbing;\\n  cursor: grabbing;\\n}\\n.rc-slider-handle:focus {\\n  border-color: #57c5f7;\\n  box-shadow: 0 0 0 5px #96dbfa;\\n  outline: none;\\n}\\n.rc-slider-mark {\\n  position: absolute;\\n  top: 18px;\\n  left: 0;\\n  width: 100%;\\n  font-size: 12px;\\n}\\n.rc-slider-mark-text {\\n  position: absolute;\\n  display: inline-block;\\n  vertical-align: middle;\\n  text-align: center;\\n  cursor: pointer;\\n  color: #999;\\n}\\n.rc-slider-mark-text-active {\\n  color: #666;\\n}\\n.rc-slider-step {\\n  position: absolute;\\n  width: 100%;\\n  height: 4px;\\n  background: transparent;\\n}\\n.rc-slider-dot {\\n  position: absolute;\\n  bottom: -2px;\\n  margin-left: -4px;\\n  width: 8px;\\n  height: 8px;\\n  border: 2px solid #e9e9e9;\\n  background-color: #fff;\\n  cursor: pointer;\\n  border-radius: 50%;\\n  vertical-align: middle;\\n}\\n.rc-slider-dot:first-child {\\n  margin-left: -4px;\\n}\\n.rc-slider-dot:last-child {\\n  margin-left: -4px;\\n}\\n.rc-slider-dot-active {\\n  border-color: #96dbfa;\\n}\\n.rc-slider-disabled {\\n  background-color: #e9e9e9;\\n}\\n.rc-slider-disabled .rc-slider-track {\\n  background-color: #ccc;\\n}\\n.rc-slider-disabled .rc-slider-handle,\\n.rc-slider-disabled .rc-slider-dot {\\n  border-color: #ccc;\\n  box-shadow: none;\\n  background-color: #fff;\\n  cursor: not-allowed;\\n}\\n.rc-slider-disabled .rc-slider-mark-text,\\n.rc-slider-disabled .rc-slider-dot {\\n  cursor: not-allowed !important;\\n}\\n.rc-slider-vertical {\\n  width: 14px;\\n  height: 100%;\\n  padding: 0 5px;\\n}\\n.rc-slider-vertical .rc-slider-rail {\\n  height: 100%;\\n  width: 4px;\\n}\\n.rc-slider-vertical .rc-slider-track {\\n  left: 5px;\\n  bottom: 0;\\n  width: 4px;\\n}\\n.rc-slider-vertical .rc-slider-handle {\\n  margin-left: -5px;\\n  margin-bottom: -7px;\\n  -ms-touch-action: pan-y;\\n      touch-action: pan-y;\\n}\\n.rc-slider-vertical .rc-slider-mark {\\n  top: 0;\\n  left: 18px;\\n  height: 100%;\\n}\\n.rc-slider-vertical .rc-slider-step {\\n  height: 100%;\\n  width: 4px;\\n}\\n.rc-slider-vertical .rc-slider-dot {\\n  left: 2px;\\n  margin-bottom: -4px;\\n}\\n.rc-slider-vertical .rc-slider-dot:first-child {\\n  margin-bottom: -4px;\\n}\\n.rc-slider-vertical .rc-slider-dot:last-child {\\n  margin-bottom: -4px;\\n}\\n.rc-slider-tooltip-zoom-down-enter,\\n.rc-slider-tooltip-zoom-down-appear {\\n  -webkit-animation-duration: .3s;\\n          animation-duration: .3s;\\n  -webkit-animation-fill-mode: both;\\n          animation-fill-mode: both;\\n  display: block !important;\\n  -webkit-animation-play-state: paused;\\n          animation-play-state: paused;\\n}\\n.rc-slider-tooltip-zoom-down-leave {\\n  -webkit-animation-duration: .3s;\\n          animation-duration: .3s;\\n  -webkit-animation-fill-mode: both;\\n          animation-fill-mode: both;\\n  display: block !important;\\n  -webkit-animation-play-state: paused;\\n          animation-play-state: paused;\\n}\\n.rc-slider-tooltip-zoom-down-enter.rc-slider-tooltip-zoom-down-enter-active,\\n.rc-slider-tooltip-zoom-down-appear.rc-slider-tooltip-zoom-down-appear-active {\\n  -webkit-animation-name: rcSliderTooltipZoomDownIn;\\n          animation-name: rcSliderTooltipZoomDownIn;\\n  -webkit-animation-play-state: running;\\n          animation-play-state: running;\\n}\\n.rc-slider-tooltip-zoom-down-leave.rc-slider-tooltip-zoom-down-leave-active {\\n  -webkit-animation-name: rcSliderTooltipZoomDownOut;\\n          animation-name: rcSliderTooltipZoomDownOut;\\n  -webkit-animation-play-state: running;\\n          animation-play-state: running;\\n}\\n.rc-slider-tooltip-zoom-down-enter,\\n.rc-slider-tooltip-zoom-down-appear {\\n  -webkit-transform: scale(0, 0);\\n          transform: scale(0, 0);\\n  -webkit-animation-timing-function: cubic-bezier(0.23, 1, 0.32, 1);\\n          animation-timing-function: cubic-bezier(0.23, 1, 0.32, 1);\\n}\\n.rc-slider-tooltip-zoom-down-leave {\\n  -webkit-animation-timing-function: cubic-bezier(0.755, 0.05, 0.855, 0.06);\\n          animation-timing-function: cubic-bezier(0.755, 0.05, 0.855, 0.06);\\n}\\n@-webkit-keyframes rcSliderTooltipZoomDownIn {\\n  0% {\\n    opacity: 0;\\n    -webkit-transform-origin: 50% 100%;\\n            transform-origin: 50% 100%;\\n    -webkit-transform: scale(0, 0);\\n            transform: scale(0, 0);\\n  }\\n  100% {\\n    -webkit-transform-origin: 50% 100%;\\n            transform-origin: 50% 100%;\\n    -webkit-transform: scale(1, 1);\\n            transform: scale(1, 1);\\n  }\\n}\\n@keyframes rcSliderTooltipZoomDownIn {\\n  0% {\\n    opacity: 0;\\n    -webkit-transform-origin: 50% 100%;\\n            transform-origin: 50% 100%;\\n    -webkit-transform: scale(0, 0);\\n            transform: scale(0, 0);\\n  }\\n  100% {\\n    -webkit-transform-origin: 50% 100%;\\n            transform-origin: 50% 100%;\\n    -webkit-transform: scale(1, 1);\\n            transform: scale(1, 1);\\n  }\\n}\\n@-webkit-keyframes rcSliderTooltipZoomDownOut {\\n  0% {\\n    -webkit-transform-origin: 50% 100%;\\n            transform-origin: 50% 100%;\\n    -webkit-transform: scale(1, 1);\\n            transform: scale(1, 1);\\n  }\\n  100% {\\n    opacity: 0;\\n    -webkit-transform-origin: 50% 100%;\\n            transform-origin: 50% 100%;\\n    -webkit-transform: scale(0, 0);\\n            transform: scale(0, 0);\\n  }\\n}\\n@keyframes rcSliderTooltipZoomDownOut {\\n  0% {\\n    -webkit-transform-origin: 50% 100%;\\n            transform-origin: 50% 100%;\\n    -webkit-transform: scale(1, 1);\\n            transform: scale(1, 1);\\n  }\\n  100% {\\n    opacity: 0;\\n    -webkit-transform-origin: 50% 100%;\\n            transform-origin: 50% 100%;\\n    -webkit-transform: scale(0, 0);\\n            transform: scale(0, 0);\\n  }\\n}\\n.rc-slider-tooltip {\\n  position: absolute;\\n  left: -9999px;\\n  top: -9999px;\\n  visibility: visible;\\n  box-sizing: border-box;\\n  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\\n}\\n.rc-slider-tooltip * {\\n  box-sizing: border-box;\\n  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\\n}\\n.rc-slider-tooltip-hidden {\\n  display: none;\\n}\\n.rc-slider-tooltip-placement-top {\\n  padding: 4px 0 8px 0;\\n}\\n.rc-slider-tooltip-inner {\\n  padding: 6px 2px;\\n  min-width: 24px;\\n  height: 24px;\\n  font-size: 12px;\\n  line-height: 1;\\n  color: #fff;\\n  text-align: center;\\n  text-decoration: none;\\n  background-color: #6c6c6c;\\n  border-radius: 6px;\\n  box-shadow: 0 0 4px #d9d9d9;\\n}\\n.rc-slider-tooltip-arrow {\\n  position: absolute;\\n  width: 0;\\n  height: 0;\\n  border-color: transparent;\\n  border-style: solid;\\n}\\n.rc-slider-tooltip-placement-top .rc-slider-tooltip-arrow {\\n  bottom: 4px;\\n  left: 50%;\\n  margin-left: -4px;\\n  border-width: 4px 4px 0;\\n  border-top-color: #6c6c6c;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","'use strict';\n\nexports.__esModule = true;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nexports.default = createSlider;\n\nvar _preact = require('preact');\n\nvar _addDomEventListener = require('add-dom-event-listener');\n\nvar _addDomEventListener2 = _interopRequireDefault(_addDomEventListener);\n\nvar _classnames = require('classnames');\n\nvar _classnames2 = _interopRequireDefault(_classnames);\n\nvar _Steps = require('./Steps');\n\nvar _Steps2 = _interopRequireDefault(_Steps);\n\nvar _Marks = require('./Marks');\n\nvar _Marks2 = _interopRequireDefault(_Marks);\n\nvar _Handle = require('./Handle');\n\nvar _Handle2 = _interopRequireDefault(_Handle);\n\nvar _util = require('./util');\n\nvar util = _interopRequireWildcard(_util);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /** @jsx h */\n\n\nfunction noop() {}\n\nfunction createSlider(Component) {\n  var _class, _temp;\n\n  return _temp = _class = function (_Component) {\n    _inherits(ComponentEnhancer, _Component);\n\n    function ComponentEnhancer(props) {\n      _classCallCheck(this, ComponentEnhancer);\n\n      var _this = _possibleConstructorReturn(this, _Component.call(this, props));\n\n      _this.onMouseDown = function (e) {\n        if (e.button !== 0) {\n          return;\n        }\n\n        var isVertical = _this.props.vertical;\n        var position = util.getMousePosition(isVertical, e);\n        if (!util.isEventFromHandle(e, _this.handlesRefs)) {\n          _this.dragOffset = 0;\n        } else {\n          var handlePosition = util.getHandleCenterPosition(isVertical, e.target);\n          _this.dragOffset = position - handlePosition;\n          position = handlePosition;\n        }\n        _this.onStart(position);\n        _this.addDocumentMouseEvents();\n        util.pauseEvent(e);\n      };\n\n      _this.onTouchStart = function (e) {\n        if (util.isNotTouchEvent(e)) return;\n\n        var isVertical = _this.props.vertical;\n        var position = util.getTouchPosition(isVertical, e);\n        if (!util.isEventFromHandle(e, _this.handlesRefs)) {\n          _this.dragOffset = 0;\n        } else {\n          var handlePosition = util.getHandleCenterPosition(isVertical, e.target);\n          _this.dragOffset = position - handlePosition;\n          position = handlePosition;\n        }\n        _this.onStart(position);\n        _this.addDocumentTouchEvents();\n        util.pauseEvent(e);\n      };\n\n      _this.onFocus = function (e) {\n        var isVertical = _this.props.vertical;\n\n        if (util.isEventFromHandle(e, _this.handlesRefs)) {\n          var handlePosition = util.getHandleCenterPosition(isVertical, e.target);\n\n          _this.dragOffset = 0;\n          _this.onStart(handlePosition);\n          util.pauseEvent(e);\n        }\n      };\n\n      _this.onBlur = function (e) {\n        _this.onEnd(e);\n      };\n\n      _this.onMouseMove = function (e) {\n        if (!_this.sliderRef) {\n          _this.onEnd();\n          return;\n        }\n        var position = util.getMousePosition(_this.props.vertical, e);\n        _this.onMove(e, position - _this.dragOffset);\n      };\n\n      _this.onTouchMove = function (e) {\n        if (util.isNotTouchEvent(e) || !_this.sliderRef) {\n          _this.onEnd();\n          return;\n        }\n\n        var position = util.getTouchPosition(_this.props.vertical, e);\n        _this.onMove(e, position - _this.dragOffset);\n      };\n\n      _this.onKeyDown = function (e) {\n        if (_this.sliderRef && util.isEventFromHandle(e, _this.handlesRefs)) {\n          _this.onKeyboard(e);\n        }\n      };\n\n      _this.saveSlider = function (slider) {\n        _this.sliderRef = slider;\n      };\n\n      _this.handlesRefs = {};\n      return _this;\n    }\n\n    ComponentEnhancer.prototype.componentWillUnmount = function componentWillUnmount() {\n      if (_Component.prototype.componentWillUnmount) _Component.prototype.componentWillUnmount.call(this);\n      this.removeDocumentEvents();\n    };\n\n    ComponentEnhancer.prototype.addDocumentTouchEvents = function addDocumentTouchEvents() {\n      // just work for Chrome iOS Safari and Android Browser\n      this.onTouchMoveListener = (0, _addDomEventListener2.default)(document, 'touchmove', this.onTouchMove);\n      this.onTouchUpListener = (0, _addDomEventListener2.default)(document, 'touchend', this.onEnd);\n    };\n\n    ComponentEnhancer.prototype.addDocumentMouseEvents = function addDocumentMouseEvents() {\n      this.onMouseMoveListener = (0, _addDomEventListener2.default)(document, 'mousemove', this.onMouseMove);\n      this.onMouseUpListener = (0, _addDomEventListener2.default)(document, 'mouseup', this.onEnd);\n    };\n\n    ComponentEnhancer.prototype.removeDocumentEvents = function removeDocumentEvents() {\n      /* eslint-disable no-unused-expressions */\n      this.onTouchMoveListener && this.onTouchMoveListener.remove();\n      this.onTouchUpListener && this.onTouchUpListener.remove();\n\n      this.onMouseMoveListener && this.onMouseMoveListener.remove();\n      this.onMouseUpListener && this.onMouseUpListener.remove();\n      /* eslint-enable no-unused-expressions */\n    };\n\n    ComponentEnhancer.prototype.getSliderStart = function getSliderStart() {\n      var slider = this.sliderRef;\n      var rect = slider.getBoundingClientRect();\n\n      return this.props.vertical ? rect.top : rect.left;\n    };\n\n    ComponentEnhancer.prototype.getSliderLength = function getSliderLength() {\n      var slider = this.sliderRef;\n      if (!slider) {\n        return 0;\n      }\n\n      var coords = slider.getBoundingClientRect();\n      return this.props.vertical ? coords.height : coords.width;\n    };\n\n    ComponentEnhancer.prototype.calcValue = function calcValue(offset) {\n      var _props = this.props,\n          vertical = _props.vertical,\n          min = _props.min,\n          max = _props.max;\n\n      var ratio = Math.abs(Math.max(offset, 0) / this.getSliderLength());\n      var value = vertical ? (1 - ratio) * (max - min) + min : ratio * (max - min) + min;\n      return value;\n    };\n\n    ComponentEnhancer.prototype.calcValueByPos = function calcValueByPos(position) {\n      var pixelOffset = position - this.getSliderStart();\n      var nextValue = this.trimAlignValue(this.calcValue(pixelOffset));\n      return nextValue;\n    };\n\n    ComponentEnhancer.prototype.calcOffset = function calcOffset(value) {\n      var _props2 = this.props,\n          min = _props2.min,\n          max = _props2.max;\n\n      var ratio = (value - min) / (max - min);\n      return ratio * 100;\n    };\n\n    ComponentEnhancer.prototype.saveHandle = function saveHandle(index, handle) {\n      this.handlesRefs[index] = handle;\n    };\n\n    ComponentEnhancer.prototype.render = function render() {\n      var _classNames;\n\n      var _props3 = this.props,\n          prefixCls = _props3.prefixCls,\n          className = _props3.className,\n          marks = _props3.marks,\n          dots = _props3.dots,\n          step = _props3.step,\n          included = _props3.included,\n          disabled = _props3.disabled,\n          vertical = _props3.vertical,\n          min = _props3.min,\n          max = _props3.max,\n          children = _props3.children,\n          maximumTrackStyle = _props3.maximumTrackStyle,\n          style = _props3.style,\n          railStyle = _props3.railStyle,\n          dotStyle = _props3.dotStyle,\n          activeDotStyle = _props3.activeDotStyle;\n\n      var _Component$prototype$ = _Component.prototype.render.call(this),\n          tracks = _Component$prototype$.tracks,\n          handles = _Component$prototype$.handles;\n\n      var sliderClassName = (0, _classnames2.default)(prefixCls, (_classNames = {}, _classNames[prefixCls + '-with-marks'] = Object.keys(marks).length, _classNames[prefixCls + '-disabled'] = disabled, _classNames[prefixCls + '-vertical'] = vertical, _classNames[className] = className, _classNames));\n      return (0, _preact.h)(\n        'div',\n        {\n          ref: this.saveSlider,\n          className: sliderClassName,\n          onTouchStart: disabled ? noop : this.onTouchStart,\n          onMouseDown: disabled ? noop : this.onMouseDown,\n          onKeyDown: disabled ? noop : this.onKeyDown,\n          onFocus: disabled ? noop : this.onFocus,\n          onBlur: disabled ? noop : this.onBlur,\n          style: style\n        },\n        (0, _preact.h)('div', {\n          className: prefixCls + '-rail',\n          style: _extends({}, maximumTrackStyle, railStyle)\n        }),\n        tracks,\n        (0, _preact.h)(_Steps2.default, {\n          prefixCls: prefixCls,\n          vertical: vertical,\n          marks: marks,\n          dots: dots,\n          step: step,\n          included: included,\n          lowerBound: this.getLowerBound(),\n          upperBound: this.getUpperBound(),\n          max: max,\n          min: min,\n          dotStyle: dotStyle,\n          activeDotStyle: activeDotStyle\n        }),\n        handles,\n        (0, _preact.h)(_Marks2.default, {\n          className: prefixCls + '-mark',\n          vertical: vertical,\n          marks: marks,\n          included: included,\n          lowerBound: this.getLowerBound(),\n          upperBound: this.getUpperBound(),\n          max: max,\n          min: min\n        }),\n        children\n      );\n    };\n\n    return ComponentEnhancer;\n  }(Component), _class.displayName = 'ComponentEnhancer(' + Component.displayName + ')', _class.defaultProps = _extends({}, Component.defaultProps, {\n    prefixCls: 'rc-slider',\n    className: '',\n    min: 0,\n    max: 100,\n    step: 1,\n    marks: {},\n    handle: function handle(_ref) {\n      var index = _ref.index,\n          restProps = _objectWithoutProperties(_ref, ['index']);\n\n      delete restProps.dragging;\n      return (0, _preact.h)(_Handle2.default, restProps);\n    },\n\n    onBeforeChange: noop,\n    onChange: noop,\n    onAfterChange: noop,\n    included: true,\n    disabled: false,\n    dots: false,\n    vertical: false,\n    trackStyle: [{}],\n    handleStyle: [{}],\n    railStyle: {},\n    dotStyle: {},\n    activeDotStyle: {}\n  }), _temp;\n}","/**\n * @ignore\n * base event object for custom and dom event.\n * @author yiminghe@gmail.com\n */\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nfunction returnFalse() {\n  return false;\n}\n\nfunction returnTrue() {\n  return true;\n}\n\nfunction EventBaseObject() {\n  this.timeStamp = Date.now();\n  this.target = undefined;\n  this.currentTarget = undefined;\n}\n\nEventBaseObject.prototype = {\n  isEventObject: 1,\n\n  constructor: EventBaseObject,\n\n  isDefaultPrevented: returnFalse,\n\n  isPropagationStopped: returnFalse,\n\n  isImmediatePropagationStopped: returnFalse,\n\n  preventDefault: function preventDefault() {\n    this.isDefaultPrevented = returnTrue;\n  },\n\n  stopPropagation: function stopPropagation() {\n    this.isPropagationStopped = returnTrue;\n  },\n\n  stopImmediatePropagation: function stopImmediatePropagation() {\n    this.isImmediatePropagationStopped = returnTrue;\n    // fixed 1.2\n    // call stopPropagation implicitly\n    this.stopPropagation();\n  },\n\n  halt: function halt(immediate) {\n    if (immediate) {\n      this.stopImmediatePropagation();\n    } else {\n      this.stopPropagation();\n    }\n    this.preventDefault();\n  }\n};\n\nexports[\"default\"] = EventBaseObject;\nmodule.exports = exports[\"default\"];","\"use strict\";\n\n/* istanbul ignore next  */\nfunction apply(styleElement, options, obj) {\n  var css = \"\";\n  if (obj.supports) {\n    css += \"@supports (\".concat(obj.supports, \") {\");\n  }\n  if (obj.media) {\n    css += \"@media \".concat(obj.media, \" {\");\n  }\n  var needLayer = typeof obj.layer !== \"undefined\";\n  if (needLayer) {\n    css += \"@layer\".concat(obj.layer.length > 0 ? \" \".concat(obj.layer) : \"\", \" {\");\n  }\n  css += obj.css;\n  if (needLayer) {\n    css += \"}\";\n  }\n  if (obj.media) {\n    css += \"}\";\n  }\n  if (obj.supports) {\n    css += \"}\";\n  }\n  var sourceMap = obj.sourceMap;\n  if (sourceMap && typeof btoa !== \"undefined\") {\n    css += \"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))), \" */\");\n  }\n\n  // For old IE\n  /* istanbul ignore if  */\n  options.styleTagTransform(css, styleElement, options.options);\n}\nfunction removeStyleElement(styleElement) {\n  // istanbul ignore if\n  if (styleElement.parentNode === null) {\n    return false;\n  }\n  styleElement.parentNode.removeChild(styleElement);\n}\n\n/* istanbul ignore next  */\nfunction domAPI(options) {\n  if (typeof document === \"undefined\") {\n    return {\n      update: function update() {},\n      remove: function remove() {}\n    };\n  }\n  var styleElement = options.insertStyleElement(options);\n  return {\n    update: function update(obj) {\n      apply(styleElement, options, obj);\n    },\n    remove: function remove() {\n      removeStyleElement(styleElement);\n    }\n  };\n}\nmodule.exports = domAPI;","'use strict';\n\nexports.__esModule = true;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _preact = require('preact');\n\nfunction _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /** @jsx h */\n\n\nvar Handle = function (_Component) {\n  _inherits(Handle, _Component);\n\n  function Handle() {\n    _classCallCheck(this, Handle);\n\n    return _possibleConstructorReturn(this, _Component.apply(this, arguments));\n  }\n\n  Handle.prototype.render = function render() {\n    var _props = this.props,\n        className = _props.className,\n        vertical = _props.vertical,\n        offset = _props.offset,\n        style = _props.style,\n        disabled = _props.disabled,\n        min = _props.min,\n        max = _props.max,\n        value = _props.value,\n        restProps = _objectWithoutProperties(_props, ['className', 'vertical', 'offset', 'style', 'disabled', 'min', 'max', 'value']);\n\n    var postionStyle = vertical ? { bottom: offset + '%' } : { left: offset + '%' };\n    var elStyle = _extends({}, style, postionStyle);\n    var ariaProps = {};\n    if (value !== undefined) {\n      ariaProps = _extends({}, ariaProps, {\n        'aria-valuemin': min,\n        'aria-valuemax': max,\n        'aria-valuenow': value,\n        'aria-disabled': !!disabled\n      });\n    }\n    return (0, _preact.h)('div', _extends({\n      role: 'slider',\n      'aria-valuemax': 0,\n      'aria-valuemin': 0,\n      'aria-valuenow': 0,\n      tabIndex: '0'\n    }, ariaProps, restProps, {\n      className: className,\n      style: elStyle\n    }));\n  };\n\n  return Handle;\n}(_preact.Component);\n\nexports.default = Handle;","//\n\nmodule.exports = function shallowEqual(objA, objB, compare, compareContext) {\n  var ret = compare ? compare.call(compareContext, objA, objB) : void 0;\n\n  if (ret !== void 0) {\n    return !!ret;\n  }\n\n  if (objA === objB) {\n    return true;\n  }\n\n  if (typeof objA !== \"object\" || !objA || typeof objB !== \"object\" || !objB) {\n    return false;\n  }\n\n  var keysA = Object.keys(objA);\n  var keysB = Object.keys(objB);\n\n  if (keysA.length !== keysB.length) {\n    return false;\n  }\n\n  var bHasOwnProperty = Object.prototype.hasOwnProperty.bind(objB);\n\n  // Test for A's keys different from B.\n  for (var idx = 0; idx < keysA.length; idx++) {\n    var key = keysA[idx];\n\n    if (!bHasOwnProperty(key)) {\n      return false;\n    }\n\n    var valueA = objA[key];\n    var valueB = objB[key];\n\n    ret = compare ? compare.call(compareContext, valueA, valueB, key) : void 0;\n\n    if (ret === false || (ret === void 0 && valueA !== valueB)) {\n      return false;\n    }\n  }\n\n  return true;\n};\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.escher-container .scaleEditor * {\r\n  font-size: 12px;\r\n  color: #777;\r\n  box-sizing: border-box;\r\n}\r\n\r\n.escher-container .scaleEditor {\r\n  position: relative;\r\n  display: flex;\r\n  justify-content: center;\r\n  flex-direction: column;\r\n}\r\n\r\n.escher-container .scaleTrack {\r\n  position: relative;\r\n  display: flex;\r\n  height: 30px;\r\n  margin-bottom: 9px;\r\n  margin-top: 30px;\r\n  margin-left: 55px;\r\n  font-size: 15px;\r\n  -webkit-user-select: none;\r\n  -moz-user-select: none;\r\n  -ms-user-select: none;\r\n  user-select: none;\r\n}\r\n\r\n.escher-container .scaleTrack.disabled {\r\n  background: #f1ecfa;\r\n  color: #b19ec0;\r\n  padding: 4px 0;\r\n  justify-content: center;\r\n}\r\n\r\n.escher-container .gradient {\r\n  position: absolute;\r\n  width: 100%;\r\n  height: 100%;\r\n  cursor: pointer;\r\n}\r\n\r\n.escher-container .scaleLabels {\r\n  display: inline-flex;\r\n  flex-direction: column;\r\n  font-size: 12px;\r\n}\r\n\r\n.escher-container .scaleLabels label {\r\n  margin-bottom: 6px;\r\n}\r\n\r\n.escher-container .noDataStyle {\r\n  position: relative;\r\n  margin-top: 20px;\r\n}\r\n\r\n.escher-container .noDataStyle .styleHeader {\r\n  font-size: 12px;\r\n  font-weight: bold;\r\n}\r\n\r\n.escher-container .noDataStyle label {\r\n  margin-right: 5px;\r\n}\r\n\r\n.escher-container .noDataStyle input[type=text] {\r\n  margin-right: 10px;\r\n  padding: 3px 0px;\r\n  width: 86px;\r\n}\r\n\r\n.escher-container .noDataStyle input[type=color] {\r\n  position: absolute;\r\n  padding: 0px;\r\n  border: 1px solid black;\r\n  left: 103px;\r\n  height: 24px;\r\n  width: 21px;\r\n}\r\n\r\n.escher-container .scaleEditor .icon-plus {\r\n  cursor: pointer;\r\n  position: absolute;\r\n  font-size: 14px;\r\n  right: 19px;\r\n}\r\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/css/ScaleSlider.css\"],\"names\":[],\"mappings\":\"AAAA;EACE,eAAe;EACf,WAAW;EACX,sBAAsB;AACxB;;AAEA;EACE,kBAAkB;EAClB,aAAa;EACb,uBAAuB;EACvB,sBAAsB;AACxB;;AAEA;EACE,kBAAkB;EAClB,aAAa;EACb,YAAY;EACZ,kBAAkB;EAClB,gBAAgB;EAChB,iBAAiB;EACjB,eAAe;EACf,yBAAyB;EACzB,sBAAsB;EACtB,qBAAqB;EACrB,iBAAiB;AACnB;;AAEA;EACE,mBAAmB;EACnB,cAAc;EACd,cAAc;EACd,uBAAuB;AACzB;;AAEA;EACE,kBAAkB;EAClB,WAAW;EACX,YAAY;EACZ,eAAe;AACjB;;AAEA;EACE,oBAAoB;EACpB,sBAAsB;EACtB,eAAe;AACjB;;AAEA;EACE,kBAAkB;AACpB;;AAEA;EACE,kBAAkB;EAClB,gBAAgB;AAClB;;AAEA;EACE,eAAe;EACf,iBAAiB;AACnB;;AAEA;EACE,iBAAiB;AACnB;;AAEA;EACE,kBAAkB;EAClB,gBAAgB;EAChB,WAAW;AACb;;AAEA;EACE,kBAAkB;EAClB,YAAY;EACZ,uBAAuB;EACvB,WAAW;EACX,YAAY;EACZ,WAAW;AACb;;AAEA;EACE,eAAe;EACf,kBAAkB;EAClB,eAAe;EACf,WAAW;AACb\",\"sourcesContent\":[\".escher-container .scaleEditor * {\\r\\n  font-size: 12px;\\r\\n  color: #777;\\r\\n  box-sizing: border-box;\\r\\n}\\r\\n\\r\\n.escher-container .scaleEditor {\\r\\n  position: relative;\\r\\n  display: flex;\\r\\n  justify-content: center;\\r\\n  flex-direction: column;\\r\\n}\\r\\n\\r\\n.escher-container .scaleTrack {\\r\\n  position: relative;\\r\\n  display: flex;\\r\\n  height: 30px;\\r\\n  margin-bottom: 9px;\\r\\n  margin-top: 30px;\\r\\n  margin-left: 55px;\\r\\n  font-size: 15px;\\r\\n  -webkit-user-select: none;\\r\\n  -moz-user-select: none;\\r\\n  -ms-user-select: none;\\r\\n  user-select: none;\\r\\n}\\r\\n\\r\\n.escher-container .scaleTrack.disabled {\\r\\n  background: #f1ecfa;\\r\\n  color: #b19ec0;\\r\\n  padding: 4px 0;\\r\\n  justify-content: center;\\r\\n}\\r\\n\\r\\n.escher-container .gradient {\\r\\n  position: absolute;\\r\\n  width: 100%;\\r\\n  height: 100%;\\r\\n  cursor: pointer;\\r\\n}\\r\\n\\r\\n.escher-container .scaleLabels {\\r\\n  display: inline-flex;\\r\\n  flex-direction: column;\\r\\n  font-size: 12px;\\r\\n}\\r\\n\\r\\n.escher-container .scaleLabels label {\\r\\n  margin-bottom: 6px;\\r\\n}\\r\\n\\r\\n.escher-container .noDataStyle {\\r\\n  position: relative;\\r\\n  margin-top: 20px;\\r\\n}\\r\\n\\r\\n.escher-container .noDataStyle .styleHeader {\\r\\n  font-size: 12px;\\r\\n  font-weight: bold;\\r\\n}\\r\\n\\r\\n.escher-container .noDataStyle label {\\r\\n  margin-right: 5px;\\r\\n}\\r\\n\\r\\n.escher-container .noDataStyle input[type=text] {\\r\\n  margin-right: 10px;\\r\\n  padding: 3px 0px;\\r\\n  width: 86px;\\r\\n}\\r\\n\\r\\n.escher-container .noDataStyle input[type=color] {\\r\\n  position: absolute;\\r\\n  padding: 0px;\\r\\n  border: 1px solid black;\\r\\n  left: 103px;\\r\\n  height: 24px;\\r\\n  width: 21px;\\r\\n}\\r\\n\\r\\n.escher-container .scaleEditor .icon-plus {\\r\\n  cursor: pointer;\\r\\n  position: absolute;\\r\\n  font-size: 14px;\\r\\n  right: 19px;\\r\\n}\\r\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","'use strict';\n\nexports.__esModule = true;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; /** @jsx h */\n\n\nvar _preact = require('preact');\n\nvar _classnames = require('classnames');\n\nvar _classnames2 = _interopRequireDefault(_classnames);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar calcPoints = function calcPoints(vertical, marks, dots, step, min, max) {\n  var points = Object.keys(marks).map(parseFloat);\n  if (dots) {\n    for (var i = min; i <= max; i = i + step) {\n      if (points.indexOf(i) >= 0) continue;\n      points.push(i);\n    }\n  }\n  return points;\n};\n\nvar Steps = function Steps(_ref) {\n  var prefixCls = _ref.prefixCls,\n      vertical = _ref.vertical,\n      marks = _ref.marks,\n      dots = _ref.dots,\n      step = _ref.step,\n      included = _ref.included,\n      lowerBound = _ref.lowerBound,\n      upperBound = _ref.upperBound,\n      max = _ref.max,\n      min = _ref.min,\n      dotStyle = _ref.dotStyle,\n      activeDotStyle = _ref.activeDotStyle;\n\n  var range = max - min;\n  var elements = calcPoints(vertical, marks, dots, step, min, max).map(function (point) {\n    var _classNames;\n\n    var offset = Math.abs(point - min) / range * 100 + '%';\n\n    var isActived = !included && point === upperBound || included && point <= upperBound && point >= lowerBound;\n    var style = vertical ? _extends({ bottom: offset }, dotStyle) : _extends({ left: offset }, dotStyle);\n    if (isActived) {\n      style = _extends({}, style, activeDotStyle);\n    }\n\n    var pointClassName = (0, _classnames2.default)((_classNames = {}, _classNames[prefixCls + '-dot'] = true, _classNames[prefixCls + '-dot-active'] = isActived, _classNames));\n\n    return (0, _preact.h)('span', { className: pointClassName, style: style, key: point });\n  });\n\n  return (0, _preact.h)(\n    'div',\n    { className: prefixCls + '-step' },\n    elements\n  );\n};\n\nexports.default = Steps;","var invariant = require('invariant');\n\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar splice = Array.prototype.splice;\n\nvar toString = Object.prototype.toString\nvar type = function(obj) {\n  return toString.call(obj).slice(8, -1);\n}\n\nvar assign = Object.assign || /* istanbul ignore next */ function assign(target, source) {\n  getAllKeys(source).forEach(function(key) {\n    if (hasOwnProperty.call(source, key)) {\n      target[key] = source[key];\n    }\n  });\n  return target;\n};\n\nvar getAllKeys = typeof Object.getOwnPropertySymbols === 'function' ?\n  function(obj) { return Object.keys(obj).concat(Object.getOwnPropertySymbols(obj)) } :\n  /* istanbul ignore next */ function(obj) { return Object.keys(obj) };\n\n/* istanbul ignore next */\nfunction copy(object) {\n  if (Array.isArray(object)) {\n    return assign(object.constructor(object.length), object)\n  } else if (type(object) === 'Map') {\n    return new Map(object)\n  } else if (type(object) === 'Set') {\n    return new Set(object)\n  } else if (object && typeof object === 'object') {\n    var prototype = Object.getPrototypeOf(object);\n    return assign(Object.create(prototype), object);\n  } else {\n    return object;\n  }\n}\n\nfunction newContext() {\n  var commands = assign({}, defaultCommands);\n  update.extend = function(directive, fn) {\n    commands[directive] = fn;\n  };\n  update.isEquals = function(a, b) { return a === b; };\n\n  return update;\n\n  function update(object, spec) {\n    if (typeof spec === 'function') {\n      spec = { $apply: spec };\n    }\n\n    if (!(Array.isArray(object) && Array.isArray(spec))) {\n      invariant(\n        !Array.isArray(spec),\n        'update(): You provided an invalid spec to update(). The spec may ' +\n        'not contain an array except as the value of $set, $push, $unshift, ' +\n        '$splice or any custom command allowing an array value.'\n      );\n    }\n\n    invariant(\n      typeof spec === 'object' && spec !== null,\n      'update(): You provided an invalid spec to update(). The spec and ' +\n      'every included key path must be plain objects containing one of the ' +\n      'following commands: %s.',\n      Object.keys(commands).join(', ')\n    );\n\n    var nextObject = object;\n    var index, key;\n    getAllKeys(spec).forEach(function(key) {\n      if (hasOwnProperty.call(commands, key)) {\n        var objectWasNextObject = object === nextObject;\n        nextObject = commands[key](spec[key], nextObject, spec, object);\n        if (objectWasNextObject && update.isEquals(nextObject, object)) {\n          nextObject = object;\n        }\n      } else {\n        var nextValueForKey =\n          type(object) === 'Map'\n            ? update(object.get(key), spec[key])\n            : update(object[key], spec[key]);\n        var nextObjectValue =\n          type(nextObject) === 'Map'\n              ? nextObject.get(key)\n              : nextObject[key];\n        if (!update.isEquals(nextValueForKey, nextObjectValue) || typeof nextValueForKey === 'undefined' && !hasOwnProperty.call(object, key)) {\n          if (nextObject === object) {\n            nextObject = copy(object);\n          }\n          if (type(nextObject) === 'Map') {\n            nextObject.set(key, nextValueForKey);\n          } else {\n            nextObject[key] = nextValueForKey;\n          }\n        }\n      }\n    })\n    return nextObject;\n  }\n\n}\n\nvar defaultCommands = {\n  $push: function(value, nextObject, spec) {\n    invariantPushAndUnshift(nextObject, spec, '$push');\n    return value.length ? nextObject.concat(value) : nextObject;\n  },\n  $unshift: function(value, nextObject, spec) {\n    invariantPushAndUnshift(nextObject, spec, '$unshift');\n    return value.length ? value.concat(nextObject) : nextObject;\n  },\n  $splice: function(value, nextObject, spec, originalObject) {\n    invariantSplices(nextObject, spec);\n    value.forEach(function(args) {\n      invariantSplice(args);\n      if (nextObject === originalObject && args.length) nextObject = copy(originalObject);\n      splice.apply(nextObject, args);\n    });\n    return nextObject;\n  },\n  $set: function(value, nextObject, spec) {\n    invariantSet(spec);\n    return value;\n  },\n  $toggle: function(targets, nextObject) {\n    invariantSpecArray(targets, '$toggle');\n    var nextObjectCopy = targets.length ? copy(nextObject) : nextObject;\n\n    targets.forEach(function(target) {\n      nextObjectCopy[target] = !nextObject[target];\n    });\n\n    return nextObjectCopy;\n  },\n  $unset: function(value, nextObject, spec, originalObject) {\n    invariantSpecArray(value, '$unset');\n    value.forEach(function(key) {\n      if (Object.hasOwnProperty.call(nextObject, key)) {\n        if (nextObject === originalObject) nextObject = copy(originalObject);\n        delete nextObject[key];\n      }\n    });\n    return nextObject;\n  },\n  $add: function(value, nextObject, spec, originalObject) {\n    invariantMapOrSet(nextObject, '$add');\n    invariantSpecArray(value, '$add');\n    if (type(nextObject) === 'Map') {\n      value.forEach(function(pair) {\n        var key = pair[0];\n        var value = pair[1];\n        if (nextObject === originalObject && nextObject.get(key) !== value) nextObject = copy(originalObject);\n        nextObject.set(key, value);\n      });\n    } else {\n      value.forEach(function(value) {\n        if (nextObject === originalObject && !nextObject.has(value)) nextObject = copy(originalObject);\n        nextObject.add(value);\n      });\n    }\n    return nextObject;\n  },\n  $remove: function(value, nextObject, spec, originalObject) {\n    invariantMapOrSet(nextObject, '$remove');\n    invariantSpecArray(value, '$remove');\n    value.forEach(function(key) {\n      if (nextObject === originalObject && nextObject.has(key)) nextObject = copy(originalObject);\n      nextObject.delete(key);\n    });\n    return nextObject;\n  },\n  $merge: function(value, nextObject, spec, originalObject) {\n    invariantMerge(nextObject, value);\n    getAllKeys(value).forEach(function(key) {\n      if (value[key] !== nextObject[key]) {\n        if (nextObject === originalObject) nextObject = copy(originalObject);\n        nextObject[key] = value[key];\n      }\n    });\n    return nextObject;\n  },\n  $apply: function(value, original) {\n    invariantApply(value);\n    return value(original);\n  }\n};\n\nvar contextForExport = newContext();\n\nmodule.exports = contextForExport;\nmodule.exports.default = contextForExport;\nmodule.exports.newContext = newContext;\n\n// invariants\n\nfunction invariantPushAndUnshift(value, spec, command) {\n  invariant(\n    Array.isArray(value),\n    'update(): expected target of %s to be an array; got %s.',\n    command,\n    value\n  );\n  invariantSpecArray(spec[command], command)\n}\n\nfunction invariantSpecArray(spec, command) {\n  invariant(\n    Array.isArray(spec),\n    'update(): expected spec of %s to be an array; got %s. ' +\n    'Did you forget to wrap your parameter in an array?',\n    command,\n    spec\n  );\n}\n\nfunction invariantSplices(value, spec) {\n  invariant(\n    Array.isArray(value),\n    'Expected $splice target to be an array; got %s',\n    value\n  );\n  invariantSplice(spec['$splice']);\n}\n\nfunction invariantSplice(value) {\n  invariant(\n    Array.isArray(value),\n    'update(): expected spec of $splice to be an array of arrays; got %s. ' +\n    'Did you forget to wrap your parameters in an array?',\n    value\n  );\n}\n\nfunction invariantApply(fn) {\n  invariant(\n    typeof fn === 'function',\n    'update(): expected spec of $apply to be a function; got %s.',\n    fn\n  );\n}\n\nfunction invariantSet(spec) {\n  invariant(\n    Object.keys(spec).length === 1,\n    'Cannot have more than one key in an object with $set'\n  );\n}\n\nfunction invariantMerge(target, specValue) {\n  invariant(\n    specValue && typeof specValue === 'object',\n    'update(): $merge expects a spec of type \\'object\\'; got %s',\n    specValue\n  );\n  invariant(\n    target && typeof target === 'object',\n    'update(): $merge expects a target of type \\'object\\'; got %s',\n    target\n  );\n}\n\nfunction invariantMapOrSet(target, command) {\n  var typeOfTarget = type(target);\n  invariant(\n    typeOfTarget === 'Map' || typeOfTarget === 'Set',\n    'update(): %s expects a target of type Set or Map; got %s',\n    command,\n    typeOfTarget\n  );\n}\n","'use strict';\n\nexports.__esModule = true;\n/**\n * @ignore\n * some key-codes definition and utils from closure-library\n * @author yiminghe@gmail.com\n */\n\nvar KeyCode = {\n  /**\n   * MAC_ENTER\n   */\n  MAC_ENTER: 3,\n  /**\n   * BACKSPACE\n   */\n  BACKSPACE: 8,\n  /**\n   * TAB\n   */\n  TAB: 9,\n  /**\n   * NUMLOCK on FF/Safari Mac\n   */\n  NUM_CENTER: 12, // NUMLOCK on FF/Safari Mac\n  /**\n   * ENTER\n   */\n  ENTER: 13,\n  /**\n   * SHIFT\n   */\n  SHIFT: 16,\n  /**\n   * CTRL\n   */\n  CTRL: 17,\n  /**\n   * ALT\n   */\n  ALT: 18,\n  /**\n   * PAUSE\n   */\n  PAUSE: 19,\n  /**\n   * CAPS_LOCK\n   */\n  CAPS_LOCK: 20,\n  /**\n   * ESC\n   */\n  ESC: 27,\n  /**\n   * SPACE\n   */\n  SPACE: 32,\n  /**\n   * PAGE_UP\n   */\n  PAGE_UP: 33, // also NUM_NORTH_EAST\n  /**\n   * PAGE_DOWN\n   */\n  PAGE_DOWN: 34, // also NUM_SOUTH_EAST\n  /**\n   * END\n   */\n  END: 35, // also NUM_SOUTH_WEST\n  /**\n   * HOME\n   */\n  HOME: 36, // also NUM_NORTH_WEST\n  /**\n   * LEFT\n   */\n  LEFT: 37, // also NUM_WEST\n  /**\n   * UP\n   */\n  UP: 38, // also NUM_NORTH\n  /**\n   * RIGHT\n   */\n  RIGHT: 39, // also NUM_EAST\n  /**\n   * DOWN\n   */\n  DOWN: 40, // also NUM_SOUTH\n  /**\n   * PRINT_SCREEN\n   */\n  PRINT_SCREEN: 44,\n  /**\n   * INSERT\n   */\n  INSERT: 45, // also NUM_INSERT\n  /**\n   * DELETE\n   */\n  DELETE: 46, // also NUM_DELETE\n  /**\n   * ZERO\n   */\n  ZERO: 48,\n  /**\n   * ONE\n   */\n  ONE: 49,\n  /**\n   * TWO\n   */\n  TWO: 50,\n  /**\n   * THREE\n   */\n  THREE: 51,\n  /**\n   * FOUR\n   */\n  FOUR: 52,\n  /**\n   * FIVE\n   */\n  FIVE: 53,\n  /**\n   * SIX\n   */\n  SIX: 54,\n  /**\n   * SEVEN\n   */\n  SEVEN: 55,\n  /**\n   * EIGHT\n   */\n  EIGHT: 56,\n  /**\n   * NINE\n   */\n  NINE: 57,\n  /**\n   * QUESTION_MARK\n   */\n  QUESTION_MARK: 63, // needs localization\n  /**\n   * A\n   */\n  A: 65,\n  /**\n   * B\n   */\n  B: 66,\n  /**\n   * C\n   */\n  C: 67,\n  /**\n   * D\n   */\n  D: 68,\n  /**\n   * E\n   */\n  E: 69,\n  /**\n   * F\n   */\n  F: 70,\n  /**\n   * G\n   */\n  G: 71,\n  /**\n   * H\n   */\n  H: 72,\n  /**\n   * I\n   */\n  I: 73,\n  /**\n   * J\n   */\n  J: 74,\n  /**\n   * K\n   */\n  K: 75,\n  /**\n   * L\n   */\n  L: 76,\n  /**\n   * M\n   */\n  M: 77,\n  /**\n   * N\n   */\n  N: 78,\n  /**\n   * O\n   */\n  O: 79,\n  /**\n   * P\n   */\n  P: 80,\n  /**\n   * Q\n   */\n  Q: 81,\n  /**\n   * R\n   */\n  R: 82,\n  /**\n   * S\n   */\n  S: 83,\n  /**\n   * T\n   */\n  T: 84,\n  /**\n   * U\n   */\n  U: 85,\n  /**\n   * V\n   */\n  V: 86,\n  /**\n   * W\n   */\n  W: 87,\n  /**\n   * X\n   */\n  X: 88,\n  /**\n   * Y\n   */\n  Y: 89,\n  /**\n   * Z\n   */\n  Z: 90,\n  /**\n   * META\n   */\n  META: 91, // WIN_KEY_LEFT\n  /**\n   * WIN_KEY_RIGHT\n   */\n  WIN_KEY_RIGHT: 92,\n  /**\n   * CONTEXT_MENU\n   */\n  CONTEXT_MENU: 93,\n  /**\n   * NUM_ZERO\n   */\n  NUM_ZERO: 96,\n  /**\n   * NUM_ONE\n   */\n  NUM_ONE: 97,\n  /**\n   * NUM_TWO\n   */\n  NUM_TWO: 98,\n  /**\n   * NUM_THREE\n   */\n  NUM_THREE: 99,\n  /**\n   * NUM_FOUR\n   */\n  NUM_FOUR: 100,\n  /**\n   * NUM_FIVE\n   */\n  NUM_FIVE: 101,\n  /**\n   * NUM_SIX\n   */\n  NUM_SIX: 102,\n  /**\n   * NUM_SEVEN\n   */\n  NUM_SEVEN: 103,\n  /**\n   * NUM_EIGHT\n   */\n  NUM_EIGHT: 104,\n  /**\n   * NUM_NINE\n   */\n  NUM_NINE: 105,\n  /**\n   * NUM_MULTIPLY\n   */\n  NUM_MULTIPLY: 106,\n  /**\n   * NUM_PLUS\n   */\n  NUM_PLUS: 107,\n  /**\n   * NUM_MINUS\n   */\n  NUM_MINUS: 109,\n  /**\n   * NUM_PERIOD\n   */\n  NUM_PERIOD: 110,\n  /**\n   * NUM_DIVISION\n   */\n  NUM_DIVISION: 111,\n  /**\n   * F1\n   */\n  F1: 112,\n  /**\n   * F2\n   */\n  F2: 113,\n  /**\n   * F3\n   */\n  F3: 114,\n  /**\n   * F4\n   */\n  F4: 115,\n  /**\n   * F5\n   */\n  F5: 116,\n  /**\n   * F6\n   */\n  F6: 117,\n  /**\n   * F7\n   */\n  F7: 118,\n  /**\n   * F8\n   */\n  F8: 119,\n  /**\n   * F9\n   */\n  F9: 120,\n  /**\n   * F10\n   */\n  F10: 121,\n  /**\n   * F11\n   */\n  F11: 122,\n  /**\n   * F12\n   */\n  F12: 123,\n  /**\n   * NUMLOCK\n   */\n  NUMLOCK: 144,\n  /**\n   * SEMICOLON\n   */\n  SEMICOLON: 186, // needs localization\n  /**\n   * DASH\n   */\n  DASH: 189, // needs localization\n  /**\n   * EQUALS\n   */\n  EQUALS: 187, // needs localization\n  /**\n   * COMMA\n   */\n  COMMA: 188, // needs localization\n  /**\n   * PERIOD\n   */\n  PERIOD: 190, // needs localization\n  /**\n   * SLASH\n   */\n  SLASH: 191, // needs localization\n  /**\n   * APOSTROPHE\n   */\n  APOSTROPHE: 192, // needs localization\n  /**\n   * SINGLE_QUOTE\n   */\n  SINGLE_QUOTE: 222, // needs localization\n  /**\n   * OPEN_SQUARE_BRACKET\n   */\n  OPEN_SQUARE_BRACKET: 219, // needs localization\n  /**\n   * BACKSLASH\n   */\n  BACKSLASH: 220, // needs localization\n  /**\n   * CLOSE_SQUARE_BRACKET\n   */\n  CLOSE_SQUARE_BRACKET: 221, // needs localization\n  /**\n   * WIN_KEY\n   */\n  WIN_KEY: 224,\n  /**\n   * MAC_FF_META\n   */\n  MAC_FF_META: 224, // Firefox (Gecko) fires this for the meta key instead of 91\n  /**\n   * WIN_IME\n   */\n  WIN_IME: 229\n\n  /*\n   whether text and modified key is entered at the same time.\n   */\n};KeyCode.isTextModifyingKeyEvent = function isTextModifyingKeyEvent(e) {\n  var keyCode = e.keyCode;\n  if (e.altKey && !e.ctrlKey || e.metaKey ||\n  // Function keys don't generate text\n  keyCode >= KeyCode.F1 && keyCode <= KeyCode.F13) {\n    return false;\n  }\n\n  // The following keys are quite harmless, even in combination with\n  // CTRL, ALT or SHIFT.\n  switch (keyCode) {\n    case KeyCode.ALT:\n    case KeyCode.CAPS_LOCK:\n    case KeyCode.CONTEXT_MENU:\n    case KeyCode.CTRL:\n    case KeyCode.DOWN:\n    case KeyCode.END:\n    case KeyCode.ESC:\n    case KeyCode.HOME:\n    case KeyCode.INSERT:\n    case KeyCode.LEFT:\n    case KeyCode.MAC_FF_META:\n    case KeyCode.META:\n    case KeyCode.NUMLOCK:\n    case KeyCode.NUM_CENTER:\n    case KeyCode.PAGE_DOWN:\n    case KeyCode.PAGE_UP:\n    case KeyCode.PAUSE:\n    case KeyCode.PRINT_SCREEN:\n    case KeyCode.RIGHT:\n    case KeyCode.SHIFT:\n    case KeyCode.UP:\n    case KeyCode.WIN_KEY:\n    case KeyCode.WIN_KEY_RIGHT:\n      return false;\n    default:\n      return true;\n  }\n};\n\n/*\n whether character is entered.\n */\nKeyCode.isCharacterKey = function isCharacterKey(keyCode) {\n  if (keyCode >= KeyCode.ZERO && keyCode <= KeyCode.NINE) {\n    return true;\n  }\n\n  if (keyCode >= KeyCode.NUM_ZERO && keyCode <= KeyCode.NUM_MULTIPLY) {\n    return true;\n  }\n\n  if (keyCode >= KeyCode.A && keyCode <= KeyCode.Z) {\n    return true;\n  }\n\n  // Safari sends zero key code for non-latin characters.\n  if (window.navigation.userAgent.indexOf('WebKit') !== -1 && keyCode === 0) {\n    return true;\n  }\n\n  switch (keyCode) {\n    case KeyCode.SPACE:\n    case KeyCode.QUESTION_MARK:\n    case KeyCode.NUM_PLUS:\n    case KeyCode.NUM_MINUS:\n    case KeyCode.NUM_PERIOD:\n    case KeyCode.NUM_DIVISION:\n    case KeyCode.SEMICOLON:\n    case KeyCode.DASH:\n    case KeyCode.EQUALS:\n    case KeyCode.COMMA:\n    case KeyCode.PERIOD:\n    case KeyCode.SLASH:\n    case KeyCode.APOSTROPHE:\n    case KeyCode.SINGLE_QUOTE:\n    case KeyCode.OPEN_SQUARE_BRACKET:\n    case KeyCode.BACKSLASH:\n    case KeyCode.CLOSE_SQUARE_BRACKET:\n      return true;\n    default:\n      return false;\n  }\n};\n\nexports.default = KeyCode;","/* FileSaver.js\n * A saveAs() FileSaver implementation.\n * 1.3.2\n * 2016-06-16 18:25:19\n *\n * By Eli Grey, http://eligrey.com\n * License: MIT\n *   See https://github.com/eligrey/FileSaver.js/blob/master/LICENSE.md\n */\n\n/*global self */\n/*jslint bitwise: true, indent: 4, laxbreak: true, laxcomma: true, smarttabs: true, plusplus: true */\n\n/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */\n\nvar saveAs = saveAs || (function(view) {\n\t\"use strict\";\n\t// IE <10 is explicitly unsupported\n\tif (typeof view === \"undefined\" || typeof navigator !== \"undefined\" && /MSIE [1-9]\\./.test(navigator.userAgent)) {\n\t\treturn;\n\t}\n\tvar\n\t\t  doc = view.document\n\t\t  // only get URL when necessary in case Blob.js hasn't overridden it yet\n\t\t, get_URL = function() {\n\t\t\treturn view.URL || view.webkitURL || view;\n\t\t}\n\t\t, save_link = doc.createElementNS(\"http://www.w3.org/1999/xhtml\", \"a\")\n\t\t, can_use_save_link = \"download\" in save_link\n\t\t, click = function(node) {\n\t\t\tvar event = new MouseEvent(\"click\");\n\t\t\tnode.dispatchEvent(event);\n\t\t}\n\t\t, is_safari = /constructor/i.test(view.HTMLElement) || view.safari\n\t\t, is_chrome_ios =/CriOS\\/[\\d]+/.test(navigator.userAgent)\n\t\t, throw_outside = function(ex) {\n\t\t\t(view.setImmediate || view.setTimeout)(function() {\n\t\t\t\tthrow ex;\n\t\t\t}, 0);\n\t\t}\n\t\t, force_saveable_type = \"application/octet-stream\"\n\t\t// the Blob API is fundamentally broken as there is no \"downloadfinished\" event to subscribe to\n\t\t, arbitrary_revoke_timeout = 1000 * 40 // in ms\n\t\t, revoke = function(file) {\n\t\t\tvar revoker = function() {\n\t\t\t\tif (typeof file === \"string\") { // file is an object URL\n\t\t\t\t\tget_URL().revokeObjectURL(file);\n\t\t\t\t} else { // file is a File\n\t\t\t\t\tfile.remove();\n\t\t\t\t}\n\t\t\t};\n\t\t\tsetTimeout(revoker, arbitrary_revoke_timeout);\n\t\t}\n\t\t, dispatch = function(filesaver, event_types, event) {\n\t\t\tevent_types = [].concat(event_types);\n\t\t\tvar i = event_types.length;\n\t\t\twhile (i--) {\n\t\t\t\tvar listener = filesaver[\"on\" + event_types[i]];\n\t\t\t\tif (typeof listener === \"function\") {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tlistener.call(filesaver, event || filesaver);\n\t\t\t\t\t} catch (ex) {\n\t\t\t\t\t\tthrow_outside(ex);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t, auto_bom = function(blob) {\n\t\t\t// prepend BOM for UTF-8 XML and text/* types (including HTML)\n\t\t\t// note: your browser will automatically convert UTF-16 U+FEFF to EF BB BF\n\t\t\tif (/^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i.test(blob.type)) {\n\t\t\t\treturn new Blob([String.fromCharCode(0xFEFF), blob], {type: blob.type});\n\t\t\t}\n\t\t\treturn blob;\n\t\t}\n\t\t, FileSaver = function(blob, name, no_auto_bom) {\n\t\t\tif (!no_auto_bom) {\n\t\t\t\tblob = auto_bom(blob);\n\t\t\t}\n\t\t\t// First try a.download, then web filesystem, then object URLs\n\t\t\tvar\n\t\t\t\t  filesaver = this\n\t\t\t\t, type = blob.type\n\t\t\t\t, force = type === force_saveable_type\n\t\t\t\t, object_url\n\t\t\t\t, dispatch_all = function() {\n\t\t\t\t\tdispatch(filesaver, \"writestart progress write writeend\".split(\" \"));\n\t\t\t\t}\n\t\t\t\t// on any filesys errors revert to saving with object URLs\n\t\t\t\t, fs_error = function() {\n\t\t\t\t\tif ((is_chrome_ios || (force && is_safari)) && view.FileReader) {\n\t\t\t\t\t\t// Safari doesn't allow downloading of blob urls\n\t\t\t\t\t\tvar reader = new FileReader();\n\t\t\t\t\t\treader.onloadend = function() {\n\t\t\t\t\t\t\tvar url = is_chrome_ios ? reader.result : reader.result.replace(/^data:[^;]*;/, 'data:attachment/file;');\n\t\t\t\t\t\t\tvar popup = view.open(url, '_blank');\n\t\t\t\t\t\t\tif(!popup) view.location.href = url;\n\t\t\t\t\t\t\turl=undefined; // release reference before dispatching\n\t\t\t\t\t\t\tfilesaver.readyState = filesaver.DONE;\n\t\t\t\t\t\t\tdispatch_all();\n\t\t\t\t\t\t};\n\t\t\t\t\t\treader.readAsDataURL(blob);\n\t\t\t\t\t\tfilesaver.readyState = filesaver.INIT;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t// don't create more object URLs than needed\n\t\t\t\t\tif (!object_url) {\n\t\t\t\t\t\tobject_url = get_URL().createObjectURL(blob);\n\t\t\t\t\t}\n\t\t\t\t\tif (force) {\n\t\t\t\t\t\tview.location.href = object_url;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar opened = view.open(object_url, \"_blank\");\n\t\t\t\t\t\tif (!opened) {\n\t\t\t\t\t\t\t// Apple does not allow window.open, see https://developer.apple.com/library/safari/documentation/Tools/Conceptual/SafariExtensionGuide/WorkingwithWindowsandTabs/WorkingwithWindowsandTabs.html\n\t\t\t\t\t\t\tview.location.href = object_url;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tfilesaver.readyState = filesaver.DONE;\n\t\t\t\t\tdispatch_all();\n\t\t\t\t\trevoke(object_url);\n\t\t\t\t}\n\t\t\t;\n\t\t\tfilesaver.readyState = filesaver.INIT;\n\n\t\t\tif (can_use_save_link) {\n\t\t\t\tobject_url = get_URL().createObjectURL(blob);\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tsave_link.href = object_url;\n\t\t\t\t\tsave_link.download = name;\n\t\t\t\t\tclick(save_link);\n\t\t\t\t\tdispatch_all();\n\t\t\t\t\trevoke(object_url);\n\t\t\t\t\tfilesaver.readyState = filesaver.DONE;\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tfs_error();\n\t\t}\n\t\t, FS_proto = FileSaver.prototype\n\t\t, saveAs = function(blob, name, no_auto_bom) {\n\t\t\treturn new FileSaver(blob, name || blob.name || \"download\", no_auto_bom);\n\t\t}\n\t;\n\t// IE 10+ (native saveAs)\n\tif (typeof navigator !== \"undefined\" && navigator.msSaveOrOpenBlob) {\n\t\treturn function(blob, name, no_auto_bom) {\n\t\t\tname = name || blob.name || \"download\";\n\n\t\t\tif (!no_auto_bom) {\n\t\t\t\tblob = auto_bom(blob);\n\t\t\t}\n\t\t\treturn navigator.msSaveOrOpenBlob(blob, name);\n\t\t};\n\t}\n\n\tFS_proto.abort = function(){};\n\tFS_proto.readyState = FS_proto.INIT = 0;\n\tFS_proto.WRITING = 1;\n\tFS_proto.DONE = 2;\n\n\tFS_proto.error =\n\tFS_proto.onwritestart =\n\tFS_proto.onprogress =\n\tFS_proto.onwrite =\n\tFS_proto.onabort =\n\tFS_proto.onerror =\n\tFS_proto.onwriteend =\n\t\tnull;\n\n\treturn saveAs;\n}(\n\t   typeof self !== \"undefined\" && self\n\t|| typeof window !== \"undefined\" && window\n\t|| this.content\n));\n// `self` is undefined in Firefox for Android content script context\n// while `this` is nsIContentFrameMessageManager\n// with an attribute `content` that corresponds to the window\n\nif (typeof module !== \"undefined\" && module.exports) {\n  module.exports.saveAs = saveAs;\n} else if ((typeof define !== \"undefined\" && define !== null) && (define.amd !== null)) {\n  define(\"FileSaver.js\", function() {\n    return saveAs;\n  });\n}\n","/*!\n\tCopyright (c) 2018 Jed Watson.\n\tLicensed under the MIT License (MIT), see\n\thttp://jedwatson.github.io/classnames\n*/\n/* global define */\n\n(function () {\n\t'use strict';\n\n\tvar hasOwn = {}.hasOwnProperty;\n\n\tfunction classNames () {\n\t\tvar classes = '';\n\n\t\tfor (var i = 0; i < arguments.length; i++) {\n\t\t\tvar arg = arguments[i];\n\t\t\tif (arg) {\n\t\t\t\tclasses = appendClass(classes, parseValue(arg));\n\t\t\t}\n\t\t}\n\n\t\treturn classes;\n\t}\n\n\tfunction parseValue (arg) {\n\t\tif (typeof arg === 'string' || typeof arg === 'number') {\n\t\t\treturn arg;\n\t\t}\n\n\t\tif (typeof arg !== 'object') {\n\t\t\treturn '';\n\t\t}\n\n\t\tif (Array.isArray(arg)) {\n\t\t\treturn classNames.apply(null, arg);\n\t\t}\n\n\t\tif (arg.toString !== Object.prototype.toString && !arg.toString.toString().includes('[native code]')) {\n\t\t\treturn arg.toString();\n\t\t}\n\n\t\tvar classes = '';\n\n\t\tfor (var key in arg) {\n\t\t\tif (hasOwn.call(arg, key) && arg[key]) {\n\t\t\t\tclasses = appendClass(classes, key);\n\t\t\t}\n\t\t}\n\n\t\treturn classes;\n\t}\n\n\tfunction appendClass (value, newClass) {\n\t\tif (!newClass) {\n\t\t\treturn value;\n\t\t}\n\t\n\t\tif (value) {\n\t\t\treturn value + ' ' + newClass;\n\t\t}\n\t\n\t\treturn value + newClass;\n\t}\n\n\tif (typeof module !== 'undefined' && module.exports) {\n\t\tclassNames.default = classNames;\n\t\tmodule.exports = classNames;\n\t} else if (typeof define === 'function' && typeof define.amd === 'object' && define.amd) {\n\t\t// register as 'classnames', consistent with npm package name\n\t\tdefine('classnames', [], function () {\n\t\t\treturn classNames;\n\t\t});\n\t} else {\n\t\twindow.classNames = classNames;\n\t}\n}());\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.amdD = function () {\n\tthrow new Error('define cannot be used indirect');\n};","__webpack_require__.amdO = {};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t511: 0,\n\t929: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","__webpack_require__.nc = undefined;","// Current version.\nexport var VERSION = '1.13.7';\n\n// Establish the root object, `window` (`self`) in the browser, `global`\n// on the server, or `this` in some virtual machines. We use `self`\n// instead of `window` for `WebWorker` support.\nexport var root = (typeof self == 'object' && self.self === self && self) ||\n          (typeof global == 'object' && global.global === global && global) ||\n          Function('return this')() ||\n          {};\n\n// Save bytes in the minified (but not gzipped) version:\nexport var ArrayProto = Array.prototype, ObjProto = Object.prototype;\nexport var SymbolProto = typeof Symbol !== 'undefined' ? Symbol.prototype : null;\n\n// Create quick reference variables for speed access to core prototypes.\nexport var push = ArrayProto.push,\n    slice = ArrayProto.slice,\n    toString = ObjProto.toString,\n    hasOwnProperty = ObjProto.hasOwnProperty;\n\n// Modern feature detection.\nexport var supportsArrayBuffer = typeof ArrayBuffer !== 'undefined',\n    supportsDataView = typeof DataView !== 'undefined';\n\n// All **ECMAScript 5+** native function implementations that we hope to use\n// are declared here.\nexport var nativeIsArray = Array.isArray,\n    nativeKeys = Object.keys,\n    nativeCreate = Object.create,\n    nativeIsView = supportsArrayBuffer && ArrayBuffer.isView;\n\n// Create references to these builtin functions because we override them.\nexport var _isNaN = isNaN,\n    _isFinite = isFinite;\n\n// Keys in IE < 9 that won't be iterated by `for key in ...` and thus missed.\nexport var hasEnumBug = !{toString: null}.propertyIsEnumerable('toString');\nexport var nonEnumerableProps = ['valueOf', 'isPrototypeOf', 'toString',\n  'propertyIsEnumerable', 'hasOwnProperty', 'toLocaleString'];\n\n// The largest integer that can be represented exactly.\nexport var MAX_ARRAY_INDEX = Math.pow(2, 53) - 1;\n","// Some functions take a variable number of arguments, or a few expected\n// arguments at the beginning and then a variable number of values to operate\n// on. This helper accumulates all remaining arguments past the function’s\n// argument length (or an explicit `startIndex`), into an array that becomes\n// the last argument. Similar to ES6’s \"rest parameter\".\nexport default function restArguments(func, startIndex) {\n  startIndex = startIndex == null ? func.length - 1 : +startIndex;\n  return function() {\n    var length = Math.max(arguments.length - startIndex, 0),\n        rest = Array(length),\n        index = 0;\n    for (; index < length; index++) {\n      rest[index] = arguments[index + startIndex];\n    }\n    switch (startIndex) {\n      case 0: return func.call(this, rest);\n      case 1: return func.call(this, arguments[0], rest);\n      case 2: return func.call(this, arguments[0], arguments[1], rest);\n    }\n    var args = Array(startIndex + 1);\n    for (index = 0; index < startIndex; index++) {\n      args[index] = arguments[index];\n    }\n    args[startIndex] = rest;\n    return func.apply(this, args);\n  };\n}\n","// Is a given variable an object?\nexport default function isObject(obj) {\n  var type = typeof obj;\n  return type === 'function' || (type === 'object' && !!obj);\n}\n","// Is a given value equal to null?\nexport default function isNull(obj) {\n  return obj === null;\n}\n","// Is a given variable undefined?\nexport default function isUndefined(obj) {\n  return obj === void 0;\n}\n","import { toString } from './_setup.js';\n\n// Is a given value a boolean?\nexport default function isBoolean(obj) {\n  return obj === true || obj === false || toString.call(obj) === '[object Boolean]';\n}\n","// Is a given value a DOM element?\nexport default function isElement(obj) {\n  return !!(obj && obj.nodeType === 1);\n}\n","import { toString } from './_setup.js';\n\n// Internal function for creating a `toString`-based type tester.\nexport default function tagTester(name) {\n  var tag = '[object ' + name + ']';\n  return function(obj) {\n    return toString.call(obj) === tag;\n  };\n}\n","import tagTester from './_tagTester.js';\n\nexport default tagTester('String');\n","import tagTester from './_tagTester.js';\n\nexport default tagTester('Number');\n","import tagTester from './_tagTester.js';\n\nexport default tagTester('Date');\n","import tagTester from './_tagTester.js';\n\nexport default tagTester('RegExp');\n","import tagTester from './_tagTester.js';\n\nexport default tagTester('Error');\n","import tagTester from './_tagTester.js';\n\nexport default tagTester('Symbol');\n","import tagTester from './_tagTester.js';\n\nexport default tagTester('ArrayBuffer');\n","import tagTester from './_tagTester.js';\nimport { root } from './_setup.js';\n\nvar isFunction = tagTester('Function');\n\n// Optimize `isFunction` if appropriate. Work around some `typeof` bugs in old\n// v8, IE 11 (#1621), Safari 8 (#1929), and PhantomJS (#2236).\nvar nodelist = root.document && root.document.childNodes;\nif (typeof /./ != 'function' && typeof Int8Array != 'object' && typeof nodelist != 'function') {\n  isFunction = function(obj) {\n    return typeof obj == 'function' || false;\n  };\n}\n\nexport default isFunction;\n","import tagTester from './_tagTester.js';\n\nexport default tagTester('Object');\n","import { supportsDataView } from './_setup.js';\nimport hasObjectTag from './_hasObjectTag.js';\n\n// In IE 10 - Edge 13, `DataView` has string tag `'[object Object]'`.\n// In IE 11, the most common among them, this problem also applies to\n// `Map`, `WeakMap` and `Set`.\n// Also, there are cases where an application can override the native\n// `DataView` object, in cases like that we can't use the constructor\n// safely and should just rely on alternate `DataView` checks\nexport var hasDataViewBug = (\n      supportsDataView && (!/\\[native code\\]/.test(String(DataView)) || hasObjectTag(new DataView(new ArrayBuffer(8))))\n    ),\n    isIE11 = (typeof Map !== 'undefined' && hasObjectTag(new Map));\n","import tagTester from './_tagTester.js';\nimport isFunction from './isFunction.js';\nimport isArrayBuffer from './isArrayBuffer.js';\nimport { hasDataViewBug } from './_stringTagBug.js';\n\nvar isDataView = tagTester('DataView');\n\n// In IE 10 - Edge 13, we need a different heuristic\n// to determine whether an object is a `DataView`.\n// Also, in cases where the native `DataView` is\n// overridden we can't rely on the tag itself.\nfunction alternateIsDataView(obj) {\n  return obj != null && isFunction(obj.getInt8) && isArrayBuffer(obj.buffer);\n}\n\nexport default (hasDataViewBug ? alternateIsDataView : isDataView);\n","import { nativeIsArray } from './_setup.js';\nimport tagTester from './_tagTester.js';\n\n// Is a given value an array?\n// Delegates to ECMA5's native `Array.isArray`.\nexport default nativeIsArray || tagTester('Array');\n","import { hasOwnProperty } from './_setup.js';\n\n// Internal function to check whether `key` is an own property name of `obj`.\nexport default function has(obj, key) {\n  return obj != null && hasOwnProperty.call(obj, key);\n}\n","import tagTester from './_tagTester.js';\nimport has from './_has.js';\n\nvar isArguments = tagTester('Arguments');\n\n// Define a fallback version of the method in browsers (ahem, IE < 9), where\n// there isn't any inspectable \"Arguments\" type.\n(function() {\n  if (!isArguments(arguments)) {\n    isArguments = function(obj) {\n      return has(obj, 'callee');\n    };\n  }\n}());\n\nexport default isArguments;\n","import { _isFinite } from './_setup.js';\nimport isSymbol from './isSymbol.js';\n\n// Is a given object a finite number?\nexport default function isFinite(obj) {\n  return !isSymbol(obj) && _isFinite(obj) && !isNaN(parseFloat(obj));\n}\n","import { _isNaN } from './_setup.js';\nimport isNumber from './isNumber.js';\n\n// Is the given value `NaN`?\nexport default function isNaN(obj) {\n  return isNumber(obj) && _isNaN(obj);\n}\n","// Predicate-generating function. Often useful outside of Underscore.\nexport default function constant(value) {\n  return function() {\n    return value;\n  };\n}\n","import { MAX_ARRAY_INDEX } from './_setup.js';\n\n// Common internal logic for `isArrayLike` and `isBufferLike`.\nexport default function createSizePropertyCheck(getSizeProperty) {\n  return function(collection) {\n    var sizeProperty = getSizeProperty(collection);\n    return typeof sizeProperty == 'number' && sizeProperty >= 0 && sizeProperty <= MAX_ARRAY_INDEX;\n  }\n}\n","// Internal helper to generate a function to obtain property `key` from `obj`.\nexport default function shallowProperty(key) {\n  return function(obj) {\n    return obj == null ? void 0 : obj[key];\n  };\n}\n","import shallowProperty from './_shallowProperty.js';\n\n// Internal helper to obtain the `byteLength` property of an object.\nexport default shallowProperty('byteLength');\n","import createSizePropertyCheck from './_createSizePropertyCheck.js';\nimport getByteLength from './_getByteLength.js';\n\n// Internal helper to determine whether we should spend extensive checks against\n// `ArrayBuffer` et al.\nexport default createSizePropertyCheck(getByteLength);\n","import { supportsArrayBuffer, nativeIsView, toString } from './_setup.js';\nimport isDataView from './isDataView.js';\nimport constant from './constant.js';\nimport isBufferLike from './_isBufferLike.js';\n\n// Is a given value a typed array?\nvar typedArrayPattern = /\\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\\]/;\nfunction isTypedArray(obj) {\n  // `ArrayBuffer.isView` is the most future-proof, so use it when available.\n  // Otherwise, fall back on the above regular expression.\n  return nativeIsView ? (nativeIsView(obj) && !isDataView(obj)) :\n                isBufferLike(obj) && typedArrayPattern.test(toString.call(obj));\n}\n\nexport default supportsArrayBuffer ? isTypedArray : constant(false);\n","import shallowProperty from './_shallowProperty.js';\n\n// Internal helper to obtain the `length` property of an object.\nexport default shallowProperty('length');\n","import { nonEnumerableProps, ObjProto } from './_setup.js';\nimport isFunction from './isFunction.js';\nimport has from './_has.js';\n\n// Internal helper to create a simple lookup structure.\n// `collectNonEnumProps` used to depend on `_.contains`, but this led to\n// circular imports. `emulatedSet` is a one-off solution that only works for\n// arrays of strings.\nfunction emulatedSet(keys) {\n  var hash = {};\n  for (var l = keys.length, i = 0; i < l; ++i) hash[keys[i]] = true;\n  return {\n    contains: function(key) { return hash[key] === true; },\n    push: function(key) {\n      hash[key] = true;\n      return keys.push(key);\n    }\n  };\n}\n\n// Internal helper. Checks `keys` for the presence of keys in IE < 9 that won't\n// be iterated by `for key in ...` and thus missed. Extends `keys` in place if\n// needed.\nexport default function collectNonEnumProps(obj, keys) {\n  keys = emulatedSet(keys);\n  var nonEnumIdx = nonEnumerableProps.length;\n  var constructor = obj.constructor;\n  var proto = (isFunction(constructor) && constructor.prototype) || ObjProto;\n\n  // Constructor is a special case.\n  var prop = 'constructor';\n  if (has(obj, prop) && !keys.contains(prop)) keys.push(prop);\n\n  while (nonEnumIdx--) {\n    prop = nonEnumerableProps[nonEnumIdx];\n    if (prop in obj && obj[prop] !== proto[prop] && !keys.contains(prop)) {\n      keys.push(prop);\n    }\n  }\n}\n","import isObject from './isObject.js';\nimport { nativeKeys, hasEnumBug } from './_setup.js';\nimport has from './_has.js';\nimport collectNonEnumProps from './_collectNonEnumProps.js';\n\n// Retrieve the names of an object's own properties.\n// Delegates to **ECMAScript 5**'s native `Object.keys`.\nexport default function keys(obj) {\n  if (!isObject(obj)) return [];\n  if (nativeKeys) return nativeKeys(obj);\n  var keys = [];\n  for (var key in obj) if (has(obj, key)) keys.push(key);\n  // Ahem, IE < 9.\n  if (hasEnumBug) collectNonEnumProps(obj, keys);\n  return keys;\n}\n","import getLength from './_getLength.js';\nimport isArray from './isArray.js';\nimport isString from './isString.js';\nimport isArguments from './isArguments.js';\nimport keys from './keys.js';\n\n// Is a given array, string, or object empty?\n// An \"empty\" object has no enumerable own-properties.\nexport default function isEmpty(obj) {\n  if (obj == null) return true;\n  // Skip the more expensive `toString`-based type checks if `obj` has no\n  // `.length`.\n  var length = getLength(obj);\n  if (typeof length == 'number' && (\n    isArray(obj) || isString(obj) || isArguments(obj)\n  )) return length === 0;\n  return getLength(keys(obj)) === 0;\n}\n","import keys from './keys.js';\n\n// Returns whether an object has a given set of `key:value` pairs.\nexport default function isMatch(object, attrs) {\n  var _keys = keys(attrs), length = _keys.length;\n  if (object == null) return !length;\n  var obj = Object(object);\n  for (var i = 0; i < length; i++) {\n    var key = _keys[i];\n    if (attrs[key] !== obj[key] || !(key in obj)) return false;\n  }\n  return true;\n}\n","import { VERSION } from './_setup.js';\n\n// If Underscore is called as a function, it returns a wrapped object that can\n// be used OO-style. This wrapper holds altered versions of all functions added\n// through `_.mixin`. Wrapped objects may be chained.\nexport default function _(obj) {\n  if (obj instanceof _) return obj;\n  if (!(this instanceof _)) return new _(obj);\n  this._wrapped = obj;\n}\n\n_.VERSION = VERSION;\n\n// Extracts the result from a wrapped and chained object.\n_.prototype.value = function() {\n  return this._wrapped;\n};\n\n// Provide unwrapping proxies for some methods used in engine operations\n// such as arithmetic and JSON stringification.\n_.prototype.valueOf = _.prototype.toJSON = _.prototype.value;\n\n_.prototype.toString = function() {\n  return String(this._wrapped);\n};\n","import getByteLength from './_getByteLength.js';\n\n// Internal function to wrap or shallow-copy an ArrayBuffer,\n// typed array or DataView to a new view, reusing the buffer.\nexport default function toBufferView(bufferSource) {\n  return new Uint8Array(\n    bufferSource.buffer || bufferSource,\n    bufferSource.byteOffset || 0,\n    getByteLength(bufferSource)\n  );\n}\n","import _ from './underscore.js';\nimport { toString, SymbolProto } from './_setup.js';\nimport getByteLength from './_getByteLength.js';\nimport isTypedArray from './isTypedArray.js';\nimport isFunction from './isFunction.js';\nimport { hasDataViewBug }  from './_stringTagBug.js';\nimport isDataView from './isDataView.js';\nimport keys from './keys.js';\nimport has from './_has.js';\nimport toBufferView from './_toBufferView.js';\n\n// We use this string twice, so give it a name for minification.\nvar tagDataView = '[object DataView]';\n\n// Internal recursive comparison function for `_.isEqual`.\nfunction eq(a, b, aStack, bStack) {\n  // Identical objects are equal. `0 === -0`, but they aren't identical.\n  // See the [Harmony `egal` proposal](https://wiki.ecmascript.org/doku.php?id=harmony:egal).\n  if (a === b) return a !== 0 || 1 / a === 1 / b;\n  // `null` or `undefined` only equal to itself (strict comparison).\n  if (a == null || b == null) return false;\n  // `NaN`s are equivalent, but non-reflexive.\n  if (a !== a) return b !== b;\n  // Exhaust primitive checks\n  var type = typeof a;\n  if (type !== 'function' && type !== 'object' && typeof b != 'object') return false;\n  return deepEq(a, b, aStack, bStack);\n}\n\n// Internal recursive comparison function for `_.isEqual`.\nfunction deepEq(a, b, aStack, bStack) {\n  // Unwrap any wrapped objects.\n  if (a instanceof _) a = a._wrapped;\n  if (b instanceof _) b = b._wrapped;\n  // Compare `[[Class]]` names.\n  var className = toString.call(a);\n  if (className !== toString.call(b)) return false;\n  // Work around a bug in IE 10 - Edge 13.\n  if (hasDataViewBug && className == '[object Object]' && isDataView(a)) {\n    if (!isDataView(b)) return false;\n    className = tagDataView;\n  }\n  switch (className) {\n    // These types are compared by value.\n    case '[object RegExp]':\n      // RegExps are coerced to strings for comparison (Note: '' + /a/i === '/a/i')\n    case '[object String]':\n      // Primitives and their corresponding object wrappers are equivalent; thus, `\"5\"` is\n      // equivalent to `new String(\"5\")`.\n      return '' + a === '' + b;\n    case '[object Number]':\n      // `NaN`s are equivalent, but non-reflexive.\n      // Object(NaN) is equivalent to NaN.\n      if (+a !== +a) return +b !== +b;\n      // An `egal` comparison is performed for other numeric values.\n      return +a === 0 ? 1 / +a === 1 / b : +a === +b;\n    case '[object Date]':\n    case '[object Boolean]':\n      // Coerce dates and booleans to numeric primitive values. Dates are compared by their\n      // millisecond representations. Note that invalid dates with millisecond representations\n      // of `NaN` are not equivalent.\n      return +a === +b;\n    case '[object Symbol]':\n      return SymbolProto.valueOf.call(a) === SymbolProto.valueOf.call(b);\n    case '[object ArrayBuffer]':\n    case tagDataView:\n      // Coerce to typed array so we can fall through.\n      return deepEq(toBufferView(a), toBufferView(b), aStack, bStack);\n  }\n\n  var areArrays = className === '[object Array]';\n  if (!areArrays && isTypedArray(a)) {\n      var byteLength = getByteLength(a);\n      if (byteLength !== getByteLength(b)) return false;\n      if (a.buffer === b.buffer && a.byteOffset === b.byteOffset) return true;\n      areArrays = true;\n  }\n  if (!areArrays) {\n    if (typeof a != 'object' || typeof b != 'object') return false;\n\n    // Objects with different constructors are not equivalent, but `Object`s or `Array`s\n    // from different frames are.\n    var aCtor = a.constructor, bCtor = b.constructor;\n    if (aCtor !== bCtor && !(isFunction(aCtor) && aCtor instanceof aCtor &&\n                             isFunction(bCtor) && bCtor instanceof bCtor)\n                        && ('constructor' in a && 'constructor' in b)) {\n      return false;\n    }\n  }\n  // Assume equality for cyclic structures. The algorithm for detecting cyclic\n  // structures is adapted from ES 5.1 section 15.12.3, abstract operation `JO`.\n\n  // Initializing stack of traversed objects.\n  // It's done here since we only need them for objects and arrays comparison.\n  aStack = aStack || [];\n  bStack = bStack || [];\n  var length = aStack.length;\n  while (length--) {\n    // Linear search. Performance is inversely proportional to the number of\n    // unique nested structures.\n    if (aStack[length] === a) return bStack[length] === b;\n  }\n\n  // Add the first object to the stack of traversed objects.\n  aStack.push(a);\n  bStack.push(b);\n\n  // Recursively compare objects and arrays.\n  if (areArrays) {\n    // Compare array lengths to determine if a deep comparison is necessary.\n    length = a.length;\n    if (length !== b.length) return false;\n    // Deep compare the contents, ignoring non-numeric properties.\n    while (length--) {\n      if (!eq(a[length], b[length], aStack, bStack)) return false;\n    }\n  } else {\n    // Deep compare objects.\n    var _keys = keys(a), key;\n    length = _keys.length;\n    // Ensure that both objects contain the same number of properties before comparing deep equality.\n    if (keys(b).length !== length) return false;\n    while (length--) {\n      // Deep compare each member\n      key = _keys[length];\n      if (!(has(b, key) && eq(a[key], b[key], aStack, bStack))) return false;\n    }\n  }\n  // Remove the first object from the stack of traversed objects.\n  aStack.pop();\n  bStack.pop();\n  return true;\n}\n\n// Perform a deep comparison to check if two objects are equal.\nexport default function isEqual(a, b) {\n  return eq(a, b);\n}\n","import isObject from './isObject.js';\nimport { hasEnumBug } from './_setup.js';\nimport collectNonEnumProps from './_collectNonEnumProps.js';\n\n// Retrieve all the enumerable property names of an object.\nexport default function allKeys(obj) {\n  if (!isObject(obj)) return [];\n  var keys = [];\n  for (var key in obj) keys.push(key);\n  // Ahem, IE < 9.\n  if (hasEnumBug) collectNonEnumProps(obj, keys);\n  return keys;\n}\n","import getLength from './_getLength.js';\nimport isFunction from './isFunction.js';\nimport allKeys from './allKeys.js';\n\n// Since the regular `Object.prototype.toString` type tests don't work for\n// some types in IE 11, we use a fingerprinting heuristic instead, based\n// on the methods. It's not great, but it's the best we got.\n// The fingerprint method lists are defined below.\nexport function ie11fingerprint(methods) {\n  var length = getLength(methods);\n  return function(obj) {\n    if (obj == null) return false;\n    // `Map`, `WeakMap` and `Set` have no enumerable keys.\n    var keys = allKeys(obj);\n    if (getLength(keys)) return false;\n    for (var i = 0; i < length; i++) {\n      if (!isFunction(obj[methods[i]])) return false;\n    }\n    // If we are testing against `WeakMap`, we need to ensure that\n    // `obj` doesn't have a `forEach` method in order to distinguish\n    // it from a regular `Map`.\n    return methods !== weakMapMethods || !isFunction(obj[forEachName]);\n  };\n}\n\n// In the interest of compact minification, we write\n// each string in the fingerprints only once.\nvar forEachName = 'forEach',\n    hasName = 'has',\n    commonInit = ['clear', 'delete'],\n    mapTail = ['get', hasName, 'set'];\n\n// `Map`, `WeakMap` and `Set` each have slightly different\n// combinations of the above sublists.\nexport var mapMethods = commonInit.concat(forEachName, mapTail),\n    weakMapMethods = commonInit.concat(mapTail),\n    setMethods = ['add'].concat(commonInit, forEachName, hasName);\n","import tagTester from './_tagTester.js';\nimport { isIE11 } from './_stringTagBug.js';\nimport { ie11fingerprint, mapMethods }  from './_methodFingerprint.js';\n\nexport default isIE11 ? ie11fingerprint(mapMethods) : tagTester('Map');\n","import tagTester from './_tagTester.js';\nimport { isIE11 } from './_stringTagBug.js';\nimport { ie11fingerprint, weakMapMethods }  from './_methodFingerprint.js';\n\nexport default isIE11 ? ie11fingerprint(weakMapMethods) : tagTester('WeakMap');\n","import tagTester from './_tagTester.js';\nimport { isIE11 } from './_stringTagBug.js';\nimport { ie11fingerprint, setMethods }  from './_methodFingerprint.js';\n\nexport default isIE11 ? ie11fingerprint(setMethods) : tagTester('Set');\n","import tagTester from './_tagTester.js';\n\nexport default tagTester('WeakSet');\n","import keys from './keys.js';\n\n// Retrieve the values of an object's properties.\nexport default function values(obj) {\n  var _keys = keys(obj);\n  var length = _keys.length;\n  var values = Array(length);\n  for (var i = 0; i < length; i++) {\n    values[i] = obj[_keys[i]];\n  }\n  return values;\n}\n","import keys from './keys.js';\n\n// Convert an object into a list of `[key, value]` pairs.\n// The opposite of `_.object` with one argument.\nexport default function pairs(obj) {\n  var _keys = keys(obj);\n  var length = _keys.length;\n  var pairs = Array(length);\n  for (var i = 0; i < length; i++) {\n    pairs[i] = [_keys[i], obj[_keys[i]]];\n  }\n  return pairs;\n}\n","import keys from './keys.js';\n\n// Invert the keys and values of an object. The values must be serializable.\nexport default function invert(obj) {\n  var result = {};\n  var _keys = keys(obj);\n  for (var i = 0, length = _keys.length; i < length; i++) {\n    result[obj[_keys[i]]] = _keys[i];\n  }\n  return result;\n}\n","import isFunction from './isFunction.js';\n\n// Return a sorted list of the function names available on the object.\nexport default function functions(obj) {\n  var names = [];\n  for (var key in obj) {\n    if (isFunction(obj[key])) names.push(key);\n  }\n  return names.sort();\n}\n","// An internal function for creating assigner functions.\nexport default function createAssigner(keysFunc, defaults) {\n  return function(obj) {\n    var length = arguments.length;\n    if (defaults) obj = Object(obj);\n    if (length < 2 || obj == null) return obj;\n    for (var index = 1; index < length; index++) {\n      var source = arguments[index],\n          keys = keysFunc(source),\n          l = keys.length;\n      for (var i = 0; i < l; i++) {\n        var key = keys[i];\n        if (!defaults || obj[key] === void 0) obj[key] = source[key];\n      }\n    }\n    return obj;\n  };\n}\n","import createAssigner from './_createAssigner.js';\nimport allKeys from './allKeys.js';\n\n// Extend a given object with all the properties in passed-in object(s).\nexport default createAssigner(allKeys);\n","import createAssigner from './_createAssigner.js';\nimport keys from './keys.js';\n\n// Assigns a given object with all the own properties in the passed-in\n// object(s).\n// (https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object/assign)\nexport default createAssigner(keys);\n","import createAssigner from './_createAssigner.js';\nimport allKeys from './allKeys.js';\n\n// Fill in a given object with default properties.\nexport default createAssigner(allKeys, true);\n","import isObject from './isObject.js';\nimport { nativeCreate } from './_setup.js';\n\n// Create a naked function reference for surrogate-prototype-swapping.\nfunction ctor() {\n  return function(){};\n}\n\n// An internal function for creating a new object that inherits from another.\nexport default function baseCreate(prototype) {\n  if (!isObject(prototype)) return {};\n  if (nativeCreate) return nativeCreate(prototype);\n  var Ctor = ctor();\n  Ctor.prototype = prototype;\n  var result = new Ctor;\n  Ctor.prototype = null;\n  return result;\n}\n","import baseCreate from './_baseCreate.js';\nimport extendOwn from './extendOwn.js';\n\n// Creates an object that inherits from the given prototype object.\n// If additional properties are provided then they will be added to the\n// created object.\nexport default function create(prototype, props) {\n  var result = baseCreate(prototype);\n  if (props) extendOwn(result, props);\n  return result;\n}\n","import isObject from './isObject.js';\nimport isArray from './isArray.js';\nimport extend from './extend.js';\n\n// Create a (shallow-cloned) duplicate of an object.\nexport default function clone(obj) {\n  if (!isObject(obj)) return obj;\n  return isArray(obj) ? obj.slice() : extend({}, obj);\n}\n","// Invokes `interceptor` with the `obj` and then returns `obj`.\n// The primary purpose of this method is to \"tap into\" a method chain, in\n// order to perform operations on intermediate results within the chain.\nexport default function tap(obj, interceptor) {\n  interceptor(obj);\n  return obj;\n}\n","import _ from './underscore.js';\nimport isArray from './isArray.js';\n\n// Normalize a (deep) property `path` to array.\n// Like `_.iteratee`, this function can be customized.\nexport default function toPath(path) {\n  return isArray(path) ? path : [path];\n}\n_.toPath = toPath;\n","import _ from './underscore.js';\nimport './toPath.js';\n\n// Internal wrapper for `_.toPath` to enable minification.\n// Similar to `cb` for `_.iteratee`.\nexport default function toPath(path) {\n  return _.toPath(path);\n}\n","// Internal function to obtain a nested property in `obj` along `path`.\nexport default function deepGet(obj, path) {\n  var length = path.length;\n  for (var i = 0; i < length; i++) {\n    if (obj == null) return void 0;\n    obj = obj[path[i]];\n  }\n  return length ? obj : void 0;\n}\n","import toPath from './_toPath.js';\nimport deepGet from './_deepGet.js';\nimport isUndefined from './isUndefined.js';\n\n// Get the value of the (deep) property on `path` from `object`.\n// If any property in `path` does not exist or if the value is\n// `undefined`, return `defaultValue` instead.\n// The `path` is normalized through `_.toPath`.\nexport default function get(object, path, defaultValue) {\n  var value = deepGet(object, toPath(path));\n  return isUndefined(value) ? defaultValue : value;\n}\n","import _has from './_has.js';\nimport toPath from './_toPath.js';\n\n// Shortcut function for checking if an object has a given property directly on\n// itself (in other words, not on a prototype). Unlike the internal `has`\n// function, this public version can also traverse nested properties.\nexport default function has(obj, path) {\n  path = toPath(path);\n  var length = path.length;\n  for (var i = 0; i < length; i++) {\n    var key = path[i];\n    if (!_has(obj, key)) return false;\n    obj = obj[key];\n  }\n  return !!length;\n}\n","// Keep the identity function around for default iteratees.\nexport default function identity(value) {\n  return value;\n}\n","import extendOwn from './extendOwn.js';\nimport isMatch from './isMatch.js';\n\n// Returns a predicate for checking whether an object has a given set of\n// `key:value` pairs.\nexport default function matcher(attrs) {\n  attrs = extendOwn({}, attrs);\n  return function(obj) {\n    return isMatch(obj, attrs);\n  };\n}\n","import deepGet from './_deepGet.js';\nimport toPath from './_toPath.js';\n\n// Creates a function that, when passed an object, will traverse that object’s\n// properties down the given `path`, specified as an array of keys or indices.\nexport default function property(path) {\n  path = toPath(path);\n  return function(obj) {\n    return deepGet(obj, path);\n  };\n}\n","// Internal function that returns an efficient (for current engines) version\n// of the passed-in callback, to be repeatedly applied in other Underscore\n// functions.\nexport default function optimizeCb(func, context, argCount) {\n  if (context === void 0) return func;\n  switch (argCount == null ? 3 : argCount) {\n    case 1: return function(value) {\n      return func.call(context, value);\n    };\n    // The 2-argument case is omitted because we’re not using it.\n    case 3: return function(value, index, collection) {\n      return func.call(context, value, index, collection);\n    };\n    case 4: return function(accumulator, value, index, collection) {\n      return func.call(context, accumulator, value, index, collection);\n    };\n  }\n  return function() {\n    return func.apply(context, arguments);\n  };\n}\n","import identity from './identity.js';\nimport isFunction from './isFunction.js';\nimport isObject from './isObject.js';\nimport isArray from './isArray.js';\nimport matcher from './matcher.js';\nimport property from './property.js';\nimport optimizeCb from './_optimizeCb.js';\n\n// An internal function to generate callbacks that can be applied to each\n// element in a collection, returning the desired result — either `_.identity`,\n// an arbitrary callback, a property matcher, or a property accessor.\nexport default function baseIteratee(value, context, argCount) {\n  if (value == null) return identity;\n  if (isFunction(value)) return optimizeCb(value, context, argCount);\n  if (isObject(value) && !isArray(value)) return matcher(value);\n  return property(value);\n}\n","import _ from './underscore.js';\nimport baseIteratee from './_baseIteratee.js';\n\n// External wrapper for our callback generator. Users may customize\n// `_.iteratee` if they want additional predicate/iteratee shorthand styles.\n// This abstraction hides the internal-only `argCount` argument.\nexport default function iteratee(value, context) {\n  return baseIteratee(value, context, Infinity);\n}\n_.iteratee = iteratee;\n","import _ from './underscore.js';\nimport baseIteratee from './_baseIteratee.js';\nimport iteratee from './iteratee.js';\n\n// The function we call internally to generate a callback. It invokes\n// `_.iteratee` if overridden, otherwise `baseIteratee`.\nexport default function cb(value, context, argCount) {\n  if (_.iteratee !== iteratee) return _.iteratee(value, context);\n  return baseIteratee(value, context, argCount);\n}\n","import cb from './_cb.js';\nimport keys from './keys.js';\n\n// Returns the results of applying the `iteratee` to each element of `obj`.\n// In contrast to `_.map` it returns an object.\nexport default function mapObject(obj, iteratee, context) {\n  iteratee = cb(iteratee, context);\n  var _keys = keys(obj),\n      length = _keys.length,\n      results = {};\n  for (var index = 0; index < length; index++) {\n    var currentKey = _keys[index];\n    results[currentKey] = iteratee(obj[currentKey], currentKey, obj);\n  }\n  return results;\n}\n","// Predicate-generating function. Often useful outside of Underscore.\nexport default function noop(){}\n","import noop from './noop.js';\nimport get from './get.js';\n\n// Generates a function for a given object that returns a given property.\nexport default function propertyOf(obj) {\n  if (obj == null) return noop;\n  return function(path) {\n    return get(obj, path);\n  };\n}\n","import optimizeCb from './_optimizeCb.js';\n\n// Run a function **n** times.\nexport default function times(n, iteratee, context) {\n  var accum = Array(Math.max(0, n));\n  iteratee = optimizeCb(iteratee, context, 1);\n  for (var i = 0; i < n; i++) accum[i] = iteratee(i);\n  return accum;\n}\n","// Return a random integer between `min` and `max` (inclusive).\nexport default function random(min, max) {\n  if (max == null) {\n    max = min;\n    min = 0;\n  }\n  return min + Math.floor(Math.random() * (max - min + 1));\n}\n","// A (possibly faster) way to get the current timestamp as an integer.\nexport default Date.now || function() {\n  return new Date().getTime();\n};\n","import keys from './keys.js';\n\n// Internal helper to generate functions for escaping and unescaping strings\n// to/from HTML interpolation.\nexport default function createEscaper(map) {\n  var escaper = function(match) {\n    return map[match];\n  };\n  // Regexes for identifying a key that needs to be escaped.\n  var source = '(?:' + keys(map).join('|') + ')';\n  var testRegexp = RegExp(source);\n  var replaceRegexp = RegExp(source, 'g');\n  return function(string) {\n    string = string == null ? '' : '' + string;\n    return testRegexp.test(string) ? string.replace(replaceRegexp, escaper) : string;\n  };\n}\n","// Internal list of HTML entities for escaping.\nexport default {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  \"'\": '&#x27;',\n  '`': '&#x60;'\n};\n","import createEscaper from './_createEscaper.js';\nimport escapeMap from './_escapeMap.js';\n\n// Function for escaping strings to HTML interpolation.\nexport default createEscaper(escapeMap);\n","import createEscaper from './_createEscaper.js';\nimport unescapeMap from './_unescapeMap.js';\n\n// Function for unescaping strings from HTML interpolation.\nexport default createEscaper(unescapeMap);\n","import invert from './invert.js';\nimport escapeMap from './_escapeMap.js';\n\n// Internal list of HTML entities for unescaping.\nexport default invert(escapeMap);\n","import _ from './underscore.js';\n\n// By default, Underscore uses ERB-style template delimiters. Change the\n// following template settings to use alternative delimiters.\nexport default _.templateSettings = {\n  evaluate: /<%([\\s\\S]+?)%>/g,\n  interpolate: /<%=([\\s\\S]+?)%>/g,\n  escape: /<%-([\\s\\S]+?)%>/g\n};\n","import defaults from './defaults.js';\nimport _ from './underscore.js';\nimport './templateSettings.js';\n\n// When customizing `_.templateSettings`, if you don't want to define an\n// interpolation, evaluation or escaping regex, we need one that is\n// guaranteed not to match.\nvar noMatch = /(.)^/;\n\n// Certain characters need to be escaped so that they can be put into a\n// string literal.\nvar escapes = {\n  \"'\": \"'\",\n  '\\\\': '\\\\',\n  '\\r': 'r',\n  '\\n': 'n',\n  '\\u2028': 'u2028',\n  '\\u2029': 'u2029'\n};\n\nvar escapeRegExp = /\\\\|'|\\r|\\n|\\u2028|\\u2029/g;\n\nfunction escapeChar(match) {\n  return '\\\\' + escapes[match];\n}\n\n// In order to prevent third-party code injection through\n// `_.templateSettings.variable`, we test it against the following regular\n// expression. It is intentionally a bit more liberal than just matching valid\n// identifiers, but still prevents possible loopholes through defaults or\n// destructuring assignment.\nvar bareIdentifier = /^\\s*(\\w|\\$)+\\s*$/;\n\n// JavaScript micro-templating, similar to John Resig's implementation.\n// Underscore templating handles arbitrary delimiters, preserves whitespace,\n// and correctly escapes quotes within interpolated code.\n// NB: `oldSettings` only exists for backwards compatibility.\nexport default function template(text, settings, oldSettings) {\n  if (!settings && oldSettings) settings = oldSettings;\n  settings = defaults({}, settings, _.templateSettings);\n\n  // Combine delimiters into one regular expression via alternation.\n  var matcher = RegExp([\n    (settings.escape || noMatch).source,\n    (settings.interpolate || noMatch).source,\n    (settings.evaluate || noMatch).source\n  ].join('|') + '|$', 'g');\n\n  // Compile the template source, escaping string literals appropriately.\n  var index = 0;\n  var source = \"__p+='\";\n  text.replace(matcher, function(match, escape, interpolate, evaluate, offset) {\n    source += text.slice(index, offset).replace(escapeRegExp, escapeChar);\n    index = offset + match.length;\n\n    if (escape) {\n      source += \"'+\\n((__t=(\" + escape + \"))==null?'':_.escape(__t))+\\n'\";\n    } else if (interpolate) {\n      source += \"'+\\n((__t=(\" + interpolate + \"))==null?'':__t)+\\n'\";\n    } else if (evaluate) {\n      source += \"';\\n\" + evaluate + \"\\n__p+='\";\n    }\n\n    // Adobe VMs need the match returned to produce the correct offset.\n    return match;\n  });\n  source += \"';\\n\";\n\n  var argument = settings.variable;\n  if (argument) {\n    // Insure against third-party code injection. (CVE-2021-23358)\n    if (!bareIdentifier.test(argument)) throw new Error(\n      'variable is not a bare identifier: ' + argument\n    );\n  } else {\n    // If a variable is not specified, place data values in local scope.\n    source = 'with(obj||{}){\\n' + source + '}\\n';\n    argument = 'obj';\n  }\n\n  source = \"var __t,__p='',__j=Array.prototype.join,\" +\n    \"print=function(){__p+=__j.call(arguments,'');};\\n\" +\n    source + 'return __p;\\n';\n\n  var render;\n  try {\n    render = new Function(argument, '_', source);\n  } catch (e) {\n    e.source = source;\n    throw e;\n  }\n\n  var template = function(data) {\n    return render.call(this, data, _);\n  };\n\n  // Provide the compiled source as a convenience for precompilation.\n  template.source = 'function(' + argument + '){\\n' + source + '}';\n\n  return template;\n}\n","import isFunction from './isFunction.js';\nimport toPath from './_toPath.js';\n\n// Traverses the children of `obj` along `path`. If a child is a function, it\n// is invoked with its parent as context. Returns the value of the final\n// child, or `fallback` if any child is undefined.\nexport default function result(obj, path, fallback) {\n  path = toPath(path);\n  var length = path.length;\n  if (!length) {\n    return isFunction(fallback) ? fallback.call(obj) : fallback;\n  }\n  for (var i = 0; i < length; i++) {\n    var prop = obj == null ? void 0 : obj[path[i]];\n    if (prop === void 0) {\n      prop = fallback;\n      i = length; // Ensure we don't continue iterating.\n    }\n    obj = isFunction(prop) ? prop.call(obj) : prop;\n  }\n  return obj;\n}\n","// Generate a unique integer id (unique within the entire client session).\n// Useful for temporary DOM ids.\nvar idCounter = 0;\nexport default function uniqueId(prefix) {\n  var id = ++idCounter + '';\n  return prefix ? prefix + id : id;\n}\n","import _ from './underscore.js';\n\n// Start chaining a wrapped Underscore object.\nexport default function chain(obj) {\n  var instance = _(obj);\n  instance._chain = true;\n  return instance;\n}\n","import baseCreate from './_baseCreate.js';\nimport isObject from './isObject.js';\n\n// Internal function to execute `sourceFunc` bound to `context` with optional\n// `args`. Determines whether to execute a function as a constructor or as a\n// normal function.\nexport default function executeBound(sourceFunc, boundFunc, context, callingContext, args) {\n  if (!(callingContext instanceof boundFunc)) return sourceFunc.apply(context, args);\n  var self = baseCreate(sourceFunc.prototype);\n  var result = sourceFunc.apply(self, args);\n  if (isObject(result)) return result;\n  return self;\n}\n","import restArguments from './restArguments.js';\nimport executeBound from './_executeBound.js';\nimport _ from './underscore.js';\n\n// Partially apply a function by creating a version that has had some of its\n// arguments pre-filled, without changing its dynamic `this` context. `_` acts\n// as a placeholder by default, allowing any combination of arguments to be\n// pre-filled. Set `_.partial.placeholder` for a custom placeholder argument.\nvar partial = restArguments(function(func, boundArgs) {\n  var placeholder = partial.placeholder;\n  var bound = function() {\n    var position = 0, length = boundArgs.length;\n    var args = Array(length);\n    for (var i = 0; i < length; i++) {\n      args[i] = boundArgs[i] === placeholder ? arguments[position++] : boundArgs[i];\n    }\n    while (position < arguments.length) args.push(arguments[position++]);\n    return executeBound(func, bound, this, this, args);\n  };\n  return bound;\n});\n\npartial.placeholder = _;\nexport default partial;\n","import restArguments from './restArguments.js';\nimport isFunction from './isFunction.js';\nimport executeBound from './_executeBound.js';\n\n// Create a function bound to a given object (assigning `this`, and arguments,\n// optionally).\nexport default restArguments(function(func, context, args) {\n  if (!isFunction(func)) throw new TypeError('Bind must be called on a function');\n  var bound = restArguments(function(callArgs) {\n    return executeBound(func, bound, context, this, args.concat(callArgs));\n  });\n  return bound;\n});\n","import createSizePropertyCheck from './_createSizePropertyCheck.js';\nimport getLength from './_getLength.js';\n\n// Internal helper for collection methods to determine whether a collection\n// should be iterated as an array or as an object.\n// Related: https://people.mozilla.org/~jorendorff/es6-draft.html#sec-tolength\n// Avoids a very nasty iOS 8 JIT bug on ARM-64. #2094\nexport default createSizePropertyCheck(getLength);\n","import getLength from './_getLength.js';\nimport isArrayLike from './_isArrayLike.js';\nimport isArray from './isArray.js';\nimport isArguments from './isArguments.js';\n\n// Internal implementation of a recursive `flatten` function.\nexport default function flatten(input, depth, strict, output) {\n  output = output || [];\n  if (!depth && depth !== 0) {\n    depth = Infinity;\n  } else if (depth <= 0) {\n    return output.concat(input);\n  }\n  var idx = output.length;\n  for (var i = 0, length = getLength(input); i < length; i++) {\n    var value = input[i];\n    if (isArrayLike(value) && (isArray(value) || isArguments(value))) {\n      // Flatten current level of array or arguments object.\n      if (depth > 1) {\n        flatten(value, depth - 1, strict, output);\n        idx = output.length;\n      } else {\n        var j = 0, len = value.length;\n        while (j < len) output[idx++] = value[j++];\n      }\n    } else if (!strict) {\n      output[idx++] = value;\n    }\n  }\n  return output;\n}\n","import restArguments from './restArguments.js';\nimport flatten from './_flatten.js';\nimport bind from './bind.js';\n\n// Bind a number of an object's methods to that object. Remaining arguments\n// are the method names to be bound. Useful for ensuring that all callbacks\n// defined on an object belong to it.\nexport default restArguments(function(obj, keys) {\n  keys = flatten(keys, false, false);\n  var index = keys.length;\n  if (index < 1) throw new Error('bindAll must be passed function names');\n  while (index--) {\n    var key = keys[index];\n    obj[key] = bind(obj[key], obj);\n  }\n  return obj;\n});\n","import has from './_has.js';\n\n// Memoize an expensive function by storing its results.\nexport default function memoize(func, hasher) {\n  var memoize = function(key) {\n    var cache = memoize.cache;\n    var address = '' + (hasher ? hasher.apply(this, arguments) : key);\n    if (!has(cache, address)) cache[address] = func.apply(this, arguments);\n    return cache[address];\n  };\n  memoize.cache = {};\n  return memoize;\n}\n","import restArguments from './restArguments.js';\n\n// Delays a function for the given number of milliseconds, and then calls\n// it with the arguments supplied.\nexport default restArguments(function(func, wait, args) {\n  return setTimeout(function() {\n    return func.apply(null, args);\n  }, wait);\n});\n","import partial from './partial.js';\nimport delay from './delay.js';\nimport _ from './underscore.js';\n\n// Defers a function, scheduling it to run after the current call stack has\n// cleared.\nexport default partial(delay, _, 1);\n","import now from './now.js';\n\n// Returns a function, that, when invoked, will only be triggered at most once\n// during a given window of time. Normally, the throttled function will run\n// as much as it can, without ever going more than once per `wait` duration;\n// but if you'd like to disable the execution on the leading edge, pass\n// `{leading: false}`. To disable execution on the trailing edge, ditto.\nexport default function throttle(func, wait, options) {\n  var timeout, context, args, result;\n  var previous = 0;\n  if (!options) options = {};\n\n  var later = function() {\n    previous = options.leading === false ? 0 : now();\n    timeout = null;\n    result = func.apply(context, args);\n    if (!timeout) context = args = null;\n  };\n\n  var throttled = function() {\n    var _now = now();\n    if (!previous && options.leading === false) previous = _now;\n    var remaining = wait - (_now - previous);\n    context = this;\n    args = arguments;\n    if (remaining <= 0 || remaining > wait) {\n      if (timeout) {\n        clearTimeout(timeout);\n        timeout = null;\n      }\n      previous = _now;\n      result = func.apply(context, args);\n      if (!timeout) context = args = null;\n    } else if (!timeout && options.trailing !== false) {\n      timeout = setTimeout(later, remaining);\n    }\n    return result;\n  };\n\n  throttled.cancel = function() {\n    clearTimeout(timeout);\n    previous = 0;\n    timeout = context = args = null;\n  };\n\n  return throttled;\n}\n","import restArguments from './restArguments.js';\nimport now from './now.js';\n\n// When a sequence of calls of the returned function ends, the argument\n// function is triggered. The end of a sequence is defined by the `wait`\n// parameter. If `immediate` is passed, the argument function will be\n// triggered at the beginning of the sequence instead of at the end.\nexport default function debounce(func, wait, immediate) {\n  var timeout, previous, args, result, context;\n\n  var later = function() {\n    var passed = now() - previous;\n    if (wait > passed) {\n      timeout = setTimeout(later, wait - passed);\n    } else {\n      timeout = null;\n      if (!immediate) result = func.apply(context, args);\n      // This check is needed because `func` can recursively invoke `debounced`.\n      if (!timeout) args = context = null;\n    }\n  };\n\n  var debounced = restArguments(function(_args) {\n    context = this;\n    args = _args;\n    previous = now();\n    if (!timeout) {\n      timeout = setTimeout(later, wait);\n      if (immediate) result = func.apply(context, args);\n    }\n    return result;\n  });\n\n  debounced.cancel = function() {\n    clearTimeout(timeout);\n    timeout = args = context = null;\n  };\n\n  return debounced;\n}\n","import partial from './partial.js';\n\n// Returns the first function passed as an argument to the second,\n// allowing you to adjust arguments, run code before and after, and\n// conditionally execute the original function.\nexport default function wrap(func, wrapper) {\n  return partial(wrapper, func);\n}\n","// Returns a negated version of the passed-in predicate.\nexport default function negate(predicate) {\n  return function() {\n    return !predicate.apply(this, arguments);\n  };\n}\n","// Returns a function that is the composition of a list of functions, each\n// consuming the return value of the function that follows.\nexport default function compose() {\n  var args = arguments;\n  var start = args.length - 1;\n  return function() {\n    var i = start;\n    var result = args[start].apply(this, arguments);\n    while (i--) result = args[i].call(this, result);\n    return result;\n  };\n}\n","// Returns a function that will only be executed on and after the Nth call.\nexport default function after(times, func) {\n  return function() {\n    if (--times < 1) {\n      return func.apply(this, arguments);\n    }\n  };\n}\n","// Returns a function that will only be executed up to (but not including) the\n// Nth call.\nexport default function before(times, func) {\n  var memo;\n  return function() {\n    if (--times > 0) {\n      memo = func.apply(this, arguments);\n    }\n    if (times <= 1) func = null;\n    return memo;\n  };\n}\n","import partial from './partial.js';\nimport before from './before.js';\n\n// Returns a function that will be executed at most one time, no matter how\n// often you call it. Useful for lazy initialization.\nexport default partial(before, 2);\n","import cb from './_cb.js';\nimport keys from './keys.js';\n\n// Returns the first key on an object that passes a truth test.\nexport default function findKey(obj, predicate, context) {\n  predicate = cb(predicate, context);\n  var _keys = keys(obj), key;\n  for (var i = 0, length = _keys.length; i < length; i++) {\n    key = _keys[i];\n    if (predicate(obj[key], key, obj)) return key;\n  }\n}\n","import cb from './_cb.js';\nimport getLength from './_getLength.js';\n\n// Internal function to generate `_.findIndex` and `_.findLastIndex`.\nexport default function createPredicateIndexFinder(dir) {\n  return function(array, predicate, context) {\n    predicate = cb(predicate, context);\n    var length = getLength(array);\n    var index = dir > 0 ? 0 : length - 1;\n    for (; index >= 0 && index < length; index += dir) {\n      if (predicate(array[index], index, array)) return index;\n    }\n    return -1;\n  };\n}\n","import createPredicateIndexFinder from './_createPredicateIndexFinder.js';\n\n// Returns the first index on an array-like that passes a truth test.\nexport default createPredicateIndexFinder(1);\n","import createPredicateIndexFinder from './_createPredicateIndexFinder.js';\n\n// Returns the last index on an array-like that passes a truth test.\nexport default createPredicateIndexFinder(-1);\n","import cb from './_cb.js';\nimport getLength from './_getLength.js';\n\n// Use a comparator function to figure out the smallest index at which\n// an object should be inserted so as to maintain order. Uses binary search.\nexport default function sortedIndex(array, obj, iteratee, context) {\n  iteratee = cb(iteratee, context, 1);\n  var value = iteratee(obj);\n  var low = 0, high = getLength(array);\n  while (low < high) {\n    var mid = Math.floor((low + high) / 2);\n    if (iteratee(array[mid]) < value) low = mid + 1; else high = mid;\n  }\n  return low;\n}\n","import getLength from './_getLength.js';\nimport { slice } from './_setup.js';\nimport isNaN from './isNaN.js';\n\n// Internal function to generate the `_.indexOf` and `_.lastIndexOf` functions.\nexport default function createIndexFinder(dir, predicateFind, sortedIndex) {\n  return function(array, item, idx) {\n    var i = 0, length = getLength(array);\n    if (typeof idx == 'number') {\n      if (dir > 0) {\n        i = idx >= 0 ? idx : Math.max(idx + length, i);\n      } else {\n        length = idx >= 0 ? Math.min(idx + 1, length) : idx + length + 1;\n      }\n    } else if (sortedIndex && idx && length) {\n      idx = sortedIndex(array, item);\n      return array[idx] === item ? idx : -1;\n    }\n    if (item !== item) {\n      idx = predicateFind(slice.call(array, i, length), isNaN);\n      return idx >= 0 ? idx + i : -1;\n    }\n    for (idx = dir > 0 ? i : length - 1; idx >= 0 && idx < length; idx += dir) {\n      if (array[idx] === item) return idx;\n    }\n    return -1;\n  };\n}\n","import sortedIndex from './sortedIndex.js';\nimport findIndex from './findIndex.js';\nimport createIndexFinder from './_createIndexFinder.js';\n\n// Return the position of the first occurrence of an item in an array,\n// or -1 if the item is not included in the array.\n// If the array is large and already in sort order, pass `true`\n// for **isSorted** to use binary search.\nexport default createIndexFinder(1, findIndex, sortedIndex);\n","import findLastIndex from './findLastIndex.js';\nimport createIndexFinder from './_createIndexFinder.js';\n\n// Return the position of the last occurrence of an item in an array,\n// or -1 if the item is not included in the array.\nexport default createIndexFinder(-1, findLastIndex);\n","import isArrayLike from './_isArrayLike.js';\nimport findIndex from './findIndex.js';\nimport findKey from './findKey.js';\n\n// Return the first value which passes a truth test.\nexport default function find(obj, predicate, context) {\n  var keyFinder = isArrayLike(obj) ? findIndex : findKey;\n  var key = keyFinder(obj, predicate, context);\n  if (key !== void 0 && key !== -1) return obj[key];\n}\n","import find from './find.js';\nimport matcher from './matcher.js';\n\n// Convenience version of a common use case of `_.find`: getting the first\n// object containing specific `key:value` pairs.\nexport default function findWhere(obj, attrs) {\n  return find(obj, matcher(attrs));\n}\n","import optimizeCb from './_optimizeCb.js';\nimport isArrayLike from './_isArrayLike.js';\nimport keys from './keys.js';\n\n// The cornerstone for collection functions, an `each`\n// implementation, aka `forEach`.\n// Handles raw objects in addition to array-likes. Treats all\n// sparse array-likes as if they were dense.\nexport default function each(obj, iteratee, context) {\n  iteratee = optimizeCb(iteratee, context);\n  var i, length;\n  if (isArrayLike(obj)) {\n    for (i = 0, length = obj.length; i < length; i++) {\n      iteratee(obj[i], i, obj);\n    }\n  } else {\n    var _keys = keys(obj);\n    for (i = 0, length = _keys.length; i < length; i++) {\n      iteratee(obj[_keys[i]], _keys[i], obj);\n    }\n  }\n  return obj;\n}\n","import cb from './_cb.js';\nimport isArrayLike from './_isArrayLike.js';\nimport keys from './keys.js';\n\n// Return the results of applying the iteratee to each element.\nexport default function map(obj, iteratee, context) {\n  iteratee = cb(iteratee, context);\n  var _keys = !isArrayLike(obj) && keys(obj),\n      length = (_keys || obj).length,\n      results = Array(length);\n  for (var index = 0; index < length; index++) {\n    var currentKey = _keys ? _keys[index] : index;\n    results[index] = iteratee(obj[currentKey], currentKey, obj);\n  }\n  return results;\n}\n","import isArrayLike from './_isArrayLike.js';\nimport keys from './keys.js';\nimport optimizeCb from './_optimizeCb.js';\n\n// Internal helper to create a reducing function, iterating left or right.\nexport default function createReduce(dir) {\n  // Wrap code that reassigns argument variables in a separate function than\n  // the one that accesses `arguments.length` to avoid a perf hit. (#1991)\n  var reducer = function(obj, iteratee, memo, initial) {\n    var _keys = !isArrayLike(obj) && keys(obj),\n        length = (_keys || obj).length,\n        index = dir > 0 ? 0 : length - 1;\n    if (!initial) {\n      memo = obj[_keys ? _keys[index] : index];\n      index += dir;\n    }\n    for (; index >= 0 && index < length; index += dir) {\n      var currentKey = _keys ? _keys[index] : index;\n      memo = iteratee(memo, obj[currentKey], currentKey, obj);\n    }\n    return memo;\n  };\n\n  return function(obj, iteratee, memo, context) {\n    var initial = arguments.length >= 3;\n    return reducer(obj, optimizeCb(iteratee, context, 4), memo, initial);\n  };\n}\n","import createReduce from './_createReduce.js';\n\n// **Reduce** builds up a single result from a list of values, aka `inject`,\n// or `foldl`.\nexport default createReduce(1);\n","import createReduce from './_createReduce.js';\n\n// The right-associative version of reduce, also known as `foldr`.\nexport default createReduce(-1);\n","import cb from './_cb.js';\nimport each from './each.js';\n\n// Return all the elements that pass a truth test.\nexport default function filter(obj, predicate, context) {\n  var results = [];\n  predicate = cb(predicate, context);\n  each(obj, function(value, index, list) {\n    if (predicate(value, index, list)) results.push(value);\n  });\n  return results;\n}\n","import filter from './filter.js';\nimport negate from './negate.js';\nimport cb from './_cb.js';\n\n// Return all the elements for which a truth test fails.\nexport default function reject(obj, predicate, context) {\n  return filter(obj, negate(cb(predicate)), context);\n}\n","import cb from './_cb.js';\nimport isArrayLike from './_isArrayLike.js';\nimport keys from './keys.js';\n\n// Determine whether all of the elements pass a truth test.\nexport default function every(obj, predicate, context) {\n  predicate = cb(predicate, context);\n  var _keys = !isArrayLike(obj) && keys(obj),\n      length = (_keys || obj).length;\n  for (var index = 0; index < length; index++) {\n    var currentKey = _keys ? _keys[index] : index;\n    if (!predicate(obj[currentKey], currentKey, obj)) return false;\n  }\n  return true;\n}\n","import cb from './_cb.js';\nimport isArrayLike from './_isArrayLike.js';\nimport keys from './keys.js';\n\n// Determine if at least one element in the object passes a truth test.\nexport default function some(obj, predicate, context) {\n  predicate = cb(predicate, context);\n  var _keys = !isArrayLike(obj) && keys(obj),\n      length = (_keys || obj).length;\n  for (var index = 0; index < length; index++) {\n    var currentKey = _keys ? _keys[index] : index;\n    if (predicate(obj[currentKey], currentKey, obj)) return true;\n  }\n  return false;\n}\n","import isArrayLike from './_isArrayLike.js';\nimport values from './values.js';\nimport indexOf from './indexOf.js';\n\n// Determine if the array or object contains a given item (using `===`).\nexport default function contains(obj, item, fromIndex, guard) {\n  if (!isArrayLike(obj)) obj = values(obj);\n  if (typeof fromIndex != 'number' || guard) fromIndex = 0;\n  return indexOf(obj, item, fromIndex) >= 0;\n}\n","import restArguments from './restArguments.js';\nimport isFunction from './isFunction.js';\nimport map from './map.js';\nimport deepGet from './_deepGet.js';\nimport toPath from './_toPath.js';\n\n// Invoke a method (with arguments) on every item in a collection.\nexport default restArguments(function(obj, path, args) {\n  var contextPath, func;\n  if (isFunction(path)) {\n    func = path;\n  } else {\n    path = toPath(path);\n    contextPath = path.slice(0, -1);\n    path = path[path.length - 1];\n  }\n  return map(obj, function(context) {\n    var method = func;\n    if (!method) {\n      if (contextPath && contextPath.length) {\n        context = deepGet(context, contextPath);\n      }\n      if (context == null) return void 0;\n      method = context[path];\n    }\n    return method == null ? method : method.apply(context, args);\n  });\n});\n","import map from './map.js';\nimport property from './property.js';\n\n// Convenience version of a common use case of `_.map`: fetching a property.\nexport default function pluck(obj, key) {\n  return map(obj, property(key));\n}\n","import filter from './filter.js';\nimport matcher from './matcher.js';\n\n// Convenience version of a common use case of `_.filter`: selecting only\n// objects containing specific `key:value` pairs.\nexport default function where(obj, attrs) {\n  return filter(obj, matcher(attrs));\n}\n","import isArrayLike from './_isArrayLike.js';\nimport values from './values.js';\nimport cb from './_cb.js';\nimport each from './each.js';\n\n// Return the maximum element (or element-based computation).\nexport default function max(obj, iteratee, context) {\n  var result = -Infinity, lastComputed = -Infinity,\n      value, computed;\n  if (iteratee == null || (typeof iteratee == 'number' && typeof obj[0] != 'object' && obj != null)) {\n    obj = isArrayLike(obj) ? obj : values(obj);\n    for (var i = 0, length = obj.length; i < length; i++) {\n      value = obj[i];\n      if (value != null && value > result) {\n        result = value;\n      }\n    }\n  } else {\n    iteratee = cb(iteratee, context);\n    each(obj, function(v, index, list) {\n      computed = iteratee(v, index, list);\n      if (computed > lastComputed || (computed === -Infinity && result === -Infinity)) {\n        result = v;\n        lastComputed = computed;\n      }\n    });\n  }\n  return result;\n}\n","import isArrayLike from './_isArrayLike.js';\nimport values from './values.js';\nimport cb from './_cb.js';\nimport each from './each.js';\n\n// Return the minimum element (or element-based computation).\nexport default function min(obj, iteratee, context) {\n  var result = Infinity, lastComputed = Infinity,\n      value, computed;\n  if (iteratee == null || (typeof iteratee == 'number' && typeof obj[0] != 'object' && obj != null)) {\n    obj = isArrayLike(obj) ? obj : values(obj);\n    for (var i = 0, length = obj.length; i < length; i++) {\n      value = obj[i];\n      if (value != null && value < result) {\n        result = value;\n      }\n    }\n  } else {\n    iteratee = cb(iteratee, context);\n    each(obj, function(v, index, list) {\n      computed = iteratee(v, index, list);\n      if (computed < lastComputed || (computed === Infinity && result === Infinity)) {\n        result = v;\n        lastComputed = computed;\n      }\n    });\n  }\n  return result;\n}\n","import isArray from './isArray.js';\nimport { slice } from './_setup.js';\nimport isString from './isString.js';\nimport isArrayLike from './_isArrayLike.js';\nimport map from './map.js';\nimport identity from './identity.js';\nimport values from './values.js';\n\n// Safely create a real, live array from anything iterable.\nvar reStrSymbol = /[^\\ud800-\\udfff]|[\\ud800-\\udbff][\\udc00-\\udfff]|[\\ud800-\\udfff]/g;\nexport default function toArray(obj) {\n  if (!obj) return [];\n  if (isArray(obj)) return slice.call(obj);\n  if (isString(obj)) {\n    // Keep surrogate pair characters together.\n    return obj.match(reStrSymbol);\n  }\n  if (isArrayLike(obj)) return map(obj, identity);\n  return values(obj);\n}\n","import isArrayLike from './_isArrayLike.js';\nimport values from './values.js';\nimport getLength from './_getLength.js';\nimport random from './random.js';\nimport toArray from './toArray.js';\n\n// Sample **n** random values from a collection using the modern version of the\n// [Fisher-Yates shuffle](https://en.wikipedia.org/wiki/Fisher–Yates_shuffle).\n// If **n** is not specified, returns a single random element.\n// The internal `guard` argument allows it to work with `_.map`.\nexport default function sample(obj, n, guard) {\n  if (n == null || guard) {\n    if (!isArrayLike(obj)) obj = values(obj);\n    return obj[random(obj.length - 1)];\n  }\n  var sample = toArray(obj);\n  var length = getLength(sample);\n  n = Math.max(Math.min(n, length), 0);\n  var last = length - 1;\n  for (var index = 0; index < n; index++) {\n    var rand = random(index, last);\n    var temp = sample[index];\n    sample[index] = sample[rand];\n    sample[rand] = temp;\n  }\n  return sample.slice(0, n);\n}\n","import sample from './sample.js';\n\n// Shuffle a collection.\nexport default function shuffle(obj) {\n  return sample(obj, Infinity);\n}\n","import cb from './_cb.js';\nimport pluck from './pluck.js';\nimport map from './map.js';\n\n// Sort the object's values by a criterion produced by an iteratee.\nexport default function sortBy(obj, iteratee, context) {\n  var index = 0;\n  iteratee = cb(iteratee, context);\n  return pluck(map(obj, function(value, key, list) {\n    return {\n      value: value,\n      index: index++,\n      criteria: iteratee(value, key, list)\n    };\n  }).sort(function(left, right) {\n    var a = left.criteria;\n    var b = right.criteria;\n    if (a !== b) {\n      if (a > b || a === void 0) return 1;\n      if (a < b || b === void 0) return -1;\n    }\n    return left.index - right.index;\n  }), 'value');\n}\n","import cb from './_cb.js';\nimport each from './each.js';\n\n// An internal function used for aggregate \"group by\" operations.\nexport default function group(behavior, partition) {\n  return function(obj, iteratee, context) {\n    var result = partition ? [[], []] : {};\n    iteratee = cb(iteratee, context);\n    each(obj, function(value, index) {\n      var key = iteratee(value, index, obj);\n      behavior(result, value, key);\n    });\n    return result;\n  };\n}\n","import group from './_group.js';\nimport has from './_has.js';\n\n// Groups the object's values by a criterion. Pass either a string attribute\n// to group by, or a function that returns the criterion.\nexport default group(function(result, value, key) {\n  if (has(result, key)) result[key].push(value); else result[key] = [value];\n});\n","import group from './_group.js';\n\n// Indexes the object's values by a criterion, similar to `_.groupBy`, but for\n// when you know that your index values will be unique.\nexport default group(function(result, value, key) {\n  result[key] = value;\n});\n","import group from './_group.js';\nimport has from './_has.js';\n\n// Counts instances of an object that group by a certain criterion. Pass\n// either a string attribute to count by, or a function that returns the\n// criterion.\nexport default group(function(result, value, key) {\n  if (has(result, key)) result[key]++; else result[key] = 1;\n});\n","import group from './_group.js';\n\n// Split a collection into two arrays: one whose elements all pass the given\n// truth test, and one whose elements all do not pass the truth test.\nexport default group(function(result, value, pass) {\n  result[pass ? 0 : 1].push(value);\n}, true);\n","import isArrayLike from './_isArrayLike.js';\nimport keys from './keys.js';\n\n// Return the number of elements in a collection.\nexport default function size(obj) {\n  if (obj == null) return 0;\n  return isArrayLike(obj) ? obj.length : keys(obj).length;\n}\n","// Internal `_.pick` helper function to determine whether `key` is an enumerable\n// property name of `obj`.\nexport default function keyInObj(value, key, obj) {\n  return key in obj;\n}\n","import restArguments from './restArguments.js';\nimport isFunction from './isFunction.js';\nimport optimizeCb from './_optimizeCb.js';\nimport allKeys from './allKeys.js';\nimport keyInObj from './_keyInObj.js';\nimport flatten from './_flatten.js';\n\n// Return a copy of the object only containing the allowed properties.\nexport default restArguments(function(obj, keys) {\n  var result = {}, iteratee = keys[0];\n  if (obj == null) return result;\n  if (isFunction(iteratee)) {\n    if (keys.length > 1) iteratee = optimizeCb(iteratee, keys[1]);\n    keys = allKeys(obj);\n  } else {\n    iteratee = keyInObj;\n    keys = flatten(keys, false, false);\n    obj = Object(obj);\n  }\n  for (var i = 0, length = keys.length; i < length; i++) {\n    var key = keys[i];\n    var value = obj[key];\n    if (iteratee(value, key, obj)) result[key] = value;\n  }\n  return result;\n});\n","import restArguments from './restArguments.js';\nimport isFunction from './isFunction.js';\nimport negate from './negate.js';\nimport map from './map.js';\nimport flatten from './_flatten.js';\nimport contains from './contains.js';\nimport pick from './pick.js';\n\n// Return a copy of the object without the disallowed properties.\nexport default restArguments(function(obj, keys) {\n  var iteratee = keys[0], context;\n  if (isFunction(iteratee)) {\n    iteratee = negate(iteratee);\n    if (keys.length > 1) context = keys[1];\n  } else {\n    keys = map(flatten(keys, false, false), String);\n    iteratee = function(value, key) {\n      return !contains(keys, key);\n    };\n  }\n  return pick(obj, iteratee, context);\n});\n","import { slice } from './_setup.js';\n\n// Returns everything but the last entry of the array. Especially useful on\n// the arguments object. Passing **n** will return all the values in\n// the array, excluding the last N.\nexport default function initial(array, n, guard) {\n  return slice.call(array, 0, Math.max(0, array.length - (n == null || guard ? 1 : n)));\n}\n","import initial from './initial.js';\n\n// Get the first element of an array. Passing **n** will return the first N\n// values in the array. The **guard** check allows it to work with `_.map`.\nexport default function first(array, n, guard) {\n  if (array == null || array.length < 1) return n == null || guard ? void 0 : [];\n  if (n == null || guard) return array[0];\n  return initial(array, array.length - n);\n}\n","import { slice } from './_setup.js';\n\n// Returns everything but the first entry of the `array`. Especially useful on\n// the `arguments` object. Passing an **n** will return the rest N values in the\n// `array`.\nexport default function rest(array, n, guard) {\n  return slice.call(array, n == null || guard ? 1 : n);\n}\n","import rest from './rest.js';\n\n// Get the last element of an array. Passing **n** will return the last N\n// values in the array.\nexport default function last(array, n, guard) {\n  if (array == null || array.length < 1) return n == null || guard ? void 0 : [];\n  if (n == null || guard) return array[array.length - 1];\n  return rest(array, Math.max(0, array.length - n));\n}\n","import filter from './filter.js';\n\n// Trim out all falsy values from an array.\nexport default function compact(array) {\n  return filter(array, Boolean);\n}\n","import _flatten from './_flatten.js';\n\n// Flatten out an array, either recursively (by default), or up to `depth`.\n// Passing `true` or `false` as `depth` means `1` or `Infinity`, respectively.\nexport default function flatten(array, depth) {\n  return _flatten(array, depth, false);\n}\n","import restArguments from './restArguments.js';\nimport flatten from './_flatten.js';\nimport filter from './filter.js';\nimport contains from './contains.js';\n\n// Take the difference between one array and a number of other arrays.\n// Only the elements present in just the first array will remain.\nexport default restArguments(function(array, rest) {\n  rest = flatten(rest, true, true);\n  return filter(array, function(value){\n    return !contains(rest, value);\n  });\n});\n","import restArguments from './restArguments.js';\nimport difference from './difference.js';\n\n// Return a version of the array that does not contain the specified value(s).\nexport default restArguments(function(array, otherArrays) {\n  return difference(array, otherArrays);\n});\n","import isBoolean from './isBoolean.js';\nimport cb from './_cb.js';\nimport getLength from './_getLength.js';\nimport contains from './contains.js';\n\n// Produce a duplicate-free version of the array. If the array has already\n// been sorted, you have the option of using a faster algorithm.\n// The faster algorithm will not work with an iteratee if the iteratee\n// is not a one-to-one function, so providing an iteratee will disable\n// the faster algorithm.\nexport default function uniq(array, isSorted, iteratee, context) {\n  if (!isBoolean(isSorted)) {\n    context = iteratee;\n    iteratee = isSorted;\n    isSorted = false;\n  }\n  if (iteratee != null) iteratee = cb(iteratee, context);\n  var result = [];\n  var seen = [];\n  for (var i = 0, length = getLength(array); i < length; i++) {\n    var value = array[i],\n        computed = iteratee ? iteratee(value, i, array) : value;\n    if (isSorted && !iteratee) {\n      if (!i || seen !== computed) result.push(value);\n      seen = computed;\n    } else if (iteratee) {\n      if (!contains(seen, computed)) {\n        seen.push(computed);\n        result.push(value);\n      }\n    } else if (!contains(result, value)) {\n      result.push(value);\n    }\n  }\n  return result;\n}\n","import restArguments from './restArguments.js';\nimport uniq from './uniq.js';\nimport flatten from './_flatten.js';\n\n// Produce an array that contains the union: each distinct element from all of\n// the passed-in arrays.\nexport default restArguments(function(arrays) {\n  return uniq(flatten(arrays, true, true));\n});\n","import getLength from './_getLength.js';\nimport contains from './contains.js';\n\n// Produce an array that contains every item shared between all the\n// passed-in arrays.\nexport default function intersection(array) {\n  var result = [];\n  var argsLength = arguments.length;\n  for (var i = 0, length = getLength(array); i < length; i++) {\n    var item = array[i];\n    if (contains(result, item)) continue;\n    var j;\n    for (j = 1; j < argsLength; j++) {\n      if (!contains(arguments[j], item)) break;\n    }\n    if (j === argsLength) result.push(item);\n  }\n  return result;\n}\n","import max from './max.js';\nimport getLength from './_getLength.js';\nimport pluck from './pluck.js';\n\n// Complement of zip. Unzip accepts an array of arrays and groups\n// each array's elements on shared indices.\nexport default function unzip(array) {\n  var length = (array && max(array, getLength).length) || 0;\n  var result = Array(length);\n\n  for (var index = 0; index < length; index++) {\n    result[index] = pluck(array, index);\n  }\n  return result;\n}\n","import restArguments from './restArguments.js';\nimport unzip from './unzip.js';\n\n// Zip together multiple lists into a single array -- elements that share\n// an index go together.\nexport default restArguments(unzip);\n","import getLength  from './_getLength.js';\n\n// Converts lists into objects. Pass either a single array of `[key, value]`\n// pairs, or two parallel arrays of the same length -- one of keys, and one of\n// the corresponding values. Passing by pairs is the reverse of `_.pairs`.\nexport default function object(list, values) {\n  var result = {};\n  for (var i = 0, length = getLength(list); i < length; i++) {\n    if (values) {\n      result[list[i]] = values[i];\n    } else {\n      result[list[i][0]] = list[i][1];\n    }\n  }\n  return result;\n}\n","// Generate an integer Array containing an arithmetic progression. A port of\n// the native Python `range()` function. See\n// [the Python documentation](https://docs.python.org/library/functions.html#range).\nexport default function range(start, stop, step) {\n  if (stop == null) {\n    stop = start || 0;\n    start = 0;\n  }\n  if (!step) {\n    step = stop < start ? -1 : 1;\n  }\n\n  var length = Math.max(Math.ceil((stop - start) / step), 0);\n  var range = Array(length);\n\n  for (var idx = 0; idx < length; idx++, start += step) {\n    range[idx] = start;\n  }\n\n  return range;\n}\n","import { slice } from './_setup.js';\n\n// Chunk a single array into multiple arrays, each containing `count` or fewer\n// items.\nexport default function chunk(array, count) {\n  if (count == null || count < 1) return [];\n  var result = [];\n  var i = 0, length = array.length;\n  while (i < length) {\n    result.push(slice.call(array, i, i += count));\n  }\n  return result;\n}\n","import _ from './underscore.js';\n\n// Helper function to continue chaining intermediate results.\nexport default function chainResult(instance, obj) {\n  return instance._chain ? _(obj).chain() : obj;\n}\n","import _ from './underscore.js';\nimport each from './each.js';\nimport functions from './functions.js';\nimport { push } from './_setup.js';\nimport chainResult from './_chainResult.js';\n\n// Add your own custom functions to the Underscore object.\nexport default function mixin(obj) {\n  each(functions(obj), function(name) {\n    var func = _[name] = obj[name];\n    _.prototype[name] = function() {\n      var args = [this._wrapped];\n      push.apply(args, arguments);\n      return chainResult(this, func.apply(_, args));\n    };\n  });\n  return _;\n}\n","import _ from './underscore.js';\nimport each from './each.js';\nimport { ArrayProto } from './_setup.js';\nimport chainResult from './_chainResult.js';\n\n// Add all mutator `Array` functions to the wrapper.\neach(['pop', 'push', 'reverse', 'shift', 'sort', 'splice', 'unshift'], function(name) {\n  var method = ArrayProto[name];\n  _.prototype[name] = function() {\n    var obj = this._wrapped;\n    if (obj != null) {\n      method.apply(obj, arguments);\n      if ((name === 'shift' || name === 'splice') && obj.length === 0) {\n        delete obj[0];\n      }\n    }\n    return chainResult(this, obj);\n  };\n});\n\n// Add all accessor `Array` functions to the wrapper.\neach(['concat', 'join', 'slice'], function(name) {\n  var method = ArrayProto[name];\n  _.prototype[name] = function() {\n    var obj = this._wrapped;\n    if (obj != null) obj = method.apply(obj, arguments);\n    return chainResult(this, obj);\n  };\n});\n\nexport default _;\n","// Default Export\n// ==============\n// In this module, we mix our bundled exports into the `_` object and export\n// the result. This is analogous to setting `module.exports = _` in CommonJS.\n// Hence, this module is also the entry point of our UMD bundle and the package\n// entry point for CommonJS and AMD users. In other words, this is (the source\n// of) the module you are interfacing with when you do any of the following:\n//\n// ```js\n// // CommonJS\n// var _ = require('underscore');\n//\n// // AMD\n// define(['underscore'], function(_) {...});\n//\n// // UMD in the browser\n// // _ is available as a global variable\n// ```\nimport * as allExports from './index.js';\nimport { mixin } from './index.js';\n\n// Add all of the Underscore functions to the wrapper object.\nvar _ = mixin(allExports);\n// Legacy Node.js API.\n_._ = _;\n// Export the Underscore API.\nexport default _;\n","/** @hidden */\nfunction nop() { }\n/** @hidden */\nconst isArray = Array.isArray || function (xs) { return xs instanceof Array; };\n/** @hidden */\nfunction isObservable(x) {\n    return x && x._isObservable;\n}\n\n/** @hidden */\nfunction all(xs, f) {\n    for (var i = 0, x; i < xs.length; i++) {\n        x = xs[i];\n        if (!f(x)) {\n            return false;\n        }\n    }\n    return true;\n}\n/** @hidden */\nfunction always(x) { return () => x; }\n/** @hidden */\nfunction any(xs, f) {\n    for (var i = 0, x; i < xs.length; i++) {\n        x = xs[i];\n        if (f(x)) {\n            return true;\n        }\n    }\n    return false;\n}\n/** @hidden */\nfunction bind(fn, me) {\n    return function () { return fn.apply(me, arguments); };\n}\n/** @hidden */\nfunction contains(xs, x) { return indexOf(xs, x) !== -1; }\n/** @hidden */\nfunction each(xs, f) {\n    for (var key in xs) {\n        if (Object.prototype.hasOwnProperty.call(xs, key)) {\n            var value = xs[key];\n            f(key, value);\n        }\n    }\n}\n/** @hidden */\nfunction empty(xs) { return xs.length === 0; }\n/** @hidden */\nfunction filter(f, xs) {\n    var filtered = [];\n    for (var i = 0, x; i < xs.length; i++) {\n        x = xs[i];\n        if (f(x)) {\n            filtered.push(x);\n        }\n    }\n    return filtered;\n}\n/** @hidden */\nfunction flatMap(f, xs) {\n    return fold(xs, [], (function (ys, x) {\n        return ys.concat(f(x));\n    }));\n}\n/** @hidden */\nfunction flip(f) {\n    return (a, b) => f(b, a);\n}\n/** @hidden */\nfunction fold(xs, seed, f) {\n    for (var i = 0, x; i < xs.length; i++) {\n        x = xs[i];\n        seed = f(seed, x);\n    }\n    return seed;\n}\n/** @hidden */\nfunction head(xs) {\n    return xs[0];\n}\n/** @hidden */\nfunction id(x) { return x; }\n/** @hidden */\nfunction indexOfDefault(xs, x) { return xs.indexOf(x); }\n/** @hidden */\nfunction indexOfFallback(xs, x) {\n    for (var i = 0, y; i < xs.length; i++) {\n        y = xs[i];\n        if (x === y) {\n            return i;\n        }\n    }\n    return -1;\n}\n/** @hidden */\nconst indexOf = Array.prototype.indexOf ? indexOfDefault : indexOfFallback;\n/** @hidden */\nfunction indexWhere(xs, f) {\n    for (var i = 0, y; i < xs.length; i++) {\n        y = xs[i];\n        if (f(y)) {\n            return i;\n        }\n    }\n    return -1;\n}\n/** @hidden */\nfunction isFunction(f) { return typeof f === \"function\"; }\n/** @hidden */\nfunction last(xs) { return xs[xs.length - 1]; }\n/** @hidden */\nfunction map(f, xs) {\n    var result = [];\n    for (var i = 0, x; i < xs.length; i++) {\n        x = xs[i];\n        result.push(f(x));\n    }\n    return result;\n}\n/** @hidden */\nfunction negate(f) { return function (x) { return !f(x); }; }\n/** @hidden */\nfunction remove(x, xs) {\n    var i = indexOf(xs, x);\n    if (i >= 0) {\n        return xs.splice(i, 1);\n    }\n}\n/** @hidden */\nfunction tail(xs) {\n    return xs.slice(1, xs.length);\n}\n/** @hidden */\nfunction toArray(xs) { return (isArray(xs) ? xs : [xs]); }\n/** @hidden */\nfunction toFunction(f) {\n    if (typeof f == \"function\") {\n        return f;\n    }\n    return x => f;\n}\n/** @hidden */\nfunction toString(obj) {\n    var hasProp = {}.hasOwnProperty;\n    try {\n        recursionDepth++;\n        if (obj == null) {\n            return \"undefined\";\n        }\n        else if (isFunction(obj)) {\n            return \"function\";\n        }\n        else if (isArray(obj)) {\n            if (recursionDepth > 5) {\n                return \"[..]\";\n            }\n            return \"[\" + map(toString, obj).toString() + \"]\";\n        }\n        else if (((obj != null ? obj.toString : void 0) != null) && obj.toString !== Object.prototype.toString) {\n            return obj.toString();\n        }\n        else if (typeof obj === \"object\") {\n            if (recursionDepth > 5) {\n                return \"{..}\";\n            }\n            var results = [];\n            for (var key in obj) {\n                if (!hasProp.call(obj, key))\n                    continue;\n                let value = (function () {\n                    try {\n                        return obj[key];\n                    }\n                    catch (error) {\n                        return error;\n                    }\n                })();\n                results.push(toString(key) + \":\" + toString(value));\n            }\n            return \"{\" + results + \"}\";\n        }\n        else {\n            return obj;\n        }\n    }\n    finally {\n        recursionDepth--;\n    }\n}\n/** @hidden */\nfunction without(x, xs) {\n    return filter((function (y) { return y !== x; }), xs);\n}\nvar _ = {\n    indexOf,\n    indexWhere,\n    head,\n    always,\n    negate,\n    empty,\n    tail,\n    filter,\n    map,\n    each,\n    toArray,\n    contains,\n    id,\n    last,\n    all,\n    any,\n    without,\n    remove,\n    fold,\n    flatMap,\n    bind,\n    isFunction,\n    toFunction,\n    toString\n};\nvar recursionDepth = 0;\n\n/**\n * Reply for \"more data, please\".\n */\nconst more = undefined;\n/**\n * Reply for \"no more data, please\".\n */\nconst noMore = \"<no-more>\";\n\n/** @hidden */\nfunction assert(message, condition) {\n    if (!condition) {\n        throw new Error(message);\n    }\n}\n/** @hidden */\nfunction assertEventStream(event) {\n    if (!(event != null ? event._isEventStream : void 0)) {\n        throw new Error(\"not an EventStream : \" + event);\n    }\n}\n/** @hidden */\nfunction assertObservable(observable) {\n    if (!(observable != null ? observable._isObservable : void 0)) {\n        throw new Error(\"not an Observable : \" + observable);\n    }\n}\n/** @hidden */\nfunction assertFunction(f) {\n    return assert(\"not a function : \" + f, _.isFunction(f));\n}\n/** @hidden */\nfunction assertArray(xs) {\n    if (!isArray(xs)) {\n        throw new Error(\"not an array : \" + xs);\n    }\n}\n/** @hidden */\nfunction assertNoArguments(args) {\n    return assert(\"no arguments supported\", args.length === 0);\n}\n\n/** @hidden */\nconst defaultScheduler = {\n    setTimeout(f, d) { return setTimeout(f, d); },\n    setInterval(f, i) { return setInterval(f, i); },\n    clearInterval(id) { return clearInterval(id); },\n    clearTimeout(id) { return clearTimeout(id); },\n    now() { return new Date().getTime(); }\n};\nconst GlobalScheduler = {\n    scheduler: defaultScheduler\n};\nfunction getScheduler() {\n    return GlobalScheduler.scheduler;\n}\nfunction setScheduler(newScheduler) {\n    GlobalScheduler.scheduler = newScheduler;\n}\n\nvar rootEvent = undefined;\nvar waiterObs = [];\nvar waiters = {};\nvar aftersStack = [];\nvar aftersStackHeight = 0;\nvar flushed = {};\nvar processingAfters = false;\nfunction toString$1() {\n    return _.toString({ rootEvent, processingAfters, waiterObs, waiters, aftersStack, aftersStackHeight, flushed });\n}\nfunction ensureStackHeight(h) {\n    if (h <= aftersStackHeight)\n        return;\n    if (!aftersStack[h - 1]) {\n        aftersStack[h - 1] = [[], 0];\n    }\n    aftersStackHeight = h;\n}\nfunction isInTransaction() {\n    return rootEvent !== undefined;\n}\nfunction soonButNotYet(obs, f) {\n    if (rootEvent) {\n        // If in transaction -> perform within transaction\n        //console.log('in tx')\n        whenDoneWith(obs, f);\n    }\n    else {\n        // Otherwise -> perform with timeout\n        //console.log('with timeout')\n        GlobalScheduler.scheduler.setTimeout(f, 0);\n    }\n}\nfunction afterTransaction(obs, f) {\n    if (rootEvent || processingAfters) {\n        ensureStackHeight(1);\n        var stackIndexForThisObs = 0;\n        while (stackIndexForThisObs < aftersStackHeight - 1) {\n            if (containsObs(obs, aftersStack[stackIndexForThisObs][0])) {\n                // this observable is already being processed at this stack index -> use this index\n                break;\n            }\n            stackIndexForThisObs++;\n        }\n        var listFromStack = aftersStack[stackIndexForThisObs][0];\n        listFromStack.push([obs, f]);\n        if (!rootEvent) {\n            processAfters(); // wouldn't be called otherwise\n        }\n    }\n    else {\n        return f();\n    }\n}\nfunction containsObs(obs, aftersList) {\n    for (var i = 0; i < aftersList.length; i++) {\n        if (aftersList[i][0].id == obs.id)\n            return true;\n    }\n    return false;\n}\nfunction processAfters() {\n    let stackSizeAtStart = aftersStackHeight;\n    if (!stackSizeAtStart)\n        return;\n    let isRoot = !processingAfters;\n    processingAfters = true;\n    try {\n        while (aftersStackHeight >= stackSizeAtStart) { // to prevent sinking to levels started by others\n            var topOfStack = aftersStack[aftersStackHeight - 1];\n            if (!topOfStack)\n                throw new Error(\"Unexpected stack top: \" + topOfStack);\n            var [topAfters, index] = topOfStack;\n            if (index < topAfters.length) {\n                var [, after] = topAfters[index];\n                topOfStack[1]++; // increase index already here to indicate that this level is being processed\n                ensureStackHeight(aftersStackHeight + 1); // to ensure there's a new level for recursively added afters\n                var callSuccess = false;\n                try {\n                    after();\n                    callSuccess = true;\n                    while (aftersStackHeight > stackSizeAtStart && aftersStack[aftersStackHeight - 1][0].length == 0) {\n                        aftersStackHeight--;\n                    }\n                }\n                finally {\n                    if (!callSuccess) {\n                        aftersStack = [];\n                        aftersStackHeight = 0; // reset state to prevent stale updates after error\n                    }\n                }\n            }\n            else {\n                topOfStack[0] = [];\n                topOfStack[1] = 0; // reset this level\n                break;\n            }\n        }\n    }\n    finally {\n        if (isRoot)\n            processingAfters = false;\n    }\n}\nfunction whenDoneWith(obs, f) {\n    if (rootEvent) {\n        var obsWaiters = waiters[obs.id];\n        if (obsWaiters === undefined) {\n            obsWaiters = waiters[obs.id] = [f];\n            return waiterObs.push(obs);\n        }\n        else {\n            return obsWaiters.push(f);\n        }\n    }\n    else {\n        return f();\n    }\n}\nfunction flush() {\n    while (waiterObs.length > 0) {\n        flushWaiters(0, true);\n    }\n    flushed = {};\n}\nfunction flushWaiters(index, deps) {\n    var obs = waiterObs[index];\n    var obsId = obs.id;\n    var obsWaiters = waiters[obsId];\n    waiterObs.splice(index, 1);\n    delete waiters[obsId];\n    if (deps && waiterObs.length > 0) {\n        flushDepsOf(obs);\n    }\n    for (var i = 0, f; i < obsWaiters.length; i++) {\n        f = obsWaiters[i];\n        f();\n    }\n}\nfunction flushDepsOf(obs) {\n    if (flushed[obs.id])\n        return;\n    var deps = obs.internalDeps();\n    for (var i = 0, dep; i < deps.length; i++) {\n        dep = deps[i];\n        flushDepsOf(dep);\n        if (waiters[dep.id]) {\n            var index = _.indexOf(waiterObs, dep);\n            flushWaiters(index, false);\n        }\n    }\n    flushed[obs.id] = true;\n}\nfunction inTransaction(event, context, f, args) {\n    if (rootEvent) {\n        //console.log(\"in tx\")\n        return f.apply(context, args);\n    }\n    else {\n        //console.log(\"start tx\")\n        rootEvent = event;\n        try {\n            var result = f.apply(context, args);\n            //console.log(\"done with tx\")\n            flush();\n        }\n        finally {\n            rootEvent = undefined;\n            processAfters();\n        }\n        return result;\n    }\n}\nfunction currentEventId() {\n    return rootEvent ? rootEvent.id : undefined;\n}\nfunction wrappedSubscribe(obs, subscribe, sink) {\n    assertFunction(sink);\n    let unsubd = false;\n    let shouldUnsub = false;\n    let doUnsub = () => {\n        shouldUnsub = true;\n    };\n    let unsub = () => {\n        unsubd = true;\n        doUnsub();\n    };\n    doUnsub = subscribe(function (event) {\n        afterTransaction(obs, function () {\n            if (!unsubd) {\n                var reply = sink(event);\n                if (reply === noMore) {\n                    unsub();\n                }\n            }\n        });\n        return more;\n    });\n    if (shouldUnsub) {\n        doUnsub();\n    }\n    return unsub;\n}\nfunction hasWaiters() { return waiterObs.length > 0; }\nvar UpdateBarrier = { toString: toString$1, whenDoneWith, hasWaiters, inTransaction, currentEventId, wrappedSubscribe, afterTransaction, soonButNotYet, isInTransaction };\n\nclass Desc {\n    constructor(context, method, args = []) {\n        /** @hidden */\n        this._isDesc = true;\n        //assert(\"context missing\", context)\n        //assert(\"method missing\", method)\n        //assert(\"args missing\", args)\n        this.context = context;\n        this.method = method;\n        this.args = args;\n    }\n    deps() {\n        if (!this.cachedDeps) {\n            this.cachedDeps = findDeps([this.context].concat(this.args));\n        }\n        return this.cachedDeps;\n    }\n    toString() {\n        let args = _.map(_.toString, this.args);\n        return _.toString(this.context) + \".\" + _.toString(this.method) + \"(\" + args + \")\";\n    }\n}\n/** @hidden */\nfunction describe(context, method, ...args) {\n    const ref = context || method;\n    if (ref && ref._isDesc) {\n        return context || method;\n    }\n    else {\n        return new Desc(context, method, args);\n    }\n}\n/** @hidden */\nfunction findDeps(x) {\n    if (isArray(x)) {\n        return _.flatMap(findDeps, x);\n    }\n    else if (isObservable(x)) {\n        return [x];\n    }\n    else if ((typeof x !== \"undefined\" && x !== null) ? x._isSource : undefined) {\n        return [x.obs];\n    }\n    else {\n        return [];\n    }\n}\n\n/** @hidden */\nconst nullSink = () => more;\n/** @hidden */\nconst nullVoidSink = () => more;\n\n/** @hidden */\nfunction withStateMachine(initState, f, src) {\n    return src.transform(withStateMachineT(initState, f), new Desc(src, \"withStateMachine\", [initState, f]));\n}\nfunction withStateMachineT(initState, f) {\n    let state = initState;\n    return (event, sink) => {\n        var fromF = f(state, event);\n        var [newState, outputs] = fromF;\n        state = newState;\n        var reply = more;\n        for (var i = 0; i < outputs.length; i++) {\n            let output = outputs[i];\n            reply = sink(output);\n            if (reply === noMore) {\n                return reply;\n            }\n        }\n        return reply;\n    };\n}\n\n/** @hidden */\nclass Some {\n    constructor(value) {\n        this._isSome = true;\n        this.isDefined = true;\n        this.value = value;\n    }\n    getOrElse(arg) { return this.value; }\n    get() { return this.value; }\n    filter(f) {\n        if (f(this.value)) {\n            return new Some(this.value);\n        }\n        else {\n            return None;\n        }\n    }\n    map(f) {\n        return new Some(f(this.value));\n    }\n    forEach(f) {\n        f(this.value);\n    }\n    toArray() { return [this.value]; }\n    inspect() { return \"Some(\" + this.value + \")\"; }\n    toString() { return this.inspect(); }\n}\n/** @hidden */\nconst None = {\n    _isNone: true,\n    getOrElse(value) { return value; },\n    get() { throw new Error(\"None.get()\"); },\n    filter() { return None; },\n    map() { return None; },\n    forEach() { },\n    isDefined: false,\n    toArray() { return []; },\n    inspect() { return \"None\"; },\n    toString() { return this.inspect(); }\n};\nfunction none() { return None; }\nfunction toOption(v) {\n    if (v && (v._isSome || v._isNone)) {\n        return v;\n    }\n    else {\n        return new Some(v);\n    }\n}\nfunction isNone(object) {\n    return ((typeof object !== \"undefined\" && object !== null) ? object._isNone : false);\n}\n\n/** @hidden */\nvar eventIdCounter = 0;\n/**\n * Base class for all events passed through [EventStreams](eventstream.html) and [Properties](property.html).\n */\nclass Event {\n    constructor() {\n        this.id = ++eventIdCounter;\n        /** @hidden */\n        this.isEvent = true;\n        /** @hidden */\n        this._isEvent = true;\n        this.isEnd = false;\n        this.isInitial = false;\n        this.isNext = false;\n        this.isError = false;\n        this.hasValue = false;\n    }\n    /** @hidden */\n    filter(f) { return true; }\n    /** @hidden */\n    inspect() { return this.toString(); }\n    /** @hidden */\n    log() { return this.toString(); }\n    /** @hidden */\n    toNext() { return this; }\n}\n/**\n *  Base class for all [Events](event.html) carrying a value.\n *\n *  Can be distinguished from other events using [hasValue](../globals.html#hasvalue)\n **/\nclass Value extends Event {\n    constructor(value) {\n        super();\n        this.hasValue = true;\n        if (value instanceof Event) {\n            throw new Error$1(\"Wrapping an event inside other event\");\n        }\n        this.value = value;\n    }\n    /** @hidden */\n    fmap(f) {\n        return this.apply(f(this.value));\n    }\n    /** @hidden */\n    filter(f) { return f(this.value); }\n    /** @hidden */\n    toString() { return _.toString(this.value); }\n    //toString(): string { return \"<value \" + this.id + \">\" + _.toString(this.value) }\n    /** @hidden */\n    log() { return this.value; }\n}\n/**\n *  Indicates a new value in an [EventStream](eventstream.html) or a [Property](property.html).\n *\n *  Can be distinguished from other events using [isNext](../globals.html#isnext)\n */\nclass Next extends Value {\n    constructor(value) {\n        super(value);\n        this.isNext = true;\n        /** @hidden */\n        this._isNext = true; // some compatibility stuff?\n    }\n    /** @hidden */\n    apply(value) { return new Next(value); }\n}\n/**\n * An event carrying the initial value of a [Property](classes/property.html). This event can be emitted by a property\n * immediately when subscribing to it.\n *\n * Can be distinguished from other events using [isInitial](../globals.html#isinitial)\n */\nclass Initial extends Value {\n    constructor(value) {\n        super(value);\n        this.isInitial = true;\n        /** @hidden */\n        this._isInitial = true;\n    }\n    /** @hidden */\n    apply(value) { return new Initial(value); }\n    /** @hidden */\n    toNext() { return new Next(this.value); }\n}\n/**\n * Base class for events not carrying a value.\n */\nclass NoValue extends Event {\n    constructor() {\n        super(...arguments);\n        this.hasValue = false;\n    }\n    /** @hidden */\n    fmap(f) {\n        return this;\n    }\n}\n/**\n * An event that indicates the end of an [EventStream](classes/eventstream.html) or a [Property](classes/property.html).\n * No more events can be emitted after this one.\n *\n * Can be distinguished from other events using [isEnd](../globals.html#isend)\n */\nclass End extends NoValue {\n    constructor() {\n        super(...arguments);\n        this.isEnd = true;\n    }\n    /** @hidden */\n    toString() { return \"<end>\"; }\n}\n/**\n *  An event carrying an error. You can use [onError](observable.html#onerror) to subscribe to errors.\n */\nclass Error$1 extends NoValue {\n    constructor(error) {\n        super();\n        this.isError = true;\n        this.error = error;\n    }\n    /** @hidden */\n    toString() {\n        return \"<error> \" + _.toString(this.error);\n    }\n}\n/** @hidden */\nfunction initialEvent(value) { return new Initial(value); }\n/** @hidden */\nfunction nextEvent(value) { return new Next(value); }\n/** @hidden */\nfunction endEvent() { return new End(); }\n/** @hidden */\nfunction toEvent(x) {\n    if (x && x._isEvent) {\n        return x;\n    }\n    else {\n        return nextEvent(x);\n    }\n}\n/**\n * Returns true if the given object is an [Event](classes/event.html).\n */\nfunction isEvent(e) {\n    return e && e._isEvent;\n}\n/**\n * Returns true if the given event is an [Initial](classes/initial.html) value of a [Property](classes/property.html).\n */\nfunction isInitial(e) {\n    return e && e._isInitial;\n}\n/**\n * Returns true if the given event is an [Error](classes/error.html) event of an [Observable](classes/observable.html).\n */\nfunction isError(e) {\n    return e.isError;\n}\n/**\n * Returns true if the given event is a [Value](classes/value.html), i.e. a [Next](classes/next.html) or\n * an [Initial](classes/error.html) value of an [Observable](classes/observable.html).\n */\nfunction hasValue(e) {\n    return e.hasValue;\n}\n/**\n * Returns true if the given event is an [End](classes/end.html)\n */\nfunction isEnd(e) {\n    return e.isEnd;\n}\n/**\n * Returns true if the given event is a [Next](classes/next.html)\n */\nfunction isNext(e) {\n    return e.isNext;\n}\n\n/** @hidden */\nfunction equals(a, b) { return a === b; }\n/** @hidden */\nfunction skipDuplicates(src, isEqual = equals) {\n    let desc = new Desc(src, \"skipDuplicates\", []);\n    return withStateMachine(none(), function (prev, event) {\n        if (!hasValue(event)) {\n            return [prev, [event]];\n        }\n        else if (event.isInitial || isNone(prev) || !isEqual(prev.get(), event.value)) {\n            return [new Some(event.value), [event]];\n        }\n        else {\n            return [prev, []];\n        }\n    }, src).withDesc(desc);\n}\n\n/** @hidden */\nfunction take(count, src, desc) {\n    return src.transform(takeT(count), desc || new Desc(src, \"take\", [count]));\n}\n/** @hidden */\nfunction takeT(count) {\n    return (e, sink) => {\n        if (!e.hasValue) {\n            return sink(e);\n        }\n        else {\n            count--;\n            if (count > 0) {\n                return sink(e);\n            }\n            else {\n                if (count === 0) {\n                    sink(e);\n                }\n                sink(endEvent());\n                return noMore;\n            }\n        }\n    };\n}\n\n/** @hidden */\nfunction log(args, src) {\n    src.subscribe(function (event) {\n        if (typeof console !== \"undefined\" && typeof console.log === \"function\") {\n            console.log(...args.concat([event.log()]));\n        }\n        return more;\n    });\n}\n\n/** @hidden */\nfunction doLogT(args) {\n    return (event, sink) => {\n        if (typeof console !== \"undefined\" && console !== null && typeof console.log === \"function\") {\n            console.log(...args.concat([event.log()]));\n        }\n        return sink(event);\n    };\n}\n\n/** @hidden */\nfunction doErrorT(f) {\n    return (event, sink) => {\n        if (isError(event)) {\n            f(event.error);\n        }\n        return sink(event);\n    };\n}\n\n/** @hidden */\nfunction doActionT(f) {\n    return (event, sink) => {\n        if (hasValue(event)) {\n            f(event.value);\n        }\n        return sink(event);\n    };\n}\n\n/** @hidden */\nfunction doEndT(f) {\n    return (event, sink) => {\n        if (isEnd(event)) {\n            f();\n        }\n        return sink(event);\n    };\n}\n\n/** @hidden */\nfunction scan(src, seed, f) {\n    let resultProperty;\n    let acc = seed;\n    let initHandled = false;\n    const subscribe = (sink) => {\n        var initSent = false;\n        var unsub = nop;\n        var reply = more;\n        const sendInit = function () {\n            if (!initSent) {\n                initSent = initHandled = true;\n                reply = sink(new Initial(acc));\n                if (reply === noMore) {\n                    unsub();\n                    unsub = nop;\n                }\n            }\n            return reply;\n        };\n        unsub = src.subscribeInternal(function (event) {\n            if (hasValue(event)) {\n                if (initHandled && event.isInitial) {\n                    //console.log \"skip INITIAL\"\n                    return more; // init already sent, skip this one\n                }\n                else {\n                    if (!event.isInitial) {\n                        sendInit();\n                    }\n                    initSent = initHandled = true;\n                    var prev = acc;\n                    var next = f(prev, event.value);\n                    //console.log prev , \",\", event.value, \"->\", next\n                    acc = next;\n                    return sink(event.apply(next));\n                }\n            }\n            else {\n                if (event.isEnd) {\n                    reply = sendInit();\n                }\n                if (reply !== noMore) {\n                    return sink(event);\n                }\n                return reply;\n            }\n        });\n        UpdateBarrier.whenDoneWith(resultProperty, sendInit);\n        return unsub;\n    };\n    return resultProperty = new Property(new Desc(src, \"scan\", [seed, f]), subscribe);\n}\n\n/** @hidden */\nfunction mapEndT(f) {\n    let theF = _.toFunction(f);\n    return function (event, sink) {\n        if (isEnd(event)) {\n            sink(nextEvent(theF(event)));\n            sink(endEvent());\n            return noMore;\n        }\n        else {\n            return sink(event);\n        }\n    };\n}\n\n/** @hidden */\nfunction mapErrorT(f) {\n    let theF = _.toFunction(f);\n    return function (event, sink) {\n        if (isError(event)) {\n            return sink(nextEvent(theF(event.error)));\n        }\n        else {\n            return sink(event);\n        }\n    };\n}\n\n/** @hidden */\nfunction skipErrors(src) {\n    return src.transform(function (event, sink) {\n        if (isError(event)) {\n            return more;\n        }\n        else {\n            return sink(event);\n        }\n    }, new Desc(src, \"skipErrors\", []));\n}\n\n/** @hidden */\nfunction last$1(src) {\n    var lastEvent;\n    return src.transform(function (event, sink) {\n        if (isEnd(event)) {\n            if (lastEvent) {\n                sink(lastEvent);\n            }\n            sink(endEvent());\n            return noMore;\n        }\n        else if (hasValue(event)) {\n            lastEvent = event;\n            return more;\n        }\n        else {\n            return sink(event);\n        }\n    }).withDesc(new Desc(src, \"last\", []));\n}\n\n/** @hidden */\nclass CompositeUnsubscribe {\n    constructor(ss = []) {\n        this.unsubscribed = false;\n        this.unsubscribe = _.bind(this.unsubscribe, this);\n        this.unsubscribed = false;\n        this.subscriptions = [];\n        this.starting = [];\n        for (var i = 0, s; i < ss.length; i++) {\n            s = ss[i];\n            this.add(s);\n        }\n    }\n    add(subscription) {\n        if (!this.unsubscribed) {\n            var ended = false;\n            var unsub = nop;\n            this.starting.push(subscription);\n            var unsubMe = () => {\n                if (this.unsubscribed) {\n                    return;\n                }\n                ended = true;\n                this.remove(unsub);\n                _.remove(subscription, this.starting);\n            };\n            unsub = subscription(this.unsubscribe, unsubMe);\n            if (!(this.unsubscribed || ended)) {\n                this.subscriptions.push(unsub);\n            }\n            else {\n                unsub();\n            }\n            _.remove(subscription, this.starting);\n        }\n    }\n    remove(unsub) {\n        if (this.unsubscribed) {\n            return;\n        }\n        if ((_.remove(unsub, this.subscriptions)) !== undefined) {\n            return unsub();\n        }\n    }\n    unsubscribe() {\n        if (this.unsubscribed) {\n            return;\n        }\n        this.unsubscribed = true;\n        var iterable = this.subscriptions;\n        for (var i = 0; i < iterable.length; i++) {\n            iterable[i]();\n        }\n        this.subscriptions = [];\n        this.starting = [];\n    }\n    count() {\n        if (this.unsubscribed) {\n            return 0;\n        }\n        return this.subscriptions.length + this.starting.length;\n    }\n    empty() {\n        return this.count() === 0;\n    }\n}\n\n/** @hidden */\nfunction streamSubscribeToPropertySubscribe(initValue, streamSubscribe) {\n    //assertFunction(streamSubscribe)\n    return function (sink) {\n        var initSent = false;\n        var subbed = false;\n        var unsub = nop;\n        var reply = more;\n        var sendInit = function () {\n            if (!initSent) {\n                return initValue.forEach(function (value) {\n                    initSent = true;\n                    reply = sink(new Initial(value));\n                    if (reply === noMore) {\n                        unsub();\n                        unsub = nop;\n                        return nop;\n                    }\n                });\n            }\n        };\n        unsub = streamSubscribe(function (event) {\n            if (event instanceof Value) {\n                if (event.isInitial && !subbed) {\n                    initValue = new Some(event.value);\n                    return more;\n                }\n                else {\n                    if (!event.isInitial) {\n                        sendInit();\n                    }\n                    initSent = true;\n                    initValue = new Some(event.value);\n                    return sink(event);\n                }\n            }\n            else {\n                if (event.isEnd) {\n                    reply = sendInit();\n                }\n                if (reply !== noMore) {\n                    return sink(event);\n                }\n                return reply;\n            }\n        });\n        subbed = true;\n        sendInit();\n        return unsub;\n    };\n}\n\n/** @hidden */\nfunction propertyFromStreamSubscribe(desc, subscribe) {\n    assertFunction(subscribe);\n    return new Property(desc, streamSubscribeToPropertySubscribe(none(), subscribe));\n}\n\n/**\n Creates an EventStream that delivers the given\n single value for the first subscriber. The stream will end immediately\n after this value. You can also send an [`Bacon.Error`](#bacon-error) event instead of a\n value: `Bacon.once(new Bacon.Error(\"fail\"))`.\n\n @param   value   the value or event to emit\n @typeparam V Type of stream elements\n */\nfunction once(value) {\n    const s = new EventStream(new Desc(\"Bacon\", \"once\", [value]), function (sink) {\n        UpdateBarrier.soonButNotYet(s, function () {\n            sink(toEvent(value));\n            sink(endEvent());\n        });\n        return nop;\n    });\n    return s;\n}\n\n/** @hidden */\nfunction flatMap_(spawner, src, params = {}) {\n    const root = src;\n    const rootDep = [root];\n    const childDeps = [];\n    const isProperty = src._isProperty;\n    const ctor = (isProperty ? propertyFromStreamSubscribe : newEventStreamAllowSync);\n    let initialSpawned = false;\n    const desc = params.desc || new Desc(src, \"flatMap_\", [spawner]);\n    const result = ctor(desc, function (sink) {\n        const composite = new CompositeUnsubscribe();\n        const queue = [];\n        function spawn(event) {\n            if (isProperty && event.isInitial) {\n                if (initialSpawned) {\n                    return more;\n                }\n                initialSpawned = true;\n            }\n            const child = makeObservable(spawner(event));\n            childDeps.push(child);\n            return composite.add(function (unsubAll, unsubMe) {\n                const unsub = child.subscribeInternal(function (event) {\n                    if (event.isEnd) {\n                        checkQueue();\n                        checkEnd(unsubMe);\n                        return noMore;\n                    }\n                    else {\n                        event = event.toNext(); // To support Property as the spawned stream\n                        const reply = sink(event);\n                        if (reply === noMore) {\n                            unsubAll();\n                        }\n                        return reply;\n                    }\n                });\n                return () => {\n                    _.remove(child, childDeps);\n                    unsub();\n                };\n            });\n        }\n        function checkQueue() {\n            const event = queue.shift();\n            if (event) {\n                spawn(event);\n            }\n        }\n        function checkEnd(unsub) {\n            unsub();\n            if (composite.empty()) {\n                return sink(endEvent());\n            }\n            return more;\n        }\n        composite.add(function (__, unsubRoot) {\n            return root.subscribeInternal(function (event) {\n                if (event.isEnd) {\n                    return checkEnd(unsubRoot);\n                }\n                else if (event.isError && !params.mapError) {\n                    return sink(event);\n                }\n                else if (params.firstOnly && composite.count() > 1) {\n                    return more;\n                }\n                else {\n                    if (composite.unsubscribed) {\n                        return noMore;\n                    }\n                    if (params.limit && composite.count() > params.limit) {\n                        queue.push(event);\n                    }\n                    else {\n                        spawn(event);\n                    }\n                    return more;\n                }\n            });\n        });\n        return composite.unsubscribe;\n    });\n    result.internalDeps = function () {\n        if (childDeps.length) {\n            return rootDep.concat(childDeps);\n        }\n        else {\n            return rootDep;\n        }\n    };\n    return result;\n}\n/** @hidden */\nfunction handleEventValueWith(f) {\n    if (typeof f == \"function\") {\n        return ((event) => {\n            if (hasValue(event)) {\n                return f(event.value);\n            }\n            return event;\n        });\n    }\n    return ((event) => f);\n}\n/** @hidden */\nfunction makeObservable(x) {\n    if (isObservable(x)) {\n        return x;\n    }\n    else {\n        return once(x);\n    }\n}\n\n/** @hidden */\nfunction flatMapEvent(src, f) {\n    return flatMap_(f, src, {\n        mapError: true,\n        desc: new Desc(src, \"flatMapEvent\", [f])\n    });\n}\n\n/** @hidden */\nfunction endAsValue(src) {\n    return src.transform((event, sink) => {\n        if (isEnd(event)) {\n            sink(nextEvent({}));\n            sink(endEvent());\n            return noMore;\n        }\n        return more;\n    });\n}\n\n/** @hidden */\nfunction endOnError(src, predicate = x => true) {\n    return src.transform((event, sink) => {\n        if (isError(event) && predicate(event.error)) {\n            sink(event);\n            return sink(endEvent());\n        }\n        else {\n            return sink(event);\n        }\n    }, new Desc(src, \"endOnError\", []));\n}\n\n/** @hidden */\nclass Source {\n    constructor(obs, sync) {\n        this._isSource = true;\n        this.flatten = true;\n        this.ended = false;\n        this.obs = obs;\n        this.sync = sync;\n    }\n    subscribe(sink) {\n        return this.obs.subscribeInternal(sink);\n    }\n    toString() {\n        return this.obs.toString();\n    }\n    markEnded() {\n        this.ended = true;\n    }\n    mayHave(count) { return true; }\n}\n/** @hidden */\nclass DefaultSource extends Source {\n    consume() {\n        return this.value;\n    }\n    push(x) {\n        this.value = x;\n    }\n    hasAtLeast(c) {\n        return !!this.value;\n    }\n}\n/** @hidden */\nclass ConsumingSource extends Source {\n    constructor(obs, sync) {\n        super(obs, sync);\n        this.flatten = false;\n        this.queue = [];\n    }\n    consume() {\n        return this.queue.shift();\n    }\n    push(x) {\n        this.queue.push(x);\n    }\n    mayHave(count) {\n        return !this.ended || this.queue.length >= count;\n    }\n    hasAtLeast(count) {\n        return this.queue.length >= count;\n    }\n}\n/** @hidden */\nclass BufferingSource extends Source {\n    constructor(obs) {\n        super(obs, true);\n        this.queue = [];\n    }\n    consume() {\n        const values = this.queue;\n        this.queue = [];\n        return {\n            value: values\n        };\n    }\n    push(x) {\n        return this.queue.push(x.value);\n    }\n    hasAtLeast(count) {\n        return true;\n    }\n}\n/** @hidden */\nfunction isTrigger(s) {\n    if (s == null)\n        return false;\n    if (s._isSource) {\n        return s.sync;\n    }\n    else {\n        return s._isEventStream;\n    }\n}\n/** @hidden */\nfunction fromObservable(s) {\n    if (s != null && s._isSource) {\n        return s;\n    }\n    else if (s != null && s._isProperty) {\n        return new DefaultSource(s, false);\n    }\n    else {\n        return new ConsumingSource(s, true);\n    }\n}\n\n/**\n Creates an EventStream that immediately ends.\n @typeparam V Type of stream elements\n */\nfunction never() {\n    return new EventStream(describe(\"Bacon\", \"never\"), (sink) => {\n        sink(endEvent());\n        return nop;\n    });\n}\n\n/**\n The `when` method provides a generalization of the [`zip`](classes/observable.html#zip) function. While zip\n synchronizes events from multiple streams pairwse, the join patterns used in `when` allow\n the implementation of more advanced synchronization patterns.\n\n Consider implementing a game with discrete time ticks. We want to\n handle key-events synchronized on tick-events, with at most one key\n event handled per tick. If there are no key events, we want to just\n process a tick.\n\n ```js\n Bacon.when(\n [tick, keyEvent, function(_, k) { handleKeyEvent(k); return handleTick(); }],\n [tick, handleTick])\n ```\n\n Order is important here. If the [tick] patterns had been written\n first, this would have been tried first, and preferred at each tick.\n\n Join patterns are indeed a generalization of zip, and for EventStreams, zip is\n equivalent to a single-rule join pattern. The following observables\n have the same output, assuming that all sources are EventStreams.\n\n ```js\n Bacon.zipWith(a,b,c, combine)\n Bacon.when([a,b,c], combine)\n ```\n\n Note that [`Bacon.when`](#bacon-when) does not trigger updates for events from Properties though;\n if you use a Property in your pattern, its value will be just sampled when all the\n other sources (EventStreams) have a value. This is useful when you need a value of a Property\n in your calculations. If you want your pattern to fire for a Property too, you can\n convert it into an EventStream using [`property.changes()`](#property-changes) or [`property.toEventStream()`](#property-toeventstream)\n\n * @param {Pattern<O>} patterns Join patterns\n * @typeparam O result type\n */\nfunction when(...patterns) {\n    return when_(newEventStream, patterns);\n}\n/** @hidden */\nfunction whenP(...patterns) {\n    return when_(propertyFromStreamSubscribe, patterns);\n}\n/** @hidden */\nfunction when_(ctor, patterns) {\n    if (patterns.length === 0) {\n        return never();\n    }\n    var [sources, ixPats] = processRawPatterns(extractRawPatterns(patterns));\n    if (!sources.length) {\n        return never();\n    }\n    var needsBarrier = (any(sources, (s) => s.flatten)) && containsDuplicateDeps(map(((s) => s.obs), sources));\n    var desc = new Desc(\"Bacon\", \"when\", Array.prototype.slice.call(patterns));\n    var resultStream = ctor(desc, function (sink) {\n        var triggers = [];\n        var ends = false;\n        function match(p) {\n            for (var i = 0; i < p.ixs.length; i++) {\n                let ix = p.ixs[i];\n                if (!sources[ix.index].hasAtLeast(ix.count)) {\n                    return false;\n                }\n            }\n            return true;\n        }\n        function cannotMatch(p) {\n            for (var i = 0; i < p.ixs.length; i++) {\n                let ix = p.ixs[i];\n                if (!sources[ix.index].mayHave(ix.count)) {\n                    return true;\n                }\n            }\n            return false;\n        }\n        function nonFlattened(trigger) { return !trigger.source.flatten; }\n        function part(source) {\n            return function (unsubAll) {\n                function flushLater() {\n                    return UpdateBarrier.whenDoneWith(resultStream, flush);\n                }\n                function flushWhileTriggers() {\n                    var trigger;\n                    if ((trigger = triggers.pop()) !== undefined) {\n                        var reply = more;\n                        for (var i = 0, p; i < ixPats.length; i++) {\n                            p = ixPats[i];\n                            if (match(p)) {\n                                const values = [];\n                                for (var j = 0; j < p.ixs.length; j++) {\n                                    let event = sources[p.ixs[j].index].consume();\n                                    if (!event)\n                                        throw new Error(\"Event was undefined\");\n                                    values.push(event.value);\n                                }\n                                //console.log(\"flushing values\", values)\n                                let applied = p.f.apply(null, values);\n                                //console.log('sinking', applied)\n                                reply = sink((trigger).e.apply(applied));\n                                if (triggers.length) {\n                                    triggers = filter(nonFlattened, triggers);\n                                }\n                                if (reply === noMore) {\n                                    return reply;\n                                }\n                                else {\n                                    return flushWhileTriggers();\n                                }\n                            }\n                        }\n                    }\n                    return more;\n                }\n                function flush() {\n                    //console.log \"flushing\", _.toString(resultStream)\n                    var reply = flushWhileTriggers();\n                    if (ends) {\n                        //console.log \"ends detected\"\n                        if (all(sources, cannotSync) || all(ixPats, cannotMatch)) {\n                            //console.log \"actually ending\"\n                            reply = noMore;\n                            sink(endEvent());\n                        }\n                    }\n                    if (reply === noMore) {\n                        unsubAll();\n                    }\n                }\n                return source.subscribe(function (e) {\n                    var reply = more;\n                    if (e.isEnd) {\n                        //console.log \"got end\"\n                        ends = true;\n                        source.markEnded();\n                        flushLater();\n                    }\n                    else if (e.isError) {\n                        reply = sink(e);\n                    }\n                    else {\n                        let valueEvent = e;\n                        //console.log \"got value\", e.value\n                        source.push(valueEvent);\n                        if (source.sync) {\n                            //console.log \"queuing\", e.toString(), toString(resultStream)\n                            triggers.push({ source: source, e: valueEvent });\n                            if (needsBarrier || UpdateBarrier.hasWaiters()) {\n                                flushLater();\n                            }\n                            else {\n                                flush();\n                            }\n                        }\n                    }\n                    if (reply === noMore) {\n                        unsubAll();\n                    }\n                    return reply;\n                });\n            };\n        }\n        return new CompositeUnsubscribe(map(part, sources)).unsubscribe;\n    });\n    return resultStream;\n}\nfunction processRawPatterns(rawPatterns) {\n    var sources = [];\n    var pats = [];\n    for (let i = 0; i < rawPatterns.length; i++) {\n        let [patSources, f] = rawPatterns[i];\n        var pat = { f, ixs: [] };\n        var triggerFound = false;\n        for (var j = 0, s; j < patSources.length; j++) {\n            s = patSources[j];\n            var index = indexOf(sources, s);\n            if (!triggerFound) {\n                triggerFound = isTrigger(s);\n            }\n            if (index < 0) {\n                sources.push(s);\n                index = sources.length - 1;\n            }\n            for (var k = 0; k < pat.ixs.length; k++) {\n                let ix = pat.ixs[k];\n                if (ix.index === index) {\n                    ix.count++;\n                }\n            }\n            pat.ixs.push({ index: index, count: 1 });\n        }\n        if (patSources.length > 0 && !triggerFound) {\n            throw new Error(\"At least one EventStream required, none found in \" + patSources);\n        }\n        if (patSources.length > 0) {\n            pats.push(pat);\n        }\n    }\n    return [map(fromObservable /* sorry */, sources), pats];\n}\nfunction extractLegacyPatterns(sourceArgs) {\n    var i = 0;\n    var len = sourceArgs.length;\n    var rawPatterns = [];\n    while (i < len) {\n        let patSources = toArray(sourceArgs[i++]);\n        let f = toFunction(sourceArgs[i++]);\n        rawPatterns.push([patSources, f]);\n    }\n    var usage = \"when: expecting arguments in the form (Observable+,function)+\";\n    assert(usage, (len % 2 === 0));\n    return rawPatterns;\n}\nfunction isTypedOrRawPattern(pattern) {\n    return (pattern instanceof Array) && (!isObservable(pattern[pattern.length - 1]));\n}\nfunction isRawPattern(pattern) {\n    return pattern[0] instanceof Array;\n}\n/** @hidden */\nfunction extractRawPatterns(patterns) {\n    let rawPatterns = [];\n    for (let i = 0; i < patterns.length; i++) {\n        let pattern = patterns[i];\n        if (!isTypedOrRawPattern(pattern)) {\n            // Fallback to legacy patterns\n            return extractLegacyPatterns(patterns);\n        }\n        if (isRawPattern(pattern)) {\n            rawPatterns.push([pattern[0], toFunction(pattern[1])]);\n        }\n        else { // typed pattern, then\n            let sources = pattern.slice(0, pattern.length - 1);\n            let f = toFunction(pattern[pattern.length - 1]);\n            rawPatterns.push([sources, f]);\n        }\n    }\n    return rawPatterns;\n}\nfunction containsDuplicateDeps(observables, state = []) {\n    function checkObservable(obs) {\n        if (contains(state, obs)) {\n            return true;\n        }\n        else {\n            var deps = obs.internalDeps();\n            if (deps.length) {\n                state.push(obs);\n                return any(deps, checkObservable);\n            }\n            else {\n                state.push(obs);\n                return false;\n            }\n        }\n    }\n    return any(observables, checkObservable);\n}\nfunction cannotSync(source) {\n    return !source.sync || source.ended;\n}\n\n/** @hidden */\nfunction withLatestFromE(sampler, samplee, f) {\n    var result = when([new DefaultSource(samplee.toProperty(), false), new DefaultSource(sampler, true), flip(f)]);\n    return result.withDesc(new Desc(sampler, \"withLatestFrom\", [samplee, f]));\n}\n/** @hidden */\nfunction withLatestFromP(sampler, samplee, f) {\n    var result = whenP([new DefaultSource(samplee.toProperty(), false), new DefaultSource(sampler, true), flip(f)]);\n    return result.withDesc(new Desc(sampler, \"withLatestFrom\", [samplee, f]));\n}\n/** @hidden */\nfunction withLatestFrom(sampler, samplee, f) {\n    if (sampler instanceof Property) {\n        return withLatestFromP(sampler, samplee, f);\n    }\n    else if (sampler instanceof EventStream) {\n        return withLatestFromE(sampler, samplee, f);\n    }\n    else {\n        throw new Error(\"Unknown observable: \" + sampler);\n    }\n}\n\n/** @hidden */\nfunction map$1(src, f) {\n    if (f instanceof Property) {\n        return withLatestFrom(src, f, (a, b) => b);\n    }\n    return src.transform(mapT(f), new Desc(src, \"map\", [f]));\n}\n/** @hidden */\nfunction mapT(f) {\n    let theF = _.toFunction(f);\n    return (e, sink) => {\n        return sink(e.fmap(theF));\n    };\n}\n\n/**\n Creates a constant property with value `x`.\n */\nfunction constant(x) {\n    return new Property(new Desc(\"Bacon\", \"constant\", [x]), function (sink) {\n        sink(initialEvent(x));\n        sink(endEvent());\n        return nop;\n    });\n}\n\n/** @hidden */\nfunction argumentsToObservables(args) {\n    args = (Array.prototype.slice.call(args));\n    return _.flatMap(singleToObservables, args);\n}\nfunction singleToObservables(x) {\n    if (isObservable(x)) {\n        return [x];\n    }\n    else if (isArray(x)) {\n        return argumentsToObservables(x);\n    }\n    else {\n        return [constant(x)];\n    }\n}\n/** @hidden */\nfunction argumentsToObservablesAndFunction(args) {\n    if (_.isFunction(args[0])) {\n        return [argumentsToObservables(Array.prototype.slice.call(args, 1)), args[0]];\n    }\n    else {\n        return [argumentsToObservables(Array.prototype.slice.call(args, 0, args.length - 1)), _.last(args)];\n    }\n}\n\n/** @hidden */\nfunction groupSimultaneous(...streams) {\n    return groupSimultaneous_(argumentsToObservables(streams));\n}\n// TODO: type is not exactly correct, because different inputs may have different types.\n// Result values are arrays where each element is the list from each input observable. Type this.\n/** @hidden */\nfunction groupSimultaneous_(streams, options) {\n    let sources = _.map((stream) => new BufferingSource(stream), streams);\n    let ctor = (desc, subscribe) => new EventStream(desc, subscribe, undefined, options);\n    return when_(ctor, [sources, (function (...xs) {\n            return xs;\n        })]).withDesc(new Desc(\"Bacon\", \"groupSimultaneous\", streams));\n}\n\n/** @hidden */\nfunction awaiting(src, other) {\n    return groupSimultaneous_([src, other], allowSync)\n        .map((values) => values[1].length === 0)\n        .toProperty(false)\n        .skipDuplicates()\n        .withDesc(new Desc(src, \"awaiting\", [other]));\n}\n\n/**\n Combines Properties, EventStreams and constant values so that the result Property will have an array of the latest\n values from all sources as its value. The inputs may contain both Properties and EventStreams.\n\n\n ```js\n property = Bacon.constant(1)\n stream = Bacon.once(2)\n constant = 3\n Bacon.combineAsArray(property, stream, constant)\n # produces the value [1,2,3]\n ```\n\n * @param streams streams and properties to combine\n */\nfunction combineAsArray(...streams) {\n    streams = argumentsToObservables(streams);\n    if (streams.length) {\n        var sources = [];\n        for (var i = 0; i < streams.length; i++) {\n            let stream = (isObservable(streams[i])\n                ? streams[i]\n                : constant(streams[i]));\n            sources.push(wrap(stream));\n        }\n        return whenP([sources, (...xs) => xs]).withDesc(new Desc(\"Bacon\", \"combineAsArray\", streams));\n    }\n    else {\n        return constant([]);\n    }\n}\nfunction combineWith(...args) {\n    // TODO: untyped\n    var [streams, f] = argumentsToObservablesAndFunction(arguments);\n    var desc = new Desc(\"Bacon\", \"combineWith\", [f, ...streams]);\n    return combineAsArray(streams).map(function (values) {\n        return f(...values);\n    }).withDesc(desc);\n}\nconst combine = combineWith;\n/** @hidden */\nfunction combineTwo(left, right, f) {\n    return whenP([[wrap(left), wrap(right)], f]).withDesc(new Desc(left, \"combine\", [right, f]));\n}\nfunction wrap(obs) {\n    return new DefaultSource(obs, true);\n}\n\n/** @hidden */\nfunction skip(src, count) {\n    return src.transform((event, sink) => {\n        if (!event.hasValue) {\n            return sink(event);\n        }\n        else if (count > 0) {\n            count--;\n            return more;\n        }\n        else {\n            return sink(event);\n        }\n    }, new Desc(src, \"skip\", [count]));\n}\n\n/** @hidden */\nfunction flatMapConcat(src, f) {\n    return flatMap_(handleEventValueWith(f), src, {\n        desc: new Desc(src, \"flatMapConcat\", [f]),\n        limit: 1\n    });\n}\n\n/**\n If none of the other factory methods above apply, you may of course roll your own EventStream by using `fromBinder`.\n\n <a name=\"bacon-frombinder\"></a>\n [`Bacon.fromBinder(subscribe)`](#bacon-frombinder \"Bacon.fromBinder(subscribe)\") The parameter `subscribe` is a function that accepts a `sink` which is a function that your `subscribe` function can \"push\" events to.\n\n For example:\n\n ```js\n var stream = Bacon.fromBinder(function(sink) {\n  sink(\"first value\")\n  sink([new Bacon.Next(\"2nd\"), new Bacon.Next(\"3rd\")])\n  sink(new Bacon.Error(\"oops, an error\"))\n  sink(new Bacon.End())\n  return function() {\n     // unsub functionality here, this one's a no-op\n  }\n})\n stream.log()\n ```\n\n As shown in the example, you can push\n\n - A plain value, like `\"first value\"`\n - An [`Event`](#event) object including [`Bacon.Error`](#bacon-error) (wraps an error) and [`Bacon.End`](#bacon-end) (indicates\n stream end).\n - An array of [event](#event) objects at once\n\n Other examples can be found on [JSFiddle](http://jsfiddle.net/PG4c4/) and the\n [Bacon.js blog](http://baconjs.blogspot.fi/2013/12/wrapping-things-in-bacon.html).\n\n The `subscribe` function must return a function. Let's call that function\n `unsubscribe`. The returned function can be used by the subscriber (directly or indirectly) to\n unsubscribe from the EventStream. It should release all resources that the subscribe function reserved.\n\n The `sink` function may return [`Bacon.noMore`](#bacon-nomore) (as well as [`Bacon.more`](#bacon-more)\n or any other value). If it returns [`Bacon.noMore`](#bacon-nomore), no further events will be consumed\n by the subscriber. The `subscribe` function may choose to clean up all resources at this point (e.g.,\n by calling `unsubscribe`). This is usually not necessary, because further calls to `sink` are ignored,\n but doing so can increase performance in [rare cases](https://github.com/baconjs/bacon.js/issues/484).\n\n The EventStream will wrap your `subscribe` function so that it will\n only be called when the first stream listener is added, and the `unsubscribe`\n function is called only after the last listener has been removed.\n The subscribe-unsubscribe cycle may of course be repeated indefinitely,\n so prepare for multiple calls to the subscribe function.\n\n\n @param  binder\n @param  eventTransformer\n @typeparam V Type of stream elements\n\n */\nfunction fromBinder(binder, eventTransformer = _.id) {\n    var desc = new Desc(\"Bacon\", \"fromBinder\", [binder, eventTransformer]);\n    return new EventStream(desc, function (sink) {\n        var unbound = false;\n        var shouldUnbind = false;\n        var unbind = function () {\n            if (!unbound) {\n                if ((typeof unbinder !== \"undefined\" && unbinder !== null)) {\n                    unbinder();\n                    return unbound = true;\n                }\n                else {\n                    return shouldUnbind = true;\n                }\n            }\n        };\n        var unbinder = binder(function (...args) {\n            var value_ = eventTransformer(...args);\n            let valueArray = isArray(value_) && isEvent(_.last(value_))\n                ? value_\n                : [value_];\n            var reply = more;\n            for (var i = 0; i < valueArray.length; i++) {\n                let event = toEvent(valueArray[i]);\n                reply = sink(event);\n                if (reply === noMore || event.isEnd) {\n                    // defer if binder calls handler in sync before returning unbinder\n                    unbind();\n                    return reply;\n                }\n            }\n            return reply;\n        });\n        if (shouldUnbind) {\n            unbind();\n        }\n        return unbind;\n    });\n}\n\n/**\n Polls given function with given interval.\n Function should return Events: either [`Bacon.Next`](classes/next.html) or [`Bacon.End`](classes/end.html). Polling occurs only\n when there are subscribers to the stream. Polling ends permanently when\n `f` returns [`Bacon.End`](classes/end.html).\n * @param delay poll interval in milliseconds\n * @param poll function to be polled\n * @typeparam V Type of stream elements\n */\nfunction fromPoll(delay, poll) {\n    var desc = new Desc(\"Bacon\", \"fromPoll\", [delay, poll]);\n    return fromBinder((function (handler) {\n        var id = GlobalScheduler.scheduler.setInterval(handler, delay);\n        return function () {\n            return GlobalScheduler.scheduler.clearInterval(id);\n        };\n    }), poll).withDesc(desc);\n}\n\n/**\n Repeats the single element indefinitely with the given interval (in milliseconds)\n\n @param   delay   Repeat delay in milliseconds\n @param   value   The single value to repeat\n @typeparam V Type of stream elements\n */\nfunction interval(delay, value) {\n    return fromPoll(delay, function () {\n        return nextEvent(value);\n    }).withDesc(new Desc(\"Bacon\", \"interval\", [delay, value]));\n}\n\nfunction makeCombinator(combinator) {\n    if (typeof combinator == \"function\") {\n        return combinator;\n    }\n    else {\n        return _.id;\n    }\n}\n/** @hidden */\nfunction sampledBy(samplee, sampler, f) {\n    if (samplee instanceof EventStream) {\n        return sampledByE(samplee, sampler, f);\n    }\n    else {\n        return sampledByP(samplee, sampler, f);\n    }\n}\n/** @hidden */\nfunction sampledByP(samplee, sampler, f) {\n    let combinator = makeCombinator(f);\n    var result = withLatestFrom(sampler, samplee, flip(combinator));\n    return result.withDesc(new Desc(samplee, \"sampledBy\", [sampler]));\n}\n/** @hidden */\nfunction sampledByE(samplee, sampler, f) {\n    return sampledByP(samplee.toProperty(), sampler, f).withDesc(new Desc(samplee, \"sampledBy\", [sampler]));\n}\n/** @hidden */\nfunction sampleP(samplee, samplingInterval) {\n    return sampledByP(samplee, interval(samplingInterval, {}), (a, b) => a).withDesc(new Desc(samplee, \"sample\", [samplingInterval]));\n}\n\n/** @hidden */\nfunction transformP(src, transformer, desc) {\n    return new Property(new Desc(src, \"transform\", [transformer]), sink => src.subscribeInternal(e => transformer(e, sink))).withDesc(desc);\n}\n/** @hidden */\nfunction transformE(src, transformer, desc) {\n    return new EventStream(new Desc(src, \"transform\", [transformer]), sink => src.subscribeInternal(e => transformer(e, sink)), undefined, allowSync).withDesc(desc);\n}\n/** @hidden */\nfunction composeT(t1, t2) {\n    let finalSink; // mutation used to avoid closure creation while dispatching events\n    const sink2 = (event) => {\n        return t2(event, finalSink);\n    };\n    return (event, sink) => {\n        finalSink = sink;\n        return t1(event, sink2);\n    };\n}\n\n/** @hidden */\nfunction toPredicate(f) {\n    if (typeof f == \"boolean\") {\n        return _.always(f);\n    }\n    else if (typeof f != \"function\") {\n        throw new Error(\"Not a function: \" + f);\n    }\n    else {\n        return f;\n    }\n}\n/** @hidden */\nfunction withPredicate(src, f, predicateTransformer, desc) {\n    if (f instanceof Property) {\n        return withLatestFrom(src, f, (p, v) => [p, v])\n            .transform(composeT(predicateTransformer(((tuple) => tuple[1])), mapT((tuple) => tuple[0])), desc);\n        // the `any` type above is needed because the type argument for Predicate2Transformer is fixed. We'd need higher-kinded types to be able to express this properly, I think.\n    }\n    return src.transform(predicateTransformer(toPredicate(f)), desc);\n}\n\n/** @hidden */\nfunction filter$1(src, f) {\n    return withPredicate(src, f, filterT, new Desc(src, \"filter\", [f]));\n}\n/** @hidden */\nfunction filterT(f) {\n    return (e, sink) => {\n        if (e.filter(f)) {\n            return sink(e);\n        }\n        else {\n            return more;\n        }\n    };\n}\n\n/** @hidden */\nfunction not(src) {\n    return src.map(x => !x).withDesc(new Desc(src, \"not\", []));\n}\n/** @hidden */\nfunction and(left, right) {\n    return left.combine(toProperty(right), (x, y) => !!(x && y)).withDesc(new Desc(left, \"and\", [right]));\n}\n/** @hidden */\nfunction or(left, right) {\n    return left.combine(toProperty(right), (x, y) => x || y).withDesc(new Desc(left, \"or\", [right]));\n}\nfunction toProperty(x) {\n    if (isProperty(x)) {\n        return x;\n    }\n    return constant(x);\n}\n\n/** @hidden */\nfunction flatMapFirst(src, f) {\n    return flatMap_(handleEventValueWith(f), src, {\n        firstOnly: true,\n        desc: new Desc(src, \"flatMapFirst\", [f])\n    });\n}\n\n/** @hidden */\nfunction concatE(left, right, options) {\n    return new EventStream(new Desc(left, \"concat\", [right]), function (sink) {\n        var unsubRight = nop;\n        var unsubLeft = left.dispatcher.subscribe(function (e) {\n            if (e.isEnd) {\n                unsubRight = right.toEventStream().dispatcher.subscribe(sink);\n                return more;\n            }\n            else {\n                return sink(e);\n            }\n        });\n        return function () {\n            return unsubLeft(), unsubRight();\n        };\n    }, undefined, options);\n}\n/**\n Concatenates given array of EventStreams or Properties. Works by subscribing to the first source, and listeing to that\n until it ends. Then repeatedly subscribes to the next source, until all sources have ended.\n\n See [`concat`](#observable-concat)\n */\nfunction concatAll(...streams_) {\n    let streams = argumentsToObservables(streams_);\n    return (streams.length\n        ? fold(tail(streams), head(streams).toEventStream(), (a, b) => a.concat(b))\n        : never()).withDesc(new Desc(\"Bacon\", \"concatAll\", streams));\n}\n\n/** @hidden */\nfunction transformPropertyChanges(property, f, desc) {\n    let initValue;\n    let comboSink;\n    // Create a `changes` stream to be transformed, which also snatches the Initial value for later use.\n    const changes = new EventStream(describe(property, \"changes\", []), (sink) => property.dispatcher.subscribe(function (event) {\n        if (!initValue && isInitial(event)) {\n            initValue = event;\n            UpdateBarrier.whenDoneWith(combo, function () {\n                if (!comboSink) {\n                    throw new Error(\"Init sequence fail\");\n                }\n                comboSink(initValue);\n            });\n        }\n        if (!event.isInitial) {\n            return sink(event);\n        }\n        return more;\n    }), undefined, allowSync);\n    const transformedChanges = f(changes);\n    const combo = propertyFromStreamSubscribe(desc, (sink) => {\n        comboSink = sink;\n        return transformedChanges.dispatcher.subscribe(function (event) {\n            sink(event);\n        });\n    });\n    return combo;\n}\n\n/** @hidden */\nfunction fold$1(src, seed, f) {\n    return src.scan(seed, f)\n        .last()\n        .withDesc(new Desc(src, \"fold\", [seed, f]));\n}\n\n/** @hidden */\nfunction startWithE(src, seed) {\n    return once(seed).concat(src).withDesc(new Desc(src, \"startWith\", [seed]));\n}\n/** @hidden */\nfunction startWithP(src, seed) {\n    return src.scan(seed, (prev, next) => next).withDesc(new Desc(src, \"startWith\", [seed]));\n}\n\n/** @hidden */\nconst endMarker = {};\n/** @hidden */\nfunction takeUntil(src, stopper) {\n    let endMapped = src.mapEnd(endMarker);\n    let withEndMarker = groupSimultaneous_([endMapped, stopper.skipErrors()], allowSync);\n    if (src instanceof Property)\n        withEndMarker = withEndMarker.toProperty();\n    return withEndMarker.transform(function (event, sink) {\n        if (hasValue(event)) {\n            var [data, stopper] = event.value;\n            if (stopper.length) {\n                return sink(endEvent());\n            }\n            else {\n                var reply = more;\n                for (var i = 0; i < data.length; i++) {\n                    let value = data[i];\n                    if (value === endMarker) {\n                        return sink(endEvent());\n                    }\n                    else {\n                        reply = sink(nextEvent(value));\n                    }\n                }\n                return reply;\n            }\n        }\n        else {\n            return sink(event);\n        }\n    }, new Desc(src, \"takeUntil\", [stopper]));\n}\n\n/** @hidden */\nfunction flatMap$1(src, f) {\n    return flatMap_(handleEventValueWith(f), src, { desc: new Desc(src, \"flatMap\", [f]) });\n}\n\n/** @hidden */\nfunction flatMapError(src, f) {\n    return flatMap_((x) => {\n        if (x instanceof Error$1) {\n            let error = x.error;\n            return f(error); // I don't understand why I need this little lie\n        }\n        else {\n            return x;\n        }\n    }, src, {\n        mapError: true,\n        desc: new Desc(src, \"flatMapError\", [f])\n    });\n}\n\nvar spies = [];\nvar running = false;\n/** @hidden */\nfunction registerObs(obs) {\n    if (spies.length) {\n        if (!running) {\n            try {\n                running = true;\n                spies.forEach(function (spy) {\n                    spy(obs);\n                });\n            }\n            finally {\n                running = false;\n            }\n        }\n    }\n}\n/**\n Adds your function as a \"spy\" that will get notified on all new Observables.\n This will allow a visualization/analytics tool to spy on all Bacon activity.\n */\nconst spy = (spy) => spies.push(spy);\n\n/** @hidden */\nfunction flatMapLatest(src, f_) {\n    let f = _.toFunction(f_);\n    var stream = isProperty(src) ? src.toEventStream(allowSync) : src;\n    let flatMapped = flatMap$1(stream, (value) => makeObservable(f(value)).takeUntil(stream));\n    if (isProperty(src))\n        flatMapped = flatMapped.toProperty();\n    return flatMapped.withDesc(new Desc(src, \"flatMapLatest\", [f]));\n}\n\n/** @hidden */\nclass Dispatcher {\n    constructor(observable, _subscribe, _handleEvent) {\n        this.pushing = false;\n        this.ended = false;\n        this.prevError = undefined;\n        this.unsubSrc = undefined;\n        this._subscribe = _subscribe;\n        this._handleEvent = _handleEvent;\n        this.subscribe = _.bind(this.subscribe, this);\n        this.handleEvent = _.bind(this.handleEvent, this);\n        this.subscriptions = [];\n        this.observable = observable;\n        this.queue = [];\n    }\n    hasSubscribers() {\n        return this.subscriptions.length > 0;\n    }\n    removeSub(subscription) {\n        this.subscriptions = _.without(subscription, this.subscriptions);\n        return this.subscriptions;\n    }\n    push(event) {\n        if (event.isEnd) {\n            this.ended = true;\n        }\n        return UpdateBarrier.inTransaction(event, this, this.pushIt, [event]);\n    }\n    pushToSubscriptions(event) {\n        try {\n            let tmp = this.subscriptions;\n            const len = tmp.length;\n            for (let i = 0; i < len; i++) {\n                const sub = tmp[i];\n                let reply = sub.sink(event);\n                if (reply === noMore || event.isEnd) {\n                    this.removeSub(sub);\n                }\n            }\n            return true;\n        }\n        catch (error) {\n            this.pushing = false;\n            this.queue = []; // ditch queue in case of exception to avoid unexpected behavior\n            throw error;\n        }\n    }\n    pushIt(event) {\n        if (!this.pushing) {\n            if (event === this.prevError) {\n                return;\n            }\n            if (event.isError) {\n                this.prevError = event;\n            }\n            this.pushing = true;\n            this.pushToSubscriptions(event);\n            this.pushing = false;\n            while (true) {\n                let e = this.queue.shift();\n                if (e) {\n                    this.push(e);\n                }\n                else {\n                    break;\n                }\n            }\n            if (this.hasSubscribers()) {\n                return more;\n            }\n            else {\n                this.unsubscribeFromSource();\n                return noMore;\n            }\n        }\n        else {\n            this.queue.push(event);\n            return more;\n        }\n    }\n    handleEvent(event) {\n        if (this._handleEvent) {\n            return this._handleEvent(event);\n        }\n        else {\n            return this.push(event);\n        }\n    }\n    ;\n    unsubscribeFromSource() {\n        if (this.unsubSrc) {\n            this.unsubSrc();\n        }\n        this.unsubSrc = undefined;\n    }\n    subscribe(sink) {\n        if (this.ended) {\n            sink(endEvent());\n            return nop;\n        }\n        else {\n            assertFunction(sink);\n            let subscription = {\n                sink: sink\n            };\n            this.subscriptions.push(subscription);\n            if (this.subscriptions.length === 1) {\n                this.unsubSrc = this._subscribe(this.handleEvent);\n                assertFunction(this.unsubSrc);\n            }\n            return () => {\n                this.removeSub(subscription);\n                if (!this.hasSubscribers()) {\n                    return this.unsubscribeFromSource();\n                }\n            };\n        }\n    }\n    inspect() {\n        return this.observable.toString();\n    }\n}\n\n/** @hidden */\nclass PropertyDispatcher extends Dispatcher {\n    constructor(property, subscribe, handleEvent) {\n        super(property, subscribe, handleEvent);\n        this.current = none();\n        this.propertyEnded = false;\n        this.subscribe = _.bind(this.subscribe, this);\n    }\n    push(event) {\n        //console.log(\"dispatch\", event, \"from\",  this)\n        if (event.isEnd) {\n            this.propertyEnded = true;\n        }\n        if (event instanceof Value) {\n            //console.log(\"setting current\")\n            this.current = new Some(event);\n            this.currentValueRootId = UpdateBarrier.currentEventId();\n        }\n        else if (event.hasValue) {\n            console.error(\"Unknown event, two Bacons loaded?\", event.constructor);\n        }\n        return super.push(event);\n    }\n    maybeSubSource(sink, reply) {\n        if (reply === noMore) {\n            return nop;\n        }\n        else if (this.propertyEnded) {\n            sink(endEvent());\n            return nop;\n        }\n        else {\n            return super.subscribe(sink);\n        }\n    }\n    subscribe(sink) {\n        // init value is \"bounced\" here because the base Dispatcher class\n        // won't add more than one subscription to the underlying observable.\n        // without bouncing, the init value would be missing from all new subscribers\n        // after the first one\n        var reply = more;\n        if (this.current.isDefined && (this.hasSubscribers() || this.propertyEnded)) {\n            // should bounce init value\n            var dispatchingId = UpdateBarrier.currentEventId();\n            var valId = this.currentValueRootId;\n            if (!this.propertyEnded && valId && dispatchingId && dispatchingId !== valId) {\n                // when subscribing while already dispatching a value and this property hasn't been updated yet\n                // we cannot bounce before this property is up to date.\n                //console.log(\"bouncing with possibly stale value\", event.value, \"root at\", valId, \"vs\", dispatchingId)\n                UpdateBarrier.whenDoneWith(this.observable, () => {\n                    if (this.currentValueRootId === valId) {\n                        //console.log(\"bouncing\", this.current.get().value)\n                        return sink(initialEvent(this.current.get().value));\n                    }\n                });\n                // the subscribing thing should be defered\n                return this.maybeSubSource(sink, reply);\n            }\n            else {\n                //console.log(\"bouncing immdiately\", this.current.get().value)\n                UpdateBarrier.inTransaction(undefined, this, () => {\n                    reply = sink(initialEvent(this.current.get().value));\n                    return reply;\n                }, []);\n                return this.maybeSubSource(sink, reply);\n            }\n        }\n        else {\n            //console.log(\"normal subscribe\", this)\n            return this.maybeSubSource(sink, reply);\n        }\n    }\n    inspect() {\n        return this.observable + \" current= \" + this.current;\n    }\n}\n\n/** @hidden */\nfunction flatMapWithConcurrencyLimit(src, limit, f) {\n    return flatMap_(handleEventValueWith(f), src, {\n        desc: new Desc(src, \"flatMapWithConcurrencyLimit\", [limit, f]),\n        limit\n    });\n}\n\n/** @hidden */\nfunction bufferWithTime(src, delay) {\n    return bufferWithTimeOrCount(src, delay, Number.MAX_VALUE).withDesc(new Desc(src, \"bufferWithTime\", [delay]));\n}\n/** @hidden */\nfunction bufferWithCount(src, count) {\n    return bufferWithTimeOrCount(src, undefined, count).withDesc(new Desc(src, \"bufferWithCount\", [count]));\n}\n/** @hidden */\nfunction bufferWithTimeOrCount(src, delay, count) {\n    const delayFunc = toDelayFunction(delay);\n    function flushOrSchedule(buffer) {\n        if (buffer.values.length === count) {\n            //console.log Bacon.scheduler.now() + \": count-flush\"\n            return buffer.flush();\n        }\n        else if (delayFunc !== undefined) {\n            return buffer.schedule(delayFunc);\n        }\n    }\n    var desc = new Desc(src, \"bufferWithTimeOrCount\", [delay, count]);\n    return buffer(src, flushOrSchedule, flushOrSchedule).withDesc(desc);\n}\nclass Buffer {\n    constructor(onFlush, onInput) {\n        this.push = (e) => more;\n        this.scheduled = null;\n        this.end = undefined;\n        this.values = [];\n        this.onFlush = onFlush;\n        this.onInput = onInput;\n    }\n    flush() {\n        if (this.scheduled) {\n            GlobalScheduler.scheduler.clearTimeout(this.scheduled);\n            this.scheduled = null;\n        }\n        if (this.values.length > 0) {\n            //console.log Bacon.scheduler.now() + \": flush \" + @values\n            var valuesToPush = this.values;\n            this.values = [];\n            var reply = this.push(nextEvent(valuesToPush));\n            if ((this.end != null)) {\n                return this.push(this.end);\n            }\n            else if (reply !== noMore) {\n                return this.onFlush(this);\n            }\n        }\n        else {\n            if ((this.end != null)) {\n                return this.push(this.end);\n            }\n        }\n    }\n    schedule(delay) {\n        if (!this.scheduled) {\n            return this.scheduled = delay(() => {\n                //console.log Bacon.scheduler.now() + \": scheduled flush\"\n                return this.flush();\n            });\n        }\n    }\n}\nfunction toDelayFunction(delay) {\n    if (delay === undefined) {\n        return undefined;\n    }\n    if (typeof delay === \"number\") {\n        var delayMs = delay;\n        return function (f) {\n            //console.log Bacon.scheduler.now() + \": schedule for \" + (Bacon.scheduler.now() + delayMs)\n            return GlobalScheduler.scheduler.setTimeout(f, delayMs);\n        };\n    }\n    return delay;\n}\n/** @hidden */\nfunction buffer(src, onInput = nop, onFlush = nop) {\n    var reply = more;\n    var buffer = new Buffer(onFlush, onInput);\n    return src.transform((event, sink) => {\n        buffer.push = sink;\n        if (hasValue(event)) {\n            buffer.values.push(event.value);\n            //console.log Bacon.scheduler.now() + \": input \" + event.value\n            onInput(buffer);\n        }\n        else if (isError(event)) {\n            reply = sink(event);\n        }\n        else if (isEnd(event)) {\n            buffer.end = event;\n            if (!buffer.scheduled) {\n                //console.log Bacon.scheduler.now() + \": end-flush\"\n                buffer.flush();\n            }\n        }\n        return reply;\n    }).withDesc(new Desc(src, \"buffer\", []));\n}\n\n/** @hidden */\nfunction asyncWrapSubscribe(obs, subscribe) {\n    //assertFunction(subscribe)\n    var subscribing = false;\n    return function wrappedSubscribe(sink) {\n        //assertFunction(sink)\n        const inTransaction = UpdateBarrier.isInTransaction();\n        subscribing = true;\n        var asyncDeliveries;\n        function deliverAsync() {\n            //console.log(\"delivering async\", obs, asyncDeliveries)\n            var toDeliverNow = asyncDeliveries || [];\n            asyncDeliveries = undefined;\n            for (var i = 0; i < toDeliverNow.length; i++) {\n                var event = toDeliverNow[i];\n                sink(event);\n            }\n        }\n        try {\n            return subscribe(function wrappedSink(event) {\n                if (subscribing || asyncDeliveries) {\n                    // Deliver async if currently subscribing\n                    // Also queue further events until async delivery has been completed\n                    //console.log(\"Stream responded synchronously\", obs)\n                    if (!asyncDeliveries) {\n                        asyncDeliveries = [event];\n                        if (inTransaction) {\n                            UpdateBarrier.soonButNotYet(obs, deliverAsync);\n                        }\n                        else {\n                            GlobalScheduler.scheduler.setTimeout(deliverAsync, 0);\n                        }\n                    }\n                    else {\n                        asyncDeliveries.push(event);\n                    }\n                    return more;\n                }\n                else {\n                    return sink(event);\n                }\n            });\n        }\n        finally {\n            subscribing = false;\n        }\n    };\n}\n\n/**\n Merges given array of EventStreams or Properties, by collecting the values from all of the sources into a single\n EventStream.\n\n See also [`merge`](classes/eventstream.html#merge).\n */\nfunction mergeAll(...streams) {\n    let flattenedStreams = argumentsToObservables(streams);\n    if (flattenedStreams.length) {\n        return new EventStream(new Desc(\"Bacon\", \"mergeAll\", flattenedStreams), function (sink) {\n            var ends = 0;\n            var smartSink = function (obs) {\n                return function (unsubBoth) {\n                    return obs.subscribeInternal(function (event) {\n                        if (event.isEnd) {\n                            ends++;\n                            if (ends === flattenedStreams.length) {\n                                return sink(endEvent());\n                            }\n                            else {\n                                return more;\n                            }\n                        }\n                        else {\n                            event = event.toNext();\n                            var reply = sink(event);\n                            if (reply === noMore) {\n                                unsubBoth();\n                            }\n                            return reply;\n                        }\n                    });\n                };\n            };\n            var sinks = map(smartSink, flattenedStreams);\n            return new CompositeUnsubscribe(sinks).unsubscribe;\n        });\n    }\n    else {\n        return never();\n    }\n}\n\n/**\n\n Creates a single-element stream that emits given value after given delay and ends.\n\n @param delay delay in milliseconds\n @param value value to be emitted\n @typeparam V Type of stream elements\n\n */\nfunction later(delay, value) {\n    return fromBinder(function (sink) {\n        var sender = function () {\n            return sink([toEvent(value), endEvent()]);\n        };\n        var id = GlobalScheduler.scheduler.setTimeout(sender, delay);\n        return function () {\n            return GlobalScheduler.scheduler.clearTimeout(id);\n        };\n    }).withDesc(new Desc(\"Bacon\", \"later\", [delay, value]));\n}\n\n/** @hidden */\nfunction delay(src, delay) {\n    return src.transformChanges(new Desc(src, \"delay\", [delay]), function (changes) {\n        return changes.flatMap(function (value) {\n            return later(delay, value);\n        });\n    });\n}\n\n/** @hidden */\nfunction debounce(src, delay) {\n    return src.transformChanges(new Desc(src, \"debounce\", [delay]), function (changes) {\n        return changes.flatMapLatest(function (value) {\n            return later(delay, value);\n        });\n    });\n}\n/** @hidden */\nfunction debounceImmediate(src, delay) {\n    return src.transformChanges(new Desc(src, \"debounceImmediate\", [delay]), function (changes) {\n        return changes.flatMapFirst(function (value) {\n            return once(value).concat(later(delay, value).errors());\n        });\n    });\n}\n\n/** @hidden */\nfunction throttle(src, delay) {\n    return src.transformChanges(new Desc(src, \"throttle\", [delay]), (changes) => changes.bufferWithTime(delay).map((values) => values[values.length - 1]));\n}\n\n/** @hidden */\nfunction bufferingThrottle(src, minimumInterval) {\n    var desc = new Desc(src, \"bufferingThrottle\", [minimumInterval]);\n    return src.transformChanges(desc, changes => changes.flatMapConcat((x) => {\n        return once(x).concat(later(minimumInterval, x).errors());\n    }));\n}\n\n/** @hidden */\nfunction takeWhile(src, f) {\n    return withPredicate(src, f, takeWhileT, new Desc(src, \"takeWhile\", [f]));\n}\nfunction takeWhileT(f) {\n    return (event, sink) => {\n        if (event.filter(f)) {\n            return sink(event);\n        }\n        else {\n            sink(endEvent());\n            return noMore;\n        }\n    };\n}\n\n/** @hidden */\nfunction skipUntil(src, starter) {\n    var started = starter\n        .transform(composeT(takeT(1), mapT(true)))\n        .toProperty()\n        .startWith(false);\n    return src.filter(started).withDesc(new Desc(src, \"skipUntil\", [starter]));\n}\n\n/** @hidden */\nfunction skipWhile(src, f) {\n    return withPredicate(src, f, skipWhileT, new Desc(src, \"skipWhile\", [f]));\n}\n/** @hidden */\nfunction skipWhileT(f) {\n    var started = false;\n    return function (event, sink) {\n        if (started || !hasValue(event) || !f(event.value)) {\n            if (event.hasValue) {\n                started = true;\n            }\n            return sink(event);\n        }\n        else {\n            return more;\n        }\n    };\n}\n\n/** @hidden */\nfunction groupBy(src, keyF, limitF = _.id) {\n    var streams = {};\n    return src.transform(composeT(filterT((x) => !streams[keyF(x)]), mapT(function (firstValue) {\n        var key = keyF(firstValue);\n        var similarValues = src.changes().filter(x => keyF(x) === key);\n        var data = once(firstValue).concat(similarValues);\n        var limited = limitF(data, firstValue).toEventStream().transform((event, sink) => {\n            let reply = sink(event);\n            if (event.isEnd) {\n                delete streams[key];\n            }\n            return reply;\n        });\n        streams[key] = limited;\n        return limited;\n    })));\n}\n\n/** @hidden */\nfunction slidingWindow(src, maxValues, minValues = 0) {\n    return src.scan([], (function (window, value) {\n        return window.concat([value]).slice(-maxValues);\n    }))\n        .filter((function (values) {\n        return values.length >= minValues;\n    })).withDesc(new Desc(src, \"slidingWindow\", [maxValues, minValues]));\n}\n\nconst nullMarker = {};\n/** @hidden */\nfunction diff(src, start, f) {\n    return transformP(scan(src, [start, nullMarker], ((prevTuple, next) => [next, f(prevTuple[0], next)])), composeT(filterT(tuple => tuple[1] !== nullMarker), mapT(tuple => tuple[1])), new Desc(src, \"diff\", [start, f]));\n}\n\n/** @hidden */\nfunction flatScan(src, seed, f) {\n    let current = seed;\n    return src.flatMapConcat((next) => makeObservable(f(current, next)).doAction(updated => current = updated)).toProperty().startWith(seed).withDesc(new Desc(src, \"flatScan\", [seed, f]));\n}\n\n/** @hidden */\nfunction holdWhen(src, valve) {\n    var onHold = false;\n    var bufferedValues = [];\n    var srcIsEnded = false;\n    return new EventStream(new Desc(src, \"holdWhen\", [valve]), function (sink) {\n        var composite = new CompositeUnsubscribe();\n        var subscribed = false;\n        var endIfBothEnded = function (unsub) {\n            if (unsub) {\n                unsub();\n            }\n            if (composite.empty() && subscribed) {\n                return sink(endEvent());\n            }\n            return more;\n        };\n        composite.add(function (unsubAll, unsubMe) {\n            return valve.subscribeInternal(function (event) {\n                if (hasValue(event)) {\n                    onHold = event.value;\n                    var result = more;\n                    if (!onHold) {\n                        var toSend = bufferedValues;\n                        bufferedValues = [];\n                        for (var i = 0; i < toSend.length; i++) {\n                            result = sink(nextEvent(toSend[i]));\n                        }\n                        if (srcIsEnded) {\n                            sink(endEvent());\n                            unsubMe();\n                            result = noMore;\n                        }\n                    }\n                    return result;\n                }\n                else if (event.isEnd) {\n                    return endIfBothEnded(unsubMe);\n                }\n                else {\n                    return sink(event);\n                }\n            });\n        });\n        composite.add(function (unsubAll, unsubMe) {\n            return src.subscribeInternal(function (event) {\n                if (onHold && hasValue(event)) {\n                    bufferedValues.push(event.value);\n                    return more;\n                }\n                else if (event.isEnd && bufferedValues.length) {\n                    srcIsEnded = true;\n                    return endIfBothEnded(unsubMe);\n                }\n                else {\n                    return sink(event);\n                }\n            });\n        });\n        subscribed = true;\n        endIfBothEnded();\n        return composite.unsubscribe;\n    });\n}\n\n/**\n Zips the array of EventStreams / Properties in to a new\n EventStream that will have an array of values from each source as\n its value. Zipping means that events from each source are combined\n pairwise so that the 1st event from each source is published first, then\n the 2nd event from each. The results will be published as soon as there\n is a value from each source.\n\n Be careful not to have too much \"drift\" between streams. If one stream\n produces many more values than some other excessive buffering will\n occur inside the zipped observable.\n\n Example:\n\n ```js\n x = Bacon.fromArray([1,2,3])\n y = Bacon.fromArray([10, 20, 30])\n z = Bacon.fromArray([100, 200, 300])\n Bacon.zipAsArray(x, y, z)\n\n # produces values [1, 10, 100], [2, 20, 200] and [3, 30, 300]\n ```\n\n */\nfunction zipAsArray(...args) {\n    let streams = _.map(((s) => s.toEventStream()), argumentsToObservables(args));\n    return when([streams, (...xs) => xs]).withDesc(new Desc(\"Bacon\", \"zipAsArray\", args));\n}\n/**\n Like [`zipAsArray`](#bacon-zipasarray) but uses the given n-ary\n function to combine the n values from n sources, instead of returning them in an Array.\n */\nfunction zipWith(f, ...streams) {\n    var [streams, f] = argumentsToObservablesAndFunction(arguments);\n    streams = _.map(((s) => s.toEventStream()), streams);\n    return when([streams, f]).withDesc(new Desc(\"Bacon\", \"zipWith\", [f].concat(streams)));\n}\n/** @hidden */\nfunction zip(left, right, f) {\n    return zipWith(f || Array, left, right).withDesc(new Desc(left, \"zip\", [right]));\n}\n\nfunction combineTemplate(template) {\n    function current(ctxStack) { return ctxStack[ctxStack.length - 1]; }\n    function setValue(ctxStack, key, value) {\n        current(ctxStack)[key] = value;\n        return value;\n    }\n    function applyStreamValue(key, index) {\n        return function (ctxStack, values) {\n            setValue(ctxStack, key, values[index]);\n        };\n    }\n    function constantValue(key, value) {\n        return function (ctxStack) {\n            setValue(ctxStack, key, value);\n        };\n    }\n    function mkContext(template) {\n        return isArray(template) ? [] : {};\n    }\n    function pushContext(key, value) {\n        return function (ctxStack) {\n            const newContext = mkContext(value);\n            setValue(ctxStack, key, newContext);\n            ctxStack.push(newContext);\n        };\n    }\n    function containsObservables(value) {\n        if (isObservable(value)) {\n            return true;\n        }\n        else if (value && (value.constructor == Object || value.constructor == Array)) {\n            for (var key in value) {\n                if (Object.prototype.hasOwnProperty.call(value, key)) {\n                    const child = value[key];\n                    if (containsObservables(child))\n                        return true;\n                }\n            }\n        }\n    }\n    function compile(key, value) {\n        if (isObservable(value)) {\n            streams.push(value);\n            funcs.push(applyStreamValue(key, streams.length - 1));\n        }\n        else if (containsObservables(value)) {\n            const popContext = function (ctxStack) { ctxStack.pop(); };\n            funcs.push(pushContext(key, value));\n            compileTemplate(value);\n            funcs.push(popContext);\n        }\n        else {\n            funcs.push(constantValue(key, value));\n        }\n    }\n    function combinator(values) {\n        const rootContext = mkContext(template);\n        const ctxStack = [rootContext];\n        for (var i = 0, f; i < funcs.length; i++) {\n            f = funcs[i];\n            f(ctxStack, values);\n        }\n        return rootContext;\n    }\n    function compileTemplate(template) { _.each(template, compile); }\n    const funcs = [];\n    const streams = [];\n    const resultProperty = containsObservables(template)\n        ? (compileTemplate(template), combineAsArray(streams).map(combinator))\n        : constant(template);\n    return resultProperty.withDesc(new Desc(\"Bacon\", \"combineTemplate\", [template]));\n}\n\n/** @hidden */\nfunction decode(src, cases) {\n    return src.combine(combineTemplate(cases), (key, values) => values[key])\n        .withDesc(new Desc(src, \"decode\", [cases]));\n}\n\n/** @hidden */\nfunction firstToPromise(src, PromiseCtr) {\n    const generator = (resolve, reject) => src.subscribe((event) => {\n        if (hasValue(event)) {\n            resolve(event.value);\n        }\n        if (isError(event)) {\n            reject(event.error);\n        }\n        // One event is enough\n        return noMore;\n    });\n    // Can't do in the global scope, as shim can be applied after Bacon is loaded.\n    if (typeof PromiseCtr === \"function\") {\n        return new PromiseCtr(generator);\n    }\n    else if (typeof Promise === \"function\") {\n        return new Promise(generator);\n    }\n    else {\n        throw new Error(\"There isn't default Promise, use shim or parameter\");\n    }\n}\n/** @hidden */\nfunction toPromise(src, PromiseCtr) {\n    return src.last().firstToPromise(PromiseCtr);\n}\n\nvar idCounter = 0;\n/**\n Observable is the base class for [EventsStream](eventstream.html) and [Property](property.html)\n\n @typeparam V   Type of the elements/values in the stream/property\n */\nclass Observable {\n    constructor(desc) {\n        /**\n         * Unique numeric id of this Observable. Implemented using a simple counter starting from 1.\n         */\n        this.id = ++idCounter;\n        /** @hidden */\n        this._isObservable = true;\n        this.desc = desc;\n        this.initialDesc = desc;\n    }\n    /**\n  Creates a Property that indicates whether\n  `observable` is awaiting `otherObservable`, i.e. has produced a value after the latest\n  value from `otherObservable`. This is handy for keeping track whether we are\n  currently awaiting an AJAX response:\n  \n  ```js\n  var showAjaxIndicator = ajaxRequest.awaiting(ajaxResponse)\n  ```\n  \n     */\n    awaiting(other) {\n        return awaiting(this, other);\n    }\n    /**\n  Throttles the observable using a buffer so that at most one value event in minimumInterval is issued.\n  Unlike [`throttle`](#observable-throttle), it doesn't discard the excessive events but buffers them instead, outputting\n  them with a rate of at most one value per minimumInterval.\n  \n  Example:\n  \n  ```js\n  var throttled = source.bufferingThrottle(2)\n  ```\n  \n  ```\n  source:    asdf----asdf----\n  throttled: a-s-d-f-a-s-d-f-\n  ```\n     */\n    bufferingThrottle(minimumInterval) {\n        return bufferingThrottle(this, minimumInterval);\n    }\n    /**\n  Combines the latest values of the two\n  streams or properties using a two-arg function. Similarly to [`scan`](#scan), you can use a\n  method name instead, so you could do `a.combine(b, \".concat\")` for two\n  properties with array value. The result is a [Property](property.html).\n     */\n    combine(right, f) {\n        return combineTwo(this, right, f).withDesc(new Desc(this, \"combine\", [right, f]));\n    }\n    /**\n  Throttles stream/property by given amount\n  of milliseconds, but so that event is only emitted after the given\n  \"quiet period\". Does not affect emitting the initial value of a [Property](property.html).\n  The difference of [`throttle`](#throttle) and [`debounce`](#debounce) is the same as it is in the\n  same methods in jQuery.\n  \n  Example:\n  \n  ```\n  source:             asdf----asdf----\n  source.debounce(2): -----f-------f--\n  ```\n  \n     */\n    debounce(minimumInterval) {\n        return debounce(this, minimumInterval);\n    }\n    /**\n  Passes the first event in the\n  stream through, but after that, only passes events after a given number\n  of milliseconds have passed since previous output.\n  \n  Example:\n  \n  ```\n  source:                      asdf----asdf----\n  source.debounceImmediate(2): a-d-----a-d-----\n  ```\n     */\n    debounceImmediate(minimumInterval) {\n        return debounceImmediate(this, minimumInterval);\n    }\n    /**\n  Decodes input using the given mapping. Is a\n  bit like a switch-case or the decode function in Oracle SQL. For\n  example, the following would map the value 1 into the string \"mike\"\n  and the value 2 into the value of the `who` property.\n  \n  ```js\n  property.decode({1 : \"mike\", 2 : who})\n  ```\n  \n  This is actually based on [`combineTemplate`](#combinetemplate) so you can compose static\n  and dynamic data quite freely, as in\n  \n  ```js\n  property.decode({1 : { type: \"mike\" }, 2 : { type: \"other\", whoThen : who }})\n  ```\n  \n  The return value of [`decode`](#decode) is always a [`Property`](property.html).\n  \n     */\n    //decode<T extends Record<any, any>>(src: Observable<keyof T>, cases: T): Property<DecodedValueOf<T>>\n    decode(cases) {\n        return decode(this, cases);\n    }\n    /**\n  Delays the stream/property by given amount of milliseconds. Does not delay the initial value of a [`Property`](property.html).\n  \n  ```js\n  var delayed = source.delay(2)\n  ```\n  \n  ```\n  source:    asdf----asdf----\n  delayed:   --asdf----asdf--\n  ```\n  \n     */\n    delay(delayMs) {\n        return delay(this, delayMs);\n    }\n    /**\n     * Returns the an array of dependencies that the Observable has. For instance, for `a.map(function() {}).deps()`, would return `[a]`.\n     This method returns the \"visible\" dependencies only, skipping internal details.  This method is thus suitable for visualization tools.\n     Internally, many combinator functions depend on other combinators to create intermediate Observables that the result will actually depend on.\n     The `deps` method will skip these internal dependencies. See also: [internalDeps](#internaldeps)\n     */\n    deps() {\n        return this.desc.deps();\n    }\n    /**\n  Returns a Property that represents the result of a comparison\n  between the previous and current value of the Observable. For the initial value of the Observable,\n  the previous value will be the given start.\n  \n  Example:\n  \n  ```js\n  var distance = function (a,b) { return a - b }\n  Bacon.sequentially(1, [1,2,3]).diff(0, distance)\n  ```\n  \n  This would result to following elements in the result stream:\n  \n      0 - 1 = -1\n      1 - 2 = -1\n      2 - 3 = -1\n  \n     */\n    diff(start, f) {\n        return diff(this, start, f);\n    }\n    /**\n  Returns a stream/property where the function f\n  is executed for each value, before dispatching to subscribers. This is\n  useful for debugging, but also for stuff like calling the\n  `preventDefault()` method for events. In fact, you can\n  also use a property-extractor string instead of a function, as in\n  `\".preventDefault\"`.\n  \n  Please note that for Properties, it's not guaranteed that the function will be called exactly once\n  per event; when a Property loses all of its subscribers it will re-emit its current value when a\n  new subscriber is added.\n     */\n    doAction(f) {\n        return this.transform(doActionT(f), new Desc(this, \"doAction\", [f]));\n    }\n    doEnd(f) {\n        return this.transform(doEndT(f), new Desc(this, \"doEnd\", [f]));\n    }\n    /**\n  Returns a stream/property where the function f\n  is executed for each error, before dispatching to subscribers.\n  That is, same as [`doAction`](#observable-doaction) but for errors.\n     */\n    doError(f) {\n        return this.transform(doErrorT(f), new Desc(this, \"doError\", [f]));\n    }\n    /**\n  Logs each value of the Observable to the console. doLog() behaves like [`log`](#log)\n  but does not subscribe to the event stream. You can think of doLog() as a\n  logger function that – unlike log() – is safe to use in production. doLog() is\n  safe, because it does not cause the same surprising side-effects as log()\n  does.\n     */\n    doLog(...args) {\n        return this.transform(doLogT(args), new Desc(this, \"doLog\", args));\n    }\n    endAsValue() {\n        return endAsValue(this);\n    }\n    /**\n    Returns a stream/property that ends the on first [`Error`](error.html) event. The\n    error is included in the output of the returned Observable.\n    \n    @param  predicate   optional predicate function to determine whether to end on a given error\n     */\n    endOnError(predicate = x => true) {\n        return endOnError(this, predicate);\n    }\n    /**\n  Returns a stream containing [`Error`](error.html) events only.\n  Same as filtering with a function that always returns false.\n     */\n    errors() {\n        return this.filter(x => false).withDesc(new Desc(this, \"errors\"));\n    }\n    /**\n  Filters values using given predicate function.\n  Instead of a function, you can use a constant value (`true` to include all, `false` to exclude all).\n  \n  You can also filter values based on the value of a\n  property. Event will be included in output [if and only if](http://en.wikipedia.org/wiki/If_and_only_if) the property holds `true`\n  at the time of the event.\n     */\n    filter(f) {\n        return filter$1(this, f);\n    }\n    /**\n  Takes the first element from the stream. Essentially `observable.take(1)`.\n     */\n    first() {\n        return take(1, this, new Desc(this, \"first\"));\n    }\n    /**\n  Returns a Promise which will be resolved with the first event coming from an Observable.\n  Like [`toPromise`](#topromise), the global ES6 promise implementation will be used unless a promise\n  constructor is given.\n     */\n    firstToPromise(PromiseCtr) {\n        return firstToPromise(this, PromiseCtr);\n    }\n    /**\n  Works like [`scan`](#scan) but only emits the final\n  value, i.e. the value just before the observable ends. Returns a\n  [`Property`](property.html).\n     */\n    fold(seed, f) {\n        return fold$1(this, seed, f);\n    }\n    /**\n     An alias for [onValue](#onvalue).\n  \n     Subscribes a given handler function to the observable. Function will be called for each new value (not for errors or stream end).\n     */\n    forEach(f = nullSink) {\n        // TODO: inefficient alias. Also, similar assign alias missing.\n        return this.onValue(f);\n    }\n    /**\n  Pauses and buffers the event stream if last event in valve is truthy.\n  All buffered events are released when valve becomes falsy.\n     */\n    holdWhen(valve) {\n        return holdWhen(this, valve);\n    }\n    inspect() { return this.toString(); }\n    /**\n     * Returns the true dependencies of the observable, including the intermediate \"hidden\" Observables.\n     This method is for Bacon.js internal purposes but could be useful for debugging/analysis tools as well.\n     See also: [deps](#deps)\n     */\n    internalDeps() {\n        return this.initialDesc.deps();\n    }\n    /**\n  Takes the last element from the stream. None, if stream is empty.\n  \n  \n  *Note:* `neverEndingStream.last()` creates the stream which doesn't produce any events and never ends.\n     */\n    last() {\n        return last$1(this);\n    }\n    /**\n  Logs each value of the Observable to the console.\n  It optionally takes arguments to pass to console.log() alongside each\n  value. To assist with chaining, it returns the original Observable. Note\n  that as a side-effect, the observable will have a constant listener and\n  will not be garbage-collected. So, use this for debugging only and\n  remove from production code. For example:\n  \n  ```js\n  myStream.log(\"New event in myStream\")\n  ```\n  \n  or just\n  \n  ```js\n  myStream.log()\n  ```\n  \n     */\n    log(...args) {\n        log(args, this);\n        return this;\n    }\n    /**\n  Adds an extra [`Next`](next.html) event just before End. The value is created\n  by calling the given function when the source stream ends. Instead of a\n  function, a static value can be used.\n     */\n    // TODO: mapEnd and mapError signatures should allow V|V2\n    mapEnd(f) {\n        return this.transform(mapEndT(f), new Desc(this, \"mapEnd\", [f]));\n    }\n    /**\n  Maps errors using given function. More\n  specifically, feeds the \"error\" field of the error event to the function\n  and produces a [`Next`](next.html) event based on the return value.\n     */\n    mapError(f) {\n        return this.transform(mapErrorT(f), new Desc(this, \"mapError\", [f]));\n    }\n    /**\n  Sets the name of the observable. Overrides the default\n  implementation of [`toString`](#tostring) and `inspect`.\n  Returns the same observable, with mutated name.\n     */\n    name(name) {\n        this._name = name;\n        return this;\n    }\n    /**\n  Subscribes a callback to stream end. The function will be called when the stream ends.\n  Just like `subscribe`, this method returns a function for unsubscribing.\n     */\n    onEnd(f = nullVoidSink) {\n        return this.subscribe(function (event) {\n            if (event.isEnd) {\n                return f();\n            }\n            return more;\n        });\n    }\n    /**\n  Subscribes a handler to error events. The function will be called for each error in the stream.\n  Just like `subscribe`, this method returns a function for unsubscribing.\n     */\n    onError(f = nullSink) {\n        return this.subscribe(function (event) {\n            if (isError(event)) {\n                return f(event.error);\n            }\n            return more;\n        });\n    }\n    /**\n  Subscribes a given handler function to the observable. Function will be called for each new value.\n  This is the simplest way to assign a side-effect to an observable. The difference\n  to the `subscribe` method is that the actual stream values are\n  received, instead of [`Event`](event) objects.\n  Just like `subscribe`, this method returns a function for unsubscribing.\n  `stream.onValue` and `property.onValue` behave similarly, except that the latter also\n  pushes the initial value of the property, in case there is one.\n     */\n    onValue(f = nullSink) {\n        return this.subscribe(function (event) {\n            if (hasValue(event)) {\n                return f(event.value);\n            }\n            return more;\n        });\n    }\n    /**\n  Like [`onValue`](#onvalue), but splits the value (assuming its an array) as function arguments to `f`.\n  Only applicable for observables with arrays as values.\n     */\n    onValues(f) {\n        return this.onValue(function (args) { return f(...args); });\n    }\n    /** A synonym for [fold](#fold).\n     */\n    reduce(seed, f) {\n        return fold$1(this, seed, f);\n    }\n    sampledBy(sampler) {\n        return sampledBy(this, sampler, arguments[1]); // TODO: combinator\n    }\n    /**\n  Scans stream/property with given seed value and\n  accumulator function, resulting to a Property. For example, you might\n  use zero as seed and a \"plus\" function as the accumulator to create\n  an \"integral\" property. Instead of a function, you can also supply a\n  method name such as \".concat\", in which case this method is called on\n  the accumulator value and the new stream value is used as argument.\n  \n  Example:\n  \n  ```js\n  var plus = function (a,b) { return a + b }\n  Bacon.sequentially(1, [1,2,3]).scan(0, plus)\n  ```\n  \n  This would result to following elements in the result stream:\n  \n      seed value = 0\n      0 + 1 = 1\n      1 + 2 = 3\n      3 + 3 = 6\n  \n  When applied to a Property as in `r = p.scan(seed, f)`, there's a (hopefully insignificant) catch:\n  The starting value for `r` depends on whether `p` has an\n  initial value when scan is applied. If there's no initial value, this works\n  identically to EventStream.scan: the `seed` will be the initial value of\n  `r`. However, if `r` already has a current/initial value `x`, the\n  seed won't be output as is. Instead, the initial value of `r` will be `f(seed, x)`. This makes sense,\n  because there can only be 1 initial value for a Property at a time.\n     */\n    scan(seed, f) {\n        return scan(this, seed, f);\n    }\n    /**\n  Skips the first n elements from the stream\n     */\n    skip(count) {\n        return skip(this, count);\n    }\n    /**\n  Drops consecutive equal elements. So,\n  from `[1, 2, 2, 1]` you'd get `[1, 2, 1]`. Uses the `===` operator for equality\n  checking by default. If the isEqual argument is supplied, checks by calling\n  isEqual(oldValue, newValue). For instance, to do a deep comparison,you can\n  use the isEqual function from [underscore.js](http://underscorejs.org/)\n  like `stream.skipDuplicates(_.isEqual)`.\n     */\n    skipDuplicates(isEqual) {\n        return skipDuplicates(this, isEqual);\n    }\n    /**\n     * Returns a new stream/property which excludes all [Error](error.html) events in the source\n     */\n    skipErrors() {\n        return skipErrors(this);\n    }\n    /**\n     Skips elements from the source, until a value event\n     appears in the given `starter` stream/property. In other words, starts delivering values\n     from the source after first value appears in `starter`.\n     */\n    skipUntil(starter) {\n        return skipUntil(this, starter);\n    }\n    /**\n     Skips elements until the given predicate function returns falsy once, and then\n     lets all events pass through. Instead of a predicate you can also pass in a `Property<boolean>` to skip elements\n     while the Property holds a truthy value.\n     */\n    skipWhile(f) {\n        return skipWhile(this, f);\n    }\n    /**\n  Returns a Property that represents a\n  \"sliding window\" into the history of the values of the Observable. The\n  result Property will have a value that is an array containing the last `n`\n  values of the original observable, where `n` is at most the value of the\n  `max` argument, and at least the value of the `min` argument. If the\n  `min` argument is omitted, there's no lower limit of values.\n  \n  For example, if you have a stream `s` with value a sequence 1 - 2 - 3 - 4 - 5, the\n  respective values in `s.slidingWindow(2)` would be [] - [1] - [1,2] -\n  [2,3] - [3,4] - [4,5]. The values of `s.slidingWindow(2,2)`would be\n  [1,2] - [2,3] - [3,4] - [4,5].\n  \n     */\n    slidingWindow(maxValues, minValues = 0) {\n        return slidingWindow(this, maxValues, minValues);\n    }\n    /**\n     * subscribes given handler function to event stream. Function will receive [event](event.html) objects\n     for all new value, end and error events in the stream.\n     The subscribe() call returns a `unsubscribe` function that you can call to unsubscribe.\n     You can also unsubscribe by returning [`Bacon.noMore`](../globals.html#nomore) from the handler function as a reply\n     to an Event.\n     `stream.subscribe` and `property.subscribe` behave similarly, except that the latter also\n     pushes the initial value of the property, in case there is one.\n  \n     * @param {EventSink<V>} sink the handler function\n     * @returns {Unsub}\n     */\n    subscribe(sink = nullSink) {\n        return UpdateBarrier.wrappedSubscribe(this, sink => this.subscribeInternal(sink), sink);\n    }\n    /**\n  Takes at most n values from the stream and then ends the stream. If the stream has\n  fewer than n values then it is unaffected.\n  Equal to [`Bacon.never()`](../globals.html#never) if `n <= 0`.\n     */\n    take(count) {\n        return take(count, this);\n    }\n    /**\n  Takes elements from source until a value event appears in the other stream.\n  If other stream ends without value, it is ignored.\n     */\n    takeUntil(stopper) {\n        return takeUntil(this, stopper);\n    }\n    /**\n  Takes while given predicate function holds true, and then ends. Alternatively, you can supply a boolean Property to take elements while the Property holds `true`.\n     */\n    takeWhile(f) {\n        return takeWhile(this, f);\n    }\n    /**\n  Throttles stream/property by given amount\n  of milliseconds. Events are emitted with the minimum interval of\n  [`delay`](#observable-delay). The implementation is based on [`stream.bufferWithTime`](#stream-bufferwithtime).\n  Does not affect emitting the initial value of a [`Property`](#property).\n  \n  Example:\n  \n  ```js\n  var throttled = source.throttle(2)\n  ```\n  \n  ```\n  source:    asdf----asdf----\n  throttled: --s--f----s--f--\n  ```\n     */\n    throttle(minimumInterval) {\n        return throttle(this, minimumInterval);\n    }\n    /**\n  Returns a Promise which will be resolved with the last event coming from an Observable.\n  The global ES6 promise implementation will be used unless a promise constructor is given.\n  Use a shim if you need to support legacy browsers or platforms.\n  [caniuse promises](http://caniuse.com/#feat=promises).\n  \n  See also [firstToPromise](#firsttopromise).\n     */\n    toPromise(PromiseCtr) {\n        return toPromise(this, PromiseCtr);\n    }\n    /**\n     *Returns a textual description of the Observable. For instance, `Bacon.once(1).map(function() {}).toString()` would return \"Bacon.once(1).map(function)\".\n     **/\n    toString() {\n        if (this._name) {\n            return this._name;\n        }\n        else {\n            return this.desc.toString();\n        }\n    }\n    withDesc(desc) {\n        if (desc)\n            this.desc = desc;\n        return this;\n    }\n    /**\n  Sets the structured description of the observable. The [`toString`](#tostring) and `inspect` methods\n  use this data recursively to create a string representation for the observable. This method\n  is probably useful for Bacon core / library / plugin development only.\n  \n  For example:\n  \n      var src = Bacon.once(1)\n      var obs = src.map(function(x) { return -x })\n      console.log(obs.toString())\n      --> Bacon.once(1).map(function)\n      obs.withDescription(src, \"times\", -1)\n      console.log(obs.toString())\n      --> Bacon.once(1).times(-1)\n  \n  The method returns the same observable with mutated description.\n  \n  */\n    withDescription(context, method, ...args) {\n        this.desc = describe(context, method, ...args);\n        return this;\n    }\n    /**\n  Returns an EventStream with elements\n  pair-wise lined up with events from this and the other EventStream or Property.\n  A zipped stream will publish only when it has a value from each\n  source and will only produce values up to when any single source ends.\n  \n  The given function `f` is used to create the result value from value in the two\n  sources. If no function is given, the values are zipped into an array.\n  \n  Be careful not to have too much \"drift\" between streams. If one stream\n  produces many more values than some other excessive buffering will\n  occur inside the zipped observable.\n  \n  Example 1:\n  \n  ```js\n  var x = Bacon.fromArray([1, 2])\n  var y = Bacon.fromArray([3, 4])\n  x.zip(y, function(x, y) { return x + y })\n  \n  # produces values 4, 6\n  ```\n  \n  See also [`zipWith`](../globals.html#zipwith) and [`zipAsArray`](../globals.html/zipasarray) for zipping more than 2 sources.\n  \n     */\n    zip(other, f) {\n        return zip(this, other, f);\n    }\n}\n/**\n A reactive property. Has the concept of \"current value\".\n You can create a Property from an EventStream by using either [`toProperty`](eventstream.html#toproperty)\n or [`scan`](eventstream.html#scan) method. Note: depending on how a Property is created, it may or may not\n have an initial value. The current value stays as its last value after the stream has ended.\n\n Here are the most common ways for creating Properties:\n\n - Create a constant property with [constant](../globals.html#constant)\n - Create a property based on an EventStream with [toProperty](eventstream.html#toproperty)\n - Scan an EventStream with an accumulator function with [scan](eventstream.html#scan)\n - Create a state property based on multiple sources using [update](../globals.html#update)\n\n @typeparam V   Type of the elements/values in the stream/property\n */\nclass Property extends Observable {\n    constructor(desc, subscribe, handler) {\n        super(desc);\n        /** @internal */\n        this._isProperty = true;\n        assertFunction(subscribe);\n        this.dispatcher = new PropertyDispatcher(this, subscribe, handler);\n        registerObs(this);\n    }\n    /**\n     Combines properties with the `&&` operator. It produces a new value when either of the Properties change,\n     combining the latest values using `&&`.\n     */\n    and(other) {\n        return and(this, other);\n    }\n    /**\n     * creates a stream of changes to the Property. The stream *does not* include\n     an event for the current value of the Property at the time this method was called.\n     */\n    changes() {\n        return new EventStream(new Desc(this, \"changes\", []), (sink) => this.dispatcher.subscribe(function (event) {\n            if (!event.isInitial) {\n                return sink(event);\n            }\n            return more;\n        }));\n    }\n    concat(other) {\n        return this.transformChanges(describe(this, \"concat\", other), changes => changes.concat(other));\n    }\n    /** @hidden */\n    transformChanges(desc, f) {\n        return transformPropertyChanges(this, f, desc);\n    }\n    /**\n     For each element in the source stream, spawn a new\n     stream/property using the function `f`. Collect events from each of the spawned\n     streams into the result property. Note that instead of a function, you can provide a\n     stream/property too. Also, the return value of function `f` can be either an\n     `Observable` (stream/property) or a constant value.\n  \n     `stream.flatMap()` can be used conveniently with [`Bacon.once()`](../globals.html#once) and [`Bacon.never()`](../globals.html#never)\n     for converting and filtering at the same time, including only some of the results.\n  \n     Example - converting strings to integers, skipping empty values:\n  \n     ```js\n     stream.flatMap(function(text) {\n      return (text != \"\") ? parseInt(text) : Bacon.never()\n  })\n     ```\n     */\n    flatMap(f) {\n        return flatMap$1(this, f);\n    }\n    /**\n     A [`flatMapWithConcurrencyLimit`](#flatmapwithconcurrencylimit) with limit of 1.\n     */\n    flatMapConcat(f) {\n        return flatMapConcat(this, f);\n    }\n    /**\n     Like [`flatMap`](#flatmap), but is applied only on [`Error`](error.html) events. Returned values go into the\n     value stream, unless an error event is returned. As an example, one type of error could result in a retry and another just\n     passed through, which can be implemented using flatMapError.\n     */\n    flatMapError(f) {\n        return flatMapError(this, f);\n    }\n    flatMapEvent(f) {\n        return flatMapEvent(this, f);\n    }\n    /**\n     Like [`flatMap`](#observable-flatmap), but only spawns a new\n     stream if the previously spawned stream has ended.\n     */\n    flatMapFirst(f) {\n        return flatMapFirst(this, f);\n    }\n    /**\n     Like [`flatMap`](#flatmap), but instead of including events from\n     all spawned streams, only includes them from the latest spawned stream.\n     You can think this as switching from stream to stream.\n     Note that instead of a function, you can provide a stream/property too.\n     */\n    flatMapLatest(f) {\n        return flatMapLatest(this, f);\n    }\n    /**\n     A super method of *flatMap* family. It limits the number of open spawned streams and buffers incoming events.\n     [`flatMapConcat`](#flatmapconcat) is `flatMapWithConcurrencyLimit(1)` (only one input active),\n     and [`flatMap`](#flatmap) is `flatMapWithConcurrencyLimit ∞` (all inputs are piped to output).\n     */\n    flatMapWithConcurrencyLimit(limit, f) {\n        return flatMapWithConcurrencyLimit(this, limit, f);\n    }\n    /**\n     Groups stream events to new streams by `keyF`. Optional `limitF` can be provided to limit grouped\n     stream life. Stream transformed by `limitF` is passed on if provided. `limitF` gets grouped stream\n     and the original event causing the stream to start as parameters.\n  \n     Calculator for grouped consecutive values until group is cancelled:\n  \n     ```\n     var events = [\n     {id: 1, type: \"add\", val: 3 },\n     {id: 2, type: \"add\", val: -1 },\n     {id: 1, type: \"add\", val: 2 },\n     {id: 2, type: \"cancel\"},\n     {id: 3, type: \"add\", val: 2 },\n     {id: 3, type: \"cancel\"},\n     {id: 1, type: \"add\", val: 1 },\n     {id: 1, type: \"add\", val: 2 },\n     {id: 1, type: \"cancel\"}\n     ]\n  \n     function keyF(event) {\n    return event.id\n  }\n  \n     function limitF(groupedStream, groupStartingEvent) {\n    var cancel = groupedStream.filter(function(x) { return x.type === \"cancel\"}).take(1)\n    var adds = groupedStream.filter(function(x) { return x.type === \"add\" })\n    return adds.takeUntil(cancel).map(\".val\")\n  }\n  \n     Bacon.sequentially(2, events)\n     .groupBy(keyF, limitF)\n     .flatMap(function(groupedStream) {\n      return groupedStream.fold(0, function(acc, x) { return acc + x })\n    })\n     .onValue(function(sum) {\n      console.log(sum)\n      // returns [-1, 2, 8] in an order\n    })\n     ```\n  \n     */\n    groupBy(keyF, limitF) {\n        return groupBy(this, keyF, limitF);\n    }\n    /**\n     Maps values using given function, returning a new\n     stream/property. Instead of a function, you can also provide a [Property](property.html),\n     in which case each element in the source stream will be mapped to the current value of\n     the given property.\n     */\n    map(f) {\n        return map$1(this, f);\n    }\n    /** Returns a Property that inverts the value of this one (using the `!` operator). **/\n    not() {\n        return not(this);\n    }\n    /**\n     Combines properties with the `||` operator. It produces a new value when either of the Properties change,\n     combining the latest values using `||`.\n     */\n    or(other) {\n        return or(this, other);\n    }\n    /**\n     Creates an EventStream by sampling the\n     property value at given interval (in milliseconds)\n     */\n    sample(interval) {\n        return sampleP(this, interval);\n    }\n    /**\n    Adds an initial \"default\" value for the\n    Property. If the Property doesn't have an initial value of it's own, the\n    given value will be used as the initial value. If the property has an\n    initial value of its own, the given value will be ignored.\n     */\n    startWith(seed) {\n        return startWithP(this, seed);\n    }\n    /** @hidden */\n    subscribeInternal(sink = nullSink) {\n        return this.dispatcher.subscribe(sink);\n    }\n    /**\n     Creates an EventStream based on this Property. The stream contains also an event for the current\n     value of this Property at the time this method was called.\n     */\n    toEventStream(options) {\n        return new EventStream(new Desc(this, \"toEventStream\", []), (sink) => this.subscribeInternal(function (event) {\n            return sink(event.toNext());\n        }), undefined, options);\n    }\n    /**\n     Returns the Property itself.\n     */\n    toProperty() {\n        assertNoArguments(arguments);\n        return this;\n    }\n    transform(transformer, desc) {\n        return transformP(this, transformer, desc);\n    }\n    /**\n     Creates an EventStream/Property by sampling a given `samplee`\n     stream/property value at each event from the this stream/property.\n  \n     @param {Observable<V2>} samplee\n     @param f function to select/calculate the result value based on the value in the source stream and the samplee\n  \n     @typeparam V2  type of values in the samplee\n     @typeparam R   type of values in the result\n     */\n    withLatestFrom(samplee, f) {\n        return withLatestFromP(this, samplee, f);\n    }\n    /**\n     Lets you run a state machine\n     on an observable. Give it an initial state object and a state\n     transformation function that processes each incoming event and\n     returns an array containing the next state and an array of output\n     events. Here's an example where we calculate the total sum of all\n     numbers in the stream and output the value on stream end:\n  \n     ```js\n     Bacon.fromArray([1,2,3])\n     .withStateMachine(0, function(sum, event) {\n      if (event.hasValue)\n        return [sum + event.value, []]\n      else if (event.isEnd)\n        return [undefined, [new Bacon.Next(sum), event]]\n      else\n        return [sum, [event]]\n    })\n     ```\n     @param initState  initial state for the state machine\n     @param f          the function that defines the state machine\n     @typeparam  State   type of machine state\n     @typeparam  Out     type of values to be emitted\n     */\n    withStateMachine(initState, f) {\n        return withStateMachine(initState, f, this);\n    }\n}\n/** @hidden */\nfunction isProperty(x) {\n    return !!x._isProperty;\n}\n// allowSync option is used for overriding the \"force async\" behaviour or EventStreams.\n// ideally, this should not exist, but right now the implementation of some operations\n// relies on using internal EventStreams that have synchronous behavior. These are not exposed\n// to the outside world, though.\n/** @hidden */\nconst allowSync = { forceAsync: false };\n/**\n * EventStream represents a stream of events. It is an Observable object, meaning\n that you can listen to events in the stream using, for instance, the [`onValue`](#onvalue) method\n with a callback.\n\n To create an EventStream, you'll want to use one of the following factory methods:\n\n  - From DOM EventTarget or Node.JS EventEmitter objects using [fromEvent](../globals.html#fromevent)\n  - From a Promise using [fromPromise](../globals.html#frompromise)\n  - From an unary callback using [fromCallback](../globals.html#fromcallback)\n  - From a Node.js style callback using [fromNodeCallback](../globals.html#fromnodecallback)\n  - From RxJs or Kefir observables using [fromESObservable](../globals.html#fromesobservable)\n  - By polling a synchronous function using [fromPoll](../globals.html#fromPoll)\n  - Emit a single event instantly using [once](../globals.html#once)\n  - Emit a single event with a delay [later](../globals.html#later)\n  - Emit the same event indefinitely using [interval](../globals.html#interval)\n  - Emit an array of events instantly [fromArray](../globals.html#fromarray)\n  - Emit an array of events with a delay [sequentially](../globals.html#sequentially)\n  - Emit an array of events repeatedly with a delay [repeatedly](../globals.html#repeatedly)\n  - Use a generator function to be called repeatedly [repeat](../globals.html#repeat)\n  - Create a stream that never emits an event, ending immediately [never](../globals.html#never)\n  - Create a stream that never emits an event, ending with a delay [silence](../globals.html#silence)\n  - Create stream using a custom binder function [fromBinder](../globals.html#frombinder)\n  - Wrap jQuery events using [asEventStream](../globals.html#_)\n\n\n @typeparam V   Type of the elements/values in the stream/property\n\n */\nclass EventStream extends Observable {\n    constructor(desc, subscribe, handler, options) {\n        super(desc);\n        /** @hidden */\n        this._isEventStream = true;\n        if (options !== allowSync) {\n            subscribe = asyncWrapSubscribe(this, subscribe);\n        }\n        this.dispatcher = new Dispatcher(this, subscribe, handler);\n        registerObs(this);\n    }\n    /**\n     Buffers stream events with given delay.\n     The buffer is flushed at most once in the given interval. So, if your input\n     contains [1,2,3,4,5,6,7], then you might get two events containing [1,2,3,4]\n     and [5,6,7] respectively, given that the flush occurs between numbers 4 and 5.\n  \n     Also works with a given \"defer-function\" instead\n     of a delay. Here's a simple example, which is equivalent to\n     stream.bufferWithTime(10):\n  \n     ```js\n     stream.bufferWithTime(function(f) { setTimeout(f, 10) })\n     ```\n  \n     * @param delay buffer duration in milliseconds\n     */\n    bufferWithTime(delay) {\n        return bufferWithTime(this, delay);\n    }\n    /**\n     Buffers stream events with given count.\n     The buffer is flushed when it contains the given number of elements or the source stream ends.\n  \n     So, if you buffer a stream of `[1, 2, 3, 4, 5]` with count `2`, you'll get output\n     events with values `[1, 2]`, `[3, 4]` and `[5]`.\n  \n     * @param {number} count\n     */\n    bufferWithCount(count) {\n        return bufferWithCount(this, count);\n    }\n    /**\n     Buffers stream events and\n     flushes when either the buffer contains the given number elements or the\n     given amount of milliseconds has passed since last buffered event.\n  \n     * @param {number | DelayFunction} delay in milliseconds or as a function\n     * @param {number} count  maximum buffer size\n     */\n    bufferWithTimeOrCount(delay, count) {\n        return bufferWithTimeOrCount(this, delay, count);\n    }\n    changes() {\n        return this;\n    }\n    concat(other, options) {\n        return concatE(this, other, options);\n    }\n    /** @hidden */\n    transformChanges(desc, f) {\n        return f(this).withDesc(desc);\n    }\n    /**\n     For each element in the source stream, spawn a new\n     stream/property using the function `f`. Collect events from each of the spawned\n     streams into the result stream/property. Note that instead of a function, you can provide a\n     stream/property too. Also, the return value of function `f` can be either an\n     `Observable` (stream/property) or a constant value.\n  \n     `stream.flatMap()` can be used conveniently with [`Bacon.once()`](../globals.html#once) and [`Bacon.never()`](../globals.html#never)\n     for converting and filtering at the same time, including only some of the results.\n  \n     Example - converting strings to integers, skipping empty values:\n  \n     ```js\n     stream.flatMap(function(text) {\n      return (text != \"\") ? parseInt(text) : Bacon.never()\n  })\n     ```\n     */\n    flatMap(f) { return flatMap$1(this, f); }\n    /**\n     A [`flatMapWithConcurrencyLimit`](#flatmapwithconcurrencylimit) with limit of 1.\n     */\n    flatMapConcat(f) { return flatMapConcat(this, f); }\n    /**\n     Like [`flatMap`](#flatmap), but is applied only on [`Error`](error.html) events. Returned values go into the\n     value stream, unless an error event is returned. As an example, one type of error could result in a retry and another just\n     passed through, which can be implemented using flatMapError.\n     */\n    flatMapError(f) { return flatMapError(this, f); }\n    /**\n     Like [`flatMap`](#observable-flatmap), but only spawns a new\n     stream if the previously spawned stream has ended.\n     */\n    flatMapFirst(f) { return flatMapFirst(this, f); }\n    /**\n     Like [`flatMap`](#flatmap), but instead of including events from\n     all spawned streams, only includes them from the latest spawned stream.\n     You can think this as switching from stream to stream.\n     Note that instead of a function, you can provide a stream/property too.\n     */\n    flatMapLatest(f) { return flatMapLatest(this, f); }\n    /**\n     A super method of *flatMap* family. It limits the number of open spawned streams and buffers incoming events.\n     [`flatMapConcat`](#flatmapconcat) is `flatMapWithConcurrencyLimit(1)` (only one input active),\n     and [`flatMap`](#flatmap) is `flatMapWithConcurrencyLimit ∞` (all inputs are piped to output).\n     */\n    flatMapWithConcurrencyLimit(limit, f) { return flatMapWithConcurrencyLimit(this, limit, f); }\n    flatMapEvent(f) { return flatMapEvent(this, f); }\n    /**\n     Scans stream with given seed value and accumulator function, resulting to a Property.\n     Difference to [`scan`](#scan) is that the function `f` can return an [`EventStream`](eventstream.html) or a [`Property`](property.html) instead\n     of a pure value, meaning that you can use [`flatScan`](#flatscan) for asynchronous updates of state. It serializes\n     updates so that that the next update will be queued until the previous one has completed.\n  \n     * @param seed initial value to start with\n     * @param f transition function from previous state and new value to next state\n     * @typeparam V2 state and result type\n     */\n    flatScan(seed, f) {\n        return flatScan(this, seed, f);\n    }\n    /**\n     Groups stream events to new streams by `keyF`. Optional `limitF` can be provided to limit grouped\n     stream life. Stream transformed by `limitF` is passed on if provided. `limitF` gets grouped stream\n     and the original event causing the stream to start as parameters.\n  \n     Calculator for grouped consecutive values until group is cancelled:\n  \n     ```\n     var events = [\n     {id: 1, type: \"add\", val: 3 },\n     {id: 2, type: \"add\", val: -1 },\n     {id: 1, type: \"add\", val: 2 },\n     {id: 2, type: \"cancel\"},\n     {id: 3, type: \"add\", val: 2 },\n     {id: 3, type: \"cancel\"},\n     {id: 1, type: \"add\", val: 1 },\n     {id: 1, type: \"add\", val: 2 },\n     {id: 1, type: \"cancel\"}\n     ]\n  \n     function keyF(event) {\n    return event.id\n  }\n  \n     function limitF(groupedStream, groupStartingEvent) {\n    var cancel = groupedStream.filter(function(x) { return x.type === \"cancel\"}).take(1)\n    var adds = groupedStream.filter(function(x) { return x.type === \"add\" })\n    return adds.takeUntil(cancel).map(\".val\")\n  }\n  \n     Bacon.sequentially(2, events)\n     .groupBy(keyF, limitF)\n     .flatMap(function(groupedStream) {\n      return groupedStream.fold(0, function(acc, x) { return acc + x })\n    })\n     .onValue(function(sum) {\n      console.log(sum)\n      // returns [-1, 2, 8] in an order\n    })\n     ```\n  \n     */\n    groupBy(keyF, limitF) {\n        return groupBy(this, keyF, limitF);\n    }\n    /**\n   Maps values using given function, returning a new\n   stream/property. Instead of a function, you can also provide a [Property](property.html),\n   in which case each element in the source stream will be mapped to the current value of\n   the given property.\n   */\n    map(f) {\n        return map$1(this, f);\n    }\n    merge(other) {\n        assertEventStream(other);\n        return mergeAll(this, other).withDesc(new Desc(this, \"merge\", [other]));\n    }\n    /**\n     Returns a stream/property that inverts boolean values (using `!`)\n     */\n    not() { return not(this); }\n    /**\n     Adds a starting value to the stream/property, i.e. concats a\n     single-element stream containing the single seed value  with this stream.\n     */\n    // TODO: should allow V|V2 signature\n    startWith(seed) {\n        return startWithE(this, seed);\n    }\n    /** @hidden */\n    subscribeInternal(sink = nullSink) {\n        return this.dispatcher.subscribe(sink);\n    }\n    /**\n     * Returns this stream.\n     */\n    toEventStream() { return this; }\n    /**\n     Creates a Property based on the\n     EventStream.\n  \n     Without arguments, you'll get a Property without an initial value.\n     The Property will get its first actual value from the stream, and after that it'll\n     always have a current value.\n  \n     You can also give an initial value that will be used as the current value until\n     the first value comes from the stream.\n     */\n    toProperty(initValue) {\n        let usedInitValue = arguments.length\n            ? toOption(initValue)\n            : none();\n        let disp = this.dispatcher;\n        let desc = new Desc(this, \"toProperty\", Array.prototype.slice.apply(arguments));\n        let streamSubscribe = disp.subscribe;\n        return new Property(desc, streamSubscribeToPropertySubscribe(usedInitValue, streamSubscribe));\n    }\n    transform(transformer, desc) {\n        return transformE(this, transformer, desc);\n    }\n    /**\n     Creates an EventStream/Property by sampling a given `samplee`\n     stream/property value at each event from the this stream/property.\n  \n     @param {Observable<V2>} samplee\n     @param f function to select/calculate the result value based on the value in the source stream and the samplee\n  \n     @typeparam V2  type of values in the samplee\n     @typeparam R   type of values in the result\n     */\n    withLatestFrom(samplee, f) {\n        return withLatestFromE(this, samplee, f);\n    }\n    /**\n     Lets you run a state machine\n     on an observable. Give it an initial state object and a state\n     transformation function that processes each incoming event and\n     returns an array containing the next state and an array of output\n     events. Here's an example where we calculate the total sum of all\n     numbers in the stream and output the value on stream end:\n  \n     ```js\n     Bacon.fromArray([1,2,3])\n     .withStateMachine(0, function(sum, event) {\n      if (event.hasValue)\n        return [sum + event.value, []]\n      else if (event.isEnd)\n        return [undefined, [new Bacon.Next(sum), event]]\n      else\n        return [sum, [event]]\n    })\n     ```\n     @param initState  initial state for the state machine\n     @param f          the function that defines the state machine\n     @typeparam  State   type of machine state\n     @typeparam  Out     type of values to be emitted\n     */\n    withStateMachine(initState, f) {\n        return withStateMachine(initState, f, this);\n    }\n}\n/** @hidden */\nfunction newEventStream(description, subscribe) {\n    return new EventStream(description, subscribe);\n}\n/** @hidden */\nfunction newEventStreamAllowSync(description, subscribe) {\n    return new EventStream(description, subscribe, undefined, allowSync);\n}\n\nfunction symbol(key) {\n    if (typeof Symbol !== \"undefined\" && Symbol[key]) {\n        return Symbol[key];\n    }\n    else if (typeof Symbol !== \"undefined\" && typeof Symbol.for === \"function\") {\n        return Symbol[key] = Symbol.for(key);\n    }\n    else {\n        return \"@@\" + key;\n    }\n}\n\nclass ESObservable {\n    constructor(observable) {\n        this.observable = observable;\n    }\n    subscribe(observerOrOnNext, onError, onComplete) {\n        const observer = typeof observerOrOnNext === 'function'\n            ? { next: observerOrOnNext, error: onError, complete: onComplete }\n            : observerOrOnNext;\n        const subscription = {\n            closed: false,\n            unsubscribe: function () {\n                subscription.closed = true;\n                cancel();\n            }\n        };\n        const cancel = this.observable.subscribe(function (event) {\n            if (hasValue(event) && observer.next) {\n                observer.next(event.value);\n            }\n            else if (isError(event)) {\n                if (observer.error)\n                    observer.error(event.error);\n                subscription.unsubscribe();\n            }\n            else if (event.isEnd) {\n                subscription.closed = true;\n                if (observer.complete)\n                    observer.complete();\n            }\n        });\n        return subscription;\n    }\n}\nESObservable.prototype[symbol('observable')] = function () {\n    return this;\n};\nObservable.prototype.toESObservable = function () {\n    return new ESObservable(this);\n};\nObservable.prototype[symbol('observable')] = Observable.prototype.toESObservable;\n\n/**\n Creates a Property from an initial value and updates the value based on multiple inputs.\n The inputs are defined similarly to [`Bacon.when`](#bacon-when), like this:\n\n ```js\n var result = Bacon.update(\n initial,\n [x,y,z, (previous,x,y,z) => { ... }],\n [x,y,   (previous,x,y) => { ... }])\n ```\n\n As input, each function above will get the previous value of the `result` Property, along with values from the listed Observables.\n The value returned by the function will be used as the next value of `result`.\n\n Just like in [`Bacon.when`](#when), only EventStreams will trigger an update, while Properties will be just sampled.\n So, if you list a single EventStream and several Properties, the value will be updated only when an event occurs in the EventStream.\n\n Here's a simple gaming example:\n\n ```js\n let scoreMultiplier = Bacon.constant(1)\n let hitUfo = Bacon.interval(1000)\n let hitMotherShip = Bacon.later(10000)\n let score = Bacon.update(\n 0,\n [hitUfo, scoreMultiplier, (score, _, multiplier) => score + 100 * multiplier ],\n [hitMotherShip, (score, _) => score + 2000 ]\n )\n ```\n\n In the example, the `score` property is updated when either `hitUfo` or `hitMotherShip` occur. The `scoreMultiplier` Property is sampled to take multiplier into account when `hitUfo` occurs.\n\n * @param initial\n * @param {UpdatePattern<Out>} patterns\n * @returns {Property<Out>}\n */\nfunction update(initial, ...patterns) {\n    let rawPatterns = extractRawPatterns(patterns);\n    for (var i = 0; i < rawPatterns.length; i++) {\n        let pattern = rawPatterns[i];\n        pattern[1] = lateBindFirst(pattern[1]);\n    }\n    return when(...rawPatterns).scan(initial, (function (x, f) {\n        return f(x);\n    })).withDesc(new Desc(\"Bacon\", \"update\", [initial, ...patterns]));\n}\nfunction lateBindFirst(f) {\n    return function (...args) {\n        return function (i) {\n            return f(...[i].concat(args));\n        };\n    };\n}\n\n/**\n Creates an EventStream that delivers the given\n series of values (given as array) to the first subscriber. The stream ends after these\n values have been delivered. You can also send [`Bacon.Error`](classes/error.html) events, or\n any combination of pure values and error events like this:\n `Bacon.fromArray([1, new Bacon.Error()])\n\n @param   values    Array of values or events to repeat\n @typeparam V Type of stream elements\n */\nfunction fromArray(values) {\n    assertArray(values);\n    if (!values.length) {\n        return never().withDesc(new Desc(\"Bacon\", \"fromArray\", values));\n    }\n    else {\n        var i = 0;\n        var stream = new EventStream(new Desc(\"Bacon\", \"fromArray\", [values]), function (sink) {\n            var unsubd = false;\n            var reply = more;\n            var pushing = false;\n            var pushNeeded = false;\n            function push() {\n                pushNeeded = true;\n                if (pushing) {\n                    return;\n                }\n                if (i === values.length) {\n                    sink(endEvent());\n                    return false;\n                }\n                pushing = true;\n                while (pushNeeded) {\n                    pushNeeded = false;\n                    if ((reply !== noMore) && !unsubd) {\n                        var value = values[i++];\n                        reply = sink(toEvent(value));\n                        if (reply !== noMore) {\n                            if (i === values.length) {\n                                sink(endEvent());\n                            }\n                            else {\n                                UpdateBarrier.afterTransaction(stream, push);\n                            }\n                        }\n                    }\n                }\n                pushing = false;\n                return pushing;\n            }\n            UpdateBarrier.soonButNotYet(stream, push);\n            return function () {\n                unsubd = true;\n                return unsubd;\n            };\n        });\n        return stream;\n    }\n}\n\nfunction isEventSourceFn(x) {\n    return _.isFunction(x);\n}\n// Wrap DOM EventTarget, Node EventEmitter, or\n// [un]bind: (Any, (Any) -> None) -> None interfaces\n// common in MVCs as EventStream\n//\n// target - EventTarget or EventEmitter, source of events\n// eventSource - event name to bind or a function that performs custom binding\n// eventTransformer - defaults to returning the first argument to handler\n//\n// Example 1:\n//\n//   Bacon.fromEventTarget(document.body, \"click\")\n//   # => EventStream\n//\n//   Bacon.fromEventTarget(document.body, \"scroll\", {passive: true})\n//   # => EventStream\n//\n//   Bacon.fromEventTarget (new EventEmitter(), \"data\")\n//   # => EventStream\n//\n// Returns EventStream\n/** @hidden */\nvar eventMethods = [\n    [\"addEventListener\", \"removeEventListener\"],\n    [\"addListener\", \"removeListener\"],\n    [\"on\", \"off\"],\n    [\"bind\", \"unbind\"]\n];\nvar findHandlerMethods = function (target) {\n    var pair;\n    for (var i = 0; i < eventMethods.length; i++) {\n        pair = eventMethods[i];\n        var methodPair = [target[pair[0]], target[pair[1]]];\n        if (methodPair[0] && methodPair[1]) {\n            return methodPair;\n        }\n    }\n    for (var j = 0; j < eventMethods.length; j++) {\n        pair = eventMethods[j];\n        var addListener = target[pair[0]];\n        if (addListener) {\n            return [addListener, function () { }];\n        }\n    }\n    throw new Error(\"No suitable event methods in \" + target);\n};\n/**\n creates an EventStream from events\n on a DOM EventTarget or Node.JS EventEmitter object, or an object that supports event listeners using `on`/`off` methods.\n You can also pass an optional function that transforms the emitted\n events' parameters.\n\n The simple form:\n\n ```js\n Bacon.fromEvent(document.body, \"click\").onValue(function() { alert(\"Bacon!\") })\n ```\n\n Using a binder function:\n\n ```js\n Bacon.fromEvent(\n window,\n function(binder, listener) {\n    binder(\"scroll\", listener, {passive: true})\n  }\n ).onValue(function() {\n  console.log(window.scrollY)\n})\n ```\n\n @param target\n @param eventSource\n @param eventTransformer\n @typeparam V Type of stream elements\n\n */\nfunction fromEvent(target, eventSource, eventTransformer) {\n    var [sub, unsub] = findHandlerMethods(target);\n    var desc = new Desc(\"Bacon\", \"fromEvent\", [target, eventSource]);\n    return fromBinder(function (handler) {\n        if (isEventSourceFn(eventSource)) {\n            eventSource(sub.bind(target), handler);\n            return function () {\n                return eventSource(unsub.bind(target), handler);\n            };\n        }\n        else {\n            sub.call(target, eventSource, handler);\n            return function () {\n                return unsub.call(target, eventSource, handler);\n            };\n        }\n    }, eventTransformer).withDesc(desc);\n}\n\n/**\n A shorthand for combining multiple\n sources (streams, properties, constants) as array and assigning the\n side-effect function f for the values. The following example would log\n the number 3.\n\n ```js\n function f(a, b) { console.log(a + b) }\n Bacon.onValues(Bacon.constant(1), Bacon.constant(2), f)\n ```\n */\nfunction onValues(...args) {\n    return combineAsArray(args.slice(0, args.length - 1)).onValues(args[arguments.length - 1]);\n}\n\n/**\n Calls generator function which is expected to return an observable. The returned EventStream contains\n values and errors from the spawned observable. When the spawned observable ends, the generator is called\n again to spawn a new observable.\n\n This is repeated until the generator returns a falsy value\n (such as `undefined` or `false`).\n\n The generator function is called with one argument — iteration number starting from `0`.\n\n Here's an example:\n\n```js\nBacon.repeat(function(i) {\nif (i < 3) {\n  return Bacon.once(i);\n} else {\n  return false;\n}\n}).log()\n```\n\n The example will produce values 0, 1 and 2.\n\n @param {(number) => (Observable<V> | null)} generator\n @returns {EventStream<V>}\n @typeparam V Type of stream elements\n\n */\nfunction repeat(generator) {\n    var index = 0;\n    return fromBinder(function (sink) {\n        var flag = false;\n        var reply = more;\n        var unsub = function () { };\n        function handleEvent(event) {\n            if (event.isEnd) {\n                if (!flag) {\n                    flag = true;\n                }\n                else {\n                    subscribeNext();\n                }\n                return more;\n            }\n            else {\n                return reply = sink(event);\n            }\n        }\n        function subscribeNext() {\n            var next;\n            flag = true;\n            while (flag && reply !== noMore) {\n                next = generator(index++);\n                flag = false;\n                if (next) {\n                    unsub = next.subscribeInternal(handleEvent);\n                }\n                else {\n                    sink(endEvent());\n                }\n            }\n            flag = true;\n        }\n        subscribeNext();\n        return () => unsub();\n    }).withDesc(new Desc(\"Bacon\", \"repeat\", [generator]));\n}\n\n/**\n Repeats given elements indefinitely\n with given interval in milliseconds. For example, `repeatedly(10, [1,2,3])`\n would lead to `1,2,3,1,2,3...` to be repeated indefinitely.\n\n @param delay between values, in milliseconds\n @param values array of values to repeat\n @typeparam V Type of stream elements\n\n */\nfunction repeatedly(delay, values) {\n    var index = 0;\n    return fromPoll(delay, function () {\n        return values[index++ % values.length];\n    }).withDesc(new Desc(\"Bacon\", \"repeatedly\", [delay, values]));\n}\n\n/**\n Creates a stream that ends after given amount of milliseconds, without emitting any values.\n\n @param duration duration of silence in milliseconds\n @typeparam V Type of stream elements\n */\nfunction silence(duration) {\n    return later(duration, \"\")\n        .filter(false)\n        .withDesc(new Desc(\"Bacon\", \"silence\", [duration]));\n}\n\n/**\n Used to retry the call when there is an [`Error`](classes/error.html) event in the stream produced by the `source` function.\n\n ```js\n var triggeringStream, ajaxCall // <- ajaxCall gives Errors on network or server errors\n ajaxResult = triggeringStream.flatMap(function(url) {\n    return Bacon.retry({\n        source: function(attemptNumber) { return ajaxCall(url) },\n        retries: 5,\n        isRetryable: function (error) { return error.httpStatusCode !== 404; },\n        delay: function(context) { return 100; } // Just use the same delay always\n    })\n})\n ```\n * @param options (click for details)\n */\nfunction retry(options) {\n    if (!_.isFunction(options.source)) {\n        throw new Error(\"'source' option has to be a function\");\n    }\n    var source = options.source;\n    var retries = options.retries || 0;\n    var retriesDone = 0;\n    var delay = options.delay || function () {\n        return 0;\n    };\n    var isRetryable = options.isRetryable || function () {\n        return true;\n    };\n    var finished = false;\n    var errorEvent = null;\n    return repeat(function (count) {\n        function valueStream() {\n            return source(count).endOnError().transform(function (event, sink) {\n                if (isError(event)) {\n                    errorEvent = event;\n                    if (!(isRetryable(errorEvent.error) && (retries === 0 || retriesDone < retries))) {\n                        finished = true;\n                        return sink(event);\n                    }\n                    else {\n                        return more;\n                    }\n                }\n                else {\n                    if (hasValue(event)) {\n                        errorEvent = null;\n                        finished = true;\n                    }\n                    return sink(event);\n                }\n            });\n        }\n        if (finished) {\n            return undefined;\n        }\n        else if (errorEvent) {\n            var context = {\n                error: errorEvent.error,\n                retriesDone\n            };\n            var pause = silence(delay(context));\n            retriesDone++;\n            return pause.concat(once(null).flatMap(valueStream));\n        }\n        else {\n            return valueStream();\n        }\n    }).withDesc(new Desc(\"Bacon\", \"retry\", [options]));\n}\n\n/**\n Creates a stream containing given\n values (given as array). Delivered with given interval in milliseconds.\n\n @param delay between elements, in milliseconds\n @param array of values or events\n @typeparam V Type of stream elements\n\n */\nfunction sequentially(delay, values) {\n    var index = 0;\n    return fromPoll(delay, function () {\n        var value = values[index++];\n        if (index < values.length) {\n            return value;\n        }\n        else if (index === values.length) {\n            return [toEvent(value), endEvent()];\n        }\n        else {\n            return endEvent();\n        }\n    }).withDesc(new Desc(\"Bacon\", \"sequentially\", [delay, values]));\n}\n\nfunction valueAndEnd(value) {\n    return [toEvent(value), endEvent()];\n}\n/**\n * Creates an EventStream from a Promise object such as JQuery Ajax.\n This stream will contain a single value or an error, followed immediately by stream end.\n You can use the optional abort flag (i.e. ´fromPromise(p, true)´ to have the `abort` method of the given promise be called when all subscribers have been removed from the created stream.\n You can also pass an optional function that transforms the promise value into Events. The default is to transform the value into `[new Bacon.Next(value), new Bacon.End()]`.\n Check out this [example](https://github.com/raimohanska/baconjs-examples/blob/master/resources/public/index.html).\n\n *\n * @param {Promise<V>} source promise object\n * @param abort should we call the `abort` method of the Promise on unsubscribe. This is a nonstandard feature you should probably ignore.\n * @param {EventTransformer<V>} eventTransformer\n * @returns {EventStream<V>}\n */\nfunction fromPromise(promise, abort, eventTransformer = valueAndEnd) {\n    return fromBinder(function (handler) {\n        const bound = promise.then(handler, (e) => handler(new Error$1(e)));\n        if (bound && typeof bound.done === \"function\") {\n            bound.done();\n        }\n        if (abort) {\n            return function () {\n                if (typeof promise.abort === \"function\") {\n                    return promise.abort();\n                }\n            };\n        }\n        else {\n            return function () {\n            };\n        }\n    }, eventTransformer).withDesc(new Desc(\"Bacon\", \"fromPromise\", [promise]));\n}\n\nfunction withMethodCallSupport(wrapped) {\n    return function (f, ...args) {\n        if (typeof f === \"object\" && args.length) {\n            var context = f;\n            var methodName = args[0];\n            f = function (...args) {\n                return context[methodName](...args);\n            };\n            args = args.slice(1);\n        }\n        return wrapped(f, ...args);\n    };\n}\nfunction partiallyApplied(f, applied) {\n    return function (...args) { return f(...(applied.concat(args))); };\n}\nconst makeFunction_ = withMethodCallSupport(function (f, ...args) {\n    if (_.isFunction(f)) {\n        if (args.length) {\n            return partiallyApplied(f, args);\n        }\n        else {\n            return f;\n        }\n    }\n    else {\n        return _.always(f);\n    }\n});\n/** @hidden */\nfunction makeFunction(f, args) {\n    return makeFunction_(f, ...args);\n}\n\n// TODO: types/doc for the object, fnname variant\n/**\n Creates an EventStream from a function that\n accepts a callback. The function is supposed to call its callback just\n once. For example:\n\n ```js\n Bacon.fromCallback(callback => callback(\"bacon\"))\n ```\n\n This would create a stream that outputs a single value \"Bacon!\" and ends\n after that. The use of setTimeout causes the value to be delayed by 1\n second.\n\n You can also give any number of arguments to [`fromCallback`](#bacon-fromcallback), which will be\n passed to the function. These arguments can be simple variables, Bacon\n EventStreams or Properties. For example the following will output \"Bacon rules\":\n\n ```js\n bacon = Bacon.constant('bacon')\n Bacon.fromCallback(function(a, b, callback) {\n  callback(a + ' ' + b);\n}, bacon, 'rules').log();\n ```\n\n * @param f\n * @param args\n * @returns {EventStream<V>}\n */\nfunction fromCallback(f, ...args) {\n    return fromBinder(function (handler) {\n        makeFunction(f, args)(handler);\n        return nop;\n    }, function (value) {\n        return [value, endEvent()];\n    }).withDesc(new Desc(\"Bacon\", \"fromCallback\", [f, ...args]));\n}\n/**\nBehaves the same way as `Bacon.fromCallback`,\nexcept that it expects the callback to be called in the Node.js convention:\n`callback(error, data)`, where error is null if everything is fine. For example:\n\n```js\nvar Bacon = require('baconjs').Bacon,\nfs = require('fs');\nvar read = Bacon.fromNodeCallback(fs.readFile, 'input.txt');\nread.onError(function(error) { console.log(\"Reading failed: \" + error); });\nread.onValue(function(value) { console.log(\"Read contents: \" + value); });\n```\n\n */\nfunction fromNodeCallback(f, ...args) {\n    return fromBinder(function (handler) {\n        makeFunction(f, args)(handler);\n        return nop;\n    }, function (error, value) {\n        if (error) {\n            return [new Error$1(error), endEvent()];\n        }\n        return [value, endEvent()];\n    }).withDesc(new Desc(\"Bacon\", \"fromNodeCallback\", [f, ...args]));\n}\n\n/**\n * Creates an EventStream from an\n [ES Observable](https://github.com/tc39/proposal-observable). Input can be any\n ES Observable implementation including RxJS and Kefir.\n */\nfunction fromESObservable(_observable) {\n    var observable;\n    if (_observable[symbol(\"observable\")]) {\n        observable = _observable[symbol(\"observable\")]();\n    }\n    else {\n        observable = _observable;\n    }\n    var desc = new Desc(\"Bacon\", \"fromESObservable\", [observable]);\n    return new EventStream(desc, function (sink) {\n        var cancel = observable.subscribe({\n            error: function (x) {\n                sink(new Error$1(x));\n                sink(new End());\n            },\n            next: function (value) { sink(new Next(value)); },\n            complete: function () {\n                sink(new End());\n            }\n        });\n        // Support RxJS Observables\n        if (cancel.unsubscribe) {\n            return function () { cancel.unsubscribe(); };\n        }\n        else {\n            return cancel;\n        }\n    });\n}\n\n/**\n An [`EventStream`](eventstream.html) that allows you to [`push`](#push) values into the stream.\n\n It also allows plugging other streams into the Bus, as inputs. The Bus practically\n merges all plugged-in streams and the values pushed using the [`push`](#push)\n method.\n */\nclass Bus extends EventStream {\n    constructor() {\n        super(new Desc(\"Bacon\", \"Bus\", []), (sink) => this.subscribeAll(sink));\n        /** @hidden */\n        this.pushing = false;\n        /** @hidden */\n        this.pushQueue = undefined;\n        /** @hidden */\n        this.ended = false;\n        /** @hidden */\n        this.subscriptions = [];\n        this.unsubAll = _.bind(this.unsubAll, this);\n        this.push = _.bind(this.push, this);\n        this.subscriptions = []; // new array for each Bus instance\n        this.ended = false;\n    }\n    /**\n     Plugs the given stream as an input to the Bus. All events from\n     the given stream will be delivered to the subscribers of the Bus.\n     Returns a function that can be used to unplug the same stream.\n  \n     The plug method practically allows you to merge in other streams after\n     the creation of the Bus.\n  \n     * @returns a function that can be called to \"unplug\" the source from Bus.\n     */\n    plug(input) {\n        assertObservable(input);\n        if (this.ended) {\n            return;\n        }\n        var sub = { input: input, unsub: undefined };\n        this.subscriptions.push(sub);\n        if (typeof this.sink !== \"undefined\") {\n            this.subscribeInput(sub);\n        }\n        return (() => this.unsubscribeInput(input));\n    }\n    /**\n     Ends the stream. Sends an [End](end.html) event to all subscribers.\n     After this call, there'll be no more events to the subscribers.\n     Also, the [`push`](#push), [`error`](#error) and [`plug`](#plug) methods have no effect.\n     */\n    end() {\n        this.ended = true;\n        this.unsubAll();\n        if (typeof this.sink === \"function\") {\n            return this.sink(endEvent());\n        }\n    }\n    /**\n     * Pushes a new value to the stream.\n     */\n    push(value) {\n        if (!this.ended && typeof this.sink === \"function\") {\n            var rootPush = !this.pushing;\n            if (!rootPush) {\n                //console.log(\"recursive push\")\n                if (!this.pushQueue)\n                    this.pushQueue = [];\n                this.pushQueue.push(value);\n                //console.log('queued', value)\n                return;\n            }\n            this.pushing = true;\n            try {\n                return this.sink(nextEvent(value));\n            }\n            finally {\n                if (rootPush && this.pushQueue) {\n                    //console.log(\"start processing queue\", this.pushQueue.length)\n                    var i = 0;\n                    while (i < this.pushQueue.length) {\n                        //console.log(\"in loop\", i, this.pushQueue[i])\n                        var v = this.pushQueue[i];\n                        this.sink(nextEvent(v));\n                        i++;\n                    }\n                    this.pushQueue = undefined;\n                }\n                this.pushing = false;\n            }\n        }\n    }\n    /**\n     * Pushes an error to this stream.\n     */\n    error(error) {\n        if (typeof this.sink === \"function\") {\n            return this.sink(new Error$1(error));\n        }\n    }\n    /** @hidden */\n    unsubAll() {\n        var iterable = this.subscriptions;\n        for (var i = 0, sub; i < iterable.length; i++) {\n            sub = iterable[i];\n            if (typeof sub.unsub === \"function\") {\n                sub.unsub();\n            }\n        }\n    }\n    /** @hidden */\n    subscribeAll(newSink) {\n        if (this.ended) {\n            newSink(endEvent());\n        }\n        else {\n            this.sink = newSink;\n            var iterable = this.subscriptions.slice();\n            for (var i = 0, subscription; i < iterable.length; i++) {\n                subscription = iterable[i];\n                this.subscribeInput(subscription);\n            }\n        }\n        return this.unsubAll;\n    }\n    /** @hidden */\n    guardedSink(input) {\n        return (event) => {\n            if (event.isEnd) {\n                this.unsubscribeInput(input);\n                return noMore;\n            }\n            else if (this.sink) {\n                return this.sink(event);\n            }\n            else {\n                return more;\n            }\n        };\n    }\n    /** @hidden */\n    subscribeInput(subscription) {\n        subscription.unsub = subscription.input.subscribeInternal(this.guardedSink(subscription.input));\n        return subscription.unsub;\n    }\n    /** @hidden */\n    unsubscribeInput(input) {\n        var iterable = this.subscriptions;\n        for (var i = 0, sub; i < iterable.length; i++) {\n            sub = iterable[i];\n            if (sub.input === input) {\n                if (typeof sub.unsub === \"function\") {\n                    sub.unsub();\n                }\n                this.subscriptions.splice(i, 1);\n                return;\n            }\n        }\n    }\n}\n\n/**\n `Bacon.try` is a helper for creating an EventStream of a single value, or a single Error event in case the given\n function throws an exception.\n\nFor example, you can use `Bacon.try` to handle JSON parse errors:\n\n```js\nvar jsonStream = Bacon\n  .once('{\"this is invalid json\"')\n  .flatMap(Bacon.try(JSON.parse))\n\njsonStream.onError(function(err) {\n  console.error(\"Failed to parse JSON\", err)\n})\n\n */\nfunction tryF(f) {\n    return function (value) {\n        try {\n            return once(f(value));\n        }\n        catch (e) {\n            return once(new Error$1(e));\n        }\n    };\n}\n\n/**\n * JQuery/Zepto integration support\n */\nconst $ = {\n    /**\n     Creates an EventStream from events on a\n     jQuery or Zepto.js object. You can pass optional arguments to add a\n     jQuery live selector and/or a function that processes the jQuery\n     event and its parameters, if given, like this:\n  \n     ```js\n     $(\"#my-div\").asEventStream(\"click\", \".more-specific-selector\")\n     $(\"#my-div\").asEventStream(\"click\", \".more-specific-selector\", function(event, args) { return args[0] })\n     $(\"#my-div\").asEventStream(\"click\", function(event, args) { return args[0] })\n     ```\n  \n     Note: you need to install the `asEventStream` method on JQuery by calling\n     [init()](#_.aseventstream) as in `Bacon.$.init($)`.\n     */\n    asEventStream(eventName, selector, eventTransformer) {\n        if (_.isFunction(selector)) {\n            eventTransformer = selector;\n            selector = undefined;\n        }\n        return fromBinder((handler) => {\n            this.on(eventName, selector, handler);\n            return (() => this.off(eventName, selector, handler));\n        }, eventTransformer).withDesc(new Desc(this.selector || this, \"asEventStream\", [eventName]));\n    },\n    /**\n     * Installs the [asEventStream](#_.aseventstream) to the given jQuery/Zepto object (the `$` object).\n     */\n    init(jQuery) {\n        jQuery.fn.asEventStream = $.asEventStream;\n    }\n};\n\n/**\n *  Bacon.js version as string\n */\nconst version = '3.0.22';\n\nexport { $, Bus, CompositeUnsubscribe, Desc, End, Error$1 as Error, Event, EventStream, Initial, Next, Observable, Property, Value, _, combine, combineAsArray, combineTemplate, combineTwo, combineWith, concatAll, constant, fromArray, fromBinder, fromCallback, fromESObservable, fromEvent, fromEvent as fromEventTarget, fromNodeCallback, fromPoll, fromPromise, getScheduler, groupSimultaneous, hasValue, interval, isEnd, isError, isEvent, isInitial, isNext, isProperty, later, mergeAll, more, never, noMore, nullSink, nullVoidSink, onValues, once, repeat, repeatedly, retry, sequentially, setScheduler, silence, spy, tryF as try, update, version, when, zipAsArray, zipWith };\n","function none() {}\n\nexport default function(selector) {\n  return selector == null ? none : function() {\n    return this.querySelector(selector);\n  };\n}\n","function empty() {\n  return [];\n}\n\nexport default function(selector) {\n  return selector == null ? empty : function() {\n    return this.querySelectorAll(selector);\n  };\n}\n","export default function(selector) {\n  return function() {\n    return this.matches(selector);\n  };\n}\n","export default function(update) {\n  return new Array(update.length);\n}\n","import sparse from \"./sparse\";\nimport {Selection} from \"./index\";\n\nexport default function() {\n  return new Selection(this._enter || this._groups.map(sparse), this._parents);\n}\n\nexport function EnterNode(parent, datum) {\n  this.ownerDocument = parent.ownerDocument;\n  this.namespaceURI = parent.namespaceURI;\n  this._next = null;\n  this._parent = parent;\n  this.__data__ = datum;\n}\n\nEnterNode.prototype = {\n  constructor: EnterNode,\n  appendChild: function(child) { return this._parent.insertBefore(child, this._next); },\n  insertBefore: function(child, next) { return this._parent.insertBefore(child, next); },\n  querySelector: function(selector) { return this._parent.querySelector(selector); },\n  querySelectorAll: function(selector) { return this._parent.querySelectorAll(selector); }\n};\n","import {Selection} from \"./index\";\nimport {EnterNode} from \"./enter\";\nimport constant from \"../constant\";\n\nvar keyPrefix = \"$\"; // Protect against keys like “__proto__”.\n\nfunction bindIndex(parent, group, enter, update, exit, data) {\n  var i = 0,\n      node,\n      groupLength = group.length,\n      dataLength = data.length;\n\n  // Put any non-null nodes that fit into update.\n  // Put any null nodes into enter.\n  // Put any remaining data into enter.\n  for (; i < dataLength; ++i) {\n    if (node = group[i]) {\n      node.__data__ = data[i];\n      update[i] = node;\n    } else {\n      enter[i] = new EnterNode(parent, data[i]);\n    }\n  }\n\n  // Put any non-null nodes that don’t fit into exit.\n  for (; i < groupLength; ++i) {\n    if (node = group[i]) {\n      exit[i] = node;\n    }\n  }\n}\n\nfunction bindKey(parent, group, enter, update, exit, data, key) {\n  var i,\n      node,\n      nodeByKeyValue = {},\n      groupLength = group.length,\n      dataLength = data.length,\n      keyValues = new Array(groupLength),\n      keyValue;\n\n  // Compute the key for each node.\n  // If multiple nodes have the same key, the duplicates are added to exit.\n  for (i = 0; i < groupLength; ++i) {\n    if (node = group[i]) {\n      keyValues[i] = keyValue = keyPrefix + key.call(node, node.__data__, i, group);\n      if (keyValue in nodeByKeyValue) {\n        exit[i] = node;\n      } else {\n        nodeByKeyValue[keyValue] = node;\n      }\n    }\n  }\n\n  // Compute the key for each datum.\n  // If there a node associated with this key, join and add it to update.\n  // If there is not (or the key is a duplicate), add it to enter.\n  for (i = 0; i < dataLength; ++i) {\n    keyValue = keyPrefix + key.call(parent, data[i], i, data);\n    if (node = nodeByKeyValue[keyValue]) {\n      update[i] = node;\n      node.__data__ = data[i];\n      nodeByKeyValue[keyValue] = null;\n    } else {\n      enter[i] = new EnterNode(parent, data[i]);\n    }\n  }\n\n  // Add any remaining nodes that were not bound to data to exit.\n  for (i = 0; i < groupLength; ++i) {\n    if ((node = group[i]) && (nodeByKeyValue[keyValues[i]] === node)) {\n      exit[i] = node;\n    }\n  }\n}\n\nexport default function(value, key) {\n  if (!value) {\n    data = new Array(this.size()), j = -1;\n    this.each(function(d) { data[++j] = d; });\n    return data;\n  }\n\n  var bind = key ? bindKey : bindIndex,\n      parents = this._parents,\n      groups = this._groups;\n\n  if (typeof value !== \"function\") value = constant(value);\n\n  for (var m = groups.length, update = new Array(m), enter = new Array(m), exit = new Array(m), j = 0; j < m; ++j) {\n    var parent = parents[j],\n        group = groups[j],\n        groupLength = group.length,\n        data = value.call(parent, parent && parent.__data__, j, parents),\n        dataLength = data.length,\n        enterGroup = enter[j] = new Array(dataLength),\n        updateGroup = update[j] = new Array(dataLength),\n        exitGroup = exit[j] = new Array(groupLength);\n\n    bind(parent, group, enterGroup, updateGroup, exitGroup, data, key);\n\n    // Now connect the enter nodes to their following update node, such that\n    // appendChild can insert the materialized enter node before this node,\n    // rather than at the end of the parent node.\n    for (var i0 = 0, i1 = 0, previous, next; i0 < dataLength; ++i0) {\n      if (previous = enterGroup[i0]) {\n        if (i0 >= i1) i1 = i0 + 1;\n        while (!(next = updateGroup[i1]) && ++i1 < dataLength);\n        previous._next = next || null;\n      }\n    }\n  }\n\n  update = new Selection(update, parents);\n  update._enter = enter;\n  update._exit = exit;\n  return update;\n}\n","import {Selection} from \"./index\";\n\nexport default function(compare) {\n  if (!compare) compare = ascending;\n\n  function compareNode(a, b) {\n    return a && b ? compare(a.__data__, b.__data__) : !a - !b;\n  }\n\n  for (var groups = this._groups, m = groups.length, sortgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, sortgroup = sortgroups[j] = new Array(n), node, i = 0; i < n; ++i) {\n      if (node = group[i]) {\n        sortgroup[i] = node;\n      }\n    }\n    sortgroup.sort(compareNode);\n  }\n\n  return new Selection(sortgroups, this._parents).order();\n}\n\nfunction ascending(a, b) {\n  return a < b ? -1 : a > b ? 1 : a >= b ? 0 : NaN;\n}\n","export var xhtml = \"http://www.w3.org/1999/xhtml\";\n\nexport default {\n  svg: \"http://www.w3.org/2000/svg\",\n  xhtml: xhtml,\n  xlink: \"http://www.w3.org/1999/xlink\",\n  xml: \"http://www.w3.org/XML/1998/namespace\",\n  xmlns: \"http://www.w3.org/2000/xmlns/\"\n};\n","import namespaces from \"./namespaces\";\n\nexport default function(name) {\n  var prefix = name += \"\", i = prefix.indexOf(\":\");\n  if (i >= 0 && (prefix = name.slice(0, i)) !== \"xmlns\") name = name.slice(i + 1);\n  return namespaces.hasOwnProperty(prefix) ? {space: namespaces[prefix], local: name} : name;\n}\n","import namespace from \"../namespace\";\n\nfunction attrRemove(name) {\n  return function() {\n    this.removeAttribute(name);\n  };\n}\n\nfunction attrRemoveNS(fullname) {\n  return function() {\n    this.removeAttributeNS(fullname.space, fullname.local);\n  };\n}\n\nfunction attrConstant(name, value) {\n  return function() {\n    this.setAttribute(name, value);\n  };\n}\n\nfunction attrConstantNS(fullname, value) {\n  return function() {\n    this.setAttributeNS(fullname.space, fullname.local, value);\n  };\n}\n\nfunction attrFunction(name, value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) this.removeAttribute(name);\n    else this.setAttribute(name, v);\n  };\n}\n\nfunction attrFunctionNS(fullname, value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) this.removeAttributeNS(fullname.space, fullname.local);\n    else this.setAttributeNS(fullname.space, fullname.local, v);\n  };\n}\n\nexport default function(name, value) {\n  var fullname = namespace(name);\n\n  if (arguments.length < 2) {\n    var node = this.node();\n    return fullname.local\n        ? node.getAttributeNS(fullname.space, fullname.local)\n        : node.getAttribute(fullname);\n  }\n\n  return this.each((value == null\n      ? (fullname.local ? attrRemoveNS : attrRemove) : (typeof value === \"function\"\n      ? (fullname.local ? attrFunctionNS : attrFunction)\n      : (fullname.local ? attrConstantNS : attrConstant)))(fullname, value));\n}\n","export default function(node) {\n  return (node.ownerDocument && node.ownerDocument.defaultView) // node is a Node\n      || (node.document && node) // node is a Window\n      || node.defaultView; // node is a Document\n}\n","import defaultView from \"../window\";\n\nfunction styleRemove(name) {\n  return function() {\n    this.style.removeProperty(name);\n  };\n}\n\nfunction styleConstant(name, value, priority) {\n  return function() {\n    this.style.setProperty(name, value, priority);\n  };\n}\n\nfunction styleFunction(name, value, priority) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) this.style.removeProperty(name);\n    else this.style.setProperty(name, v, priority);\n  };\n}\n\nexport default function(name, value, priority) {\n  return arguments.length > 1\n      ? this.each((value == null\n            ? styleRemove : typeof value === \"function\"\n            ? styleFunction\n            : styleConstant)(name, value, priority == null ? \"\" : priority))\n      : styleValue(this.node(), name);\n}\n\nexport function styleValue(node, name) {\n  return node.style.getPropertyValue(name)\n      || defaultView(node).getComputedStyle(node, null).getPropertyValue(name);\n}\n","function propertyRemove(name) {\n  return function() {\n    delete this[name];\n  };\n}\n\nfunction propertyConstant(name, value) {\n  return function() {\n    this[name] = value;\n  };\n}\n\nfunction propertyFunction(name, value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) delete this[name];\n    else this[name] = v;\n  };\n}\n\nexport default function(name, value) {\n  return arguments.length > 1\n      ? this.each((value == null\n          ? propertyRemove : typeof value === \"function\"\n          ? propertyFunction\n          : propertyConstant)(name, value))\n      : this.node()[name];\n}\n","function classArray(string) {\n  return string.trim().split(/^|\\s+/);\n}\n\nfunction classList(node) {\n  return node.classList || new ClassList(node);\n}\n\nfunction ClassList(node) {\n  this._node = node;\n  this._names = classArray(node.getAttribute(\"class\") || \"\");\n}\n\nClassList.prototype = {\n  add: function(name) {\n    var i = this._names.indexOf(name);\n    if (i < 0) {\n      this._names.push(name);\n      this._node.setAttribute(\"class\", this._names.join(\" \"));\n    }\n  },\n  remove: function(name) {\n    var i = this._names.indexOf(name);\n    if (i >= 0) {\n      this._names.splice(i, 1);\n      this._node.setAttribute(\"class\", this._names.join(\" \"));\n    }\n  },\n  contains: function(name) {\n    return this._names.indexOf(name) >= 0;\n  }\n};\n\nfunction classedAdd(node, names) {\n  var list = classList(node), i = -1, n = names.length;\n  while (++i < n) list.add(names[i]);\n}\n\nfunction classedRemove(node, names) {\n  var list = classList(node), i = -1, n = names.length;\n  while (++i < n) list.remove(names[i]);\n}\n\nfunction classedTrue(names) {\n  return function() {\n    classedAdd(this, names);\n  };\n}\n\nfunction classedFalse(names) {\n  return function() {\n    classedRemove(this, names);\n  };\n}\n\nfunction classedFunction(names, value) {\n  return function() {\n    (value.apply(this, arguments) ? classedAdd : classedRemove)(this, names);\n  };\n}\n\nexport default function(name, value) {\n  var names = classArray(name + \"\");\n\n  if (arguments.length < 2) {\n    var list = classList(this.node()), i = -1, n = names.length;\n    while (++i < n) if (!list.contains(names[i])) return false;\n    return true;\n  }\n\n  return this.each((typeof value === \"function\"\n      ? classedFunction : value\n      ? classedTrue\n      : classedFalse)(names, value));\n}\n","function textRemove() {\n  this.textContent = \"\";\n}\n\nfunction textConstant(value) {\n  return function() {\n    this.textContent = value;\n  };\n}\n\nfunction textFunction(value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    this.textContent = v == null ? \"\" : v;\n  };\n}\n\nexport default function(value) {\n  return arguments.length\n      ? this.each(value == null\n          ? textRemove : (typeof value === \"function\"\n          ? textFunction\n          : textConstant)(value))\n      : this.node().textContent;\n}\n","function htmlRemove() {\n  this.innerHTML = \"\";\n}\n\nfunction htmlConstant(value) {\n  return function() {\n    this.innerHTML = value;\n  };\n}\n\nfunction htmlFunction(value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    this.innerHTML = v == null ? \"\" : v;\n  };\n}\n\nexport default function(value) {\n  return arguments.length\n      ? this.each(value == null\n          ? htmlRemove : (typeof value === \"function\"\n          ? htmlFunction\n          : htmlConstant)(value))\n      : this.node().innerHTML;\n}\n","function raise() {\n  if (this.nextSibling) this.parentNode.appendChild(this);\n}\n\nexport default function() {\n  return this.each(raise);\n}\n","function lower() {\n  if (this.previousSibling) this.parentNode.insertBefore(this, this.parentNode.firstChild);\n}\n\nexport default function() {\n  return this.each(lower);\n}\n","import namespace from \"./namespace\";\nimport {xhtml} from \"./namespaces\";\n\nfunction creatorInherit(name) {\n  return function() {\n    var document = this.ownerDocument,\n        uri = this.namespaceURI;\n    return uri === xhtml && document.documentElement.namespaceURI === xhtml\n        ? document.createElement(name)\n        : document.createElementNS(uri, name);\n  };\n}\n\nfunction creatorFixed(fullname) {\n  return function() {\n    return this.ownerDocument.createElementNS(fullname.space, fullname.local);\n  };\n}\n\nexport default function(name) {\n  var fullname = namespace(name);\n  return (fullname.local\n      ? creatorFixed\n      : creatorInherit)(fullname);\n}\n","import creator from \"../creator\";\nimport selector from \"../selector\";\n\nfunction constantNull() {\n  return null;\n}\n\nexport default function(name, before) {\n  var create = typeof name === \"function\" ? name : creator(name),\n      select = before == null ? constantNull : typeof before === \"function\" ? before : selector(before);\n  return this.select(function() {\n    return this.insertBefore(create.apply(this, arguments), select.apply(this, arguments) || null);\n  });\n}\n","function remove() {\n  var parent = this.parentNode;\n  if (parent) parent.removeChild(this);\n}\n\nexport default function() {\n  return this.each(remove);\n}\n","function selection_cloneShallow() {\n  var clone = this.cloneNode(false), parent = this.parentNode;\n  return parent ? parent.insertBefore(clone, this.nextSibling) : clone;\n}\n\nfunction selection_cloneDeep() {\n  var clone = this.cloneNode(true), parent = this.parentNode;\n  return parent ? parent.insertBefore(clone, this.nextSibling) : clone;\n}\n\nexport default function(deep) {\n  return this.select(deep ? selection_cloneDeep : selection_cloneShallow);\n}\n","var filterEvents = {};\n\nexport var event = null;\n\nif (typeof document !== \"undefined\") {\n  var element = document.documentElement;\n  if (!(\"onmouseenter\" in element)) {\n    filterEvents = {mouseenter: \"mouseover\", mouseleave: \"mouseout\"};\n  }\n}\n\nfunction filterContextListener(listener, index, group) {\n  listener = contextListener(listener, index, group);\n  return function(event) {\n    var related = event.relatedTarget;\n    if (!related || (related !== this && !(related.compareDocumentPosition(this) & 8))) {\n      listener.call(this, event);\n    }\n  };\n}\n\nfunction contextListener(listener, index, group) {\n  return function(event1) {\n    var event0 = event; // Events can be reentrant (e.g., focus).\n    event = event1;\n    try {\n      listener.call(this, this.__data__, index, group);\n    } finally {\n      event = event0;\n    }\n  };\n}\n\nfunction parseTypenames(typenames) {\n  return typenames.trim().split(/^|\\s+/).map(function(t) {\n    var name = \"\", i = t.indexOf(\".\");\n    if (i >= 0) name = t.slice(i + 1), t = t.slice(0, i);\n    return {type: t, name: name};\n  });\n}\n\nfunction onRemove(typename) {\n  return function() {\n    var on = this.__on;\n    if (!on) return;\n    for (var j = 0, i = -1, m = on.length, o; j < m; ++j) {\n      if (o = on[j], (!typename.type || o.type === typename.type) && o.name === typename.name) {\n        this.removeEventListener(o.type, o.listener, o.capture);\n      } else {\n        on[++i] = o;\n      }\n    }\n    if (++i) on.length = i;\n    else delete this.__on;\n  };\n}\n\nfunction onAdd(typename, value, capture) {\n  var wrap = filterEvents.hasOwnProperty(typename.type) ? filterContextListener : contextListener;\n  return function(d, i, group) {\n    var on = this.__on, o, listener = wrap(value, i, group);\n    if (on) for (var j = 0, m = on.length; j < m; ++j) {\n      if ((o = on[j]).type === typename.type && o.name === typename.name) {\n        this.removeEventListener(o.type, o.listener, o.capture);\n        this.addEventListener(o.type, o.listener = listener, o.capture = capture);\n        o.value = value;\n        return;\n      }\n    }\n    this.addEventListener(typename.type, listener, capture);\n    o = {type: typename.type, name: typename.name, value: value, listener: listener, capture: capture};\n    if (!on) this.__on = [o];\n    else on.push(o);\n  };\n}\n\nexport default function(typename, value, capture) {\n  var typenames = parseTypenames(typename + \"\"), i, n = typenames.length, t;\n\n  if (arguments.length < 2) {\n    var on = this.node().__on;\n    if (on) for (var j = 0, m = on.length, o; j < m; ++j) {\n      for (i = 0, o = on[j]; i < n; ++i) {\n        if ((t = typenames[i]).type === o.type && t.name === o.name) {\n          return o.value;\n        }\n      }\n    }\n    return;\n  }\n\n  on = value ? onAdd : onRemove;\n  if (capture == null) capture = false;\n  for (i = 0; i < n; ++i) this.each(on(typenames[i], value, capture));\n  return this;\n}\n\nexport function customEvent(event1, listener, that, args) {\n  var event0 = event;\n  event1.sourceEvent = event;\n  event = event1;\n  try {\n    return listener.apply(that, args);\n  } finally {\n    event = event0;\n  }\n}\n","import defaultView from \"../window\";\n\nfunction dispatchEvent(node, type, params) {\n  var window = defaultView(node),\n      event = window.CustomEvent;\n\n  if (typeof event === \"function\") {\n    event = new event(type, params);\n  } else {\n    event = window.document.createEvent(\"Event\");\n    if (params) event.initEvent(type, params.bubbles, params.cancelable), event.detail = params.detail;\n    else event.initEvent(type, false, false);\n  }\n\n  node.dispatchEvent(event);\n}\n\nfunction dispatchConstant(type, params) {\n  return function() {\n    return dispatchEvent(this, type, params);\n  };\n}\n\nfunction dispatchFunction(type, params) {\n  return function() {\n    return dispatchEvent(this, type, params.apply(this, arguments));\n  };\n}\n\nexport default function(type, params) {\n  return this.each((typeof params === \"function\"\n      ? dispatchFunction\n      : dispatchConstant)(type, params));\n}\n","import selection_select from \"./select\";\nimport selection_selectAll from \"./selectAll\";\nimport selection_filter from \"./filter\";\nimport selection_data from \"./data\";\nimport selection_enter from \"./enter\";\nimport selection_exit from \"./exit\";\nimport selection_join from \"./join\";\nimport selection_merge from \"./merge\";\nimport selection_order from \"./order\";\nimport selection_sort from \"./sort\";\nimport selection_call from \"./call\";\nimport selection_nodes from \"./nodes\";\nimport selection_node from \"./node\";\nimport selection_size from \"./size\";\nimport selection_empty from \"./empty\";\nimport selection_each from \"./each\";\nimport selection_attr from \"./attr\";\nimport selection_style from \"./style\";\nimport selection_property from \"./property\";\nimport selection_classed from \"./classed\";\nimport selection_text from \"./text\";\nimport selection_html from \"./html\";\nimport selection_raise from \"./raise\";\nimport selection_lower from \"./lower\";\nimport selection_append from \"./append\";\nimport selection_insert from \"./insert\";\nimport selection_remove from \"./remove\";\nimport selection_clone from \"./clone\";\nimport selection_datum from \"./datum\";\nimport selection_on from \"./on\";\nimport selection_dispatch from \"./dispatch\";\n\nexport var root = [null];\n\nexport function Selection(groups, parents) {\n  this._groups = groups;\n  this._parents = parents;\n}\n\nfunction selection() {\n  return new Selection([[document.documentElement]], root);\n}\n\nSelection.prototype = selection.prototype = {\n  constructor: Selection,\n  select: selection_select,\n  selectAll: selection_selectAll,\n  filter: selection_filter,\n  data: selection_data,\n  enter: selection_enter,\n  exit: selection_exit,\n  join: selection_join,\n  merge: selection_merge,\n  order: selection_order,\n  sort: selection_sort,\n  call: selection_call,\n  nodes: selection_nodes,\n  node: selection_node,\n  size: selection_size,\n  empty: selection_empty,\n  each: selection_each,\n  attr: selection_attr,\n  style: selection_style,\n  property: selection_property,\n  classed: selection_classed,\n  text: selection_text,\n  html: selection_html,\n  raise: selection_raise,\n  lower: selection_lower,\n  append: selection_append,\n  insert: selection_insert,\n  remove: selection_remove,\n  clone: selection_clone,\n  datum: selection_datum,\n  on: selection_on,\n  dispatch: selection_dispatch\n};\n\nexport default selection;\n","import {Selection} from \"./index\";\nimport selector from \"../selector\";\n\nexport default function(select) {\n  if (typeof select !== \"function\") select = selector(select);\n\n  for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, subgroup = subgroups[j] = new Array(n), node, subnode, i = 0; i < n; ++i) {\n      if ((node = group[i]) && (subnode = select.call(node, node.__data__, i, group))) {\n        if (\"__data__\" in node) subnode.__data__ = node.__data__;\n        subgroup[i] = subnode;\n      }\n    }\n  }\n\n  return new Selection(subgroups, this._parents);\n}\n","import {Selection} from \"./index\";\nimport selectorAll from \"../selectorAll\";\n\nexport default function(select) {\n  if (typeof select !== \"function\") select = selectorAll(select);\n\n  for (var groups = this._groups, m = groups.length, subgroups = [], parents = [], j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, node, i = 0; i < n; ++i) {\n      if (node = group[i]) {\n        subgroups.push(select.call(node, node.__data__, i, group));\n        parents.push(node);\n      }\n    }\n  }\n\n  return new Selection(subgroups, parents);\n}\n","import {Selection} from \"./index\";\nimport matcher from \"../matcher\";\n\nexport default function(match) {\n  if (typeof match !== \"function\") match = matcher(match);\n\n  for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, subgroup = subgroups[j] = [], node, i = 0; i < n; ++i) {\n      if ((node = group[i]) && match.call(node, node.__data__, i, group)) {\n        subgroup.push(node);\n      }\n    }\n  }\n\n  return new Selection(subgroups, this._parents);\n}\n","export default function(x) {\n  return function() {\n    return x;\n  };\n}\n","import sparse from \"./sparse\";\nimport {Selection} from \"./index\";\n\nexport default function() {\n  return new Selection(this._exit || this._groups.map(sparse), this._parents);\n}\n","export default function(onenter, onupdate, onexit) {\n  var enter = this.enter(), update = this, exit = this.exit();\n  enter = typeof onenter === \"function\" ? onenter(enter) : enter.append(onenter + \"\");\n  if (onupdate != null) update = onupdate(update);\n  if (onexit == null) exit.remove(); else onexit(exit);\n  return enter && update ? enter.merge(update).order() : update;\n}\n","import {Selection} from \"./index\";\n\nexport default function(selection) {\n\n  for (var groups0 = this._groups, groups1 = selection._groups, m0 = groups0.length, m1 = groups1.length, m = Math.min(m0, m1), merges = new Array(m0), j = 0; j < m; ++j) {\n    for (var group0 = groups0[j], group1 = groups1[j], n = group0.length, merge = merges[j] = new Array(n), node, i = 0; i < n; ++i) {\n      if (node = group0[i] || group1[i]) {\n        merge[i] = node;\n      }\n    }\n  }\n\n  for (; j < m0; ++j) {\n    merges[j] = groups0[j];\n  }\n\n  return new Selection(merges, this._parents);\n}\n","export default function() {\n\n  for (var groups = this._groups, j = -1, m = groups.length; ++j < m;) {\n    for (var group = groups[j], i = group.length - 1, next = group[i], node; --i >= 0;) {\n      if (node = group[i]) {\n        if (next && node.compareDocumentPosition(next) ^ 4) next.parentNode.insertBefore(node, next);\n        next = node;\n      }\n    }\n  }\n\n  return this;\n}\n","export default function() {\n  var callback = arguments[0];\n  arguments[0] = this;\n  callback.apply(null, arguments);\n  return this;\n}\n","export default function() {\n  var nodes = new Array(this.size()), i = -1;\n  this.each(function() { nodes[++i] = this; });\n  return nodes;\n}\n","export default function() {\n\n  for (var groups = this._groups, j = 0, m = groups.length; j < m; ++j) {\n    for (var group = groups[j], i = 0, n = group.length; i < n; ++i) {\n      var node = group[i];\n      if (node) return node;\n    }\n  }\n\n  return null;\n}\n","export default function() {\n  var size = 0;\n  this.each(function() { ++size; });\n  return size;\n}\n","export default function() {\n  return !this.node();\n}\n","export default function(callback) {\n\n  for (var groups = this._groups, j = 0, m = groups.length; j < m; ++j) {\n    for (var group = groups[j], i = 0, n = group.length, node; i < n; ++i) {\n      if (node = group[i]) callback.call(node, node.__data__, i, group);\n    }\n  }\n\n  return this;\n}\n","import creator from \"../creator\";\n\nexport default function(name) {\n  var create = typeof name === \"function\" ? name : creator(name);\n  return this.select(function() {\n    return this.appendChild(create.apply(this, arguments));\n  });\n}\n","export default function(value) {\n  return arguments.length\n      ? this.property(\"__data__\", value)\n      : this.node().__data__;\n}\n","import {Selection, root} from \"./selection/index\";\n\nexport default function(selector) {\n  return typeof selector === \"string\"\n      ? new Selection([[document.querySelector(selector)]], [document.documentElement])\n      : new Selection([[selector]], root);\n}\n","export var prefix = \"$\";\n\nfunction Map() {}\n\nMap.prototype = map.prototype = {\n  constructor: Map,\n  has: function(key) {\n    return (prefix + key) in this;\n  },\n  get: function(key) {\n    return this[prefix + key];\n  },\n  set: function(key, value) {\n    this[prefix + key] = value;\n    return this;\n  },\n  remove: function(key) {\n    var property = prefix + key;\n    return property in this && delete this[property];\n  },\n  clear: function() {\n    for (var property in this) if (property[0] === prefix) delete this[property];\n  },\n  keys: function() {\n    var keys = [];\n    for (var property in this) if (property[0] === prefix) keys.push(property.slice(1));\n    return keys;\n  },\n  values: function() {\n    var values = [];\n    for (var property in this) if (property[0] === prefix) values.push(this[property]);\n    return values;\n  },\n  entries: function() {\n    var entries = [];\n    for (var property in this) if (property[0] === prefix) entries.push({key: property.slice(1), value: this[property]});\n    return entries;\n  },\n  size: function() {\n    var size = 0;\n    for (var property in this) if (property[0] === prefix) ++size;\n    return size;\n  },\n  empty: function() {\n    for (var property in this) if (property[0] === prefix) return false;\n    return true;\n  },\n  each: function(f) {\n    for (var property in this) if (property[0] === prefix) f(this[property], property.slice(1), this);\n  }\n};\n\nfunction map(object, f) {\n  var map = new Map;\n\n  // Copy constructor.\n  if (object instanceof Map) object.each(function(value, key) { map.set(key, value); });\n\n  // Index array by numeric index or specified key function.\n  else if (Array.isArray(object)) {\n    var i = -1,\n        n = object.length,\n        o;\n\n    if (f == null) while (++i < n) map.set(i, object[i]);\n    else while (++i < n) map.set(f(o = object[i], i, object), o);\n  }\n\n  // Convert object to map.\n  else if (object) for (var key in object) map.set(key, object[key]);\n\n  return map;\n}\n\nexport default map;\n","import {default as map, prefix} from \"./map\";\n\nfunction Set() {}\n\nvar proto = map.prototype;\n\nSet.prototype = set.prototype = {\n  constructor: Set,\n  has: proto.has,\n  add: function(value) {\n    value += \"\";\n    this[prefix + value] = value;\n    return this;\n  },\n  remove: proto.remove,\n  clear: proto.clear,\n  values: proto.keys,\n  size: proto.size,\n  empty: proto.empty,\n  each: proto.each\n};\n\nfunction set(object, f) {\n  var set = new Set;\n\n  // Copy constructor.\n  if (object instanceof Set) object.each(function(value) { set.add(value); });\n\n  // Otherwise, assume it’s an array.\n  else if (object) {\n    var i = -1, n = object.length;\n    if (f == null) while (++i < n) set.add(object[i]);\n    else while (++i < n) set.add(f(object[i], i, object));\n  }\n\n  return set;\n}\n\nexport default set;\n","var noop = {value: function() {}};\n\nfunction dispatch() {\n  for (var i = 0, n = arguments.length, _ = {}, t; i < n; ++i) {\n    if (!(t = arguments[i] + \"\") || (t in _)) throw new Error(\"illegal type: \" + t);\n    _[t] = [];\n  }\n  return new Dispatch(_);\n}\n\nfunction Dispatch(_) {\n  this._ = _;\n}\n\nfunction parseTypenames(typenames, types) {\n  return typenames.trim().split(/^|\\s+/).map(function(t) {\n    var name = \"\", i = t.indexOf(\".\");\n    if (i >= 0) name = t.slice(i + 1), t = t.slice(0, i);\n    if (t && !types.hasOwnProperty(t)) throw new Error(\"unknown type: \" + t);\n    return {type: t, name: name};\n  });\n}\n\nDispatch.prototype = dispatch.prototype = {\n  constructor: Dispatch,\n  on: function(typename, callback) {\n    var _ = this._,\n        T = parseTypenames(typename + \"\", _),\n        t,\n        i = -1,\n        n = T.length;\n\n    // If no callback was specified, return the callback of the given type and name.\n    if (arguments.length < 2) {\n      while (++i < n) if ((t = (typename = T[i]).type) && (t = get(_[t], typename.name))) return t;\n      return;\n    }\n\n    // If a type was specified, set the callback for the given type and name.\n    // Otherwise, if a null callback was specified, remove callbacks of the given name.\n    if (callback != null && typeof callback !== \"function\") throw new Error(\"invalid callback: \" + callback);\n    while (++i < n) {\n      if (t = (typename = T[i]).type) _[t] = set(_[t], typename.name, callback);\n      else if (callback == null) for (t in _) _[t] = set(_[t], typename.name, null);\n    }\n\n    return this;\n  },\n  copy: function() {\n    var copy = {}, _ = this._;\n    for (var t in _) copy[t] = _[t].slice();\n    return new Dispatch(copy);\n  },\n  call: function(type, that) {\n    if ((n = arguments.length - 2) > 0) for (var args = new Array(n), i = 0, n, t; i < n; ++i) args[i] = arguments[i + 2];\n    if (!this._.hasOwnProperty(type)) throw new Error(\"unknown type: \" + type);\n    for (t = this._[type], i = 0, n = t.length; i < n; ++i) t[i].value.apply(that, args);\n  },\n  apply: function(type, that, args) {\n    if (!this._.hasOwnProperty(type)) throw new Error(\"unknown type: \" + type);\n    for (var t = this._[type], i = 0, n = t.length; i < n; ++i) t[i].value.apply(that, args);\n  }\n};\n\nfunction get(type, name) {\n  for (var i = 0, n = type.length, c; i < n; ++i) {\n    if ((c = type[i]).name === name) {\n      return c.value;\n    }\n  }\n}\n\nfunction set(type, name, callback) {\n  for (var i = 0, n = type.length; i < n; ++i) {\n    if (type[i].name === name) {\n      type[i] = noop, type = type.slice(0, i).concat(type.slice(i + 1));\n      break;\n    }\n  }\n  if (callback != null) type.push({name: name, value: callback});\n  return type;\n}\n\nexport default dispatch;\n","import {map} from \"d3-collection\";\nimport {dispatch} from \"d3-dispatch\";\n\nexport default function(url, callback) {\n  var request,\n      event = dispatch(\"beforesend\", \"progress\", \"load\", \"error\"),\n      mimeType,\n      headers = map(),\n      xhr = new XMLHttpRequest,\n      user = null,\n      password = null,\n      response,\n      responseType,\n      timeout = 0;\n\n  // If IE does not support CORS, use XDomainRequest.\n  if (typeof XDomainRequest !== \"undefined\"\n      && !(\"withCredentials\" in xhr)\n      && /^(http(s)?:)?\\/\\//.test(url)) xhr = new XDomainRequest;\n\n  \"onload\" in xhr\n      ? xhr.onload = xhr.onerror = xhr.ontimeout = respond\n      : xhr.onreadystatechange = function(o) { xhr.readyState > 3 && respond(o); };\n\n  function respond(o) {\n    var status = xhr.status, result;\n    if (!status && hasResponse(xhr)\n        || status >= 200 && status < 300\n        || status === 304) {\n      if (response) {\n        try {\n          result = response.call(request, xhr);\n        } catch (e) {\n          event.call(\"error\", request, e);\n          return;\n        }\n      } else {\n        result = xhr;\n      }\n      event.call(\"load\", request, result);\n    } else {\n      event.call(\"error\", request, o);\n    }\n  }\n\n  xhr.onprogress = function(e) {\n    event.call(\"progress\", request, e);\n  };\n\n  request = {\n    header: function(name, value) {\n      name = (name + \"\").toLowerCase();\n      if (arguments.length < 2) return headers.get(name);\n      if (value == null) headers.remove(name);\n      else headers.set(name, value + \"\");\n      return request;\n    },\n\n    // If mimeType is non-null and no Accept header is set, a default is used.\n    mimeType: function(value) {\n      if (!arguments.length) return mimeType;\n      mimeType = value == null ? null : value + \"\";\n      return request;\n    },\n\n    // Specifies what type the response value should take;\n    // for instance, arraybuffer, blob, document, or text.\n    responseType: function(value) {\n      if (!arguments.length) return responseType;\n      responseType = value;\n      return request;\n    },\n\n    timeout: function(value) {\n      if (!arguments.length) return timeout;\n      timeout = +value;\n      return request;\n    },\n\n    user: function(value) {\n      return arguments.length < 1 ? user : (user = value == null ? null : value + \"\", request);\n    },\n\n    password: function(value) {\n      return arguments.length < 1 ? password : (password = value == null ? null : value + \"\", request);\n    },\n\n    // Specify how to convert the response content to a specific type;\n    // changes the callback value on \"load\" events.\n    response: function(value) {\n      response = value;\n      return request;\n    },\n\n    // Alias for send(\"GET\", …).\n    get: function(data, callback) {\n      return request.send(\"GET\", data, callback);\n    },\n\n    // Alias for send(\"POST\", …).\n    post: function(data, callback) {\n      return request.send(\"POST\", data, callback);\n    },\n\n    // If callback is non-null, it will be used for error and load events.\n    send: function(method, data, callback) {\n      xhr.open(method, url, true, user, password);\n      if (mimeType != null && !headers.has(\"accept\")) headers.set(\"accept\", mimeType + \",*/*\");\n      if (xhr.setRequestHeader) headers.each(function(value, name) { xhr.setRequestHeader(name, value); });\n      if (mimeType != null && xhr.overrideMimeType) xhr.overrideMimeType(mimeType);\n      if (responseType != null) xhr.responseType = responseType;\n      if (timeout > 0) xhr.timeout = timeout;\n      if (callback == null && typeof data === \"function\") callback = data, data = null;\n      if (callback != null && callback.length === 1) callback = fixCallback(callback);\n      if (callback != null) request.on(\"error\", callback).on(\"load\", function(xhr) { callback(null, xhr); });\n      event.call(\"beforesend\", request, xhr);\n      xhr.send(data == null ? null : data);\n      return request;\n    },\n\n    abort: function() {\n      xhr.abort();\n      return request;\n    },\n\n    on: function() {\n      var value = event.on.apply(event, arguments);\n      return value === event ? request : value;\n    }\n  };\n\n  if (callback != null) {\n    if (typeof callback !== \"function\") throw new Error(\"invalid callback: \" + callback);\n    return request.get(callback);\n  }\n\n  return request;\n}\n\nfunction fixCallback(callback) {\n  return function(error, xhr) {\n    callback(error == null ? xhr : null);\n  };\n}\n\nfunction hasResponse(xhr) {\n  var type = xhr.responseType;\n  return type && type !== \"text\"\n      ? xhr.response // null on error\n      : xhr.responseText; // \"\" on error\n}\n","import request from \"./request\";\n\nexport default function(defaultMimeType, response) {\n  return function(url, callback) {\n    var r = request(url).mimeType(defaultMimeType).response(response);\n    if (callback != null) {\n      if (typeof callback !== \"function\") throw new Error(\"invalid callback: \" + callback);\n      return r.get(callback);\n    }\n    return r;\n  };\n}\n","import type from \"./type\";\n\nexport default type(\"text/html\", function(xhr) {\n  return document.createRange().createContextualFragment(xhr.responseText);\n});\n","import type from \"./type\";\n\nexport default type(\"application/json\", function(xhr) {\n  return JSON.parse(xhr.responseText);\n});\n","import type from \"./type\";\n\nexport default type(\"text/plain\", function(xhr) {\n  return xhr.responseText;\n});\n","import type from \"./type\";\n\nexport default type(\"application/xml\", function(xhr) {\n  var xml = xhr.responseXML;\n  if (!xml) throw new Error(\"parse error\");\n  return xml;\n});\n","var EOL = {},\n    EOF = {},\n    QUOTE = 34,\n    NEWLINE = 10,\n    RETURN = 13;\n\nfunction objectConverter(columns) {\n  return new Function(\"d\", \"return {\" + columns.map(function(name, i) {\n    return JSON.stringify(name) + \": d[\" + i + \"] || \\\"\\\"\";\n  }).join(\",\") + \"}\");\n}\n\nfunction customConverter(columns, f) {\n  var object = objectConverter(columns);\n  return function(row, i) {\n    return f(object(row), i, columns);\n  };\n}\n\n// Compute unique columns in order of discovery.\nfunction inferColumns(rows) {\n  var columnSet = Object.create(null),\n      columns = [];\n\n  rows.forEach(function(row) {\n    for (var column in row) {\n      if (!(column in columnSet)) {\n        columns.push(columnSet[column] = column);\n      }\n    }\n  });\n\n  return columns;\n}\n\nfunction pad(value, width) {\n  var s = value + \"\", length = s.length;\n  return length < width ? new Array(width - length + 1).join(0) + s : s;\n}\n\nfunction formatYear(year) {\n  return year < 0 ? \"-\" + pad(-year, 6)\n    : year > 9999 ? \"+\" + pad(year, 6)\n    : pad(year, 4);\n}\n\nfunction formatDate(date) {\n  var hours = date.getUTCHours(),\n      minutes = date.getUTCMinutes(),\n      seconds = date.getUTCSeconds(),\n      milliseconds = date.getUTCMilliseconds();\n  return isNaN(date) ? \"Invalid Date\"\n      : formatYear(date.getUTCFullYear(), 4) + \"-\" + pad(date.getUTCMonth() + 1, 2) + \"-\" + pad(date.getUTCDate(), 2)\n      + (milliseconds ? \"T\" + pad(hours, 2) + \":\" + pad(minutes, 2) + \":\" + pad(seconds, 2) + \".\" + pad(milliseconds, 3) + \"Z\"\n      : seconds ? \"T\" + pad(hours, 2) + \":\" + pad(minutes, 2) + \":\" + pad(seconds, 2) + \"Z\"\n      : minutes || hours ? \"T\" + pad(hours, 2) + \":\" + pad(minutes, 2) + \"Z\"\n      : \"\");\n}\n\nexport default function(delimiter) {\n  var reFormat = new RegExp(\"[\\\"\" + delimiter + \"\\n\\r]\"),\n      DELIMITER = delimiter.charCodeAt(0);\n\n  function parse(text, f) {\n    var convert, columns, rows = parseRows(text, function(row, i) {\n      if (convert) return convert(row, i - 1);\n      columns = row, convert = f ? customConverter(row, f) : objectConverter(row);\n    });\n    rows.columns = columns || [];\n    return rows;\n  }\n\n  function parseRows(text, f) {\n    var rows = [], // output rows\n        N = text.length,\n        I = 0, // current character index\n        n = 0, // current line number\n        t, // current token\n        eof = N <= 0, // current token followed by EOF?\n        eol = false; // current token followed by EOL?\n\n    // Strip the trailing newline.\n    if (text.charCodeAt(N - 1) === NEWLINE) --N;\n    if (text.charCodeAt(N - 1) === RETURN) --N;\n\n    function token() {\n      if (eof) return EOF;\n      if (eol) return eol = false, EOL;\n\n      // Unescape quotes.\n      var i, j = I, c;\n      if (text.charCodeAt(j) === QUOTE) {\n        while (I++ < N && text.charCodeAt(I) !== QUOTE || text.charCodeAt(++I) === QUOTE);\n        if ((i = I) >= N) eof = true;\n        else if ((c = text.charCodeAt(I++)) === NEWLINE) eol = true;\n        else if (c === RETURN) { eol = true; if (text.charCodeAt(I) === NEWLINE) ++I; }\n        return text.slice(j + 1, i - 1).replace(/\"\"/g, \"\\\"\");\n      }\n\n      // Find next delimiter or newline.\n      while (I < N) {\n        if ((c = text.charCodeAt(i = I++)) === NEWLINE) eol = true;\n        else if (c === RETURN) { eol = true; if (text.charCodeAt(I) === NEWLINE) ++I; }\n        else if (c !== DELIMITER) continue;\n        return text.slice(j, i);\n      }\n\n      // Return last token before EOF.\n      return eof = true, text.slice(j, N);\n    }\n\n    while ((t = token()) !== EOF) {\n      var row = [];\n      while (t !== EOL && t !== EOF) row.push(t), t = token();\n      if (f && (row = f(row, n++)) == null) continue;\n      rows.push(row);\n    }\n\n    return rows;\n  }\n\n  function preformatBody(rows, columns) {\n    return rows.map(function(row) {\n      return columns.map(function(column) {\n        return formatValue(row[column]);\n      }).join(delimiter);\n    });\n  }\n\n  function format(rows, columns) {\n    if (columns == null) columns = inferColumns(rows);\n    return [columns.map(formatValue).join(delimiter)].concat(preformatBody(rows, columns)).join(\"\\n\");\n  }\n\n  function formatBody(rows, columns) {\n    if (columns == null) columns = inferColumns(rows);\n    return preformatBody(rows, columns).join(\"\\n\");\n  }\n\n  function formatRows(rows) {\n    return rows.map(formatRow).join(\"\\n\");\n  }\n\n  function formatRow(row) {\n    return row.map(formatValue).join(delimiter);\n  }\n\n  function formatValue(value) {\n    return value == null ? \"\"\n        : value instanceof Date ? formatDate(value)\n        : reFormat.test(value += \"\") ? \"\\\"\" + value.replace(/\"/g, \"\\\"\\\"\") + \"\\\"\"\n        : value;\n  }\n\n  return {\n    parse: parse,\n    parseRows: parseRows,\n    format: format,\n    formatBody: formatBody,\n    formatRows: formatRows,\n    formatRow: formatRow,\n    formatValue: formatValue\n  };\n}\n","import dsv from \"./dsv.js\";\n\nvar csv = dsv(\",\");\n\nexport var csvParse = csv.parse;\nexport var csvParseRows = csv.parseRows;\nexport var csvFormat = csv.format;\nexport var csvFormatBody = csv.formatBody;\nexport var csvFormatRows = csv.formatRows;\nexport var csvFormatRow = csv.formatRow;\nexport var csvFormatValue = csv.formatValue;\n","import request from \"./request\";\n\nexport default function(defaultMimeType, parse) {\n  return function(url, row, callback) {\n    if (arguments.length < 3) callback = row, row = null;\n    var r = request(url).mimeType(defaultMimeType);\n    r.row = function(_) { return arguments.length ? r.response(responseOf(parse, row = _)) : row; };\n    r.row(row);\n    return callback ? r.get(callback) : r;\n  };\n}\n\nfunction responseOf(parse, row) {\n  return function(request) {\n    return parse(request.responseText, row);\n  };\n}\n","import {csvParse} from \"d3-dsv\";\nimport dsv from \"./dsv\";\n\nexport default dsv(\"text/csv\", csvParse);\n","import dsv from \"./dsv.js\";\n\nvar tsv = dsv(\"\\t\");\n\nexport var tsvParse = tsv.parse;\nexport var tsvParseRows = tsv.parseRows;\nexport var tsvFormat = tsv.format;\nexport var tsvFormatBody = tsv.formatBody;\nexport var tsvFormatRows = tsv.formatRows;\nexport var tsvFormatRow = tsv.formatRow;\nexport var tsvFormatValue = tsv.formatValue;\n","import {tsvParse} from \"d3-dsv\";\nimport dsv from \"./dsv\";\n\nexport default dsv(\"text/tab-separated-values\", tsvParse);\n","/* eslint-disable camelcase */\r\n/* global Blob, XMLSerializer, Image, btoa */\r\n\r\nimport vkbeautify from 'vkbeautify';\r\nimport _ from 'underscore';\r\nimport {json as d3_json} from 'd3-request';\r\nimport {text as d3_text} from 'd3-request';\r\nimport {csvParseRows as d3_csvParseRows} from 'd3-dsv';\r\nimport {Selection as d3_selection} from 'd3-selection';\r\nimport {Coord, D3Selection, D3SVGSelection} from './types';\r\n\r\n// const vkbeautify = require('vkbeautify');\r\n// const _ = require('underscore');\r\n// const d3_json = require('d3-request').json;\r\n// const d3_text = require('d3-request').text;\r\n// const d3_csvParseRows = require('d3-dsv').csvParseRows;\r\n\r\ntry {\r\n  // @ts-ignore\r\n  if (!window.saveAs)\r\n    // @ts-ignore\r\n    window.saveAs = require('file-saver').saveAs;\r\n} catch (e) {\r\n  console.warn('Not a browser, so FileSaver.js not available.');\r\n}\r\n\r\n/**\r\n * Check if Blob is available, and alert if it is not.\r\n */\r\nexport function _check_filesaver() {\r\n  try {\r\n    const isFileSaverSupported = !!new Blob();\r\n  } catch (e) {\r\n    alert('Blob not supported');\r\n  }\r\n}\r\n\r\nexport function set_options<T extends Object>(options: Partial<T>, defaults: T, must_be_float?: { [key: string]: any }): T {\r\n  if (options === undefined || options == null)\r\n    return defaults as T;\r\n\r\n  const i = -1;\r\n  const out: { [key: string]: any } = {};\r\n  for (const key in defaults) {\r\n    const has_key = ((key in options) &&\r\n                   (options[key] !== null) &&\r\n                   (options[key] !== undefined));\r\n    let val: any = (has_key ? options[key] : defaults[key]);\r\n    if (must_be_float && key in must_be_float) {\r\n      val = parseFloat(val);\r\n      if (isNaN(val)) {\r\n        if (has_key) {\r\n          console.warn('Bad float for option ' + key);\r\n          val = parseFloat(defaults[key] as string);\r\n          if (isNaN(val)) {\r\n            console.warn('Bad float for default ' + key);\r\n            val = null;\r\n          }\r\n        } else {\r\n          console.warn('Bad float for default ' + key);\r\n          val = null;\r\n        }\r\n      }\r\n    }\r\n    out[key] = val;\r\n  }\r\n  return out as T;\r\n}\r\n\r\n\r\nexport function remove_child_nodes(selection: D3Selection) {\r\n  /** Removes all child nodes from a d3 selection\r\n\r\n   */\r\n  const node = selection.node();\r\n  while (node?.hasChildNodes())\r\n    node.removeChild(node.lastChild as Node);\r\n}\r\n\r\n\r\nexport function load_css(css_path: string, callback: (css: string) => void) {\r\n  let css = '';\r\n  if (css_path) {\r\n    d3_text(css_path, function(error, text) {\r\n      if (error)\r\n        console.warn(error);\r\n\r\n      css = text;\r\n      callback(css);\r\n    });\r\n  }\r\n  return false;\r\n}\r\n\r\n\r\nexport function _ends_with(str: string, suffix: string) {\r\n  return str.indexOf(suffix, str.length - suffix.length) !== -1;\r\n}\r\n\r\n/**\r\n * Load a file.\r\n * @param {} t - this context for callback. Should be an object.\r\n * @param {} files_to_load - A filename to load. Must be JSON or CSS.\r\n * @param {} callback - Function to run after the file is loaded. Takes the\r\n * arguments error and data.\r\n * @param {} value - If the value is specified, just assign it and do not\r\n * execute the ajax query.\r\n */\r\nexport function load_the_file(t: any, file: string, callback: (error: any, d: any) => void, value?: any) {\r\n  if (value) {\r\n    if (file) console.warn('File ' + file + ' overridden by value.');\r\n    callback.call(t, null, value);\r\n    return;\r\n  }\r\n  if (!file) {\r\n    callback.call(t, 'No filename', null);\r\n    return;\r\n  }\r\n  if (_ends_with(file, 'json'))\r\n    d3_json(file, function(e, d) { callback.call(t, e, d); });\r\n  else if (_ends_with(file, 'css'))\r\n    d3_text(file, function(e, d) { callback.call(t, e, d); });\r\n  else\r\n    callback.call(t, 'Unrecognized file type', null);\r\n\r\n  return;\r\n}\r\n\r\n\r\nexport function load_files(t: any, files_to_load: { file: string, callback: (error: any, d: any) => void, value: any }[], final_callback: (error: any, d: any) => void) {\r\n  /** Load multiple files asynchronously by calling utils.load_the_file.\r\n\r\n      t: this context for callback. Should be an object.\r\n\r\n      files_to_load: A list of objects with the attributes:\r\n\r\n      { file: a_filename.json, callback: a_callback_fn }\r\n\r\n      File must be JSON or CSS.\r\n\r\n      final_callback: Function that runs after all files have loaded.\r\n\r\n  */\r\n  if (files_to_load.length === 0) final_callback.call(t, null, null);\r\n  let i = -1;\r\n  let remaining = files_to_load.length;\r\n  while (++i < files_to_load.length) {\r\n    load_the_file(\r\n      t,\r\n      files_to_load[i].file,\r\n      function(e: any, d: any) {\r\n        // @ts-ignore\r\n        (this as any).call(t, e, d);\r\n        if (!--remaining) final_callback.call(t, null, null);\r\n      }.bind(files_to_load[i].callback),\r\n      files_to_load[i].value\r\n    );\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * Create a constructor that returns a new object with our without the 'new'\r\n * keyword.\r\n *\r\n * Adapted from Hubert Kauker (MIT Licensed), John Resig (MIT Licensed).\r\n * http://stackoverflow.com/questions/7892884/simple-class-instantiation\r\n */\r\nexport function make_class() {\r\n  let is_internal: boolean;\r\n  const constructor = function(args: any) {\r\n    // @ts-ignore\r\n    // eslint-disable-next-line no-invalid-this\r\n    if (this instanceof constructor) {\r\n      // @ts-ignore\r\n      // eslint-disable-next-line no-invalid-this\r\n      if (typeof this.init === 'function')\r\n        // @ts-ignore\r\n        // eslint-disable-next-line prefer-rest-params, no-invalid-this\r\n        this.init.apply(this, ...(is_internal ? args : arguments as any));\r\n    } else {\r\n      is_internal = true;\r\n      // @ts-ignore\r\n      // eslint-disable-next-line prefer-rest-params\r\n      const instance = new constructor(arguments as any);\r\n      is_internal = false;\r\n      return instance;\r\n    }\r\n  };\r\n  return constructor;\r\n}\r\n\r\n/**\r\n * Return a class that can be instantiated without the new keyword.\r\n * @param {Class} AClass - Any ES6 class.\r\n */\r\nexport function class_with_optional_new(AClass: any) {\r\n  return new Proxy(AClass, {\r\n    apply(Target, thisArg, args) {\r\n      return new Target(...args);\r\n    }\r\n  });\r\n}\r\n\r\nexport function setup_defs(svg: D3Selection, style: string) {\r\n  // add stylesheet\r\n  svg.select('defs').remove();\r\n  const defs = svg.append('defs');\r\n  // make sure the defs is the first node\r\n  const node = defs.node()!;\r\n  node.parentNode!.insertBefore(node, node.parentNode!.firstChild);\r\n  defs.append('style')\r\n    .attr('type', 'text/css')\r\n    .text(style);\r\n  return defs;\r\n}\r\n\r\n/**\r\n * Run through the d3 data binding steps for an object. Also checks to make sure\r\n * none of the values in the *object* are undefined, and ignores those.\r\n *\r\n * The create_function, update_function, and exit_function CAN modify the input\r\n * data object.\r\n *\r\n * @param {} container_sel - A d3 selection containing all objects.\r\n *\r\n * @param {} parent_node_selector - A selector string for a subselection of\r\n * container_sel.\r\n *\r\n * @param {} children_selector - A selector string for each DOM element to bind.\r\n *\r\n * @param {} object - An object to bind to the selection.\r\n *\r\n * @param {} id_key - The key that will be used to store object IDs in the bound\r\n * data points.\r\n *\r\n * @param {} create_function - A function for enter selection. Create function\r\n * must return a selection of the new nodes.\r\n *\r\n * @param {} update_function - A function for update selection.\r\n *\r\n * @param {} exit_function - A function for exit selection.\r\n */\r\nexport function draw_an_object(container_sel: D3Selection, parent_node_selector: string, children_selector: string,\r\n  object: any, id_key: string, create_function: any, update_function?: any,\r\n  exit_function?: any) {\r\n  const draw_object: { [key: string]: any } = {};\r\n\r\n  for (const id in object) {\r\n    if (object[id] === undefined)\r\n      console.warn('Undefined value for id ' + id + ' in object. Ignoring.');\r\n    else\r\n      draw_object[id] = object[id];\r\n  }\r\n\r\n  const sel = container_sel.select(parent_node_selector)\r\n    .selectAll(children_selector)\r\n    .data(make_array_ref(draw_object, id_key),\r\n      function(d: any) { return d[id_key]; });\r\n\r\n  // enter: generate and place reaction\r\n  const update_sel = create_function ?\r\n    create_function(sel.enter()).merge(sel) :\r\n    sel;\r\n\r\n  // update: update when necessary\r\n  if (update_function)\r\n    update_sel.call(update_function);\r\n\r\n\r\n  // exit\r\n  if (exit_function)\r\n    sel.exit().call(exit_function);\r\n}\r\n\r\n/**\r\n * Run through the d3 data binding steps for an object that is nested within\r\n * another element with D3 data.\r\n *\r\n * The create_function, update_function, and exit_function CAN modify the input\r\n * data object.\r\n *\r\n * @param {} container_sel - A d3 selection containing all objects.\r\n *\r\n * @param {} children_selector - A selector string for each DOM element to bind.\r\n *\r\n * @param {} object_data_key - A key for the parent object containing data for\r\n * the new selection.\r\n *\r\n * @param {} id_key - The key that will be used to store object IDs in the bound\r\n * data points.\r\n *\r\n * @param {} create_function - A function for enter selection. Create function\r\n * must return a selection of the new nodes.\r\n *\r\n * @param {} update_function - A function for update selection.\r\n *\r\n * @param {} exit_function - A function for exit selection.\r\n */\r\nexport function draw_a_nested_object(container_sel: D3Selection, children_selector: string, object_data_key: string,\r\n  id_key: string, create_function: any, update_function: any,\r\n  exit_function: any) {\r\n  const sel = container_sel.selectAll(children_selector)\r\n    .data(function(d: any) { return make_array_ref(d[object_data_key], id_key); },\r\n      function(d: any) { return d[id_key]; });\r\n\r\n  // enter: generate and place reaction\r\n  const update_sel = (create_function ?\r\n    create_function(sel.enter()).merge(sel) :\r\n    sel);\r\n\r\n  // update: update when necessary\r\n  if (update_function)\r\n    update_sel.call(update_function);\r\n\r\n\r\n  // exit\r\n  if (exit_function)\r\n    sel.exit().call(exit_function);\r\n}\r\n\r\nexport function make_array(obj: any, id_key: string) { // is this super slow?\r\n  const array = [];\r\n  for (const key in obj) {\r\n    // copy object\r\n    const it = clone(obj[key]);\r\n    // add key as 'id'\r\n    it[id_key] = key;\r\n    // add object to array\r\n    array.push(it);\r\n  }\r\n  return array;\r\n}\r\n\r\nexport function make_array_ref(obj: any, id_key: string) {\r\n  /** Turn the object into an array, but only by reference. Faster than\r\n      make_array.\r\n\r\n  */\r\n  const array = [];\r\n  for (const key in obj) {\r\n    // copy object\r\n    const it = obj[key];\r\n    // add key as 'id'\r\n    it[id_key] = key;\r\n    // add object to array\r\n    array.push(it);\r\n  }\r\n  return array;\r\n}\r\n\r\nexport function compare_arrays(a1: any, a2: any) {\r\n  /** Compares two simple (not-nested) arrays.\r\n\r\n   */\r\n  if (!a1 || !a2) return false;\r\n  if (a1.length != a2.length) return false;\r\n  for (let i = 0, l = a1.length; i < l; i++) {\r\n    if (a1[i] != a2[i]) {\r\n      // Warning - two different object instances will never be equal: {x:20} != {x:20}\r\n      return false;\r\n    }\r\n  }\r\n  return true;\r\n}\r\n\r\n/**\r\n * Convert an array of objects to an object with all keys and values\r\n * that are arrays of the same length as arr. Fills in spaces with null.\r\n *\r\n *  For example, [ { a: 1 }, { b: 2 }] becomes { a: [1, null], b: [null, 2] }.\r\n */\r\nexport function arrayToObject(arr: any) {\r\n  // new object\r\n  const obj: { [key: string]: any } = {};\r\n  // for each element of the array\r\n  for (let i = 0, l = arr.length; i < l; i++) {\r\n    const column = arr[i];\r\n    const keys = Object.keys(column);\r\n    for (let k = 0, nk = keys.length; k < nk; k++) {\r\n      const id = keys[k];\r\n      if (!(id in obj)) {\r\n        const n = [];\r\n        // fill spaces with null\r\n        for (let j = 0; j < l; j++)\r\n          n[j] = null;\r\n\r\n        n[i] = column[id];\r\n        obj[id] = n;\r\n      } else\r\n        obj[id][i] = column[id];\r\n    }\r\n  }\r\n  return obj;\r\n}\r\n\r\n/**\r\n * Deep copy for array and object types. All other types are returned by\r\n * reference.\r\n * @param {T<Object|Array|*>} obj - The object to copy.\r\n * @return {T} The copied object.\r\n */\r\nexport function clone<T = any>(obj: T): T {\r\n  if (_.isArray(obj))\r\n    return _.map(obj, function(t: any) { return clone(t); }) as T;\r\n  else if (_.isObject(obj))\r\n    return _.mapObject(obj, function(t: any, k: any) { return clone(t); }) as T;\r\n  else\r\n    return obj;\r\n}\r\n\r\nexport function extend<T extends Object = any >(obj1: T, obj2: Partial<T>, overwrite: boolean = false) {\r\n  /** Extends obj1 with keys/values from obj2. Performs the extension\r\n      cautiously, and does not override attributes, unless the overwrite\r\n      argument is true.\r\n\r\n      Arguments\r\n      ---------\r\n\r\n      obj1: Object to extend\r\n\r\n      obj2: Object with which to extend.\r\n\r\n      overwrite: (Optional, Default false) Overwrite attributes in obj1.\r\n\r\n  */\r\n\r\n  if (overwrite === undefined)\r\n    overwrite = false;\r\n\r\n  for (const attrname in obj2) {\r\n    if (!(attrname in obj1) || overwrite) // UNIT TEST This\r\n      obj1[attrname] = obj2[attrname] as any;\r\n    else\r\n      throw new Error('Attribute ' + attrname + ' already in object.');\r\n  }\r\n}\r\n\r\nexport function uniqueConcat(arrays: any[]) {\r\n  const newArray: any[] = [];\r\n  arrays.forEach((a: any[]) => {\r\n    a.forEach((x: any) => {\r\n      if (newArray.indexOf(x) < 0)\r\n        newArray.push(x);\r\n    });\r\n  });\r\n  return newArray;\r\n}\r\n\r\n/**\r\n * Return unique values in array of strings.\r\n *\r\n * http://stackoverflow.com/questions/1960473/unique-values-in-an-array\r\n */\r\nexport function unique_strings_array(arr: any[]) {\r\n  const a = [];\r\n  for (let i = 0, l = arr.length; i < l; i++) {\r\n    if (a.indexOf(arr[i]) === -1)\r\n      a.push(arr[i]);\r\n  }\r\n  return a;\r\n}\r\n\r\n/**\r\n * Returns a function, that, as long as it continues to be invoked, will not be\r\n * triggered. The function will be called after it stops being called for N\r\n * milliseconds. If \"immediate\" is passed, trigger the function on the leading\r\n * edge, instead of the trailing.\r\n */\r\nexport function debounce(func: Function, wait: number, immediate: boolean) {\r\n  let timeout: any;\r\n  return function() {\r\n    // @ts-ignore\r\n    // eslint-disable-next-line no-invalid-this\r\n    const context = this as any;\r\n    // @ts-ignore\r\n    // eslint-disable-next-line prefer-rest-params\r\n    const args = arguments as any;\r\n    const later = function() {\r\n      timeout = null;\r\n      if (!immediate) func.apply(context, args);\r\n    };\r\n    const callNow = immediate && !timeout;\r\n    clearTimeout(timeout);\r\n    timeout = setTimeout(later, wait);\r\n    if (callNow) func.apply(context, args);\r\n  };\r\n}\r\n\r\n/**\r\n * Return a copy of the object with just the given ids.\r\n * @param {} obj - An object\r\n * @param {} ids - An array of id strings\r\n */\r\nexport function object_slice_for_ids(obj: any, ids: string[]) {\r\n  const subset: { [key: string]: any } = {};\r\n  let i = -1;\r\n  while (++i < ids.length)\r\n    subset[ids[i]] = clone(obj[ids[i]]);\r\n\r\n  if (ids.length !== Object.keys(subset).length)\r\n    console.warn('did not find correct reaction subset');\r\n\r\n  return subset;\r\n}\r\n\r\n/**\r\n * Return a reference of the object with just the given ids. Faster than\r\n * object_slice_for_ids.\r\n * @param {} obj - An object.\r\n * @param {} ids - An array of id strings.\r\n */\r\nexport function object_slice_for_ids_ref(obj: any, ids: string[]) {\r\n  const subset: { [key: string]: any } = {};\r\n  let i = -1;\r\n  while (++i < ids.length)\r\n    subset[ids[i]] = obj[ids[i]];\r\n\r\n  if (ids.length !== Object.keys(subset).length)\r\n    console.warn('did not find correct reaction subset');\r\n\r\n  return subset;\r\n}\r\n\r\nexport function c_plus_c(coords1: Coord | null | undefined, coords2: Coord | null | undefined) {\r\n  if (coords1 == null || coords2 == null ||\r\n      coords1 === undefined || coords2 === undefined)\r\n    return null;\r\n\r\n  return {\r\n    x: coords1.x + coords2.x,\r\n    y: coords1.y + coords2.y,\r\n  };\r\n}\r\n\r\nexport function c_minus_c(coords1: Coord | null | undefined, coords2: Coord | null | undefined) {\r\n  if (coords1 == null || coords2 == null ||\r\n      coords1 === undefined || coords2 === undefined)\r\n    return null;\r\n\r\n  return {\r\n    x: coords1.x - coords2.x,\r\n    y: coords1.y - coords2.y,\r\n  };\r\n}\r\n\r\nexport function c_times_scalar(coords: Coord, scalar: number) {\r\n  return {\r\n    x: coords.x * scalar,\r\n    y: coords.y * scalar,\r\n  };\r\n}\r\n\r\n/**\r\n * Download JSON file in a blob.\r\n */\r\nexport function download_json(json: any, name: string) {\r\n  // Alert if blob isn't going to work\r\n  _check_filesaver();\r\n\r\n  const j = JSON.stringify(json);\r\n  const blob = new Blob([j], {type: 'application/json'});\r\n  window.saveAs?.(blob, name + '.json');\r\n}\r\n\r\n/**\r\n * Try to load the file as JSON.\r\n * @param {} f - The file path\r\n * @param {} callback - A callback function that accepts arguments: error, data.\r\n * @param {} pre_fn (optional) - A function to call before loading the data.\r\n * @param {} failure_fn (optional) - A function to call if the load fails or is\r\n * aborted.\r\n*/\r\nexport function load_json(f: string, callback: (error: any, d: any) => void, pre_fn: () => void, failure_fn: () => void) {\r\n  // Check for the various File API support\r\n  if (!(window.File && window.FileReader && window.FileList && window.Blob))\r\n    callback('The File APIs are not fully supported in this browser.', null);\r\n\r\n\r\n  const reader = new window.FileReader();\r\n  // Closure to capture the file information.\r\n  reader.onload = function(event: any) {\r\n    const result = event.target.result;\r\n    let data;\r\n    // Try JSON\r\n    try {\r\n      data = JSON.parse(result);\r\n    } catch (e) {\r\n      // If it failed, return the error\r\n      callback(e, null);\r\n      return;\r\n    }\r\n    // If successful, return the data\r\n    callback(null, data);\r\n  };\r\n  if (pre_fn !== undefined && pre_fn !== null)\r\n    try { pre_fn(); } catch (e) { console.warn(e); }\r\n\r\n  reader.onabort = function(event) {\r\n    try { failure_fn(); } catch (e) { console.warn(e); }\r\n  };\r\n  reader.onerror = function(event) {\r\n    try { failure_fn(); } catch (e) { console.warn(e); }\r\n  };\r\n  // Read in the image file as a data URL\r\n  reader.readAsText(new Blob([f]));\r\n}\r\n\r\n/**\r\n * Try to load the file as JSON or CSV (JSON first).\r\n * @param {String} f - The file path\r\n * @param {Function}  csv_converter - A function to convert the CSV output to equivalent JSON.\r\n * @param {Function} callback - A callback function that accepts arguments: error, data.\r\n * @param {} pre_fn (optional) - A function to call before loading the data.\r\n * @param {} failure_fn (optional) - A function to call if the load fails or is\r\n * aborted.\r\n * @param {} debug_event (optional) - An event, with a string at\r\n * event.target.result, to load as though it was the contents of a loaded file.\r\n */\r\nexport function load_json_or_csv(f: string | File | Blob, csv_converter: (data: any) => any, callback: (error: any, d: any) => void, pre_fn?: () => void, failure_fn?: () => void,\r\n  debug_event?: any) {\r\n  // Capture the file information.\r\n  const onload_function = function(event: any) {\r\n    const result = event.target.result;\r\n    let data;\r\n    let errors;\r\n    // try JSON\r\n    try {\r\n      data = JSON.parse(result);\r\n    } catch (e) {\r\n      errors = 'JSON error: ' + e;\r\n\r\n      // try csv\r\n      try {\r\n        data = csv_converter(d3_csvParseRows(result));\r\n      } catch (e) {\r\n        // if both failed, return the errors\r\n        callback(errors + '\\nCSV error: ' + e, null);\r\n        return;\r\n      }\r\n    }\r\n    // if successful, return the data\r\n    callback(null, data);\r\n  };\r\n  if (debug_event !== undefined && debug_event !== null) {\r\n    console.warn('Debugging load_json_or_csv');\r\n    return onload_function(debug_event);\r\n  }\r\n\r\n  // Check for the various File API support.\r\n  if (!(window.File && window.FileReader && window.FileList && window.Blob))\r\n    callback('The File APIs are not fully supported in this browser.', null);\r\n  const reader = new window.FileReader();\r\n\r\n  if (pre_fn !== undefined && pre_fn !== null)\r\n    try { pre_fn(); } catch (e) { console.warn(e); }\r\n\r\n  reader.onabort = function(event) {\r\n    try { failure_fn(); } catch (e) { console.warn(e); }\r\n  };\r\n  reader.onerror = function(event) {\r\n    try { failure_fn(); } catch (e) { console.warn(e); }\r\n  };\r\n  // Read in the image file as a data URL.\r\n  reader.onload = onload_function;\r\n  reader.readAsText(new Blob([f]));\r\n}\r\n\r\n/**\r\n * Download an svg file using FileSaver.js.\r\n * @param {String} name - The filename (without extension)\r\n * @param {D3 Selection} svg_sel - The d3 selection for the SVG element\r\n * @param {Boolean} do_beautify - If true, then beautify the SVG output\r\n */\r\nexport function downloadSvg(name: string, svg_sel: D3Selection, do_beautify: boolean) {\r\n  // Alert if blob isn't going to work\r\n  _check_filesaver();\r\n\r\n  // Make the xml string\r\n  let xml = (new XMLSerializer()).serializeToString(svg_sel.node()!);\r\n  if (do_beautify) xml = vkbeautify.xml(xml);\r\n  xml = ('<?xml version=\"1.0\" encoding=\"utf-8\"?>\\n' +\r\n         '<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\\n' +\r\n         ' \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\\n' +\r\n         xml);\r\n\r\n  // Save\r\n  const blob = new Blob([xml], {type: 'image/svg+xml'});\r\n  window.saveAs?.(blob, name + '.svg');\r\n}\r\n\r\n/**\r\n * Download a png file using FileSaver.js.\r\n * @param {String} name - The filename (without extension).\r\n * @param {D3 Selection} svg_sel - The d3 selection for the SVG element.\r\n */\r\nexport function downloadPng(name: string, svg_sel: D3SVGSelection) {\r\n  // Alert if blob isn't going to work\r\n  _check_filesaver();\r\n\r\n  // Make the xml string\r\n  let xml = new XMLSerializer().serializeToString(svg_sel.node()!);\r\n  xml = ('<?xml version=\"1.0\" encoding=\"utf-8\"?>\\n' +\r\n         '<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\\n' +\r\n         ' \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\\n' +\r\n         xml);\r\n\r\n  // Canvas to hold the image\r\n  const canvas = document.createElement('canvas');\r\n  const context = canvas.getContext('2d')!;\r\n\r\n  // Get SVG size\r\n  const svg_size = svg_sel.node()!.getBBox();\r\n  const svg_width = svg_size.width + svg_size.x;\r\n  const svg_height = svg_size.height + svg_size.y;\r\n\r\n  // Canvas size = SVG size. Constrained to 10000px for very large SVGs\r\n  if (svg_width < 10000 && svg_height < 10000) {\r\n    canvas.width = svg_width;\r\n    canvas.height = svg_height;\r\n  } else {\r\n    if (canvas.width > canvas.height) {\r\n      canvas.width = 10000;\r\n      canvas.height = 10000 * (svg_height / svg_width);\r\n    } else {\r\n      canvas.width = 10000 * (svg_width / svg_height);\r\n      canvas.height = 10000;\r\n    }\r\n  }\r\n\r\n  // Image element appended with data\r\n  const base_image = new Image();\r\n  base_image.src = 'data:image/svg+xml;base64,' + btoa(xml);\r\n\r\n  base_image.onload = function() {\r\n    // Draw image to canvas with white background\r\n    context.fillStyle = '#FFF';\r\n    context.fillRect(0, 0, canvas.width, canvas.height);\r\n    context.drawImage(base_image, 0, 0, canvas.width, canvas.height);\r\n\r\n    // Save image\r\n    canvas.toBlob(function(blob: Blob | null) {\r\n      blob && window.saveAs?.(blob, name + '.png');\r\n    });\r\n  };\r\n}\r\n\r\nexport function rotate_coords_recursive(coords_array: Coord[], angle: number, center: Coord) {\r\n  return coords_array.map(function(c) {\r\n    return rotate_coords(c, angle, center);\r\n  });\r\n}\r\n\r\n/**\r\n * Calculates displacement { x: dx, y: dy } based on rotating point c around\r\n * center with angle.\r\n */\r\nexport function rotate_coords(c: Coord, angle: number, center: Coord) {\r\n  const dx = Math.cos(-angle) * (c.x - center.x) +\r\n      Math.sin(-angle) * (c.y - center.y) +\r\n    center.x - c.x;\r\n  const dy = - Math.sin(-angle) * (c.x - center.x) +\r\n    Math.cos(-angle) * (c.y - center.y) +\r\n    center.y - c.y;\r\n  return {x: dx, y: dy};\r\n}\r\n\r\n/**\r\n * Get the angle between coordinates\r\n * @param {Object} coords - Array of 2 coordinate objects { x: 1, y: 1 }\r\n * @return {Number} angle between 0 and 2PI.\r\n */\r\nexport function get_angle(coords: Coord[]) {\r\n  const denominator = coords[1].x - coords[0].x;\r\n  const numerator = coords[1].y - coords[0].y;\r\n  if (denominator === 0 && numerator >= 0)\r\n    return Math.PI / 2;\r\n  else if (denominator === 0 && numerator < 0)\r\n    return 3 * Math.PI / 2;\r\n  else if (denominator >= 0 && numerator >= 0)\r\n    return Math.atan(numerator / denominator);\r\n  else if (denominator >= 0)\r\n    return (Math.atan(numerator / denominator) + 2 * Math.PI);\r\n  else\r\n    return (Math.atan(numerator / denominator) + Math.PI);\r\n}\r\n\r\nexport function to_degrees(radians: number) {\r\n  return radians * 180 / Math.PI;\r\n}\r\n\r\n/**\r\n * Force to domain -PI to PI\r\n */\r\nexport function angleNorm(radians: number) {\r\n  if (radians < -Math.PI)\r\n    return radians + Math.floor((radians - Math.PI) / (-2 * Math.PI)) * 2 * Math.PI;\r\n  else if (radians > Math.PI)\r\n    return radians - Math.floor((radians + Math.PI) / (2 * Math.PI)) * 2 * Math.PI;\r\n  else\r\n    return radians;\r\n}\r\n\r\nexport function to_radians(degrees: number) {\r\n  return Math.PI / 180 * degrees;\r\n}\r\n\r\n/**\r\n * Convert to radians, and force to domain -PI to PI\r\n */\r\nexport function to_radians_norm(degrees: number) {\r\n  const radians = to_radians(degrees);\r\n  return angleNorm(radians);\r\n}\r\n\r\nexport function angle_for_event(displacement: Coord, point: Coord, center: Coord) {\r\n  const gamma = Math.atan2((point.x - center.x), (center.y - point.y));\r\n  const beta = Math.atan2((point.x - center.x + displacement.x),\r\n    (center.y - point.y - displacement.y));\r\n  const angle = beta - gamma;\r\n  return angle;\r\n}\r\n\r\nexport function distance(start: Coord, end: Coord) {\r\n  return Math.sqrt(Math.pow(end.y - start.y, 2) + Math.pow(end.x - start.x, 2));\r\n}\r\n\r\n/**\r\n * Report an error if any of the arguments are undefined. Call by passing in\r\n * \"arguments\" from any function and an array of argument names.\r\n */\r\nexport function check_undefined(args: any[], names: string[]) {\r\n  names.forEach(function(name, i) {\r\n    if (args[i] === undefined)\r\n      console.error(`Argument is undefined: ${names[i]}`);\r\n  });\r\n}\r\n\r\nexport function compartmentalize(bigg_id: string, compartment_id: string) {\r\n  return `${bigg_id}_${compartment_id}`;\r\n}\r\n\r\n/**\r\n * Returns an array of [bigg_id, compartment id]. Matches compartment ids with\r\n * length 1 or 2. Return [ id, null ] if no match is found.\r\n */\r\nexport function decompartmentalize(id: string) {\r\n  const reg = /(.*)_([a-z0-9]{1,2})$/;\r\n  const result = reg.exec(id);\r\n  return result !== null ? result.slice(1, 3) : [id, null];\r\n}\r\n\r\nexport function mean(array: number[]) {\r\n  const sum = array.reduce(function(a, b) { return a + b; });\r\n  const avg = sum / array.length;\r\n  return avg;\r\n}\r\n\r\nexport function median(array: number[]) {\r\n  array.sort(function(a, b) { return a - b; });\r\n  const half = Math.floor(array.length / 2);\r\n  if (array.length % 2 == 1)\r\n    return array[half];\r\n  else\r\n    return (array[half - 1] + array[half]) / 2.0;\r\n}\r\n\r\nexport function quartiles(array: number[]) {\r\n  array.sort(function(a, b) { return a - b; });\r\n  const half = Math.floor(array.length / 2);\r\n  if (array.length === 1) {\r\n    return [\r\n      array[0],\r\n      array[0],\r\n      array[0],\r\n    ];\r\n  } else if (array.length % 2 === 1) {\r\n    return [\r\n      median(array.slice(0, half)),\r\n      array[half],\r\n      median(array.slice(half + 1)),\r\n    ];\r\n  } else {\r\n    return [\r\n      median(array.slice(0, half)),\r\n      (array[half - 1] + array[half]) / 2.0,\r\n      median(array.slice(half)),\r\n    ];\r\n  }\r\n}\r\n\r\n/**\r\n * Generate random characters\r\n *\r\n * Thanks to @csharptest.net\r\n * http://stackoverflow.com/questions/1349404/generate-a-string-of-5-random-characters-in-javascript\r\n */\r\nexport function random_characters(num: number) {\r\n  let text = '';\r\n  const possible = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\r\n  for (let i = 0; i < num; i++)\r\n    text += possible.charAt(Math.floor(Math.random() * possible.length));\r\n\r\n  return text;\r\n}\r\n\r\nexport function generate_map_id() {\r\n  return random_characters(12);\r\n}\r\n\r\n/**\r\n * Check that the selection has the given parent tag.\r\n * @param {D3 Selection|DOM Node} el - A D3 Selection or DOM Node to check.\r\n * @param {String} tag - A tag name (case insensitive).\r\n */\r\nexport function check_for_parent_tag(el: D3Selection | Element, tag: string) {\r\n  // make sure it is a node\r\n  if (!(el instanceof Element))\r\n    el = el.node()!;\r\n\r\n  while (el.parentNode != null) {\r\n    el = el.parentNode as Element;\r\n    if (el.tagName == undefined)\r\n      continue;\r\n\r\n    if (el.tagName.toLowerCase() === tag.toLowerCase())\r\n      return true;\r\n  }\r\n  return false;\r\n}\r\n\r\n/**\r\n * Convert model or map name to url.\r\n * @param {String} name - The short name, e.g. e_coli.iJO1366.central_metabolism.\r\n * @param {String} download_url (optional) - The url to prepend.\r\n */\r\nexport function name_to_url(name: string, download_url: string | null | undefined) {\r\n  if (download_url !== undefined && download_url !== null) {\r\n    // strip download_url\r\n    download_url = download_url.replace(/^\\/|\\/$/g, '');\r\n    name = [download_url, name].join('/');\r\n  }\r\n  // strip final path\r\n  return name.replace(/^\\/|\\/$/g, '') + '.json';\r\n}\r\n\r\n/**\r\n * Get the document for the node\r\n */\r\nexport function get_document(node: Element) {\r\n  return node.ownerDocument;\r\n}\r\n\r\n/**\r\n * Get the window for the node\r\n */\r\nexport function get_window(node: Element) {\r\n  return get_document(node).defaultView;\r\n}\r\n\r\n/**\r\n * Get translation and rotation values for a transform string. This used to be\r\n * in d3, but since v4, I just adapted a solution from SO:\r\n *\r\n * http://stackoverflow.com/questions/38224875/replacing-d3-transform-in-d3-v4\r\n *\r\n * To get skew and scale out, go back to that example.\r\n *\r\n * TODO rename function without \"catch\"\r\n *\r\n * @param {String} transform_attr - A transform string.\r\n */\r\nexport function d3_transform_catch(transform_attr: string) {\r\n  if (transform_attr.indexOf('skew') !== -1 ||\r\n      transform_attr.indexOf('matrix') !== -1)\r\n    throw new Error('d3_transform_catch does not work with skew or matrix');\r\n\r\n\r\n  const translate_res = (/translate\\s*\\(\\s*([0-9.-]+)\\s*,\\s*([0-9.-]+)\\s*\\)/\r\n    .exec(transform_attr));\r\n  const tn = _.isNull(translate_res);\r\n  const tx = tn ? 0.0 : Number(translate_res[1]);\r\n  const ty = tn ? 0.0 : Number(translate_res[2]);\r\n\r\n  const rotate_res = (/rotate\\s*\\(\\s*([0-9.-]+)\\s*\\)/\r\n    .exec(transform_attr));\r\n  const rn = _.isNull(rotate_res);\r\n  const r = rn ? 0.0 : Number(rotate_res[1]);\r\n\r\n  const scale_res = (/scale\\s*\\(\\s*([0-9.-]+)\\s*\\)/\r\n    .exec(transform_attr));\r\n  const sn = _.isNull(scale_res);\r\n  const s = sn ? 0.0 : Number(scale_res[1]);\r\n\r\n  return {translate: [tx, ty], rotate: r, scale: s,};\r\n\r\n  // // Create a dummy g for calculation purposes only. This will new be appended\r\n  // // to the DOM and will be discarded once this function returns.\r\n  // var g = document.createElementNS('http://www.w3.org/2000/svg', 'g')\r\n\r\n  // // Set the transform attribute to the provided string value.\r\n  // g.setAttributeNS(null, 'transform', transform_attr)\r\n\r\n  // // Consolidate the SVGTransformList containing all Try to a single\r\n  // // SVGTransform of type SVG_TRANSFORM_MATRIX and get its SVGMatrix.\r\n\r\n  // var matrix = g.transform.baseVal.consolidate().matrix\r\n\r\n  // // Below calculations are taken and adapted from the private func\r\n  // // transform/decompose.js of D3's module d3-interpolate.\r\n  // var a = matrix.a\r\n  // var b = matrix.b\r\n  // var c = matrix.c\r\n  // var d = matrix.d\r\n  // var e = matrix.e\r\n  // var f = matrix.f\r\n  // var scaleX = Math.sqrt(a * a + b * b)\r\n\r\n  // if (scaleX) {\r\n  //   a /= scaleX\r\n  //   b /= scaleX\r\n  // }\r\n\r\n  // if (a * d < b * c) {\r\n  //   a = -a\r\n  //   b = -b\r\n  // }\r\n\r\n  // return {\r\n  //   translate: [ e, f ],\r\n  //   rotate: Math.atan2(b, a) * Math.PI / 180,\r\n  // }\r\n}\r\n\r\n/**\r\n * Look for name in the user agent string.\r\n */\r\n// function check_browser (name) {\r\n//   var browser = function() {\r\n//     // Thanks to\r\n//     // http://stackoverflow.com/questions/2400935/browser-detection-in-javascript\r\n//     var ua = navigator.userAgent\r\n//     var M = ua.match(/(opera|chrome|safari|firefox|msie|trident(?=\\/))\\/?\\s*(\\d+)/i) || []\r\n//     var tem\r\n//     if (/trident/i.test(M[1])) {\r\n//       tem = /\\brv[ :]+(\\d+)/g.exec(ua) || []\r\n//       return 'IE '+ (tem[1] || '')\r\n//     }\r\n//     if (M[1] === 'Chrome') {\r\n//       tem = ua.match(/\\b(OPR|Edge)\\/(\\d+)/)\r\n//       if (tem != null) return tem.slice(1).join(' ').replace('OPR', 'Opera')\r\n//     }\r\n//     M = M[2] ? [ M[1], M[2] ]: [ navigator.appName, navigator.appVersion, '-?' ]\r\n//     if ((tem = ua.match(/version\\/(\\d+)/i)) !== null) {\r\n//       M.splice(1, 1, tem[1])\r\n//     }\r\n//     return M.join(' ')\r\n//   }\r\n\r\n//   try {\r\n//     // navigator.userAgent is deprecated, so don't count on it\r\n//     return browser().toLowerCase().indexOf(name) > -1\r\n//   } catch (e) {\r\n//     return false\r\n//   }\r\n// }\r\n","/* eslint-disable no-invalid-this */\r\n/* eslint-disable camelcase */\r\n/**\r\n * PlacedDiv. A container to position an html div to match the coordinates of a\r\n * SVG element.\r\n */\r\nimport {EscherMap} from './escherMap';\r\nimport {Coord, D3Selection} from './types';\r\nimport * as utils from './utils';\r\n\r\n\r\nexport default class PlacedDiv {\r\n  private div!: D3Selection;\r\n  private map!: EscherMap;\r\n  private displacement!: {x: number, y: number};\r\n  private shouldReposition!: boolean;\r\n  private visible!: boolean;\r\n\r\n  constructor(div: D3Selection<any>, map: EscherMap, displacement = {x: 0, y: 0}, shouldReposition = true) {\r\n    this.div = div;\r\n\r\n    this.map = map;\r\n\r\n    this.displacement = displacement;\r\n\r\n    this.shouldReposition = shouldReposition;\r\n    // begin hidden\r\n\r\n    this.visible = true;\r\n\r\n    this.hide();\r\n  }\r\n\r\n  is_visible(): boolean {\r\n    return this.visible;\r\n  }\r\n\r\n  /**\r\n   * Position the html div to match the given SVG coordinates.\r\n   */\r\n  place(coords: Coord) {\r\n    // show the input\r\n\r\n    this.div.style('display', null);\r\n\r\n    // move the new input\r\n\r\n    const window_translate = this.map.zoomContainer.windowTranslate;\r\n\r\n    const window_scale = this.map.zoomContainer.windowScale;\r\n\r\n    const map_size = this.map.get_size();\r\n\r\n    /**\r\n     * If shouldReposition is true, the div is placed so that it does not render\r\n     * outside of the viewable area of the window. Math.max is used so that it\r\n     * does not overflow to the left and top, Math.min is used so that it does not\r\n     * overflow to the right or bottom. If the screen is tool small to show the\r\n     * entire div, the div will overflow to the right and bottom.\r\n     */\r\n\r\n    if (this.shouldReposition) {\r\n      const left = Math.max(20,\r\n        Math.min(map_size.width - 270,\r\n          (window_scale * coords.x + window_translate.x -\r\n\r\n                                  this.displacement.x)));\r\n      const top = Math.max(20,\r\n        Math.min(map_size.height - 40,\r\n          (window_scale * coords.y + window_translate.y -\r\n\r\n                                  this.displacement.y)));\r\n\r\n      this.div.style('position', 'absolute')\r\n\r\n        .style('display', 'block')\r\n\r\n        .style('left', `${left}px`)\r\n\r\n        .style('top', `${top}px`);\r\n    } else {\r\n      this.div.style('position', 'absolute')\r\n        .style('display', 'block')\r\n\r\n        .style('left', `${window_scale * coords.x + window_translate.x - this.displacement.x}px`)\r\n\r\n        .style('top', `${window_scale * coords.y + window_translate.y - this.displacement.y}px`);\r\n    }\r\n\r\n    this.visible = true;\r\n  }\r\n\r\n  /**\r\n   * Hide the PlacedDiv.\r\n   */\r\n  hide() {\r\n    if (this.visible) {\r\n      this.div.style('display', 'none');\r\n\r\n      this.visible = false;\r\n    }\r\n  }\r\n}\r\n","/* eslint-disable no-invalid-this */\r\n/* eslint-disable camelcase */\r\n/**\r\n * @license\r\n *\r\n * complete.ly 1.0.0\r\n * MIT Licensing\r\n * Copyright (c) 2013 Lorenzo Puccetti\r\n *\r\n * This Software shall be used for doing good things, not bad things.\r\n *\r\n *\r\n * Modified by Zachary King (c) 2014.\r\n *\r\n **/\r\n\r\nimport * as utils from './utils';\r\n\r\nexport default function completely(container: HTMLElement, config: any) {\r\n  const thisDocument = utils.get_document(container);\r\n  const thisWindow = utils.get_window(container)!;\r\n\r\n  config = config || {};\r\n  config.fontSize = config.fontSize || '13px';\r\n  config.fontFamily = config.fontFamily || 'sans-serif';\r\n  config.promptInnerHTML = config.promptInnerHTML || '';\r\n  config.color = config.color || '#333';\r\n  config.hintColor = config.hintColor || '#aaa';\r\n  config.backgroundColor = config.backgroundColor || '#fff';\r\n  config.dropDownBorderColor = config.dropDownBorderColor || '#aaa';\r\n  config.dropDownZIndex = config.dropDownZIndex || '100'; // to ensure we are in front of everybody\r\n  config.dropDownOnHoverBackgroundColor = config.dropDownOnHoverBackgroundColor || '#ddd';\r\n\r\n  const txtInput = thisDocument.createElement('input');\r\n  txtInput.type = 'text';\r\n  txtInput.spellcheck = false;\r\n  txtInput.style.fontSize = config.fontSize;\r\n  txtInput.style.fontFamily = config.fontFamily;\r\n  txtInput.style.color = config.color;\r\n  txtInput.style.backgroundColor = config.backgroundColor;\r\n  txtInput.style.width = '100%';\r\n  txtInput.style.outline = '0';\r\n  txtInput.style.border = '0';\r\n  txtInput.style.margin = '0';\r\n  txtInput.style.padding = '0';\r\n\r\n  const txtHint = txtInput.cloneNode() as HTMLElement;\r\n  // @ts-ignore\r\n  txtHint.disabled = '';\r\n  txtHint.style.position = 'absolute';\r\n  txtHint.style.top = '0';\r\n  txtHint.style.left = '0';\r\n  txtHint.style.borderColor = 'transparent';\r\n  txtHint.style.boxShadow = 'none';\r\n  txtHint.style.color = config.hintColor;\r\n\r\n  txtInput.style.backgroundColor = 'transparent';\r\n  txtInput.style.verticalAlign = 'top';\r\n  txtInput.style.position = 'relative';\r\n\r\n  const wrapper = thisDocument.createElement('div');\r\n  wrapper.style.position = 'relative';\r\n  wrapper.style.outline = '0';\r\n  wrapper.style.border = '0';\r\n  wrapper.style.margin = '0';\r\n  wrapper.style.padding = '0';\r\n\r\n  const prompt = thisDocument.createElement('div');\r\n  prompt.style.position = 'absolute';\r\n  prompt.style.outline = '0';\r\n  prompt.style.margin = '0';\r\n  prompt.style.padding = '0';\r\n  prompt.style.border = '0';\r\n  prompt.style.fontSize = config.fontSize;\r\n  prompt.style.fontFamily = config.fontFamily;\r\n  prompt.style.color = config.color;\r\n  prompt.style.backgroundColor = config.backgroundColor;\r\n  prompt.style.top = '0';\r\n  prompt.style.left = '0';\r\n  prompt.style.overflow = 'hidden';\r\n  prompt.innerHTML = config.promptInnerHTML;\r\n  prompt.style.background = 'transparent';\r\n  if (thisDocument.body === undefined)\r\n    throw new Error('thisDocument.body is undefined. The library was wired up incorrectly.');\r\n\r\n  thisDocument.body.appendChild(prompt);\r\n  const w = prompt.getBoundingClientRect().right; // works out the width of the prompt.\r\n  wrapper.appendChild(prompt);\r\n  prompt.style.visibility = 'visible';\r\n  prompt.style.left = '-' + w + 'px';\r\n  wrapper.style.marginLeft = w + 'px';\r\n\r\n  wrapper.appendChild(txtHint);\r\n  wrapper.appendChild(txtInput);\r\n\r\n  const dropDown = thisDocument.createElement('div');\r\n  dropDown.style.position = 'absolute';\r\n  dropDown.style.visibility = 'hidden';\r\n  dropDown.style.outline = '0';\r\n  dropDown.style.margin = '0';\r\n  dropDown.style.padding = '0';\r\n  dropDown.style.textAlign = 'left';\r\n  dropDown.style.fontSize = config.fontSize;\r\n  dropDown.style.fontFamily = config.fontFamily;\r\n  dropDown.style.backgroundColor = config.backgroundColor;\r\n  dropDown.style.zIndex = config.dropDownZIndex;\r\n  dropDown.style.cursor = 'default';\r\n  dropDown.style.borderStyle = 'solid';\r\n  dropDown.style.borderWidth = '1px';\r\n  dropDown.style.borderColor = config.dropDownBorderColor;\r\n  dropDown.style.overflowX = 'hidden';\r\n  dropDown.style.whiteSpace = 'pre';\r\n  dropDown.style.overflowY = 'scroll';\r\n\r\n  const createDropDownController = function(elem: HTMLElement) {\r\n    let rows: HTMLElement[] = [];\r\n    let ix = 0;\r\n    let oldIndex = -1;\r\n    let current_row: HTMLElement | null = null;\r\n\r\n    // @ts-ignore\r\n    const onMouseOver = function() { this.style.outline = '1px solid #ddd'; };\r\n    // @ts-ignore\r\n    const onMouseOut = function() { this.style.outline = '0'; };\r\n    // @ts-ignore\r\n    const onDblClick = function(e) {\r\n      e.preventDefault();\r\n      // @ts-ignore\r\n      p.onmouseselection(this.id);\r\n    };\r\n\r\n    const p = {\r\n      hide: function() { elem.style.visibility = 'hidden'; },\r\n      refresh: function(token: string, options: any) {\r\n        elem.style.visibility = 'hidden';\r\n        ix = 0;\r\n        elem.innerHTML = '';\r\n        const vph = (thisWindow.innerHeight || thisDocument.documentElement.clientHeight);\r\n        const rect = (elem.parentNode as HTMLElement)!.getBoundingClientRect();\r\n        const distanceToTop = rect.top - 6; // heuristic give 6px\r\n        const distanceToBottom = vph - rect.bottom - 6; // distance from the browser border.\r\n\r\n        rows = [];\r\n        for (let i = 0; i < options.length; i++) {\r\n          // ignore case\r\n          const found = options[i].matches.filter(function(match: string) {\r\n            return match.toLowerCase().indexOf(token.toLowerCase()) == 0;\r\n          });\r\n          if (found.length == 0)\r\n            continue;\r\n          const divRow = thisDocument.createElement('div');\r\n          divRow.style.color = config.color;\r\n          divRow.onmouseover = onMouseOver;\r\n          divRow.onmouseout = onMouseOut;\r\n          // prevent selection for double click\r\n          divRow.onmousedown = function(e) { e.preventDefault(); };\r\n          divRow.ondblclick = onDblClick;\r\n          // @ts-ignore\r\n          divRow.__hint = found[0];\r\n          divRow.id = options[i].id;\r\n          divRow.innerHTML = options[i].html;\r\n          rows.push(divRow);\r\n          elem.appendChild(divRow);\r\n          // limit results and add a note at the buttom\r\n          if (rows.length >= rs.display_limit) {\r\n            const divRow2 = thisDocument.createElement('div');\r\n            divRow2.innerHTML = ' ' + (options.length - rows.length) + ' more';\r\n            rows.push(divRow2);\r\n            elem.appendChild(divRow2);\r\n            break;\r\n          }\r\n        }\r\n        if (rows.length === 0)\r\n          return; // nothing to show.\r\n\r\n        p.highlight(0);\r\n\r\n        // Heuristic (only when the distance to the to top is 4\r\n        // times more than distance to the bottom\r\n        if (distanceToTop > distanceToBottom * 3) {\r\n          // we display the dropDown on the top of the input text\r\n          elem.style.maxHeight = distanceToTop + 'px';\r\n          elem.style.top = '';\r\n          elem.style.bottom = '100%';\r\n        } else {\r\n          elem.style.top = '100%';\r\n          elem.style.bottom = '';\r\n          elem.style.maxHeight = distanceToBottom + 'px';\r\n        }\r\n        elem.style.visibility = 'visible';\r\n      },\r\n      highlight: function(index: number) {\r\n        if (oldIndex != -1 && rows[oldIndex])\r\n          rows[oldIndex].style.backgroundColor = config.backgroundColor;\r\n\r\n        rows[index].style.backgroundColor = config.dropDownOnHoverBackgroundColor; // <-- should be config\r\n        oldIndex = index;\r\n        current_row = rows[index];\r\n      },\r\n      // moves the selection either up or down (unless it's not\r\n      // possible) step is either +1 or -1.\r\n      move: function(step: number) {\r\n        // nothing to move if there is no dropDown. (this happens if\r\n        // the user hits escape and then down or up)\r\n        if (elem.style.visibility === 'hidden')\r\n          return '';\r\n        // No circular scrolling\r\n        if (ix + step === -1 || ix + step === rows.length)\r\n          // @ts-ignore\r\n          return rows[ix].__hint;\r\n        ix += step;\r\n        p.highlight(ix);\r\n        // @ts-ignore\r\n        return rows[ix].__hint;\r\n      },\r\n      onmouseselection: function() {},\r\n      get_current_row: function() {\r\n        return current_row;\r\n      }\r\n    };\r\n    return p;\r\n  };\r\n\r\n  const dropDownController = createDropDownController(dropDown);\r\n  // @ts-ignore\r\n  dropDownController.onmouseselection = function(id: string) {\r\n    rs.onEnter(id);\r\n    rs.input.focus();\r\n  };\r\n\r\n  wrapper.appendChild(dropDown);\r\n  container.appendChild(wrapper);\r\n\r\n  let spacer: HTMLElement;\r\n  // This will contain the leftSide part of the textfield (the bit that\r\n  // was already autocompleted)\r\n  let leftSide;\r\n\r\n  function calculateWidthForText(text: string) {\r\n    if (spacer === undefined) { // on first call only.\r\n      spacer = thisDocument.createElement('span');\r\n      spacer.style.visibility = 'hidden';\r\n      spacer.style.position = 'fixed';\r\n      spacer.style.outline = '0';\r\n      spacer.style.margin = '0';\r\n      spacer.style.padding = '0';\r\n      spacer.style.border = '0';\r\n      spacer.style.left = '0';\r\n      spacer.style.whiteSpace = 'pre';\r\n      spacer.style.fontSize = config.fontSize;\r\n      spacer.style.fontFamily = config.fontFamily;\r\n      spacer.style.fontWeight = 'normal';\r\n      thisDocument.body.appendChild(spacer);\r\n    }\r\n\r\n    // Used to encode an HTML string into a plain text.\r\n    // taken from http://stackoverflow.com/questions/1219860/javascript-jquery-html-encoding\r\n    spacer.innerHTML = String(text).replace(/&/g, '&amp;')\r\n      .replace(/\"/g, '&quot;')\r\n      .replace(/'/g, '&#39;')\r\n      .replace(/</g, '&lt;')\r\n      .replace(/>/g, '&gt;');\r\n    return spacer.getBoundingClientRect().right;\r\n  }\r\n\r\n\r\n  const rs = {\r\n    get_hint: function(x: string) { return x; },\r\n    display_limit: 1000,\r\n    onArrowDown: function() {}, // defaults to no action.\r\n    onArrowUp: function() {}, // defaults to no action.\r\n    onEnter: function(id: string) {}, // defaults to no action.\r\n    onTab: function() {}, // defaults to no action.\r\n    onChange: function(txt: string) { rs.repaint(); }, // defaults to repainting.\r\n    startFrom: 0,\r\n    options: [] as any[],\r\n\r\n    // Only to allow easy access to the HTML elements to the final user\r\n    // (possibly for minor customizations)\r\n    wrapper: wrapper,\r\n    input: txtInput,\r\n    hint: txtHint,\r\n    dropDown: dropDown,\r\n\r\n    prompt: prompt,\r\n    setText: function(text: string) {\r\n      // @ts-ignore\r\n      txtHint.value = text;\r\n      txtInput.value = text;\r\n    },\r\n    getText: function() {\r\n      return txtInput.value;\r\n    },\r\n    hideDropDown: function() {\r\n      dropDownController.hide();\r\n    },\r\n    repaint: function() {\r\n      const text = txtInput.value;\r\n      const startFrom = rs.startFrom;\r\n      const options = rs.options;\r\n      const optionsLength = options.length;\r\n\r\n      // breaking text in leftSide and token.\r\n      const token = text.substring(startFrom);\r\n      leftSide = text.substring(0, startFrom);\r\n\r\n      // updating the hint.\r\n      // @ts-ignore\r\n      txtHint.value = '';\r\n      for (let i = 0; i < optionsLength; i++) {\r\n        const found = options[i].matches.filter(function(match: string) {\r\n          return match.toLowerCase().indexOf(token.toLowerCase()) == 0;\r\n        });\r\n        if (found.length == 0)\r\n          continue;\r\n        // @ts-ignore\r\n        txtHint.value = rs.get_hint(found[0]);\r\n        break;\r\n      }\r\n\r\n      // moving the dropDown and refreshing it.\r\n      dropDown.style.left = calculateWidthForText(leftSide) + 'px';\r\n      dropDownController.refresh(token, rs.options);\r\n    }\r\n  };\r\n\r\n  let registerOnTextChangeOldValue: string;\r\n\r\n  // Register a callback function to detect changes to the content of the\r\n  // input-type-text.  Those changes are typically followed by user's\r\n  // action: a key-stroke event but sometimes it might be a mouse click.\r\n  const registerOnTextChange = function(txt: HTMLInputElement, callback: (text: string) => void) {\r\n    registerOnTextChangeOldValue = txt.value;\r\n    const handler = function() {\r\n      const value = txt.value;\r\n      if (registerOnTextChangeOldValue !== value) {\r\n        registerOnTextChangeOldValue = value;\r\n        callback(value);\r\n      }\r\n    };\r\n\r\n    // For user's actions, we listen to both input events and key up events\r\n    // It appears that input events are not enough so we defensively listen to key up events too.\r\n    // source: http://help.dottoro.com/ljhxklln.php\r\n    //\r\n    // The cost of listening to three sources should be negligible as the handler will invoke callback function\r\n    // only if the text.value was effectively changed.\r\n    txt.addEventListener('input', handler, false);\r\n    txt.addEventListener('keyup', handler, false);\r\n    txt.addEventListener('change', handler, false);\r\n  };\r\n\r\n\r\n  registerOnTextChange(txtInput, function(text: string) { // note the function needs to be wrapped as API-users will define their onChange\r\n    rs.onChange(text);\r\n    rs.repaint();\r\n  });\r\n\r\n\r\n  const keyDownHandler = function(e: KeyboardEvent) {\r\n    e = e || thisWindow.event as KeyboardEvent;\r\n    const keyCode = e.keyCode;\r\n\r\n    if (keyCode == 33) return; // page up (do nothing)\r\n    if (keyCode == 34) return; // page down (do nothing);\r\n\r\n    // right,  end, tab  (autocomplete triggered)\r\n    if (keyCode == 39 || keyCode == 35 || keyCode == 9) {\r\n      // for tabs we need to ensure that we override the default\r\n      // behaviour: move to the next focusable HTML-element\r\n      if (keyCode == 9) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        // @ts-ignore\r\n        if (txtHint.value?.length == 0) {\r\n          // tab was called with no action.\r\n          rs.onTab();\r\n        }\r\n      }\r\n      // if there is a hint\r\n      // @ts-ignore\r\n      if (txtHint.value?.length > 0) {\r\n        // @ts-ignore\r\n        txtInput.value = txtHint.value;\r\n        const hasTextChanged = registerOnTextChangeOldValue != txtInput.value;\r\n        // avoid dropDown to appear again\r\n        registerOnTextChangeOldValue = txtInput.value;\r\n        // for example imagine the array contains the following\r\n        // words: bee, beef, beetroot. User has hit enter to get\r\n        // 'bee' it would be prompted with the dropDown again (as\r\n        // beef and beetroot also match)\r\n        if (hasTextChanged) {\r\n          // force it.\r\n          rs.onChange(txtInput.value);\r\n        }\r\n      }\r\n      return;\r\n    }\r\n\r\n    if (keyCode == 13) { // enter\r\n      // get current\r\n      const id = (dropDownController.get_current_row() as HTMLElement).id;\r\n      rs.onEnter(id);\r\n      return;\r\n    }\r\n\r\n    if (keyCode == 40) { // down\r\n      const m = dropDownController.move(+1);\r\n      if (m == '') rs.onArrowDown();\r\n      // @ts-ignore\r\n      txtHint.value = rs.get_hint(m);\r\n      return;\r\n    }\r\n\r\n    if (keyCode == 38 ) { // up\r\n      const m = dropDownController.move(-1);\r\n      if (m == '') rs.onArrowUp();\r\n      // @ts-ignore\r\n      txtHint.value = rs.get_hint(m);\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n      return;\r\n    }\r\n\r\n    // it's important to reset the txtHint on key down. Think: user\r\n    // presses a letter (e.g. 'x') and never releases. You get\r\n    // (xxxxxxxxxxxxxxxxx) and you would see still the hint. Reset the\r\n    // txtHint. (it might be updated onKeyUp).\r\n    // @ts-ignore\r\n    txtHint.value = '';\r\n  };\r\n\r\n  txtInput.addEventListener('keydown', keyDownHandler, false);\r\n  return rs;\r\n};\r\n","import {event} from \"./selection/on\";\n\nexport default function() {\n  var current = event, source;\n  while (source = current.sourceEvent) current = source;\n  return current;\n}\n","export default function(node, event) {\n  var svg = node.ownerSVGElement || node;\n\n  if (svg.createSVGPoint) {\n    var point = svg.createSVGPoint();\n    point.x = event.clientX, point.y = event.clientY;\n    point = point.matrixTransform(node.getScreenCTM().inverse());\n    return [point.x, point.y];\n  }\n\n  var rect = node.getBoundingClientRect();\n  return [event.clientX - rect.left - node.clientLeft, event.clientY - rect.top - node.clientTop];\n}\n","import sourceEvent from \"./sourceEvent\";\nimport point from \"./point\";\n\nexport default function(node) {\n  var event = sourceEvent();\n  if (event.changedTouches) event = event.changedTouches[0];\n  return point(node, event);\n}\n","import sourceEvent from \"./sourceEvent\";\nimport point from \"./point\";\n\nexport default function(node, touches, identifier) {\n  if (arguments.length < 3) identifier = touches, touches = sourceEvent().changedTouches;\n\n  for (var i = 0, n = touches ? touches.length : 0, touch; i < n; ++i) {\n    if ((touch = touches[i]).identifier === identifier) {\n      return point(node, touch);\n    }\n  }\n\n  return null;\n}\n","import {event} from \"d3-selection\";\n\nexport function nopropagation() {\n  event.stopImmediatePropagation();\n}\n\nexport default function() {\n  event.preventDefault();\n  event.stopImmediatePropagation();\n}\n","import {select} from \"d3-selection\";\nimport noevent from \"./noevent.js\";\n\nexport default function(view) {\n  var root = view.document.documentElement,\n      selection = select(view).on(\"dragstart.drag\", noevent, true);\n  if (\"onselectstart\" in root) {\n    selection.on(\"selectstart.drag\", noevent, true);\n  } else {\n    root.__noselect = root.style.MozUserSelect;\n    root.style.MozUserSelect = \"none\";\n  }\n}\n\nexport function yesdrag(view, noclick) {\n  var root = view.document.documentElement,\n      selection = select(view).on(\"dragstart.drag\", null);\n  if (noclick) {\n    selection.on(\"click.drag\", noevent, true);\n    setTimeout(function() { selection.on(\"click.drag\", null); }, 0);\n  }\n  if (\"onselectstart\" in root) {\n    selection.on(\"selectstart.drag\", null);\n  } else {\n    root.style.MozUserSelect = root.__noselect;\n    delete root.__noselect;\n  }\n}\n","export default function(x) {\n  return function() {\n    return x;\n  };\n}\n","export default function DragEvent(target, type, subject, id, active, x, y, dx, dy, dispatch) {\n  this.target = target;\n  this.type = type;\n  this.subject = subject;\n  this.identifier = id;\n  this.active = active;\n  this.x = x;\n  this.y = y;\n  this.dx = dx;\n  this.dy = dy;\n  this._ = dispatch;\n}\n\nDragEvent.prototype.on = function() {\n  var value = this._.on.apply(this._, arguments);\n  return value === this._ ? this : value;\n};\n","import {dispatch} from \"d3-dispatch\";\nimport {event, customEvent, select, mouse, touch} from \"d3-selection\";\nimport nodrag, {yesdrag} from \"./nodrag.js\";\nimport noevent, {nopropagation} from \"./noevent.js\";\nimport constant from \"./constant.js\";\nimport DragEvent from \"./event.js\";\n\n// Ignore right-click, since that should open the context menu.\nfunction defaultFilter() {\n  return !event.ctrlKey && !event.button;\n}\n\nfunction defaultContainer() {\n  return this.parentNode;\n}\n\nfunction defaultSubject(d) {\n  return d == null ? {x: event.x, y: event.y} : d;\n}\n\nfunction defaultTouchable() {\n  return navigator.maxTouchPoints || (\"ontouchstart\" in this);\n}\n\nexport default function() {\n  var filter = defaultFilter,\n      container = defaultContainer,\n      subject = defaultSubject,\n      touchable = defaultTouchable,\n      gestures = {},\n      listeners = dispatch(\"start\", \"drag\", \"end\"),\n      active = 0,\n      mousedownx,\n      mousedowny,\n      mousemoving,\n      touchending,\n      clickDistance2 = 0;\n\n  function drag(selection) {\n    selection\n        .on(\"mousedown.drag\", mousedowned)\n      .filter(touchable)\n        .on(\"touchstart.drag\", touchstarted)\n        .on(\"touchmove.drag\", touchmoved)\n        .on(\"touchend.drag touchcancel.drag\", touchended)\n        .style(\"touch-action\", \"none\")\n        .style(\"-webkit-tap-highlight-color\", \"rgba(0,0,0,0)\");\n  }\n\n  function mousedowned() {\n    if (touchending || !filter.apply(this, arguments)) return;\n    var gesture = beforestart(\"mouse\", container.apply(this, arguments), mouse, this, arguments);\n    if (!gesture) return;\n    select(event.view).on(\"mousemove.drag\", mousemoved, true).on(\"mouseup.drag\", mouseupped, true);\n    nodrag(event.view);\n    nopropagation();\n    mousemoving = false;\n    mousedownx = event.clientX;\n    mousedowny = event.clientY;\n    gesture(\"start\");\n  }\n\n  function mousemoved() {\n    noevent();\n    if (!mousemoving) {\n      var dx = event.clientX - mousedownx, dy = event.clientY - mousedowny;\n      mousemoving = dx * dx + dy * dy > clickDistance2;\n    }\n    gestures.mouse(\"drag\");\n  }\n\n  function mouseupped() {\n    select(event.view).on(\"mousemove.drag mouseup.drag\", null);\n    yesdrag(event.view, mousemoving);\n    noevent();\n    gestures.mouse(\"end\");\n  }\n\n  function touchstarted() {\n    if (!filter.apply(this, arguments)) return;\n    var touches = event.changedTouches,\n        c = container.apply(this, arguments),\n        n = touches.length, i, gesture;\n\n    for (i = 0; i < n; ++i) {\n      if (gesture = beforestart(touches[i].identifier, c, touch, this, arguments)) {\n        nopropagation();\n        gesture(\"start\");\n      }\n    }\n  }\n\n  function touchmoved() {\n    var touches = event.changedTouches,\n        n = touches.length, i, gesture;\n\n    for (i = 0; i < n; ++i) {\n      if (gesture = gestures[touches[i].identifier]) {\n        noevent();\n        gesture(\"drag\");\n      }\n    }\n  }\n\n  function touchended() {\n    var touches = event.changedTouches,\n        n = touches.length, i, gesture;\n\n    if (touchending) clearTimeout(touchending);\n    touchending = setTimeout(function() { touchending = null; }, 500); // Ghost clicks are delayed!\n    for (i = 0; i < n; ++i) {\n      if (gesture = gestures[touches[i].identifier]) {\n        nopropagation();\n        gesture(\"end\");\n      }\n    }\n  }\n\n  function beforestart(id, container, point, that, args) {\n    var p = point(container, id), s, dx, dy,\n        sublisteners = listeners.copy();\n\n    if (!customEvent(new DragEvent(drag, \"beforestart\", s, id, active, p[0], p[1], 0, 0, sublisteners), function() {\n      if ((event.subject = s = subject.apply(that, args)) == null) return false;\n      dx = s.x - p[0] || 0;\n      dy = s.y - p[1] || 0;\n      return true;\n    })) return;\n\n    return function gesture(type) {\n      var p0 = p, n;\n      switch (type) {\n        case \"start\": gestures[id] = gesture, n = active++; break;\n        case \"end\": delete gestures[id], --active; // nobreak\n        case \"drag\": p = point(container, id), n = active; break;\n      }\n      customEvent(new DragEvent(drag, type, s, id, n, p[0] + dx, p[1] + dy, p[0] - p0[0], p[1] - p0[1], sublisteners), sublisteners.apply, sublisteners, [type, that, args]);\n    };\n  }\n\n  drag.filter = function(_) {\n    return arguments.length ? (filter = typeof _ === \"function\" ? _ : constant(!!_), drag) : filter;\n  };\n\n  drag.container = function(_) {\n    return arguments.length ? (container = typeof _ === \"function\" ? _ : constant(_), drag) : container;\n  };\n\n  drag.subject = function(_) {\n    return arguments.length ? (subject = typeof _ === \"function\" ? _ : constant(_), drag) : subject;\n  };\n\n  drag.touchable = function(_) {\n    return arguments.length ? (touchable = typeof _ === \"function\" ? _ : constant(!!_), drag) : touchable;\n  };\n\n  drag.on = function() {\n    var value = listeners.on.apply(listeners, arguments);\n    return value === listeners ? drag : value;\n  };\n\n  drag.clickDistance = function(_) {\n    return arguments.length ? (clickDistance2 = (_ = +_) * _, drag) : Math.sqrt(clickDistance2);\n  };\n\n  return drag;\n}\n","import * as utils from './utils';\r\nimport {drag as d3Drag} from 'd3-drag';\r\n// @ts-ignore\r\nimport {mouse as d3Mouse, event} from 'd3-selection';\r\nimport {Coord, D3Selection} from './types';\r\n\r\n/**\r\n * DirectionArrow. A constructor for an arrow that can be rotated and dragged,\r\n * and supplies its direction.\r\n * @param {D3 Selection} sel - The sel to render the arrow in.\r\n */\r\nexport default class DirectionArrow {\r\n  arrowContainer: D3Selection<any>;\r\n  arrow: D3Selection<any>;\r\n  sel: D3Selection<any>;\r\n  center: {x: number, y: number};\r\n  dragging: boolean;\r\n  isVisible: boolean;\r\n\r\n  constructor(sel: D3Selection) {\r\n    this.arrowContainer = sel.append('g')\r\n      .attr('id', 'direction-arrow-container')\r\n      .attr('transform', 'translate(0,0)rotate(0)');\r\n\r\n    this.arrow = this.arrowContainer.append('path')\r\n      .classed('direction-arrow', true)\r\n      .attr('d', 'M0 -5 L0 5 L20 5 L20 10 L30 0 L20 -10 L20 -5 Z')\r\n      .style('visibility', 'hidden')\r\n      .attr('transform', 'translate(30,0)scale(2.5)');\r\n\r\n    this.sel = sel;\r\n    this.center = {x: 0, y: 0};\r\n\r\n    this._setupDrag();\r\n    this.dragging = false;\r\n\r\n    this.isVisible = false;\r\n    this.show();\r\n  }\r\n\r\n  /**\r\n   * Move the arrow to coords.\r\n   */\r\n  setLocation(coords: Coord) {\r\n    this.center = coords;\r\n    const transform = utils.d3_transform_catch(this.arrowContainer.attr('transform'));\r\n    this.arrowContainer.attr('transform',\r\n      'translate(' + coords.x + ',' + coords.y +\r\n                             ')rotate(' + transform.rotate + ')');\r\n  }\r\n\r\n  /**\r\n   * Rotate the arrow to rotation.\r\n   */\r\n  setRotation(rotation: number) {\r\n    const transform = utils.d3_transform_catch(this.arrowContainer.attr('transform'));\r\n    this.arrowContainer.attr('transform',\r\n      'translate(' + transform.translate + ')rotate(' + rotation + ')');\r\n  }\r\n\r\n  /**\r\n   * Displace the arrow rotation by a set amount.\r\n   */\r\n  displaceRotation(dRotation: number) {\r\n    const transform = utils.d3_transform_catch(this.arrowContainer.attr('transform'));\r\n    this.arrowContainer.attr('transform',\r\n      'translate(' + transform.translate + ')' +\r\n                              'rotate(' + (transform.rotate + dRotation) + ')');\r\n  }\r\n\r\n  /**\r\n   * Returns the arrow rotation.\r\n   */\r\n  getRotation() {\r\n    return utils.d3_transform_catch(this.arrowContainer.attr('transform')).rotate;\r\n  }\r\n\r\n  toggle(onOff: boolean) {\r\n    if (onOff === undefined) this.isVisible = !this.isVisible;\r\n    else this.isVisible = onOff;\r\n    this.arrow.style('visibility', this.isVisible ? 'visible' : 'hidden');\r\n  }\r\n\r\n  show() {\r\n    this.toggle(true);\r\n  }\r\n\r\n  hide() {\r\n    this.toggle(false);\r\n  }\r\n\r\n  right() {\r\n    this.setRotation(0);\r\n  }\r\n\r\n  down() {\r\n    this.setRotation(90);\r\n  }\r\n\r\n  left() {\r\n    this.setRotation(180);\r\n  }\r\n\r\n  up() {\r\n    this.setRotation(270);\r\n  }\r\n\r\n  _setupDrag() {\r\n    const drag = d3Drag()\r\n      .on('start', (d) => {\r\n        // silence other listeners\r\n        event.sourceEvent.stopPropagation();\r\n        this.dragging = true;\r\n      })\r\n      .on('drag', (d) => {\r\n        const displacement = {\r\n          x: event.dx,\r\n          y: event.dy\r\n        };\r\n        const location = {\r\n          x: d3Mouse(this.sel.node())[0],\r\n          y: d3Mouse(this.sel.node())[1]\r\n        };\r\n        const dAngle = utils.angle_for_event(displacement, location,\r\n          this.center);\r\n        this.displaceRotation(utils.to_degrees(dAngle));\r\n      })\r\n      .on('end', (d) => {\r\n        setTimeout(() => { this.dragging = false; }, 200);\r\n      });\r\n    this.arrowContainer.call(drag);\r\n  }\r\n}\r\n","export default function(x) {\n  return Math.abs(x = Math.round(x)) >= 1e21\n      ? x.toLocaleString(\"en\").replace(/,/g, \"\")\n      : x.toString(10);\n}\n\n// Computes the decimal coefficient and exponent of the specified number x with\n// significant digits p, where x is positive and p is in [1, 21] or undefined.\n// For example, formatDecimalParts(1.23) returns [\"123\", 0].\nexport function formatDecimalParts(x, p) {\n  if ((i = (x = p ? x.toExponential(p - 1) : x.toExponential()).indexOf(\"e\")) < 0) return null; // NaN, ±Infinity\n  var i, coefficient = x.slice(0, i);\n\n  // The string returned by toExponential either has the form \\d\\.\\d+e[-+]\\d+\n  // (e.g., 1.2e+3) or the form \\de[-+]\\d+ (e.g., 1e+3).\n  return [\n    coefficient.length > 1 ? coefficient[0] + coefficient.slice(2) : coefficient,\n    +x.slice(i + 1)\n  ];\n}\n","import {formatDecimalParts} from \"./formatDecimal.js\";\n\nexport default function(x) {\n  return x = formatDecimalParts(Math.abs(x)), x ? x[1] : NaN;\n}\n","// [[fill]align][sign][symbol][0][width][,][.precision][~][type]\nvar re = /^(?:(.)?([<>=^]))?([+\\-( ])?([$#])?(0)?(\\d+)?(,)?(\\.\\d+)?(~)?([a-z%])?$/i;\n\nexport default function formatSpecifier(specifier) {\n  if (!(match = re.exec(specifier))) throw new Error(\"invalid format: \" + specifier);\n  var match;\n  return new FormatSpecifier({\n    fill: match[1],\n    align: match[2],\n    sign: match[3],\n    symbol: match[4],\n    zero: match[5],\n    width: match[6],\n    comma: match[7],\n    precision: match[8] && match[8].slice(1),\n    trim: match[9],\n    type: match[10]\n  });\n}\n\nformatSpecifier.prototype = FormatSpecifier.prototype; // instanceof\n\nexport function FormatSpecifier(specifier) {\n  this.fill = specifier.fill === undefined ? \" \" : specifier.fill + \"\";\n  this.align = specifier.align === undefined ? \">\" : specifier.align + \"\";\n  this.sign = specifier.sign === undefined ? \"-\" : specifier.sign + \"\";\n  this.symbol = specifier.symbol === undefined ? \"\" : specifier.symbol + \"\";\n  this.zero = !!specifier.zero;\n  this.width = specifier.width === undefined ? undefined : +specifier.width;\n  this.comma = !!specifier.comma;\n  this.precision = specifier.precision === undefined ? undefined : +specifier.precision;\n  this.trim = !!specifier.trim;\n  this.type = specifier.type === undefined ? \"\" : specifier.type + \"\";\n}\n\nFormatSpecifier.prototype.toString = function() {\n  return this.fill\n      + this.align\n      + this.sign\n      + this.symbol\n      + (this.zero ? \"0\" : \"\")\n      + (this.width === undefined ? \"\" : Math.max(1, this.width | 0))\n      + (this.comma ? \",\" : \"\")\n      + (this.precision === undefined ? \"\" : \".\" + Math.max(0, this.precision | 0))\n      + (this.trim ? \"~\" : \"\")\n      + this.type;\n};\n","import {formatDecimalParts} from \"./formatDecimal.js\";\n\nexport var prefixExponent;\n\nexport default function(x, p) {\n  var d = formatDecimalParts(x, p);\n  if (!d) return x + \"\";\n  var coefficient = d[0],\n      exponent = d[1],\n      i = exponent - (prefixExponent = Math.max(-8, Math.min(8, Math.floor(exponent / 3))) * 3) + 1,\n      n = coefficient.length;\n  return i === n ? coefficient\n      : i > n ? coefficient + new Array(i - n + 1).join(\"0\")\n      : i > 0 ? coefficient.slice(0, i) + \".\" + coefficient.slice(i)\n      : \"0.\" + new Array(1 - i).join(\"0\") + formatDecimalParts(x, Math.max(0, p + i - 1))[0]; // less than 1y!\n}\n","import {formatDecimalParts} from \"./formatDecimal.js\";\n\nexport default function(x, p) {\n  var d = formatDecimalParts(x, p);\n  if (!d) return x + \"\";\n  var coefficient = d[0],\n      exponent = d[1];\n  return exponent < 0 ? \"0.\" + new Array(-exponent).join(\"0\") + coefficient\n      : coefficient.length > exponent + 1 ? coefficient.slice(0, exponent + 1) + \".\" + coefficient.slice(exponent + 1)\n      : coefficient + new Array(exponent - coefficient.length + 2).join(\"0\");\n}\n","import formatDecimal from \"./formatDecimal.js\";\nimport formatPrefixAuto from \"./formatPrefixAuto.js\";\nimport formatRounded from \"./formatRounded.js\";\n\nexport default {\n  \"%\": function(x, p) { return (x * 100).toFixed(p); },\n  \"b\": function(x) { return Math.round(x).toString(2); },\n  \"c\": function(x) { return x + \"\"; },\n  \"d\": formatDecimal,\n  \"e\": function(x, p) { return x.toExponential(p); },\n  \"f\": function(x, p) { return x.toFixed(p); },\n  \"g\": function(x, p) { return x.toPrecision(p); },\n  \"o\": function(x) { return Math.round(x).toString(8); },\n  \"p\": function(x, p) { return formatRounded(x * 100, p); },\n  \"r\": formatRounded,\n  \"s\": formatPrefixAuto,\n  \"X\": function(x) { return Math.round(x).toString(16).toUpperCase(); },\n  \"x\": function(x) { return Math.round(x).toString(16); }\n};\n","export default function(x) {\n  return x;\n}\n","import exponent from \"./exponent.js\";\nimport formatGroup from \"./formatGroup.js\";\nimport formatNumerals from \"./formatNumerals.js\";\nimport formatSpecifier from \"./formatSpecifier.js\";\nimport formatTrim from \"./formatTrim.js\";\nimport formatTypes from \"./formatTypes.js\";\nimport {prefixExponent} from \"./formatPrefixAuto.js\";\nimport identity from \"./identity.js\";\n\nvar map = Array.prototype.map,\n    prefixes = [\"y\",\"z\",\"a\",\"f\",\"p\",\"n\",\"µ\",\"m\",\"\",\"k\",\"M\",\"G\",\"T\",\"P\",\"E\",\"Z\",\"Y\"];\n\nexport default function(locale) {\n  var group = locale.grouping === undefined || locale.thousands === undefined ? identity : formatGroup(map.call(locale.grouping, Number), locale.thousands + \"\"),\n      currencyPrefix = locale.currency === undefined ? \"\" : locale.currency[0] + \"\",\n      currencySuffix = locale.currency === undefined ? \"\" : locale.currency[1] + \"\",\n      decimal = locale.decimal === undefined ? \".\" : locale.decimal + \"\",\n      numerals = locale.numerals === undefined ? identity : formatNumerals(map.call(locale.numerals, String)),\n      percent = locale.percent === undefined ? \"%\" : locale.percent + \"\",\n      minus = locale.minus === undefined ? \"-\" : locale.minus + \"\",\n      nan = locale.nan === undefined ? \"NaN\" : locale.nan + \"\";\n\n  function newFormat(specifier) {\n    specifier = formatSpecifier(specifier);\n\n    var fill = specifier.fill,\n        align = specifier.align,\n        sign = specifier.sign,\n        symbol = specifier.symbol,\n        zero = specifier.zero,\n        width = specifier.width,\n        comma = specifier.comma,\n        precision = specifier.precision,\n        trim = specifier.trim,\n        type = specifier.type;\n\n    // The \"n\" type is an alias for \",g\".\n    if (type === \"n\") comma = true, type = \"g\";\n\n    // The \"\" type, and any invalid type, is an alias for \".12~g\".\n    else if (!formatTypes[type]) precision === undefined && (precision = 12), trim = true, type = \"g\";\n\n    // If zero fill is specified, padding goes after sign and before digits.\n    if (zero || (fill === \"0\" && align === \"=\")) zero = true, fill = \"0\", align = \"=\";\n\n    // Compute the prefix and suffix.\n    // For SI-prefix, the suffix is lazily computed.\n    var prefix = symbol === \"$\" ? currencyPrefix : symbol === \"#\" && /[boxX]/.test(type) ? \"0\" + type.toLowerCase() : \"\",\n        suffix = symbol === \"$\" ? currencySuffix : /[%p]/.test(type) ? percent : \"\";\n\n    // What format function should we use?\n    // Is this an integer type?\n    // Can this type generate exponential notation?\n    var formatType = formatTypes[type],\n        maybeSuffix = /[defgprs%]/.test(type);\n\n    // Set the default precision if not specified,\n    // or clamp the specified precision to the supported range.\n    // For significant precision, it must be in [1, 21].\n    // For fixed precision, it must be in [0, 20].\n    precision = precision === undefined ? 6\n        : /[gprs]/.test(type) ? Math.max(1, Math.min(21, precision))\n        : Math.max(0, Math.min(20, precision));\n\n    function format(value) {\n      var valuePrefix = prefix,\n          valueSuffix = suffix,\n          i, n, c;\n\n      if (type === \"c\") {\n        valueSuffix = formatType(value) + valueSuffix;\n        value = \"\";\n      } else {\n        value = +value;\n\n        // Determine the sign. -0 is not less than 0, but 1 / -0 is!\n        var valueNegative = value < 0 || 1 / value < 0;\n\n        // Perform the initial formatting.\n        value = isNaN(value) ? nan : formatType(Math.abs(value), precision);\n\n        // Trim insignificant zeros.\n        if (trim) value = formatTrim(value);\n\n        // If a negative value rounds to zero after formatting, and no explicit positive sign is requested, hide the sign.\n        if (valueNegative && +value === 0 && sign !== \"+\") valueNegative = false;\n\n        // Compute the prefix and suffix.\n        valuePrefix = (valueNegative ? (sign === \"(\" ? sign : minus) : sign === \"-\" || sign === \"(\" ? \"\" : sign) + valuePrefix;\n        valueSuffix = (type === \"s\" ? prefixes[8 + prefixExponent / 3] : \"\") + valueSuffix + (valueNegative && sign === \"(\" ? \")\" : \"\");\n\n        // Break the formatted value into the integer “value” part that can be\n        // grouped, and fractional or exponential “suffix” part that is not.\n        if (maybeSuffix) {\n          i = -1, n = value.length;\n          while (++i < n) {\n            if (c = value.charCodeAt(i), 48 > c || c > 57) {\n              valueSuffix = (c === 46 ? decimal + value.slice(i + 1) : value.slice(i)) + valueSuffix;\n              value = value.slice(0, i);\n              break;\n            }\n          }\n        }\n      }\n\n      // If the fill character is not \"0\", grouping is applied before padding.\n      if (comma && !zero) value = group(value, Infinity);\n\n      // Compute the padding.\n      var length = valuePrefix.length + value.length + valueSuffix.length,\n          padding = length < width ? new Array(width - length + 1).join(fill) : \"\";\n\n      // If the fill character is \"0\", grouping is applied after padding.\n      if (comma && zero) value = group(padding + value, padding.length ? width - valueSuffix.length : Infinity), padding = \"\";\n\n      // Reconstruct the final output based on the desired alignment.\n      switch (align) {\n        case \"<\": value = valuePrefix + value + valueSuffix + padding; break;\n        case \"=\": value = valuePrefix + padding + value + valueSuffix; break;\n        case \"^\": value = padding.slice(0, length = padding.length >> 1) + valuePrefix + value + valueSuffix + padding.slice(length); break;\n        default: value = padding + valuePrefix + value + valueSuffix; break;\n      }\n\n      return numerals(value);\n    }\n\n    format.toString = function() {\n      return specifier + \"\";\n    };\n\n    return format;\n  }\n\n  function formatPrefix(specifier, value) {\n    var f = newFormat((specifier = formatSpecifier(specifier), specifier.type = \"f\", specifier)),\n        e = Math.max(-8, Math.min(8, Math.floor(exponent(value) / 3))) * 3,\n        k = Math.pow(10, -e),\n        prefix = prefixes[8 + e / 3];\n    return function(value) {\n      return f(k * value) + prefix;\n    };\n  }\n\n  return {\n    format: newFormat,\n    formatPrefix: formatPrefix\n  };\n}\n","import formatLocale from \"./locale.js\";\n\nvar locale;\nexport var format;\nexport var formatPrefix;\n\ndefaultLocale({\n  decimal: \".\",\n  thousands: \",\",\n  grouping: [3],\n  currency: [\"$\", \"\"],\n  minus: \"-\"\n});\n\nexport default function defaultLocale(definition) {\n  locale = formatLocale(definition);\n  format = locale.format;\n  formatPrefix = locale.formatPrefix;\n  return locale;\n}\n","export default function(grouping, thousands) {\n  return function(value, width) {\n    var i = value.length,\n        t = [],\n        j = 0,\n        g = grouping[0],\n        length = 0;\n\n    while (i > 0 && g > 0) {\n      if (length + g + 1 > width) g = Math.max(1, width - length);\n      t.push(value.substring(i -= g, i + g));\n      if ((length += g + 1) > width) break;\n      g = grouping[j = (j + 1) % grouping.length];\n    }\n\n    return t.reverse().join(thousands);\n  };\n}\n","export default function(numerals) {\n  return function(value) {\n    return value.replace(/[0-9]/g, function(i) {\n      return numerals[+i];\n    });\n  };\n}\n","// Trims insignificant zeros, e.g., replaces 1.2000k with 1.2k.\nexport default function(s) {\n  out: for (var n = s.length, i = 1, i0 = -1, i1; i < n; ++i) {\n    switch (s[i]) {\n      case \".\": i0 = i1 = i; break;\n      case \"0\": if (i0 === 0) i0 = i; i1 = i; break;\n      default: if (!+s[i]) break out; if (i0 > 0) i0 = 0; break;\n    }\n  }\n  return i0 > 0 ? s.slice(0, i0) + s.slice(i1 + 1) : s;\n}\n","/* eslint-disable camelcase */\r\nimport * as utils from './utils';\r\nimport _ from 'underscore';\r\nimport {format as d3Format} from 'd3-format';\r\nimport {MapNode, MapReaction} from './types';\r\n\r\n// globals\r\nconst RETURN_ARG = <T>(x: T) => x;\r\nconst ESCAPE_REG = /([.*+?^=!:${}()|[\\]/\\\\])/g;\r\nconst EMPTY_LINES = /\\n\\s*\\n/g;\r\nconst TRAILING_NEWLINE = /\\n\\s*(\\)*)\\s*$/;\r\nconst AND_OR = /([() ])(?:and|or)([)( ])/ig;\r\nconst ALL_PARENS = /[()]/g;\r\n// capture an expression surrounded by whitespace and a set of parentheses\r\nconst EXCESS_PARENS = /\\(\\s*(\\S+)\\s*\\)/g;\r\nconst OR = /\\s+or\\s+/i;\r\nconst AND = /\\s+and\\s+/i;\r\n// find ORs\r\nconst OR_EXPRESSION = /(^|\\()(\\s*-?[0-9.]+\\s+(?:or\\s+-?[0-9.]+\\s*)+)(\\)|$)/ig;\r\n// find ANDS, respecting order of operations (and before or)\r\nconst AND_EXPRESSION = /(^|\\(|or\\s)(\\s*-?[0-9.]+\\s+(?:and\\s+-?[0-9.]+\\s*)+)(\\sor|\\)|$)/ig;\r\n\r\nfunction parseFloatOrNull(x: string | number | null) {\r\n  // strict number casting\r\n  const f = Number(x);\r\n  // check for null and '', which haven't been caught yet\r\n  return (x == null || isNaN(f) || parseFloat(typeof x === 'string' ? x : String(x)) !== f) ? null : f;\r\n}\r\n\r\nfunction alignGeneDataToReactions(data: { [key: string]: any[] }, reactions: { [key: string]: any }) {\r\n  const aligned: { [key: string]: { [key: string]: any[] } } = {};\r\n  let nullVal = [null];\r\n  // make an array of nulls as the default\r\n  for (const firstGeneId in data) {\r\n    nullVal = data[firstGeneId].map(() => null);\r\n    break;\r\n  }\r\n  for (const reactionId in reactions) {\r\n    const reaction = reactions[reactionId];\r\n    const biggId = reaction.bigg_id;\r\n    const thisGeneData: { [key: string]: any[] } = {};\r\n\r\n    reaction.genes.forEach((gene: {bigg_id: string, name: string}) => {\r\n      // check both gene id and gene name\r\n      // @ts-ignore\r\n      ;['bigg_id', 'name'].forEach((kind: keyof typeof gene) => {\r\n        const d = data[gene[kind]] || utils.clone(nullVal);\r\n        // merger with existing data if present\r\n        const existingD = thisGeneData[gene.bigg_id];\r\n        if (existingD === undefined)\r\n          thisGeneData[gene.bigg_id] = d;\r\n        else {\r\n          for (let i = 0; i < d.length; i++) {\r\n            const pnt = d[i];\r\n            if (pnt !== null)\r\n              existingD[i] = pnt;\r\n          }\r\n        }\r\n      });\r\n    });\r\n    aligned[biggId] = thisGeneData;\r\n  }\r\n  return aligned;\r\n}\r\n\r\nfunction checkFinite(x: number | null) {\r\n  return x != null && isFinite(x) ? x : null;\r\n}\r\n\r\nfunction abs(x: number, takeAbs: boolean) {\r\n  return takeAbs ? Math.abs(x) : x;\r\n}\r\n\r\nfunction diff(x: number, y: number, takeAbs: boolean) {\r\n  if (takeAbs) return Math.abs(y - x);\r\n  else return y - x;\r\n}\r\n\r\nfunction fold(x: number, y: number, takeAbs: boolean) {\r\n  if (x === 0 || y === 0) return null;\r\n  const fold = (y >= x ? y / x : -x / y);\r\n  return takeAbs ? Math.abs(fold) : fold;\r\n}\r\n\r\nfunction log2Fold(x: number, y: number, takeAbs: boolean) {\r\n  if (x === 0) return null;\r\n  if (y / x < 0) return null;\r\n  const log = Math.log(y / x) / Math.log(2);\r\n  return takeAbs ? Math.abs(log) : log;\r\n}\r\n\r\n/**\r\n * Convert imported data to a style that can be applied to reactions and nodes.\r\n * @param data - The data object.\r\n * @param name - Either 'reaction_data', 'metabolite_data', or 'gene_data'\r\n * @param allReactions - Required for name == 'gene_data'. Must include all GPRs\r\n *                       for the map and model.\r\n */\r\nexport function importAndCheck(data: any, name: string, allReactions?: any) {\r\n  // check arguments\r\n  if (!data) return null;\r\n\r\n  if (['reaction_data', 'metabolite_data', 'gene_data'].indexOf(name) === -1)\r\n    throw new Error('Invalid name argument: ' + name);\r\n\r\n\r\n  // make array\r\n  if (!(data instanceof Array))\r\n    data = [data];\r\n\r\n  // check data\r\n  const check = function() {\r\n    if (data == null)\r\n      return null;\r\n\r\n    if (data.length === 1)\r\n      return null;\r\n\r\n    if (data.length === 2)\r\n      return null;\r\n\r\n    return console.warn('Bad data style: ' + name);\r\n  };\r\n  check();\r\n  data = utils.arrayToObject(data);\r\n\r\n  if (name === 'gene_data') {\r\n    if (allReactions === undefined)\r\n      throw new Error('Must pass all_reactions argument for gene_data');\r\n\r\n    data = alignGeneDataToReactions(data, allReactions);\r\n  }\r\n\r\n  return data;\r\n}\r\n\r\nexport function floatForData(d: (number |string| null)[], styles: any, compareStyle: any) {\r\n  // all null\r\n  if (d == null) return null;\r\n\r\n  // absolute value\r\n  const takeAbs = styles.indexOf('abs') !== -1;\r\n\r\n  if (d.length === 1) { // 1 set\r\n    // 1 null\r\n    const f = parseFloatOrNull(d[0]);\r\n    if (f == null) return null;\r\n    return abs(f, takeAbs);\r\n  } else if (d.length === 2) { // 2 sets\r\n    // 2 null\r\n    const fs = d.map(parseFloatOrNull) as (number)[];\r\n    if (fs[0] == null || fs[1] == null) return null;\r\n\r\n    if (compareStyle === 'diff')\r\n      return diff(fs[0], fs[1], takeAbs);\r\n    else if (compareStyle === 'fold')\r\n      return checkFinite(fold(fs[0], fs[1], takeAbs));\r\n    else if (compareStyle === 'log2_fold')\r\n      return checkFinite(log2Fold(fs[0], fs[1], takeAbs));\r\n  } else\r\n    throw new Error('Data array must be of length 1 or 2');\r\n\r\n  throw new Error('Bad data compare_style: ' + compareStyle);\r\n}\r\n\r\nexport function reverse_flux_for_data(d: (number | string | null)[]) {\r\n  if (d == null || d[0] == null)\r\n    return false;\r\n\r\n  return (typeof d[0] === 'number' && d[0] < 0) || (typeof d[0] === 'string' && Number(d[0]) < 0);\r\n}\r\n\r\n/**\r\n * Add gene values to the gene_reaction_rule string.\r\n * @param {String} rule - The gene reaction rule.\r\n * @param {} gene_values - The values.\r\n * @param {} genes - An array of objects specifying the gene bigg_id and name.\r\n * @param {} styles - The reaction styles.\r\n * @param {String} identifiers_on_map - The type of identifiers ('bigg_id' or 'name').\r\n * @param {} compare_style - The comparison style.\r\n *\r\n * @return {Array} A list of objects with:\r\n *\r\n * {\r\n *    bigg_id: The bigg ID.\r\n *    name: The name.\r\n *    text: The new string with formatted data values.\r\n * }\r\n *\r\n * The text elements should each appear on a new line.\r\n */\r\nexport function gene_string_for_data(rule: string, gene_values: { [key: string]: (number | string | null)[] } | null, genes: { bigg_id: string, name: string }[], styles: any,\r\n  identifiers_on_map: string, compare_style?: string | null) {\r\n  let out_text = rule;\r\n  const no_data = (gene_values == null);\r\n  // keep track of bigg_ids to remove repeats\r\n  const genes_found: { [key: string]: boolean } = {};\r\n\r\n  genes.forEach(function(g_obj) {\r\n    const bigg_id = g_obj.bigg_id;\r\n\r\n    // ignore repeats that may have found their way into the genes object\r\n    if (bigg_id in genes_found) return;\r\n    genes_found[bigg_id] = true;\r\n\r\n    // generate the string\r\n    if (no_data)\r\n      out_text = replace_gene_in_rule(out_text, bigg_id, bigg_id + '\\n');\r\n    else {\r\n      if (!(bigg_id in gene_values))\r\n        return;\r\n      const d = gene_values[bigg_id];\r\n      const f = floatForData(d, styles, compare_style);\r\n      const format = (f == null ? RETURN_ARG : d3Format('.3g'));\r\n      if (d.length === 1) {\r\n        out_text = replace_gene_in_rule(out_text, bigg_id,\r\n          bigg_id + ' (' + null_or_d(d[0], format) + ')\\n');\r\n      } else if (d.length === 2) {\r\n        let new_str;\r\n        // check if they are all text\r\n        const any_num = _.any(d, function(x) {\r\n          return parseFloatOrNull(x) !== null;\r\n        });\r\n        if (any_num) {\r\n          new_str = (bigg_id + ' (' +\r\n                     null_or_d(d[0], format) + ', ' +\r\n                     null_or_d(d[1], format) + ': ' +\r\n                     null_or_d(f, format) +\r\n                     ')\\n');\r\n        } else {\r\n          new_str = (bigg_id + ' (' +\r\n                     null_or_d(d[0], format) + ', ' +\r\n                     null_or_d(d[1], format) + ')\\n');\r\n        }\r\n        out_text = replace_gene_in_rule(out_text, bigg_id, new_str);\r\n      }\r\n    }\r\n  });\r\n  out_text = (out_text\r\n  // remove empty lines\r\n    .replace(EMPTY_LINES, '\\n')\r\n  // remove trailing newline (with or without parens)\r\n    .replace(TRAILING_NEWLINE, '$1'));\r\n\r\n  // split by newlines, and switch to names if necessary\r\n  const result = out_text.split('\\n').map(function(text) {\r\n    for (let i = 0, l = genes.length; i < l; i++) {\r\n      const gene = genes[i];\r\n      if (text.indexOf(gene.bigg_id) !== -1) {\r\n        // replace with names\r\n        if (identifiers_on_map === 'name')\r\n          text = replace_gene_in_rule(text, gene.bigg_id, gene.name);\r\n        return {bigg_id: gene.bigg_id, name: gene.name, text: text};\r\n      }\r\n    }\r\n    // not found, then none\r\n    return {bigg_id: null, name: null, text: text};\r\n  });\r\n  return result;\r\n}\r\n\r\n// definitions\r\nfunction null_or_d(d: any, format: (d: any) => string) {\r\n  return d == null ? 'nd' : format(d);\r\n}\r\n\r\nexport function text_for_data(d: (number | string | null)[], f: string | null | number) {\r\n  if (d == null)\r\n    return null_or_d(null, () => '');\r\n\r\n  if (d.length === 1) {\r\n    const format = (f == null ? RETURN_ARG : d3Format('.3g'));\r\n    return null_or_d(d[0], format);\r\n  }\r\n  if (d.length === 2) {\r\n    const format = (f == null ? RETURN_ARG : d3Format('.3g'));\r\n    let t = null_or_d(d[0], format);\r\n    t += ', ' + null_or_d(d[1], format);\r\n    t += ': ' + null_or_d(f, format);\r\n    return t;\r\n  }\r\n  return '';\r\n}\r\n\r\nexport function csv_converter(csv_rows: string[][]) {\r\n  /** Convert data from a csv file to json-style data.\r\n\r\n      File must include a header row.\r\n\r\n  */\r\n  // count rows\r\n  const c = csv_rows[0].length;\r\n  const converted: { [key: string]: any }[] = [];\r\n  if (c < 2 || c > 3)\r\n    throw new Error('CSV file must have 2 or 3 columns');\r\n  // set up rows\r\n  for (let i = 1; i < c; i++)\r\n    converted[i - 1] = {};\r\n\r\n  // fill\r\n  csv_rows.slice(1).forEach(function(row) {\r\n    for (let i = 1, l = row.length; i < l; i++)\r\n      converted[i - 1][row[0]] = row[i];\r\n  });\r\n  return converted;\r\n}\r\n\r\nexport function genes_for_gene_reaction_rule(rule: string) {\r\n  /** Find unique genes in gene_reaction_rule string.\r\n\r\n      Arguments\r\n      ---------\r\n\r\n      rule: A boolean string containing gene names, parentheses, AND's and\r\n      OR's.\r\n\r\n      Returns\r\n      -------\r\n\r\n      An array of gene strings.\r\n\r\n  */\r\n  const genes = rule\r\n  // remove ANDs and ORs, surrounded by space or parentheses\r\n    .replace(AND_OR, '$1$2')\r\n  // remove parentheses\r\n    .replace(ALL_PARENS, '')\r\n  // split on whitespace\r\n    .split(' ')\r\n    .filter(function(x) { return x != ''; });\r\n  // unique strings\r\n  return utils.unique_strings_array(genes);\r\n}\r\n\r\nexport function evaluate_gene_reaction_rule(rule: string, gene_values: { [key: string]: (number | string | null)[] }, and_method_in_gene_reaction_rule: string) {\r\n  /** Return a value given the rule and gene_values object.\r\n\r\n      Arguments\r\n      ---------\r\n\r\n      rule: A boolean string containing gene names, parentheses, AND's and\r\n      OR's.\r\n\r\n      gene_values: Object with gene_ids for keys and numbers for values.\r\n\r\n      and_method_in_gene_reaction_rule: Either 'mean' or 'min'.\r\n\r\n  */\r\n\r\n  let null_val = [null];\r\n  let l = 1;\r\n  // make an array of nulls as the default\r\n  for (const gene_id in gene_values) {\r\n    null_val = gene_values[gene_id].map(function() { return null; });\r\n    l = null_val.length;\r\n    break;\r\n  }\r\n\r\n  if (rule == '') return utils.clone(null_val);\r\n\r\n  // for each element in the arrays\r\n  const out = [];\r\n  for (let i = 0; i < l; i++) {\r\n    // get the rule\r\n    let curr_val = rule;\r\n\r\n    // put all the numbers into the expression\r\n    let all_null = true;\r\n    for (const gene_id in gene_values) {\r\n      let f = parseFloatOrNull(gene_values[gene_id][i]);\r\n      if (f == null)\r\n        f = 0;\r\n      else\r\n        all_null = false;\r\n\r\n      curr_val = replace_gene_in_rule(curr_val, gene_id, String(f));\r\n    }\r\n    if (all_null) {\r\n      out.push(null);\r\n      continue;\r\n    }\r\n\r\n    // recursively evaluate\r\n    while (true) {\r\n      // arithemtic expressions\r\n      let new_curr_val = curr_val;\r\n\r\n      // take out excessive parentheses\r\n      new_curr_val = new_curr_val.replace(EXCESS_PARENS, ' $1 ');\r\n\r\n      // or's\r\n      new_curr_val = new_curr_val.replace(OR_EXPRESSION, function(match, p1, p2, p3) {\r\n        // sum\r\n        const nums = p2.split(OR).map(parseFloat);\r\n        const sum = nums.reduce(function(a: number, b: number) { return a + b; });\r\n        return p1 + sum + p3;\r\n      });\r\n      // and's\r\n      new_curr_val = new_curr_val.replace(AND_EXPRESSION, function(match, p1, p2, p3) {\r\n        // find min\r\n        const nums = p2.split(AND).map(parseFloat);\r\n        const val = (and_method_in_gene_reaction_rule == 'min' ?\r\n          Math.min.apply(null, nums) :\r\n          nums.reduce(function(a: number, b: number) { return a + b; }) / nums.length);\r\n        return p1 + val + p3;\r\n      });\r\n      // break if there is no change\r\n      if (new_curr_val == curr_val)\r\n        break;\r\n      curr_val = new_curr_val;\r\n    }\r\n    // strict test for number\r\n    const num = Number(curr_val);\r\n    if (isNaN(num)) {\r\n      console.warn('Could not evaluate ' + rule);\r\n      out.push(null);\r\n    } else\r\n      out.push(num);\r\n  }\r\n  return out;\r\n}\r\n\r\nexport function replace_gene_in_rule(rule: string, gene_id: string, val: string) {\r\n  // get the escaped string, with surrounding space or parentheses\r\n  const space_or_par_start = '(^|[\\\\\\s\\\\\\(\\\\\\)])';\r\n  const space_or_par_finish = '([\\\\\\s\\\\\\(\\\\\\)]|$)';\r\n  const escaped = space_or_par_start + escape_reg_exp(gene_id) + space_or_par_finish;\r\n  return rule.replace(new RegExp(escaped, 'g'), '$1' + val + '$2');\r\n\r\n  // definitions\r\n  function escape_reg_exp(string: string) {\r\n    return string.replace(ESCAPE_REG, '\\\\$1');\r\n  }\r\n}\r\n\r\n/**\r\n * Returns True if the scale has changed.\r\n * @param {Object} reactions -\r\n * @param {} data -\r\n * @param {} styles -\r\n * @param {String} compare_style -\r\n * @param {Array} keys - (Optional) The keys in reactions to apply data to.\r\n */\r\nexport function apply_reaction_data_to_reactions(reactions: { [key: string]: MapReaction }, data: { [key: string]: (number | string | null)[] }, styles: string[],\r\n  compare_style: string, keys?: string[]) {\r\n  if (_.isUndefined(keys)) keys = Object.keys(reactions);\r\n\r\n  let reaction_id;\r\n  let reaction;\r\n  let segment_id;\r\n  let segment;\r\n\r\n  if (data == null) {\r\n    keys.map(function(reaction_id: string) {\r\n      reaction = reactions[reaction_id];\r\n      reaction.data = null;\r\n      reaction.data_string = '';\r\n      for (segment_id in reaction.segments) {\r\n        segment = reaction.segments[segment_id];\r\n        segment.data = null;\r\n      }\r\n      reaction.gene_string = null;\r\n    });\r\n    return false;\r\n  }\r\n\r\n  // apply the datasets to the reactions\r\n  keys.map(function(reaction_id: string) {\r\n    reaction = reactions[reaction_id];\r\n    // check bigg_id and name\r\n    const d = data[reaction.bigg_id] || data[reaction.name!] || null;\r\n    const f = floatForData(d, styles, compare_style);\r\n    const r = reverse_flux_for_data(d);\r\n    const s = text_for_data(d, f);\r\n    reaction.data = f;\r\n    reaction.data_string = s;\r\n    reaction.reverse_flux = r;\r\n    reaction.gene_string = null;\r\n    // apply to the segments\r\n    for (segment_id in reaction.segments) {\r\n      segment = reaction.segments[segment_id];\r\n      segment.data = reaction.data;\r\n      segment.reverse_flux = reaction.reverse_flux;\r\n    }\r\n  });\r\n  return true;\r\n}\r\n\r\n/**\r\n * Returns True if the scale has changed.\r\n * @param {Object} nodes -\r\n * @param {} data -\r\n * @param {} styles -\r\n * @param {String} compare_style -\r\n * @param {Array} keys - (Optional) The keys in nodes to apply data to.\r\n */\r\nexport function apply_metabolite_data_to_nodes(nodes: { [key: string]: MapNode }, data: { [key: string]: (number | string | null)[] }, styles: string[], compareStyle: string, keys?: string[]) {\r\n  if (_.isUndefined(keys)) keys = Object.keys(nodes);\r\n\r\n  if (data == null) {\r\n    keys.map((nodeId: string) => {\r\n      nodes[nodeId].data = null;\r\n      nodes[nodeId].data_string = '';\r\n    });\r\n    return false;\r\n  }\r\n\r\n  // grab the data\r\n  keys.map((nodeId: string) => {\r\n    const node = nodes[nodeId];\r\n    // check bigg_id and name\r\n    const d = data[node.bigg_id] || data[node.name!] || null;\r\n    const f = floatForData(d, styles, compareStyle);\r\n    const s = text_for_data(d, f);\r\n    node.data = f;\r\n    node.data_string = s;\r\n  });\r\n  return true;\r\n}\r\n\r\n/**\r\n * Returns true if data is present\r\n * reactions: The reactions to update.\r\n * gene_data_obj: The gene data object, with the following style:\r\n *   { reaction_id: { gene_id: value } }\r\n * styles:  Gene styles array.\r\n * identifiers_on_map:\r\n * compare_style:\r\n * and_method_in_gene_reaction_rule:\r\n * @param {Array} keys - (Optional) The keys in reactions to apply data to.\r\n */\r\nexport function apply_gene_data_to_reactions(\r\n  reactions: { [key: string]: MapReaction },\r\n  gene_data_obj: { [key: string]: { [key: string]: (number | string | null)[] } },\r\n  styles: string[],\r\n  identifiers_on_map: string,\r\n  compare_style: string,\r\n  and_method_in_gene_reaction_rule: string,\r\n  keys?: string[]\r\n) {\r\n  if (_.isUndefined(keys)) keys = Object.keys(reactions);\r\n\r\n  if (gene_data_obj == null) {\r\n    keys.map(function(reaction_id) {\r\n      const reaction = reactions[reaction_id];\r\n      reaction.data = null;\r\n      reaction.data_string = '';\r\n      reaction.reverse_flux = false;\r\n      for (const segment_id in reaction.segments) {\r\n        const segment = reaction.segments[segment_id];\r\n        segment.data = null;\r\n      }\r\n      reaction.gene_string = null;\r\n    });\r\n    return false;\r\n  }\r\n\r\n  // Get the null val\r\n  let null_val = [null];\r\n  // Make an array of nulls as the default\r\n  for (const reaction_id in gene_data_obj) {\r\n    for (const gene_id in gene_data_obj[reaction_id]) {\r\n      null_val = gene_data_obj[reaction_id][gene_id]\r\n        .map(function() { return null; });\r\n      break;\r\n    }\r\n    break;\r\n  }\r\n\r\n  // Apply the datasets to the reactions\r\n  keys.map(function(reaction_id) {\r\n    const reaction = reactions[reaction_id];\r\n    const rule = reaction.gene_reaction_rule;\r\n    // find the data\r\n    let d; let gene_values;\r\n    const r_data = gene_data_obj[reaction.bigg_id];\r\n    if (!_.isUndefined(r_data)) {\r\n      gene_values = r_data;\r\n      d = evaluate_gene_reaction_rule(rule, gene_values,\r\n        and_method_in_gene_reaction_rule);\r\n    } else {\r\n      gene_values = {};\r\n      d = utils.clone(null_val);\r\n    }\r\n    const f = floatForData(d, styles, compare_style);\r\n    const r = reverse_flux_for_data(d);\r\n    const s = text_for_data(d, f);\r\n    reaction.data = f;\r\n    reaction.data_string = s;\r\n    reaction.reverse_flux = r;\r\n    // apply to the segments\r\n    for (const segment_id in reaction.segments) {\r\n      const segment = reaction.segments[segment_id];\r\n      segment.data = reaction.data;\r\n      segment.reverse_flux = reaction.reverse_flux;\r\n    }\r\n    // always update the gene string\r\n    reaction.gene_string = gene_string_for_data(rule,\r\n      gene_values,\r\n      reaction.genes as { bigg_id: string, name: string }[],\r\n      styles,\r\n      identifiers_on_map,\r\n      compare_style);\r\n  });\r\n  return true;\r\n}\r\n","/* eslint-disable camelcase */\r\n/**\r\n * CobraModel\r\n */\r\n\r\nimport * as utils from './utils';\r\nimport * as dataStyles from './dataStyles';\r\nimport {CobraGene, CobraModelData} from './types';\r\n\r\n/**\r\n * Return a reaction string for the given stoichiometries. Adapted from\r\n * cobra.core.Reaction.build_reaction_string().\r\n * @param {Object} stoichiometries - An object with metabolites as keys and\r\n * stoichiometries as values.\r\n * @param {Boolean} is_reversible - Whether the reaction is reversible.\r\n */\r\nexport function build_reaction_string(stoichiometries: { [key: string]: number }, is_reversible: boolean) {\r\n  const format = function(number: number) {\r\n    if (number == 1)\r\n      return '';\r\n\r\n    return String(number) + ' ';\r\n  };\r\n  const reactant_bits = [];\r\n  const product_bits = [];\r\n  for (const the_metabolite in stoichiometries) {\r\n    const coefficient = stoichiometries[the_metabolite];\r\n    if (coefficient > 0)\r\n      product_bits.push(format(coefficient) + the_metabolite);\r\n    else\r\n      reactant_bits.push(format(Math.abs(coefficient)) + the_metabolite);\r\n  }\r\n  let reaction_string = reactant_bits.join(' + ');\r\n  if (is_reversible)\r\n    reaction_string += ' ↔ ';\r\n  else\r\n    reaction_string += ' → ';\r\n\r\n  reaction_string += product_bits.join(' + ');\r\n  return reaction_string;\r\n}\r\n\r\nexport function from_cobra_json(model_data: CobraModelData) {\r\n  /** Use a JSON Cobra model exported by COBRApy to make a new CobraModel\r\n      object.\r\n\r\n      The COBRA \"id\" becomes a \"bigg_id\", and \"upper_bound\" and \"lower_bound\"\r\n      bounds become \"reversibility\".\r\n\r\n      Fills out a \"genes\" list.\r\n\r\n  */\r\n  // reactions and metabolites\r\n  if (!(model_data.reactions && model_data.metabolites))\r\n    throw new Error('Bad model data.');\r\n\r\n\r\n  // make a gene dictionary\r\n  const genes: { [key: string]: CobraGene } = {};\r\n  for (let i = 0, l = model_data.genes.length; i < l; i++) {\r\n    const r = model_data.genes[i];\r\n    const the_id = r.id;\r\n    genes[the_id] = r;\r\n  }\r\n\r\n  const model = new CobraModel();\r\n\r\n  model.reactions = {};\r\n  for (let i = 0, l = model_data.reactions.length; i < l; i++) {\r\n    const r = model_data.reactions[i];\r\n    const the_id = r.id;\r\n    const reaction = utils.clone(r);\r\n    delete reaction.id;\r\n    reaction.bigg_id = the_id;\r\n    reaction.data_string = '';\r\n    // add the appropriate genes\r\n    reaction.genes = [];\r\n\r\n    // set reversibility\r\n    reaction.reversibility = (reaction.lower_bound < 0 && reaction.upper_bound > 0);\r\n    if (reaction.upper_bound <= 0 && reaction.lower_bound < 0) {\r\n      // reverse stoichiometries\r\n      for (const met_id in reaction.metabolites)\r\n        reaction.metabolites[met_id] = -reaction.metabolites[met_id];\r\n    }\r\n    delete reaction.lower_bound;\r\n    delete reaction.upper_bound;\r\n\r\n    if ('gene_reaction_rule' in reaction) {\r\n      const gene_ids = dataStyles.genes_for_gene_reaction_rule(reaction.gene_reaction_rule!);\r\n      gene_ids.forEach(function(gene_id) {\r\n        if (gene_id in genes) {\r\n          const gene = utils.clone(genes[gene_id]);\r\n          // rename id to bigg_id\r\n          gene.bigg_id = gene.id;\r\n          delete gene.id;\r\n          reaction.genes!.push(gene);\r\n        } else\r\n          console.warn('Could not find gene for gene_id ' + gene_id);\r\n      });\r\n    }\r\n    model.reactions[the_id] = reaction;\r\n  }\r\n  model.metabolites = {};\r\n  for (let i = 0, l = model_data.metabolites.length; i < l; i++) {\r\n    const r = model_data.metabolites[i];\r\n    const the_id = r.id;\r\n    const met = utils.clone(r);\r\n    delete met.id;\r\n    met.bigg_id = the_id;\r\n    model.metabolites[the_id] = met;\r\n  }\r\n  return model;\r\n}\r\n\r\n\r\nexport default class CobraModel {\r\n  reactions: { [key: string]: any };\r\n  metabolites: { [key: string]: any };\r\n\r\n\r\n  // instance methods\r\n  constructor() {\r\n    this.reactions = {};\r\n    this.metabolites = {};\r\n  }\r\n\r\n  /**\r\n * Apply data to model. This is only used to display options in\r\n * BuildInput. apply_reaction_data overrides apply_gene_data.\r\n */\r\n  apply_reaction_data(reaction_data: { [key: string]: (number | string | null)[]}, styles: string[], compare_style: string) {\r\n    dataStyles.apply_reaction_data_to_reactions(this.reactions, reaction_data,\r\n      styles, compare_style);\r\n  }\r\n\r\n  /**\r\n * Apply data to model. This is only used to display options in BuildInput.\r\n */\r\n  apply_metabolite_data(metabolite_data: { [key: string]: (number | string | null)[]}, styles: string[], compare_style: string) {\r\n    dataStyles.apply_metabolite_data_to_nodes(this.metabolites, metabolite_data,\r\n      styles, compare_style);\r\n  }\r\n\r\n  /**\r\n * Apply data to model. This is only used to display options in\r\n * BuildInput. Overrides apply_reaction_data.\r\n */\r\n  apply_gene_data(gene_data_obj: { [key: string]: { [key: string]: (number | string | null)[] } }, styles: string[], identifiers_on_map: string,\r\n    compare_style: string, and_method_in_gene_reaction_rule: string) {\r\n    dataStyles.apply_gene_data_to_reactions(this.reactions, gene_data_obj,\r\n      styles, identifiers_on_map,\r\n      compare_style,\r\n      and_method_in_gene_reaction_rule);\r\n  }\r\n\r\n  static from_cobra_json(model_data: CobraModelData) {\r\n    return from_cobra_json(model_data);\r\n  }\r\n\r\n  static build_reaction_string(stoichiometries: { [key: string]: number }, is_reversible: boolean) {\r\n    return build_reaction_string(stoichiometries, is_reversible);\r\n  }\r\n}\r\n\r\n// class methods\r\n","import * as utils from './utils';\r\nimport PlacedDiv from './PlacedDiv';\r\nimport completely from './completely';\r\nimport DirectionArrow from './DirectionArrow';\r\nimport CobraModel from './CobraModel';\r\nimport _ from 'underscore';\r\n// @ts-ignore\r\nimport {mouse as d3Mouse} from 'd3-selection';\r\nimport {EscherMap} from './escherMap';\r\nimport {CobraGene, CobraMetabolite, Coord, D3Selection, MapNode, MapReaction} from './types';\r\nimport ZoomContainer from './ZoomContainer';\r\nimport Settings from './Settings';\r\n\r\n/**\r\n * BuildInput\r\n * @param selection - A d3 selection for the BuildInput.\r\n * @param map - A Map instance.\r\n * @param zoomContainer - A ZoomContainer instance.\r\n * @param settings - A Settings instance.\r\n */\r\n\r\nlet selectedOrderCounter = 0;\r\n\r\nexport default class BuildInput {\r\n  placed_div: PlacedDiv;\r\n  map: EscherMap;\r\n  completely: any;\r\n  direction_arrow: DirectionArrow;\r\n  settings: Settings;\r\n  target_coords: {x: number, y: number} | null;\r\n  start_reaction_listener: boolean = false;\r\n  zoomContainer: ZoomContainer;\r\n  is_active: boolean = false;\r\n  clear_escape: any;\r\n\r\n  constructor(selection: D3Selection, map: EscherMap, zoomContainer: ZoomContainer, settings: Settings) {\r\n    // set up container\r\n    const newSel = selection.append('div').attr('id', 'rxn-input');\r\n    this.placed_div = new PlacedDiv(newSel, map, {x: 240, y: 0});\r\n    this.placed_div.hide();\r\n\r\n    // set up complete.ly\r\n    this.completely = completely(newSel.node()!, {backgroundColor: '#eee'});\r\n\r\n    // close button\r\n    newSel.append('button').attr('class', 'button input-close-button')\r\n      .text('×')\r\n      .on('mousedown', () => this.hideDropdown());\r\n\r\n    // map\r\n    this.map = map;\r\n    // set up the reaction direction arrow\r\n    const defaultAngle = 90; // degrees\r\n    this.direction_arrow = new DirectionArrow(map.sel);\r\n    this.direction_arrow.setRotation(defaultAngle);\r\n    this.setUpMapCallbacks(map);\r\n\r\n    // zoom container\r\n    this.zoomContainer = zoomContainer;\r\n    this.setUpZoomCallbacks(zoomContainer);\r\n\r\n    // settings\r\n    this.settings = settings;\r\n\r\n    // toggle off\r\n    this.toggle(false);\r\n    this.target_coords = null;\r\n  }\r\n\r\n  setUpMapCallbacks(map: EscherMap) {\r\n    // input\r\n    map.callback_manager.set('select_metabolite_with_id.input', (selectedNode: MapNode, coords: Coord) => {\r\n      if (this.is_active) {\r\n        const hasModel = this.reload(selectedNode, coords, false);\r\n        if (hasModel) this.showDropdown(coords);\r\n      }\r\n      this.map.unhighlightShortestPaths();\r\n      this.hideTarget();\r\n    });\r\n    map.callback_manager.set('select_selectable.input', (count: number, selectedNode: MapNode, coords: Coord) => {\r\n      this.hideTarget();\r\n      if (selectedNode && typeof selectedNode === 'object')\r\n        selectedNode.selectionOrder = selectedOrderCounter++;\r\n\r\n      if (count === 1 && this.is_active && coords) {\r\n        const hasModel = this.reload(selectedNode, coords, false);\r\n        if (hasModel) this.showDropdown(coords);\r\n      } else\r\n        this.toggle(false);\r\n\r\n      if (count === 1 && this.settings.get('highlight_same_nodes'))\r\n        this.map.highlightSameNodes();\r\n      this.map.selectionChanged();\r\n      this.map.unhighlightShortestPaths();\r\n    });\r\n    map.callback_manager.set('deselect_nodes', () => {\r\n      this.map.unhighlightShortestPaths();\r\n      this.direction_arrow.hide();\r\n      this.hideDropdown();\r\n    });\r\n\r\n    // svg export\r\n    map.callback_manager.set('before_svg_export', () => {\r\n      this.direction_arrow.hide();\r\n      this.hideTarget();\r\n    });\r\n  }\r\n\r\n  setUpZoomCallbacks(zoomContainer: ZoomContainer) {\r\n    // TODO this is broken.\r\n    // Should place either for selected or for location on zoom or pan.\r\n    // zoomContainer.callbackManager.set('zoom_change.input', () => {\r\n    //   if (this.is_active) {\r\n    //     this.place_at_selected()\r\n    //   }\r\n    // })\r\n  }\r\n\r\n  is_visible() { // eslint-disable-line camelcase\r\n    return this.placed_div.is_visible();\r\n  }\r\n\r\n  toggle(onOff: boolean) {\r\n    if (onOff === undefined) this.is_active = !this.is_active;\r\n    else this.is_active = onOff;\r\n    if (this.is_active) {\r\n      this.toggleStartReactionListener(true);\r\n      let hasModelAndSelection = true;\r\n      if (_.isNull(this.target_coords))\r\n        hasModelAndSelection = this.reloadAtSelected() as boolean;\r\n      else\r\n        this.placed_div.place(this.target_coords);\r\n\r\n      if (hasModelAndSelection) {\r\n        this.showDropdown();\r\n        this.map.set_status('Click on the canvas or an existing metabolite');\r\n      }\r\n      this.direction_arrow.show();\r\n    } else {\r\n      this.toggleStartReactionListener(false);\r\n      this.hideDropdown();\r\n      this.map.set_status(null);\r\n      this.direction_arrow.hide();\r\n    }\r\n  }\r\n\r\n  showDropdown(coords?: Coord) {\r\n    // escape key\r\n    this.clear_escape = this.map.key_manager\r\n      .addEscapeListener(() => this.hideDropdown());\r\n    // dropdown\r\n    this.completely.input.blur();\r\n    this.completely.repaint();\r\n    this.completely.setText('');\r\n    this.completely.input.focus();\r\n  }\r\n\r\n  hideDropdown() {\r\n    // escape key\r\n    if (this.clear_escape) this.clear_escape();\r\n    this.clear_escape = null;\r\n    // dropdown\r\n    this.placed_div.hide();\r\n    this.completely.input.blur();\r\n    this.completely.hideDropDown();\r\n  }\r\n\r\n  place(coords: Coord) {\r\n    this.placed_div.place(coords);\r\n    this.direction_arrow.setLocation(coords);\r\n    this.direction_arrow.show();\r\n  }\r\n\r\n  /**\r\n   * Reload data for autocomplete box and redraw box at the first selected node.\r\n   * @return {Boolean} Returns true if a model is present and a node is selected.\r\n   */\r\n  reloadAtSelected() {\r\n    // get the selected node\r\n    this.map.deselect_text_labels();\r\n    const selectedNode = this.map.select_single_node();\r\n    if (selectedNode == null) return false;\r\n    const coords = {x: selectedNode.x, y: selectedNode.y};\r\n    // reload the reaction input\r\n    return this.reload(selectedNode, coords, false);\r\n  }\r\n\r\n  alreadyDrawn(biggId: string, reactions: { [key: string]: MapReaction }) {\r\n    for (const drawnId in reactions) {\r\n      if (reactions[drawnId].bigg_id === biggId)\r\n        return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Reload data for autocomplete box and redraw box at the new coordinates.\r\n   * @param {} selectedNode -\r\n   * @param {} coords -\r\n   * @param {Boolean} startingFromScratch -\r\n   * @return {Boolean} Returns true if a model is present.\r\n   */\r\n  reload(selectedNode: MapNode | null, coords: Coord, startingFromScratch: boolean) {\r\n    // Try finding the selected node\r\n    if (!startingFromScratch && !selectedNode) {\r\n      console.error('No selected node and not starting from scratch');\r\n      return;\r\n    }\r\n\r\n    this.place(coords);\r\n\r\n    if (this.map.cobra_model == null) {\r\n      this.completely.setText('Cannot add: No model.');\r\n      // this.completely.repaint()\r\n      return false;\r\n    }\r\n\r\n    // settings\r\n    const showNames = this.settings.get('identifiers_on_map') === 'name';\r\n    const allowDuplicates = this.settings.get('allow_building_duplicate_reactions');\r\n\r\n    // Find selected\r\n    const options = [];\r\n    const cobraReactions = this.map.cobra_model.reactions;\r\n    const cobraMetabolites = this.map.cobra_model.metabolites;\r\n    const reactions = this.map.reactions;\r\n    const hasDataOnReactions = this.map.has_data_on_reactions;\r\n    const selectedMetName = (selectedNode ? (showNames ? selectedNode.name : selectedNode.bigg_id) : '');\r\n    const boldMetsInStr = (str: string, mets: string[]) =>\r\n      str.replace(new RegExp('(^| )(' + mets.join('|') + ')($| )', 'g'), '$1<b>$2</b>$3');\r\n\r\n    // for reactions\r\n    const reactionSuggestions: { [key: string]: boolean } = {};\r\n    for (const biggId in cobraReactions) {\r\n      const reaction = cobraReactions[biggId];\r\n      const reactionName = reaction.name;\r\n      const showReactionName = (showNames ? reactionName : biggId);\r\n\r\n      // ignore drawn reactions\r\n      if ((!allowDuplicates) && this.alreadyDrawn(biggId, reactions))\r\n        continue;\r\n\r\n\r\n      // check segments for match to selected metabolite\r\n      for (const metBiggId in reaction.metabolites) {\r\n        // if starting with a selected metabolite, check for that id\r\n        if (startingFromScratch || metBiggId === selectedNode?.bigg_id) {\r\n          // don't add suggestions twice\r\n          if (biggId in reactionSuggestions) continue;\r\n\r\n          // get the metabolite names or IDs\r\n          let mets: { [key: string]: CobraMetabolite } = {};\r\n          const showMetNames = [];\r\n          let metId;\r\n          if (showNames) {\r\n            for (metId in reaction.metabolites) {\r\n              const name = cobraMetabolites[metId].name;\r\n              mets[name] = reaction.metabolites[metId];\r\n              showMetNames.push(name);\r\n            }\r\n          } else {\r\n            mets = utils.clone(reaction.metabolites);\r\n            for (metId in reaction.metabolites)\r\n              showMetNames.push(metId);\r\n          }\r\n          const showGeneNames = _.flatten(\r\n            reaction.genes.map((g: CobraGene) => [g.name, g.biggId])\r\n          );\r\n          // get the reaction string\r\n          const reactionString = CobraModel.build_reaction_string(Object.fromEntries(Object.entries(mets).map(([key, value]) => [key, value.coefficient])),\r\n            reaction.reversibility);\r\n          // make the matches list and filter out any missing entries (e.g.\r\n          // missing gene names from model\r\n          const matches = [showReactionName].concat(showMetNames).concat(showGeneNames).filter((x) => x);\r\n\r\n          if (hasDataOnReactions) {\r\n            options.push({\r\n              reaction_data: reaction.data,\r\n              html: '<b>' + showReactionName + '</b>' + ': ' + reaction.data_string,\r\n              matches,\r\n              id: biggId\r\n            });\r\n          } else {\r\n            options.push({\r\n              html: ('<b>' + showReactionName + '</b>' + '\\t' +\r\n                     boldMetsInStr(reactionString, [selectedMetName!])),\r\n              matches,\r\n              id: biggId\r\n            });\r\n          }\r\n          reactionSuggestions[biggId!] = true;\r\n        }\r\n      }\r\n    }\r\n\r\n    // Generate the array of reactions to suggest and sort it\r\n    const sortFn = hasDataOnReactions ?\r\n      (x: any, y: any) => Math.abs(x.reaction_data) > Math.abs(y.reaction_data) ? -1 : 1 :\r\n      (x: any, y: any) => x.html.toLowerCase() < y.html.toLowerCase() ? -1 : 1;\r\n\r\n    // set up the box with data\r\n    this.completely.options = options.sort(sortFn);\r\n\r\n    // TODO test this behavior\r\n    // if (strings_to_display.length==1) this.completely.setText(strings_to_display[0])\r\n    // else this.completely.setText(\"\")\r\n    this.completely.setText('');\r\n\r\n    const checkAndBuild = (id: string) => {\r\n      if (id !== null) {\r\n        // make sure the selected node exists, in case changes were made in the meantime\r\n        if (startingFromScratch) {\r\n          this.map.new_reaction_from_scratch(id,\r\n            coords,\r\n            this.direction_arrow.getRotation());\r\n        } else {\r\n          if (!(selectedNode!.node_id! in this.map.nodes)) {\r\n            console.error('Selected node no longer exists');\r\n            this.hideDropdown();\r\n            return;\r\n          }\r\n          this.map.new_reaction_for_metabolite(id,\r\n            selectedNode!.node_id!,\r\n            this.direction_arrow.getRotation());\r\n        }\r\n      }\r\n    };\r\n    this.completely.onEnter = function(id: string) {\r\n      this.setText('');\r\n      this.onChange('');\r\n      checkAndBuild(id);\r\n    };\r\n\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * Toggle listening for a click to place a new reaction on the canvas.\r\n   */\r\n  toggleStartReactionListener(onOff: boolean) {\r\n    if (onOff === undefined)\r\n      this.start_reaction_listener = !this.start_reaction_listener;\r\n    else if (this.start_reaction_listener === onOff)\r\n      return;\r\n    else\r\n      this.start_reaction_listener = onOff;\r\n\r\n\r\n    if (this.start_reaction_listener) {\r\n      const node = this.map.sel.node();\r\n      this.map.sel.on('click.start_reaction', () => {\r\n        // TODO fix this hack\r\n        if (this.direction_arrow.dragging) return;\r\n        // reload the reaction input\r\n        const coords = {\r\n          x: d3Mouse(node)[0],\r\n          y: d3Mouse(node)[1]\r\n        };\r\n        // unselect metabolites\r\n        this.map.deselect_nodes();\r\n        this.map.deselect_text_labels();\r\n        // reload the reaction input\r\n        const hasModel = this.reload(null, coords, true);\r\n        if (hasModel) {\r\n          // show the dropdown\r\n          this.showDropdown(coords);\r\n        }\r\n        // generate the target symbol\r\n        this.showTarget(this.map, coords);\r\n      });\r\n      this.map.sel.style('cursor', 'pointer');\r\n    } else {\r\n      this.map.sel.on('click.start_reaction', null);\r\n      this.map.sel.style('cursor', null);\r\n      this.hideTarget();\r\n    }\r\n  }\r\n\r\n  hideTarget() {\r\n    if (this.target_coords)\r\n      this.map.sel.selectAll('.start-reaction-target').remove();\r\n\r\n    this.target_coords = null;\r\n  }\r\n\r\n  showTarget(map: EscherMap, coords: Coord) {\r\n    const s = map.sel.selectAll('.start-reaction-target').data([12, 5]);\r\n    s.enter()\r\n      .append('circle')\r\n      .classed('start-reaction-target', true)\r\n      .attr('r', function(d) { return d; })\r\n      .style('stroke-width', 4)\r\n      .merge(s as any)\r\n      .style('visibility', 'visible')\r\n      .attr('transform', 'translate(' + coords.x + ',' + coords.y + ')');\r\n    this.target_coords = coords;\r\n  }\r\n}\r\n","/** CallbackManager */\r\nexport default class CallbackManager {\r\n  callbacks: { [key: string]: ((...args: any[]) => void)[] } = {};\r\n  /**\r\n   * As in d3 callbacks, you can namespace your callbacks after a period:\r\n   * select_metabolite.direction_arrow, select_metabolite.input. Both are called\r\n   * by select_metabolite.\r\n  */\r\n  set(name: string, fn: (...args: any[]) => void) {\r\n    if (this.callbacks === undefined) this.callbacks = {};\r\n    if (this.callbacks[name] === undefined) this.callbacks[name] = [];\r\n    this.callbacks[name].push(fn);\r\n  }\r\n\r\n  /** Remove a callback by name */\r\n  remove(name: string) {\r\n    if (this.callbacks === undefined || Object.keys(this.callbacks).length === 0)\r\n      console.warn('No callbacks to remove');\r\n    else\r\n      delete this.callbacks[name];\r\n  }\r\n\r\n  /**\r\n   * Run all callbacks that match the portion of name before the period ('.').\r\n   * @param {String} name - The callback name, which can include a tag after a\r\n   * '.' to specificy a particular callback.\r\n   * @param {Any} thisArg = null - The object assigned to `this` in the\r\n   * callback.\r\n  */\r\n  run(name: string, thisArg: any = null, ...passArgs: any[]) {\r\n    if (this.callbacks === undefined) return;\r\n    // look for matching callback names\r\n    for (const aName in this.callbacks) {\r\n      const splitName = aName.split('.')[0];\r\n      if (splitName === name) {\r\n        this.callbacks[aName].forEach((fn) => {\r\n          fn.apply(thisArg, passArgs);\r\n        });\r\n      }\r\n    }\r\n  }\r\n}\r\n","var rho = Math.SQRT2,\n    rho2 = 2,\n    rho4 = 4,\n    epsilon2 = 1e-12;\n\nfunction cosh(x) {\n  return ((x = Math.exp(x)) + 1 / x) / 2;\n}\n\nfunction sinh(x) {\n  return ((x = Math.exp(x)) - 1 / x) / 2;\n}\n\nfunction tanh(x) {\n  return ((x = Math.exp(2 * x)) - 1) / (x + 1);\n}\n\n// p0 = [ux0, uy0, w0]\n// p1 = [ux1, uy1, w1]\nexport default function(p0, p1) {\n  var ux0 = p0[0], uy0 = p0[1], w0 = p0[2],\n      ux1 = p1[0], uy1 = p1[1], w1 = p1[2],\n      dx = ux1 - ux0,\n      dy = uy1 - uy0,\n      d2 = dx * dx + dy * dy,\n      i,\n      S;\n\n  // Special case for u0 ≅ u1.\n  if (d2 < epsilon2) {\n    S = Math.log(w1 / w0) / rho;\n    i = function(t) {\n      return [\n        ux0 + t * dx,\n        uy0 + t * dy,\n        w0 * Math.exp(rho * t * S)\n      ];\n    }\n  }\n\n  // General case.\n  else {\n    var d1 = Math.sqrt(d2),\n        b0 = (w1 * w1 - w0 * w0 + rho4 * d2) / (2 * w0 * rho2 * d1),\n        b1 = (w1 * w1 - w0 * w0 - rho4 * d2) / (2 * w1 * rho2 * d1),\n        r0 = Math.log(Math.sqrt(b0 * b0 + 1) - b0),\n        r1 = Math.log(Math.sqrt(b1 * b1 + 1) - b1);\n    S = (r1 - r0) / rho;\n    i = function(t) {\n      var s = t * S,\n          coshr0 = cosh(r0),\n          u = w0 / (rho2 * d1) * (coshr0 * tanh(rho * s + r0) - sinh(r0));\n      return [\n        ux0 + u * dx,\n        uy0 + u * dy,\n        w0 * coshr0 / cosh(rho * s + r0)\n      ];\n    }\n  }\n\n  i.duration = S * 1000;\n\n  return i;\n}\n","var frame = 0, // is an animation frame pending?\n    timeout = 0, // is a timeout pending?\n    interval = 0, // are any timers active?\n    pokeDelay = 1000, // how frequently we check for clock skew\n    taskHead,\n    taskTail,\n    clockLast = 0,\n    clockNow = 0,\n    clockSkew = 0,\n    clock = typeof performance === \"object\" && performance.now ? performance : Date,\n    setFrame = typeof window === \"object\" && window.requestAnimationFrame ? window.requestAnimationFrame.bind(window) : function(f) { setTimeout(f, 17); };\n\nexport function now() {\n  return clockNow || (setFrame(clearNow), clockNow = clock.now() + clockSkew);\n}\n\nfunction clearNow() {\n  clockNow = 0;\n}\n\nexport function Timer() {\n  this._call =\n  this._time =\n  this._next = null;\n}\n\nTimer.prototype = timer.prototype = {\n  constructor: Timer,\n  restart: function(callback, delay, time) {\n    if (typeof callback !== \"function\") throw new TypeError(\"callback is not a function\");\n    time = (time == null ? now() : +time) + (delay == null ? 0 : +delay);\n    if (!this._next && taskTail !== this) {\n      if (taskTail) taskTail._next = this;\n      else taskHead = this;\n      taskTail = this;\n    }\n    this._call = callback;\n    this._time = time;\n    sleep();\n  },\n  stop: function() {\n    if (this._call) {\n      this._call = null;\n      this._time = Infinity;\n      sleep();\n    }\n  }\n};\n\nexport function timer(callback, delay, time) {\n  var t = new Timer;\n  t.restart(callback, delay, time);\n  return t;\n}\n\nexport function timerFlush() {\n  now(); // Get the current time, if not already set.\n  ++frame; // Pretend we’ve set an alarm, if we haven’t already.\n  var t = taskHead, e;\n  while (t) {\n    if ((e = clockNow - t._time) >= 0) t._call.call(null, e);\n    t = t._next;\n  }\n  --frame;\n}\n\nfunction wake() {\n  clockNow = (clockLast = clock.now()) + clockSkew;\n  frame = timeout = 0;\n  try {\n    timerFlush();\n  } finally {\n    frame = 0;\n    nap();\n    clockNow = 0;\n  }\n}\n\nfunction poke() {\n  var now = clock.now(), delay = now - clockLast;\n  if (delay > pokeDelay) clockSkew -= delay, clockLast = now;\n}\n\nfunction nap() {\n  var t0, t1 = taskHead, t2, time = Infinity;\n  while (t1) {\n    if (t1._call) {\n      if (time > t1._time) time = t1._time;\n      t0 = t1, t1 = t1._next;\n    } else {\n      t2 = t1._next, t1._next = null;\n      t1 = t0 ? t0._next = t2 : taskHead = t2;\n    }\n  }\n  taskTail = t0;\n  sleep(time);\n}\n\nfunction sleep(time) {\n  if (frame) return; // Soonest alarm already set, or will be.\n  if (timeout) timeout = clearTimeout(timeout);\n  var delay = time - clockNow; // Strictly less than if we recomputed clockNow.\n  if (delay > 24) {\n    if (time < Infinity) timeout = setTimeout(wake, time - clock.now() - clockSkew);\n    if (interval) interval = clearInterval(interval);\n  } else {\n    if (!interval) clockLast = clock.now(), interval = setInterval(poke, pokeDelay);\n    frame = 1, setFrame(wake);\n  }\n}\n","import {Timer} from \"./timer.js\";\n\nexport default function(callback, delay, time) {\n  var t = new Timer;\n  delay = delay == null ? 0 : +delay;\n  t.restart(function(elapsed) {\n    t.stop();\n    callback(elapsed + delay);\n  }, delay, time);\n  return t;\n}\n","import {dispatch} from \"d3-dispatch\";\nimport {timer, timeout} from \"d3-timer\";\n\nvar emptyOn = dispatch(\"start\", \"end\", \"cancel\", \"interrupt\");\nvar emptyTween = [];\n\nexport var CREATED = 0;\nexport var SCHEDULED = 1;\nexport var STARTING = 2;\nexport var STARTED = 3;\nexport var RUNNING = 4;\nexport var ENDING = 5;\nexport var ENDED = 6;\n\nexport default function(node, name, id, index, group, timing) {\n  var schedules = node.__transition;\n  if (!schedules) node.__transition = {};\n  else if (id in schedules) return;\n  create(node, id, {\n    name: name,\n    index: index, // For context during callback.\n    group: group, // For context during callback.\n    on: emptyOn,\n    tween: emptyTween,\n    time: timing.time,\n    delay: timing.delay,\n    duration: timing.duration,\n    ease: timing.ease,\n    timer: null,\n    state: CREATED\n  });\n}\n\nexport function init(node, id) {\n  var schedule = get(node, id);\n  if (schedule.state > CREATED) throw new Error(\"too late; already scheduled\");\n  return schedule;\n}\n\nexport function set(node, id) {\n  var schedule = get(node, id);\n  if (schedule.state > STARTED) throw new Error(\"too late; already running\");\n  return schedule;\n}\n\nexport function get(node, id) {\n  var schedule = node.__transition;\n  if (!schedule || !(schedule = schedule[id])) throw new Error(\"transition not found\");\n  return schedule;\n}\n\nfunction create(node, id, self) {\n  var schedules = node.__transition,\n      tween;\n\n  // Initialize the self timer when the transition is created.\n  // Note the actual delay is not known until the first callback!\n  schedules[id] = self;\n  self.timer = timer(schedule, 0, self.time);\n\n  function schedule(elapsed) {\n    self.state = SCHEDULED;\n    self.timer.restart(start, self.delay, self.time);\n\n    // If the elapsed delay is less than our first sleep, start immediately.\n    if (self.delay <= elapsed) start(elapsed - self.delay);\n  }\n\n  function start(elapsed) {\n    var i, j, n, o;\n\n    // If the state is not SCHEDULED, then we previously errored on start.\n    if (self.state !== SCHEDULED) return stop();\n\n    for (i in schedules) {\n      o = schedules[i];\n      if (o.name !== self.name) continue;\n\n      // While this element already has a starting transition during this frame,\n      // defer starting an interrupting transition until that transition has a\n      // chance to tick (and possibly end); see d3/d3-transition#54!\n      if (o.state === STARTED) return timeout(start);\n\n      // Interrupt the active transition, if any.\n      if (o.state === RUNNING) {\n        o.state = ENDED;\n        o.timer.stop();\n        o.on.call(\"interrupt\", node, node.__data__, o.index, o.group);\n        delete schedules[i];\n      }\n\n      // Cancel any pre-empted transitions.\n      else if (+i < id) {\n        o.state = ENDED;\n        o.timer.stop();\n        o.on.call(\"cancel\", node, node.__data__, o.index, o.group);\n        delete schedules[i];\n      }\n    }\n\n    // Defer the first tick to end of the current frame; see d3/d3#1576.\n    // Note the transition may be canceled after start and before the first tick!\n    // Note this must be scheduled before the start event; see d3/d3-transition#16!\n    // Assuming this is successful, subsequent callbacks go straight to tick.\n    timeout(function() {\n      if (self.state === STARTED) {\n        self.state = RUNNING;\n        self.timer.restart(tick, self.delay, self.time);\n        tick(elapsed);\n      }\n    });\n\n    // Dispatch the start event.\n    // Note this must be done before the tween are initialized.\n    self.state = STARTING;\n    self.on.call(\"start\", node, node.__data__, self.index, self.group);\n    if (self.state !== STARTING) return; // interrupted\n    self.state = STARTED;\n\n    // Initialize the tween, deleting null tween.\n    tween = new Array(n = self.tween.length);\n    for (i = 0, j = -1; i < n; ++i) {\n      if (o = self.tween[i].value.call(node, node.__data__, self.index, self.group)) {\n        tween[++j] = o;\n      }\n    }\n    tween.length = j + 1;\n  }\n\n  function tick(elapsed) {\n    var t = elapsed < self.duration ? self.ease.call(null, elapsed / self.duration) : (self.timer.restart(stop), self.state = ENDING, 1),\n        i = -1,\n        n = tween.length;\n\n    while (++i < n) {\n      tween[i].call(node, t);\n    }\n\n    // Dispatch the end event.\n    if (self.state === ENDING) {\n      self.on.call(\"end\", node, node.__data__, self.index, self.group);\n      stop();\n    }\n  }\n\n  function stop() {\n    self.state = ENDED;\n    self.timer.stop();\n    delete schedules[id];\n    for (var i in schedules) return; // eslint-disable-line no-unused-vars\n    delete node.__transition;\n  }\n}\n","import {STARTING, ENDING, ENDED} from \"./transition/schedule.js\";\n\nexport default function(node, name) {\n  var schedules = node.__transition,\n      schedule,\n      active,\n      empty = true,\n      i;\n\n  if (!schedules) return;\n\n  name = name == null ? null : name + \"\";\n\n  for (i in schedules) {\n    if ((schedule = schedules[i]).name !== name) { empty = false; continue; }\n    active = schedule.state > STARTING && schedule.state < ENDING;\n    schedule.state = ENDED;\n    schedule.timer.stop();\n    schedule.on.call(active ? \"interrupt\" : \"cancel\", node, node.__data__, schedule.index, schedule.group);\n    delete schedules[i];\n  }\n\n  if (empty) delete node.__transition;\n}\n","export default function(a, b) {\n  return a = +a, b = +b, function(t) {\n    return a * (1 - t) + b * t;\n  };\n}\n","var degrees = 180 / Math.PI;\n\nexport var identity = {\n  translateX: 0,\n  translateY: 0,\n  rotate: 0,\n  skewX: 0,\n  scaleX: 1,\n  scaleY: 1\n};\n\nexport default function(a, b, c, d, e, f) {\n  var scaleX, scaleY, skewX;\n  if (scaleX = Math.sqrt(a * a + b * b)) a /= scaleX, b /= scaleX;\n  if (skewX = a * c + b * d) c -= a * skewX, d -= b * skewX;\n  if (scaleY = Math.sqrt(c * c + d * d)) c /= scaleY, d /= scaleY, skewX /= scaleY;\n  if (a * d < b * c) a = -a, b = -b, skewX = -skewX, scaleX = -scaleX;\n  return {\n    translateX: e,\n    translateY: f,\n    rotate: Math.atan2(b, a) * degrees,\n    skewX: Math.atan(skewX) * degrees,\n    scaleX: scaleX,\n    scaleY: scaleY\n  };\n}\n","import decompose, {identity} from \"./decompose.js\";\n\nvar cssNode,\n    cssRoot,\n    cssView,\n    svgNode;\n\nexport function parseCss(value) {\n  if (value === \"none\") return identity;\n  if (!cssNode) cssNode = document.createElement(\"DIV\"), cssRoot = document.documentElement, cssView = document.defaultView;\n  cssNode.style.transform = value;\n  value = cssView.getComputedStyle(cssRoot.appendChild(cssNode), null).getPropertyValue(\"transform\");\n  cssRoot.removeChild(cssNode);\n  value = value.slice(7, -1).split(\",\");\n  return decompose(+value[0], +value[1], +value[2], +value[3], +value[4], +value[5]);\n}\n\nexport function parseSvg(value) {\n  if (value == null) return identity;\n  if (!svgNode) svgNode = document.createElementNS(\"http://www.w3.org/2000/svg\", \"g\");\n  svgNode.setAttribute(\"transform\", value);\n  if (!(value = svgNode.transform.baseVal.consolidate())) return identity;\n  value = value.matrix;\n  return decompose(value.a, value.b, value.c, value.d, value.e, value.f);\n}\n","import number from \"../number.js\";\nimport {parseCss, parseSvg} from \"./parse.js\";\n\nfunction interpolateTransform(parse, pxComma, pxParen, degParen) {\n\n  function pop(s) {\n    return s.length ? s.pop() + \" \" : \"\";\n  }\n\n  function translate(xa, ya, xb, yb, s, q) {\n    if (xa !== xb || ya !== yb) {\n      var i = s.push(\"translate(\", null, pxComma, null, pxParen);\n      q.push({i: i - 4, x: number(xa, xb)}, {i: i - 2, x: number(ya, yb)});\n    } else if (xb || yb) {\n      s.push(\"translate(\" + xb + pxComma + yb + pxParen);\n    }\n  }\n\n  function rotate(a, b, s, q) {\n    if (a !== b) {\n      if (a - b > 180) b += 360; else if (b - a > 180) a += 360; // shortest path\n      q.push({i: s.push(pop(s) + \"rotate(\", null, degParen) - 2, x: number(a, b)});\n    } else if (b) {\n      s.push(pop(s) + \"rotate(\" + b + degParen);\n    }\n  }\n\n  function skewX(a, b, s, q) {\n    if (a !== b) {\n      q.push({i: s.push(pop(s) + \"skewX(\", null, degParen) - 2, x: number(a, b)});\n    } else if (b) {\n      s.push(pop(s) + \"skewX(\" + b + degParen);\n    }\n  }\n\n  function scale(xa, ya, xb, yb, s, q) {\n    if (xa !== xb || ya !== yb) {\n      var i = s.push(pop(s) + \"scale(\", null, \",\", null, \")\");\n      q.push({i: i - 4, x: number(xa, xb)}, {i: i - 2, x: number(ya, yb)});\n    } else if (xb !== 1 || yb !== 1) {\n      s.push(pop(s) + \"scale(\" + xb + \",\" + yb + \")\");\n    }\n  }\n\n  return function(a, b) {\n    var s = [], // string constants and placeholders\n        q = []; // number interpolators\n    a = parse(a), b = parse(b);\n    translate(a.translateX, a.translateY, b.translateX, b.translateY, s, q);\n    rotate(a.rotate, b.rotate, s, q);\n    skewX(a.skewX, b.skewX, s, q);\n    scale(a.scaleX, a.scaleY, b.scaleX, b.scaleY, s, q);\n    a = b = null; // gc\n    return function(t) {\n      var i = -1, n = q.length, o;\n      while (++i < n) s[(o = q[i]).i] = o.x(t);\n      return s.join(\"\");\n    };\n  };\n}\n\nexport var interpolateTransformCss = interpolateTransform(parseCss, \"px, \", \"px)\", \"deg)\");\nexport var interpolateTransformSvg = interpolateTransform(parseSvg, \", \", \")\", \")\");\n","import {get, set} from \"./schedule.js\";\n\nfunction tweenRemove(id, name) {\n  var tween0, tween1;\n  return function() {\n    var schedule = set(this, id),\n        tween = schedule.tween;\n\n    // If this node shared tween with the previous node,\n    // just assign the updated shared tween and we’re done!\n    // Otherwise, copy-on-write.\n    if (tween !== tween0) {\n      tween1 = tween0 = tween;\n      for (var i = 0, n = tween1.length; i < n; ++i) {\n        if (tween1[i].name === name) {\n          tween1 = tween1.slice();\n          tween1.splice(i, 1);\n          break;\n        }\n      }\n    }\n\n    schedule.tween = tween1;\n  };\n}\n\nfunction tweenFunction(id, name, value) {\n  var tween0, tween1;\n  if (typeof value !== \"function\") throw new Error;\n  return function() {\n    var schedule = set(this, id),\n        tween = schedule.tween;\n\n    // If this node shared tween with the previous node,\n    // just assign the updated shared tween and we’re done!\n    // Otherwise, copy-on-write.\n    if (tween !== tween0) {\n      tween1 = (tween0 = tween).slice();\n      for (var t = {name: name, value: value}, i = 0, n = tween1.length; i < n; ++i) {\n        if (tween1[i].name === name) {\n          tween1[i] = t;\n          break;\n        }\n      }\n      if (i === n) tween1.push(t);\n    }\n\n    schedule.tween = tween1;\n  };\n}\n\nexport default function(name, value) {\n  var id = this._id;\n\n  name += \"\";\n\n  if (arguments.length < 2) {\n    var tween = get(this.node(), id).tween;\n    for (var i = 0, n = tween.length, t; i < n; ++i) {\n      if ((t = tween[i]).name === name) {\n        return t.value;\n      }\n    }\n    return null;\n  }\n\n  return this.each((value == null ? tweenRemove : tweenFunction)(id, name, value));\n}\n\nexport function tweenValue(transition, name, value) {\n  var id = transition._id;\n\n  transition.each(function() {\n    var schedule = set(this, id);\n    (schedule.value || (schedule.value = {}))[name] = value.apply(this, arguments);\n  });\n\n  return function(node) {\n    return get(node, id).value[name];\n  };\n}\n","export default function(constructor, factory, prototype) {\n  constructor.prototype = factory.prototype = prototype;\n  prototype.constructor = constructor;\n}\n\nexport function extend(parent, definition) {\n  var prototype = Object.create(parent.prototype);\n  for (var key in definition) prototype[key] = definition[key];\n  return prototype;\n}\n","import define, {extend} from \"./define.js\";\n\nexport function Color() {}\n\nexport var darker = 0.7;\nexport var brighter = 1 / darker;\n\nvar reI = \"\\\\s*([+-]?\\\\d+)\\\\s*\",\n    reN = \"\\\\s*([+-]?\\\\d*\\\\.?\\\\d+(?:[eE][+-]?\\\\d+)?)\\\\s*\",\n    reP = \"\\\\s*([+-]?\\\\d*\\\\.?\\\\d+(?:[eE][+-]?\\\\d+)?)%\\\\s*\",\n    reHex = /^#([0-9a-f]{3,8})$/,\n    reRgbInteger = new RegExp(\"^rgb\\\\(\" + [reI, reI, reI] + \"\\\\)$\"),\n    reRgbPercent = new RegExp(\"^rgb\\\\(\" + [reP, reP, reP] + \"\\\\)$\"),\n    reRgbaInteger = new RegExp(\"^rgba\\\\(\" + [reI, reI, reI, reN] + \"\\\\)$\"),\n    reRgbaPercent = new RegExp(\"^rgba\\\\(\" + [reP, reP, reP, reN] + \"\\\\)$\"),\n    reHslPercent = new RegExp(\"^hsl\\\\(\" + [reN, reP, reP] + \"\\\\)$\"),\n    reHslaPercent = new RegExp(\"^hsla\\\\(\" + [reN, reP, reP, reN] + \"\\\\)$\");\n\nvar named = {\n  aliceblue: 0xf0f8ff,\n  antiquewhite: 0xfaebd7,\n  aqua: 0x00ffff,\n  aquamarine: 0x7fffd4,\n  azure: 0xf0ffff,\n  beige: 0xf5f5dc,\n  bisque: 0xffe4c4,\n  black: 0x000000,\n  blanchedalmond: 0xffebcd,\n  blue: 0x0000ff,\n  blueviolet: 0x8a2be2,\n  brown: 0xa52a2a,\n  burlywood: 0xdeb887,\n  cadetblue: 0x5f9ea0,\n  chartreuse: 0x7fff00,\n  chocolate: 0xd2691e,\n  coral: 0xff7f50,\n  cornflowerblue: 0x6495ed,\n  cornsilk: 0xfff8dc,\n  crimson: 0xdc143c,\n  cyan: 0x00ffff,\n  darkblue: 0x00008b,\n  darkcyan: 0x008b8b,\n  darkgoldenrod: 0xb8860b,\n  darkgray: 0xa9a9a9,\n  darkgreen: 0x006400,\n  darkgrey: 0xa9a9a9,\n  darkkhaki: 0xbdb76b,\n  darkmagenta: 0x8b008b,\n  darkolivegreen: 0x556b2f,\n  darkorange: 0xff8c00,\n  darkorchid: 0x9932cc,\n  darkred: 0x8b0000,\n  darksalmon: 0xe9967a,\n  darkseagreen: 0x8fbc8f,\n  darkslateblue: 0x483d8b,\n  darkslategray: 0x2f4f4f,\n  darkslategrey: 0x2f4f4f,\n  darkturquoise: 0x00ced1,\n  darkviolet: 0x9400d3,\n  deeppink: 0xff1493,\n  deepskyblue: 0x00bfff,\n  dimgray: 0x696969,\n  dimgrey: 0x696969,\n  dodgerblue: 0x1e90ff,\n  firebrick: 0xb22222,\n  floralwhite: 0xfffaf0,\n  forestgreen: 0x228b22,\n  fuchsia: 0xff00ff,\n  gainsboro: 0xdcdcdc,\n  ghostwhite: 0xf8f8ff,\n  gold: 0xffd700,\n  goldenrod: 0xdaa520,\n  gray: 0x808080,\n  green: 0x008000,\n  greenyellow: 0xadff2f,\n  grey: 0x808080,\n  honeydew: 0xf0fff0,\n  hotpink: 0xff69b4,\n  indianred: 0xcd5c5c,\n  indigo: 0x4b0082,\n  ivory: 0xfffff0,\n  khaki: 0xf0e68c,\n  lavender: 0xe6e6fa,\n  lavenderblush: 0xfff0f5,\n  lawngreen: 0x7cfc00,\n  lemonchiffon: 0xfffacd,\n  lightblue: 0xadd8e6,\n  lightcoral: 0xf08080,\n  lightcyan: 0xe0ffff,\n  lightgoldenrodyellow: 0xfafad2,\n  lightgray: 0xd3d3d3,\n  lightgreen: 0x90ee90,\n  lightgrey: 0xd3d3d3,\n  lightpink: 0xffb6c1,\n  lightsalmon: 0xffa07a,\n  lightseagreen: 0x20b2aa,\n  lightskyblue: 0x87cefa,\n  lightslategray: 0x778899,\n  lightslategrey: 0x778899,\n  lightsteelblue: 0xb0c4de,\n  lightyellow: 0xffffe0,\n  lime: 0x00ff00,\n  limegreen: 0x32cd32,\n  linen: 0xfaf0e6,\n  magenta: 0xff00ff,\n  maroon: 0x800000,\n  mediumaquamarine: 0x66cdaa,\n  mediumblue: 0x0000cd,\n  mediumorchid: 0xba55d3,\n  mediumpurple: 0x9370db,\n  mediumseagreen: 0x3cb371,\n  mediumslateblue: 0x7b68ee,\n  mediumspringgreen: 0x00fa9a,\n  mediumturquoise: 0x48d1cc,\n  mediumvioletred: 0xc71585,\n  midnightblue: 0x191970,\n  mintcream: 0xf5fffa,\n  mistyrose: 0xffe4e1,\n  moccasin: 0xffe4b5,\n  navajowhite: 0xffdead,\n  navy: 0x000080,\n  oldlace: 0xfdf5e6,\n  olive: 0x808000,\n  olivedrab: 0x6b8e23,\n  orange: 0xffa500,\n  orangered: 0xff4500,\n  orchid: 0xda70d6,\n  palegoldenrod: 0xeee8aa,\n  palegreen: 0x98fb98,\n  paleturquoise: 0xafeeee,\n  palevioletred: 0xdb7093,\n  papayawhip: 0xffefd5,\n  peachpuff: 0xffdab9,\n  peru: 0xcd853f,\n  pink: 0xffc0cb,\n  plum: 0xdda0dd,\n  powderblue: 0xb0e0e6,\n  purple: 0x800080,\n  rebeccapurple: 0x663399,\n  red: 0xff0000,\n  rosybrown: 0xbc8f8f,\n  royalblue: 0x4169e1,\n  saddlebrown: 0x8b4513,\n  salmon: 0xfa8072,\n  sandybrown: 0xf4a460,\n  seagreen: 0x2e8b57,\n  seashell: 0xfff5ee,\n  sienna: 0xa0522d,\n  silver: 0xc0c0c0,\n  skyblue: 0x87ceeb,\n  slateblue: 0x6a5acd,\n  slategray: 0x708090,\n  slategrey: 0x708090,\n  snow: 0xfffafa,\n  springgreen: 0x00ff7f,\n  steelblue: 0x4682b4,\n  tan: 0xd2b48c,\n  teal: 0x008080,\n  thistle: 0xd8bfd8,\n  tomato: 0xff6347,\n  turquoise: 0x40e0d0,\n  violet: 0xee82ee,\n  wheat: 0xf5deb3,\n  white: 0xffffff,\n  whitesmoke: 0xf5f5f5,\n  yellow: 0xffff00,\n  yellowgreen: 0x9acd32\n};\n\ndefine(Color, color, {\n  copy: function(channels) {\n    return Object.assign(new this.constructor, this, channels);\n  },\n  displayable: function() {\n    return this.rgb().displayable();\n  },\n  hex: color_formatHex, // Deprecated! Use color.formatHex.\n  formatHex: color_formatHex,\n  formatHsl: color_formatHsl,\n  formatRgb: color_formatRgb,\n  toString: color_formatRgb\n});\n\nfunction color_formatHex() {\n  return this.rgb().formatHex();\n}\n\nfunction color_formatHsl() {\n  return hslConvert(this).formatHsl();\n}\n\nfunction color_formatRgb() {\n  return this.rgb().formatRgb();\n}\n\nexport default function color(format) {\n  var m, l;\n  format = (format + \"\").trim().toLowerCase();\n  return (m = reHex.exec(format)) ? (l = m[1].length, m = parseInt(m[1], 16), l === 6 ? rgbn(m) // #ff0000\n      : l === 3 ? new Rgb((m >> 8 & 0xf) | (m >> 4 & 0xf0), (m >> 4 & 0xf) | (m & 0xf0), ((m & 0xf) << 4) | (m & 0xf), 1) // #f00\n      : l === 8 ? rgba(m >> 24 & 0xff, m >> 16 & 0xff, m >> 8 & 0xff, (m & 0xff) / 0xff) // #ff000000\n      : l === 4 ? rgba((m >> 12 & 0xf) | (m >> 8 & 0xf0), (m >> 8 & 0xf) | (m >> 4 & 0xf0), (m >> 4 & 0xf) | (m & 0xf0), (((m & 0xf) << 4) | (m & 0xf)) / 0xff) // #f000\n      : null) // invalid hex\n      : (m = reRgbInteger.exec(format)) ? new Rgb(m[1], m[2], m[3], 1) // rgb(255, 0, 0)\n      : (m = reRgbPercent.exec(format)) ? new Rgb(m[1] * 255 / 100, m[2] * 255 / 100, m[3] * 255 / 100, 1) // rgb(100%, 0%, 0%)\n      : (m = reRgbaInteger.exec(format)) ? rgba(m[1], m[2], m[3], m[4]) // rgba(255, 0, 0, 1)\n      : (m = reRgbaPercent.exec(format)) ? rgba(m[1] * 255 / 100, m[2] * 255 / 100, m[3] * 255 / 100, m[4]) // rgb(100%, 0%, 0%, 1)\n      : (m = reHslPercent.exec(format)) ? hsla(m[1], m[2] / 100, m[3] / 100, 1) // hsl(120, 50%, 50%)\n      : (m = reHslaPercent.exec(format)) ? hsla(m[1], m[2] / 100, m[3] / 100, m[4]) // hsla(120, 50%, 50%, 1)\n      : named.hasOwnProperty(format) ? rgbn(named[format]) // eslint-disable-line no-prototype-builtins\n      : format === \"transparent\" ? new Rgb(NaN, NaN, NaN, 0)\n      : null;\n}\n\nfunction rgbn(n) {\n  return new Rgb(n >> 16 & 0xff, n >> 8 & 0xff, n & 0xff, 1);\n}\n\nfunction rgba(r, g, b, a) {\n  if (a <= 0) r = g = b = NaN;\n  return new Rgb(r, g, b, a);\n}\n\nexport function rgbConvert(o) {\n  if (!(o instanceof Color)) o = color(o);\n  if (!o) return new Rgb;\n  o = o.rgb();\n  return new Rgb(o.r, o.g, o.b, o.opacity);\n}\n\nexport function rgb(r, g, b, opacity) {\n  return arguments.length === 1 ? rgbConvert(r) : new Rgb(r, g, b, opacity == null ? 1 : opacity);\n}\n\nexport function Rgb(r, g, b, opacity) {\n  this.r = +r;\n  this.g = +g;\n  this.b = +b;\n  this.opacity = +opacity;\n}\n\ndefine(Rgb, rgb, extend(Color, {\n  brighter: function(k) {\n    k = k == null ? brighter : Math.pow(brighter, k);\n    return new Rgb(this.r * k, this.g * k, this.b * k, this.opacity);\n  },\n  darker: function(k) {\n    k = k == null ? darker : Math.pow(darker, k);\n    return new Rgb(this.r * k, this.g * k, this.b * k, this.opacity);\n  },\n  rgb: function() {\n    return this;\n  },\n  displayable: function() {\n    return (-0.5 <= this.r && this.r < 255.5)\n        && (-0.5 <= this.g && this.g < 255.5)\n        && (-0.5 <= this.b && this.b < 255.5)\n        && (0 <= this.opacity && this.opacity <= 1);\n  },\n  hex: rgb_formatHex, // Deprecated! Use color.formatHex.\n  formatHex: rgb_formatHex,\n  formatRgb: rgb_formatRgb,\n  toString: rgb_formatRgb\n}));\n\nfunction rgb_formatHex() {\n  return \"#\" + hex(this.r) + hex(this.g) + hex(this.b);\n}\n\nfunction rgb_formatRgb() {\n  var a = this.opacity; a = isNaN(a) ? 1 : Math.max(0, Math.min(1, a));\n  return (a === 1 ? \"rgb(\" : \"rgba(\")\n      + Math.max(0, Math.min(255, Math.round(this.r) || 0)) + \", \"\n      + Math.max(0, Math.min(255, Math.round(this.g) || 0)) + \", \"\n      + Math.max(0, Math.min(255, Math.round(this.b) || 0))\n      + (a === 1 ? \")\" : \", \" + a + \")\");\n}\n\nfunction hex(value) {\n  value = Math.max(0, Math.min(255, Math.round(value) || 0));\n  return (value < 16 ? \"0\" : \"\") + value.toString(16);\n}\n\nfunction hsla(h, s, l, a) {\n  if (a <= 0) h = s = l = NaN;\n  else if (l <= 0 || l >= 1) h = s = NaN;\n  else if (s <= 0) h = NaN;\n  return new Hsl(h, s, l, a);\n}\n\nexport function hslConvert(o) {\n  if (o instanceof Hsl) return new Hsl(o.h, o.s, o.l, o.opacity);\n  if (!(o instanceof Color)) o = color(o);\n  if (!o) return new Hsl;\n  if (o instanceof Hsl) return o;\n  o = o.rgb();\n  var r = o.r / 255,\n      g = o.g / 255,\n      b = o.b / 255,\n      min = Math.min(r, g, b),\n      max = Math.max(r, g, b),\n      h = NaN,\n      s = max - min,\n      l = (max + min) / 2;\n  if (s) {\n    if (r === max) h = (g - b) / s + (g < b) * 6;\n    else if (g === max) h = (b - r) / s + 2;\n    else h = (r - g) / s + 4;\n    s /= l < 0.5 ? max + min : 2 - max - min;\n    h *= 60;\n  } else {\n    s = l > 0 && l < 1 ? 0 : h;\n  }\n  return new Hsl(h, s, l, o.opacity);\n}\n\nexport function hsl(h, s, l, opacity) {\n  return arguments.length === 1 ? hslConvert(h) : new Hsl(h, s, l, opacity == null ? 1 : opacity);\n}\n\nfunction Hsl(h, s, l, opacity) {\n  this.h = +h;\n  this.s = +s;\n  this.l = +l;\n  this.opacity = +opacity;\n}\n\ndefine(Hsl, hsl, extend(Color, {\n  brighter: function(k) {\n    k = k == null ? brighter : Math.pow(brighter, k);\n    return new Hsl(this.h, this.s, this.l * k, this.opacity);\n  },\n  darker: function(k) {\n    k = k == null ? darker : Math.pow(darker, k);\n    return new Hsl(this.h, this.s, this.l * k, this.opacity);\n  },\n  rgb: function() {\n    var h = this.h % 360 + (this.h < 0) * 360,\n        s = isNaN(h) || isNaN(this.s) ? 0 : this.s,\n        l = this.l,\n        m2 = l + (l < 0.5 ? l : 1 - l) * s,\n        m1 = 2 * l - m2;\n    return new Rgb(\n      hsl2rgb(h >= 240 ? h - 240 : h + 120, m1, m2),\n      hsl2rgb(h, m1, m2),\n      hsl2rgb(h < 120 ? h + 240 : h - 120, m1, m2),\n      this.opacity\n    );\n  },\n  displayable: function() {\n    return (0 <= this.s && this.s <= 1 || isNaN(this.s))\n        && (0 <= this.l && this.l <= 1)\n        && (0 <= this.opacity && this.opacity <= 1);\n  },\n  formatHsl: function() {\n    var a = this.opacity; a = isNaN(a) ? 1 : Math.max(0, Math.min(1, a));\n    return (a === 1 ? \"hsl(\" : \"hsla(\")\n        + (this.h || 0) + \", \"\n        + (this.s || 0) * 100 + \"%, \"\n        + (this.l || 0) * 100 + \"%\"\n        + (a === 1 ? \")\" : \", \" + a + \")\");\n  }\n}));\n\n/* From FvD 13.37, CSS Color Module Level 3 */\nfunction hsl2rgb(h, m1, m2) {\n  return (h < 60 ? m1 + (m2 - m1) * h / 60\n      : h < 180 ? m2\n      : h < 240 ? m1 + (m2 - m1) * (240 - h) / 60\n      : m1) * 255;\n}\n","export function basis(t1, v0, v1, v2, v3) {\n  var t2 = t1 * t1, t3 = t2 * t1;\n  return ((1 - 3 * t1 + 3 * t2 - t3) * v0\n      + (4 - 6 * t2 + 3 * t3) * v1\n      + (1 + 3 * t1 + 3 * t2 - 3 * t3) * v2\n      + t3 * v3) / 6;\n}\n\nexport default function(values) {\n  var n = values.length - 1;\n  return function(t) {\n    var i = t <= 0 ? (t = 0) : t >= 1 ? (t = 1, n - 1) : Math.floor(t * n),\n        v1 = values[i],\n        v2 = values[i + 1],\n        v0 = i > 0 ? values[i - 1] : 2 * v1 - v2,\n        v3 = i < n - 1 ? values[i + 2] : 2 * v2 - v1;\n    return basis((t - i / n) * n, v0, v1, v2, v3);\n  };\n}\n","export default function(x) {\n  return function() {\n    return x;\n  };\n}\n","import constant from \"./constant.js\";\n\nfunction linear(a, d) {\n  return function(t) {\n    return a + t * d;\n  };\n}\n\nfunction exponential(a, b, y) {\n  return a = Math.pow(a, y), b = Math.pow(b, y) - a, y = 1 / y, function(t) {\n    return Math.pow(a + t * b, y);\n  };\n}\n\nexport function hue(a, b) {\n  var d = b - a;\n  return d ? linear(a, d > 180 || d < -180 ? d - 360 * Math.round(d / 360) : d) : constant(isNaN(a) ? b : a);\n}\n\nexport function gamma(y) {\n  return (y = +y) === 1 ? nogamma : function(a, b) {\n    return b - a ? exponential(a, b, y) : constant(isNaN(a) ? b : a);\n  };\n}\n\nexport default function nogamma(a, b) {\n  var d = b - a;\n  return d ? linear(a, d) : constant(isNaN(a) ? b : a);\n}\n","import {rgb as colorRgb} from \"d3-color\";\nimport basis from \"./basis.js\";\nimport basisClosed from \"./basisClosed.js\";\nimport nogamma, {gamma} from \"./color.js\";\n\nexport default (function rgbGamma(y) {\n  var color = gamma(y);\n\n  function rgb(start, end) {\n    var r = color((start = colorRgb(start)).r, (end = colorRgb(end)).r),\n        g = color(start.g, end.g),\n        b = color(start.b, end.b),\n        opacity = nogamma(start.opacity, end.opacity);\n    return function(t) {\n      start.r = r(t);\n      start.g = g(t);\n      start.b = b(t);\n      start.opacity = opacity(t);\n      return start + \"\";\n    };\n  }\n\n  rgb.gamma = rgbGamma;\n\n  return rgb;\n})(1);\n\nfunction rgbSpline(spline) {\n  return function(colors) {\n    var n = colors.length,\n        r = new Array(n),\n        g = new Array(n),\n        b = new Array(n),\n        i, color;\n    for (i = 0; i < n; ++i) {\n      color = colorRgb(colors[i]);\n      r[i] = color.r || 0;\n      g[i] = color.g || 0;\n      b[i] = color.b || 0;\n    }\n    r = spline(r);\n    g = spline(g);\n    b = spline(b);\n    color.opacity = 1;\n    return function(t) {\n      color.r = r(t);\n      color.g = g(t);\n      color.b = b(t);\n      return color + \"\";\n    };\n  };\n}\n\nexport var rgbBasis = rgbSpline(basis);\nexport var rgbBasisClosed = rgbSpline(basisClosed);\n","import {basis} from \"./basis.js\";\n\nexport default function(values) {\n  var n = values.length;\n  return function(t) {\n    var i = Math.floor(((t %= 1) < 0 ? ++t : t) * n),\n        v0 = values[(i + n - 1) % n],\n        v1 = values[i % n],\n        v2 = values[(i + 1) % n],\n        v3 = values[(i + 2) % n];\n    return basis((t - i / n) * n, v0, v1, v2, v3);\n  };\n}\n","import number from \"./number.js\";\n\nvar reA = /[-+]?(?:\\d+\\.?\\d*|\\.?\\d+)(?:[eE][-+]?\\d+)?/g,\n    reB = new RegExp(reA.source, \"g\");\n\nfunction zero(b) {\n  return function() {\n    return b;\n  };\n}\n\nfunction one(b) {\n  return function(t) {\n    return b(t) + \"\";\n  };\n}\n\nexport default function(a, b) {\n  var bi = reA.lastIndex = reB.lastIndex = 0, // scan index for next number in b\n      am, // current match in a\n      bm, // current match in b\n      bs, // string preceding current number in b, if any\n      i = -1, // index in s\n      s = [], // string constants and placeholders\n      q = []; // number interpolators\n\n  // Coerce inputs to strings.\n  a = a + \"\", b = b + \"\";\n\n  // Interpolate pairs of numbers in a & b.\n  while ((am = reA.exec(a))\n      && (bm = reB.exec(b))) {\n    if ((bs = bm.index) > bi) { // a string precedes the next number in b\n      bs = b.slice(bi, bs);\n      if (s[i]) s[i] += bs; // coalesce with previous string\n      else s[++i] = bs;\n    }\n    if ((am = am[0]) === (bm = bm[0])) { // numbers in a & b match\n      if (s[i]) s[i] += bm; // coalesce with previous string\n      else s[++i] = bm;\n    } else { // interpolate non-matching numbers\n      s[++i] = null;\n      q.push({i: i, x: number(am, bm)});\n    }\n    bi = reB.lastIndex;\n  }\n\n  // Add remains of b.\n  if (bi < b.length) {\n    bs = b.slice(bi);\n    if (s[i]) s[i] += bs; // coalesce with previous string\n    else s[++i] = bs;\n  }\n\n  // Special optimization for only a single match.\n  // Otherwise, interpolate each of the numbers and rejoin the string.\n  return s.length < 2 ? (q[0]\n      ? one(q[0].x)\n      : zero(b))\n      : (b = q.length, function(t) {\n          for (var i = 0, o; i < b; ++i) s[(o = q[i]).i] = o.x(t);\n          return s.join(\"\");\n        });\n}\n","import {color} from \"d3-color\";\nimport {interpolateNumber, interpolateRgb, interpolateString} from \"d3-interpolate\";\n\nexport default function(a, b) {\n  var c;\n  return (typeof b === \"number\" ? interpolateNumber\n      : b instanceof color ? interpolateRgb\n      : (c = color(b)) ? (b = c, interpolateRgb)\n      : interpolateString)(a, b);\n}\n","import {interpolateTransformSvg as interpolateTransform} from \"d3-interpolate\";\nimport {namespace} from \"d3-selection\";\nimport {tweenValue} from \"./tween.js\";\nimport interpolate from \"./interpolate.js\";\n\nfunction attrRemove(name) {\n  return function() {\n    this.removeAttribute(name);\n  };\n}\n\nfunction attrRemoveNS(fullname) {\n  return function() {\n    this.removeAttributeNS(fullname.space, fullname.local);\n  };\n}\n\nfunction attrConstant(name, interpolate, value1) {\n  var string00,\n      string1 = value1 + \"\",\n      interpolate0;\n  return function() {\n    var string0 = this.getAttribute(name);\n    return string0 === string1 ? null\n        : string0 === string00 ? interpolate0\n        : interpolate0 = interpolate(string00 = string0, value1);\n  };\n}\n\nfunction attrConstantNS(fullname, interpolate, value1) {\n  var string00,\n      string1 = value1 + \"\",\n      interpolate0;\n  return function() {\n    var string0 = this.getAttributeNS(fullname.space, fullname.local);\n    return string0 === string1 ? null\n        : string0 === string00 ? interpolate0\n        : interpolate0 = interpolate(string00 = string0, value1);\n  };\n}\n\nfunction attrFunction(name, interpolate, value) {\n  var string00,\n      string10,\n      interpolate0;\n  return function() {\n    var string0, value1 = value(this), string1;\n    if (value1 == null) return void this.removeAttribute(name);\n    string0 = this.getAttribute(name);\n    string1 = value1 + \"\";\n    return string0 === string1 ? null\n        : string0 === string00 && string1 === string10 ? interpolate0\n        : (string10 = string1, interpolate0 = interpolate(string00 = string0, value1));\n  };\n}\n\nfunction attrFunctionNS(fullname, interpolate, value) {\n  var string00,\n      string10,\n      interpolate0;\n  return function() {\n    var string0, value1 = value(this), string1;\n    if (value1 == null) return void this.removeAttributeNS(fullname.space, fullname.local);\n    string0 = this.getAttributeNS(fullname.space, fullname.local);\n    string1 = value1 + \"\";\n    return string0 === string1 ? null\n        : string0 === string00 && string1 === string10 ? interpolate0\n        : (string10 = string1, interpolate0 = interpolate(string00 = string0, value1));\n  };\n}\n\nexport default function(name, value) {\n  var fullname = namespace(name), i = fullname === \"transform\" ? interpolateTransform : interpolate;\n  return this.attrTween(name, typeof value === \"function\"\n      ? (fullname.local ? attrFunctionNS : attrFunction)(fullname, i, tweenValue(this, \"attr.\" + name, value))\n      : value == null ? (fullname.local ? attrRemoveNS : attrRemove)(fullname)\n      : (fullname.local ? attrConstantNS : attrConstant)(fullname, i, value));\n}\n","import {namespace} from \"d3-selection\";\n\nfunction attrInterpolate(name, i) {\n  return function(t) {\n    this.setAttribute(name, i.call(this, t));\n  };\n}\n\nfunction attrInterpolateNS(fullname, i) {\n  return function(t) {\n    this.setAttributeNS(fullname.space, fullname.local, i.call(this, t));\n  };\n}\n\nfunction attrTweenNS(fullname, value) {\n  var t0, i0;\n  function tween() {\n    var i = value.apply(this, arguments);\n    if (i !== i0) t0 = (i0 = i) && attrInterpolateNS(fullname, i);\n    return t0;\n  }\n  tween._value = value;\n  return tween;\n}\n\nfunction attrTween(name, value) {\n  var t0, i0;\n  function tween() {\n    var i = value.apply(this, arguments);\n    if (i !== i0) t0 = (i0 = i) && attrInterpolate(name, i);\n    return t0;\n  }\n  tween._value = value;\n  return tween;\n}\n\nexport default function(name, value) {\n  var key = \"attr.\" + name;\n  if (arguments.length < 2) return (key = this.tween(key)) && key._value;\n  if (value == null) return this.tween(key, null);\n  if (typeof value !== \"function\") throw new Error;\n  var fullname = namespace(name);\n  return this.tween(key, (fullname.local ? attrTweenNS : attrTween)(fullname, value));\n}\n","import {get, init} from \"./schedule.js\";\n\nfunction delayFunction(id, value) {\n  return function() {\n    init(this, id).delay = +value.apply(this, arguments);\n  };\n}\n\nfunction delayConstant(id, value) {\n  return value = +value, function() {\n    init(this, id).delay = value;\n  };\n}\n\nexport default function(value) {\n  var id = this._id;\n\n  return arguments.length\n      ? this.each((typeof value === \"function\"\n          ? delayFunction\n          : delayConstant)(id, value))\n      : get(this.node(), id).delay;\n}\n","import {get, set} from \"./schedule.js\";\n\nfunction durationFunction(id, value) {\n  return function() {\n    set(this, id).duration = +value.apply(this, arguments);\n  };\n}\n\nfunction durationConstant(id, value) {\n  return value = +value, function() {\n    set(this, id).duration = value;\n  };\n}\n\nexport default function(value) {\n  var id = this._id;\n\n  return arguments.length\n      ? this.each((typeof value === \"function\"\n          ? durationFunction\n          : durationConstant)(id, value))\n      : get(this.node(), id).duration;\n}\n","import {selection} from \"d3-selection\";\n\nvar Selection = selection.prototype.constructor;\n\nexport default function() {\n  return new Selection(this._groups, this._parents);\n}\n","import {interpolateTransformCss as interpolateTransform} from \"d3-interpolate\";\nimport {style} from \"d3-selection\";\nimport {set} from \"./schedule.js\";\nimport {tweenValue} from \"./tween.js\";\nimport interpolate from \"./interpolate.js\";\n\nfunction styleNull(name, interpolate) {\n  var string00,\n      string10,\n      interpolate0;\n  return function() {\n    var string0 = style(this, name),\n        string1 = (this.style.removeProperty(name), style(this, name));\n    return string0 === string1 ? null\n        : string0 === string00 && string1 === string10 ? interpolate0\n        : interpolate0 = interpolate(string00 = string0, string10 = string1);\n  };\n}\n\nfunction styleRemove(name) {\n  return function() {\n    this.style.removeProperty(name);\n  };\n}\n\nfunction styleConstant(name, interpolate, value1) {\n  var string00,\n      string1 = value1 + \"\",\n      interpolate0;\n  return function() {\n    var string0 = style(this, name);\n    return string0 === string1 ? null\n        : string0 === string00 ? interpolate0\n        : interpolate0 = interpolate(string00 = string0, value1);\n  };\n}\n\nfunction styleFunction(name, interpolate, value) {\n  var string00,\n      string10,\n      interpolate0;\n  return function() {\n    var string0 = style(this, name),\n        value1 = value(this),\n        string1 = value1 + \"\";\n    if (value1 == null) string1 = value1 = (this.style.removeProperty(name), style(this, name));\n    return string0 === string1 ? null\n        : string0 === string00 && string1 === string10 ? interpolate0\n        : (string10 = string1, interpolate0 = interpolate(string00 = string0, value1));\n  };\n}\n\nfunction styleMaybeRemove(id, name) {\n  var on0, on1, listener0, key = \"style.\" + name, event = \"end.\" + key, remove;\n  return function() {\n    var schedule = set(this, id),\n        on = schedule.on,\n        listener = schedule.value[key] == null ? remove || (remove = styleRemove(name)) : undefined;\n\n    // If this node shared a dispatch with the previous node,\n    // just assign the updated shared dispatch and we’re done!\n    // Otherwise, copy-on-write.\n    if (on !== on0 || listener0 !== listener) (on1 = (on0 = on).copy()).on(event, listener0 = listener);\n\n    schedule.on = on1;\n  };\n}\n\nexport default function(name, value, priority) {\n  var i = (name += \"\") === \"transform\" ? interpolateTransform : interpolate;\n  return value == null ? this\n      .styleTween(name, styleNull(name, i))\n      .on(\"end.style.\" + name, styleRemove(name))\n    : typeof value === \"function\" ? this\n      .styleTween(name, styleFunction(name, i, tweenValue(this, \"style.\" + name, value)))\n      .each(styleMaybeRemove(this._id, name))\n    : this\n      .styleTween(name, styleConstant(name, i, value), priority)\n      .on(\"end.style.\" + name, null);\n}\n","import {selection} from \"d3-selection\";\nimport transition_attr from \"./attr.js\";\nimport transition_attrTween from \"./attrTween.js\";\nimport transition_delay from \"./delay.js\";\nimport transition_duration from \"./duration.js\";\nimport transition_ease from \"./ease.js\";\nimport transition_filter from \"./filter.js\";\nimport transition_merge from \"./merge.js\";\nimport transition_on from \"./on.js\";\nimport transition_remove from \"./remove.js\";\nimport transition_select from \"./select.js\";\nimport transition_selectAll from \"./selectAll.js\";\nimport transition_selection from \"./selection.js\";\nimport transition_style from \"./style.js\";\nimport transition_styleTween from \"./styleTween.js\";\nimport transition_text from \"./text.js\";\nimport transition_textTween from \"./textTween.js\";\nimport transition_transition from \"./transition.js\";\nimport transition_tween from \"./tween.js\";\nimport transition_end from \"./end.js\";\n\nvar id = 0;\n\nexport function Transition(groups, parents, name, id) {\n  this._groups = groups;\n  this._parents = parents;\n  this._name = name;\n  this._id = id;\n}\n\nexport default function transition(name) {\n  return selection().transition(name);\n}\n\nexport function newId() {\n  return ++id;\n}\n\nvar selection_prototype = selection.prototype;\n\nTransition.prototype = transition.prototype = {\n  constructor: Transition,\n  select: transition_select,\n  selectAll: transition_selectAll,\n  filter: transition_filter,\n  merge: transition_merge,\n  selection: transition_selection,\n  transition: transition_transition,\n  call: selection_prototype.call,\n  nodes: selection_prototype.nodes,\n  node: selection_prototype.node,\n  size: selection_prototype.size,\n  empty: selection_prototype.empty,\n  each: selection_prototype.each,\n  on: transition_on,\n  attr: transition_attr,\n  attrTween: transition_attrTween,\n  style: transition_style,\n  styleTween: transition_styleTween,\n  text: transition_text,\n  textTween: transition_textTween,\n  remove: transition_remove,\n  tween: transition_tween,\n  delay: transition_delay,\n  duration: transition_duration,\n  ease: transition_ease,\n  end: transition_end\n};\n","import {selector} from \"d3-selection\";\nimport {Transition} from \"./index.js\";\nimport schedule, {get} from \"./schedule.js\";\n\nexport default function(select) {\n  var name = this._name,\n      id = this._id;\n\n  if (typeof select !== \"function\") select = selector(select);\n\n  for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, subgroup = subgroups[j] = new Array(n), node, subnode, i = 0; i < n; ++i) {\n      if ((node = group[i]) && (subnode = select.call(node, node.__data__, i, group))) {\n        if (\"__data__\" in node) subnode.__data__ = node.__data__;\n        subgroup[i] = subnode;\n        schedule(subgroup[i], name, id, i, subgroup, get(node, id));\n      }\n    }\n  }\n\n  return new Transition(subgroups, this._parents, name, id);\n}\n","import {selectorAll} from \"d3-selection\";\nimport {Transition} from \"./index.js\";\nimport schedule, {get} from \"./schedule.js\";\n\nexport default function(select) {\n  var name = this._name,\n      id = this._id;\n\n  if (typeof select !== \"function\") select = selectorAll(select);\n\n  for (var groups = this._groups, m = groups.length, subgroups = [], parents = [], j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, node, i = 0; i < n; ++i) {\n      if (node = group[i]) {\n        for (var children = select.call(node, node.__data__, i, group), child, inherit = get(node, id), k = 0, l = children.length; k < l; ++k) {\n          if (child = children[k]) {\n            schedule(child, name, id, k, children, inherit);\n          }\n        }\n        subgroups.push(children);\n        parents.push(node);\n      }\n    }\n  }\n\n  return new Transition(subgroups, parents, name, id);\n}\n","import {matcher} from \"d3-selection\";\nimport {Transition} from \"./index.js\";\n\nexport default function(match) {\n  if (typeof match !== \"function\") match = matcher(match);\n\n  for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, subgroup = subgroups[j] = [], node, i = 0; i < n; ++i) {\n      if ((node = group[i]) && match.call(node, node.__data__, i, group)) {\n        subgroup.push(node);\n      }\n    }\n  }\n\n  return new Transition(subgroups, this._parents, this._name, this._id);\n}\n","import {Transition} from \"./index.js\";\n\nexport default function(transition) {\n  if (transition._id !== this._id) throw new Error;\n\n  for (var groups0 = this._groups, groups1 = transition._groups, m0 = groups0.length, m1 = groups1.length, m = Math.min(m0, m1), merges = new Array(m0), j = 0; j < m; ++j) {\n    for (var group0 = groups0[j], group1 = groups1[j], n = group0.length, merge = merges[j] = new Array(n), node, i = 0; i < n; ++i) {\n      if (node = group0[i] || group1[i]) {\n        merge[i] = node;\n      }\n    }\n  }\n\n  for (; j < m0; ++j) {\n    merges[j] = groups0[j];\n  }\n\n  return new Transition(merges, this._parents, this._name, this._id);\n}\n","import {Transition, newId} from \"./index.js\";\nimport schedule, {get} from \"./schedule.js\";\n\nexport default function() {\n  var name = this._name,\n      id0 = this._id,\n      id1 = newId();\n\n  for (var groups = this._groups, m = groups.length, j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, node, i = 0; i < n; ++i) {\n      if (node = group[i]) {\n        var inherit = get(node, id0);\n        schedule(node, name, id1, i, group, {\n          time: inherit.time + inherit.delay + inherit.duration,\n          delay: 0,\n          duration: inherit.duration,\n          ease: inherit.ease\n        });\n      }\n    }\n  }\n\n  return new Transition(groups, this._parents, name, id1);\n}\n","import {get, set, init} from \"./schedule.js\";\n\nfunction start(name) {\n  return (name + \"\").trim().split(/^|\\s+/).every(function(t) {\n    var i = t.indexOf(\".\");\n    if (i >= 0) t = t.slice(0, i);\n    return !t || t === \"start\";\n  });\n}\n\nfunction onFunction(id, name, listener) {\n  var on0, on1, sit = start(name) ? init : set;\n  return function() {\n    var schedule = sit(this, id),\n        on = schedule.on;\n\n    // If this node shared a dispatch with the previous node,\n    // just assign the updated shared dispatch and we’re done!\n    // Otherwise, copy-on-write.\n    if (on !== on0) (on1 = (on0 = on).copy()).on(name, listener);\n\n    schedule.on = on1;\n  };\n}\n\nexport default function(name, listener) {\n  var id = this._id;\n\n  return arguments.length < 2\n      ? get(this.node(), id).on.on(name)\n      : this.each(onFunction(id, name, listener));\n}\n","function styleInterpolate(name, i, priority) {\n  return function(t) {\n    this.style.setProperty(name, i.call(this, t), priority);\n  };\n}\n\nfunction styleTween(name, value, priority) {\n  var t, i0;\n  function tween() {\n    var i = value.apply(this, arguments);\n    if (i !== i0) t = (i0 = i) && styleInterpolate(name, i, priority);\n    return t;\n  }\n  tween._value = value;\n  return tween;\n}\n\nexport default function(name, value, priority) {\n  var key = \"style.\" + (name += \"\");\n  if (arguments.length < 2) return (key = this.tween(key)) && key._value;\n  if (value == null) return this.tween(key, null);\n  if (typeof value !== \"function\") throw new Error;\n  return this.tween(key, styleTween(name, value, priority == null ? \"\" : priority));\n}\n","import {tweenValue} from \"./tween.js\";\n\nfunction textConstant(value) {\n  return function() {\n    this.textContent = value;\n  };\n}\n\nfunction textFunction(value) {\n  return function() {\n    var value1 = value(this);\n    this.textContent = value1 == null ? \"\" : value1;\n  };\n}\n\nexport default function(value) {\n  return this.tween(\"text\", typeof value === \"function\"\n      ? textFunction(tweenValue(this, \"text\", value))\n      : textConstant(value == null ? \"\" : value + \"\"));\n}\n","function textInterpolate(i) {\n  return function(t) {\n    this.textContent = i.call(this, t);\n  };\n}\n\nfunction textTween(value) {\n  var t0, i0;\n  function tween() {\n    var i = value.apply(this, arguments);\n    if (i !== i0) t0 = (i0 = i) && textInterpolate(i);\n    return t0;\n  }\n  tween._value = value;\n  return tween;\n}\n\nexport default function(value) {\n  var key = \"text\";\n  if (arguments.length < 1) return (key = this.tween(key)) && key._value;\n  if (value == null) return this.tween(key, null);\n  if (typeof value !== \"function\") throw new Error;\n  return this.tween(key, textTween(value));\n}\n","function removeFunction(id) {\n  return function() {\n    var parent = this.parentNode;\n    for (var i in this.__transition) if (+i !== id) return;\n    if (parent) parent.removeChild(this);\n  };\n}\n\nexport default function() {\n  return this.on(\"end.remove\", removeFunction(this._id));\n}\n","import {get, set} from \"./schedule.js\";\n\nfunction easeConstant(id, value) {\n  if (typeof value !== \"function\") throw new Error;\n  return function() {\n    set(this, id).ease = value;\n  };\n}\n\nexport default function(value) {\n  var id = this._id;\n\n  return arguments.length\n      ? this.each(easeConstant(id, value))\n      : get(this.node(), id).ease;\n}\n","import {set} from \"./schedule.js\";\n\nexport default function() {\n  var on0, on1, that = this, id = that._id, size = that.size();\n  return new Promise(function(resolve, reject) {\n    var cancel = {value: reject},\n        end = {value: function() { if (--size === 0) resolve(); }};\n\n    that.each(function() {\n      var schedule = set(this, id),\n          on = schedule.on;\n\n      // If this node shared a dispatch with the previous node,\n      // just assign the updated shared dispatch and we’re done!\n      // Otherwise, copy-on-write.\n      if (on !== on0) {\n        on1 = (on0 = on).copy();\n        on1._.cancel.push(cancel);\n        on1._.interrupt.push(cancel);\n        on1._.end.push(end);\n      }\n\n      schedule.on = on1;\n    });\n  });\n}\n","import {Transition, newId} from \"../transition/index.js\";\nimport schedule from \"../transition/schedule.js\";\nimport {easeCubicInOut} from \"d3-ease\";\nimport {now} from \"d3-timer\";\n\nvar defaultTiming = {\n  time: null, // Set on use.\n  delay: 0,\n  duration: 250,\n  ease: easeCubicInOut\n};\n\nfunction inherit(node, id) {\n  var timing;\n  while (!(timing = node.__transition) || !(timing = timing[id])) {\n    if (!(node = node.parentNode)) {\n      return defaultTiming.time = now(), defaultTiming;\n    }\n  }\n  return timing;\n}\n\nexport default function(name) {\n  var id,\n      timing;\n\n  if (name instanceof Transition) {\n    id = name._id, name = name._name;\n  } else {\n    id = newId(), (timing = defaultTiming).time = now(), name = name == null ? null : name + \"\";\n  }\n\n  for (var groups = this._groups, m = groups.length, j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, node, i = 0; i < n; ++i) {\n      if (node = group[i]) {\n        schedule(node, name, id, i, group, timing || inherit(node, id));\n      }\n    }\n  }\n\n  return new Transition(groups, this._parents, name, id);\n}\n","export function cubicIn(t) {\n  return t * t * t;\n}\n\nexport function cubicOut(t) {\n  return --t * t * t + 1;\n}\n\nexport function cubicInOut(t) {\n  return ((t *= 2) <= 1 ? t * t * t : (t -= 2) * t * t + 2) / 2;\n}\n","export default function(x) {\n  return function() {\n    return x;\n  };\n}\n","export default function ZoomEvent(target, type, transform) {\n  this.target = target;\n  this.type = type;\n  this.transform = transform;\n}\n","export function Transform(k, x, y) {\n  this.k = k;\n  this.x = x;\n  this.y = y;\n}\n\nTransform.prototype = {\n  constructor: Transform,\n  scale: function(k) {\n    return k === 1 ? this : new Transform(this.k * k, this.x, this.y);\n  },\n  translate: function(x, y) {\n    return x === 0 & y === 0 ? this : new Transform(this.k, this.x + this.k * x, this.y + this.k * y);\n  },\n  apply: function(point) {\n    return [point[0] * this.k + this.x, point[1] * this.k + this.y];\n  },\n  applyX: function(x) {\n    return x * this.k + this.x;\n  },\n  applyY: function(y) {\n    return y * this.k + this.y;\n  },\n  invert: function(location) {\n    return [(location[0] - this.x) / this.k, (location[1] - this.y) / this.k];\n  },\n  invertX: function(x) {\n    return (x - this.x) / this.k;\n  },\n  invertY: function(y) {\n    return (y - this.y) / this.k;\n  },\n  rescaleX: function(x) {\n    return x.copy().domain(x.range().map(this.invertX, this).map(x.invert, x));\n  },\n  rescaleY: function(y) {\n    return y.copy().domain(y.range().map(this.invertY, this).map(y.invert, y));\n  },\n  toString: function() {\n    return \"translate(\" + this.x + \",\" + this.y + \") scale(\" + this.k + \")\";\n  }\n};\n\nexport var identity = new Transform(1, 0, 0);\n\ntransform.prototype = Transform.prototype;\n\nexport default function transform(node) {\n  while (!node.__zoom) if (!(node = node.parentNode)) return identity;\n  return node.__zoom;\n}\n","import {selection} from \"d3-selection\";\nimport selection_interrupt from \"./interrupt.js\";\nimport selection_transition from \"./transition.js\";\n\nselection.prototype.interrupt = selection_interrupt;\nselection.prototype.transition = selection_transition;\n","import interrupt from \"../interrupt.js\";\n\nexport default function(name) {\n  return this.each(function() {\n    interrupt(this, name);\n  });\n}\n","import {event} from \"d3-selection\";\n\nexport function nopropagation() {\n  event.stopImmediatePropagation();\n}\n\nexport default function() {\n  event.preventDefault();\n  event.stopImmediatePropagation();\n}\n","import {dispatch} from \"d3-dispatch\";\nimport {dragDisable, dragEnable} from \"d3-drag\";\nimport {interpolateZoom} from \"d3-interpolate\";\nimport {event, customEvent, select, mouse, touch} from \"d3-selection\";\nimport {interrupt} from \"d3-transition\";\nimport constant from \"./constant.js\";\nimport ZoomEvent from \"./event.js\";\nimport {Transform, identity} from \"./transform.js\";\nimport noevent, {nopropagation} from \"./noevent.js\";\n\n// Ignore right-click, since that should open the context menu.\nfunction defaultFilter() {\n  return !event.ctrlKey && !event.button;\n}\n\nfunction defaultExtent() {\n  var e = this;\n  if (e instanceof SVGElement) {\n    e = e.ownerSVGElement || e;\n    if (e.hasAttribute(\"viewBox\")) {\n      e = e.viewBox.baseVal;\n      return [[e.x, e.y], [e.x + e.width, e.y + e.height]];\n    }\n    return [[0, 0], [e.width.baseVal.value, e.height.baseVal.value]];\n  }\n  return [[0, 0], [e.clientWidth, e.clientHeight]];\n}\n\nfunction defaultTransform() {\n  return this.__zoom || identity;\n}\n\nfunction defaultWheelDelta() {\n  return -event.deltaY * (event.deltaMode === 1 ? 0.05 : event.deltaMode ? 1 : 0.002);\n}\n\nfunction defaultTouchable() {\n  return navigator.maxTouchPoints || (\"ontouchstart\" in this);\n}\n\nfunction defaultConstrain(transform, extent, translateExtent) {\n  var dx0 = transform.invertX(extent[0][0]) - translateExtent[0][0],\n      dx1 = transform.invertX(extent[1][0]) - translateExtent[1][0],\n      dy0 = transform.invertY(extent[0][1]) - translateExtent[0][1],\n      dy1 = transform.invertY(extent[1][1]) - translateExtent[1][1];\n  return transform.translate(\n    dx1 > dx0 ? (dx0 + dx1) / 2 : Math.min(0, dx0) || Math.max(0, dx1),\n    dy1 > dy0 ? (dy0 + dy1) / 2 : Math.min(0, dy0) || Math.max(0, dy1)\n  );\n}\n\nexport default function() {\n  var filter = defaultFilter,\n      extent = defaultExtent,\n      constrain = defaultConstrain,\n      wheelDelta = defaultWheelDelta,\n      touchable = defaultTouchable,\n      scaleExtent = [0, Infinity],\n      translateExtent = [[-Infinity, -Infinity], [Infinity, Infinity]],\n      duration = 250,\n      interpolate = interpolateZoom,\n      listeners = dispatch(\"start\", \"zoom\", \"end\"),\n      touchstarting,\n      touchending,\n      touchDelay = 500,\n      wheelDelay = 150,\n      clickDistance2 = 0;\n\n  function zoom(selection) {\n    selection\n        .property(\"__zoom\", defaultTransform)\n        .on(\"wheel.zoom\", wheeled)\n        .on(\"mousedown.zoom\", mousedowned)\n        .on(\"dblclick.zoom\", dblclicked)\n      .filter(touchable)\n        .on(\"touchstart.zoom\", touchstarted)\n        .on(\"touchmove.zoom\", touchmoved)\n        .on(\"touchend.zoom touchcancel.zoom\", touchended)\n        .style(\"touch-action\", \"none\")\n        .style(\"-webkit-tap-highlight-color\", \"rgba(0,0,0,0)\");\n  }\n\n  zoom.transform = function(collection, transform, point) {\n    var selection = collection.selection ? collection.selection() : collection;\n    selection.property(\"__zoom\", defaultTransform);\n    if (collection !== selection) {\n      schedule(collection, transform, point);\n    } else {\n      selection.interrupt().each(function() {\n        gesture(this, arguments)\n            .start()\n            .zoom(null, typeof transform === \"function\" ? transform.apply(this, arguments) : transform)\n            .end();\n      });\n    }\n  };\n\n  zoom.scaleBy = function(selection, k, p) {\n    zoom.scaleTo(selection, function() {\n      var k0 = this.__zoom.k,\n          k1 = typeof k === \"function\" ? k.apply(this, arguments) : k;\n      return k0 * k1;\n    }, p);\n  };\n\n  zoom.scaleTo = function(selection, k, p) {\n    zoom.transform(selection, function() {\n      var e = extent.apply(this, arguments),\n          t0 = this.__zoom,\n          p0 = p == null ? centroid(e) : typeof p === \"function\" ? p.apply(this, arguments) : p,\n          p1 = t0.invert(p0),\n          k1 = typeof k === \"function\" ? k.apply(this, arguments) : k;\n      return constrain(translate(scale(t0, k1), p0, p1), e, translateExtent);\n    }, p);\n  };\n\n  zoom.translateBy = function(selection, x, y) {\n    zoom.transform(selection, function() {\n      return constrain(this.__zoom.translate(\n        typeof x === \"function\" ? x.apply(this, arguments) : x,\n        typeof y === \"function\" ? y.apply(this, arguments) : y\n      ), extent.apply(this, arguments), translateExtent);\n    });\n  };\n\n  zoom.translateTo = function(selection, x, y, p) {\n    zoom.transform(selection, function() {\n      var e = extent.apply(this, arguments),\n          t = this.__zoom,\n          p0 = p == null ? centroid(e) : typeof p === \"function\" ? p.apply(this, arguments) : p;\n      return constrain(identity.translate(p0[0], p0[1]).scale(t.k).translate(\n        typeof x === \"function\" ? -x.apply(this, arguments) : -x,\n        typeof y === \"function\" ? -y.apply(this, arguments) : -y\n      ), e, translateExtent);\n    }, p);\n  };\n\n  function scale(transform, k) {\n    k = Math.max(scaleExtent[0], Math.min(scaleExtent[1], k));\n    return k === transform.k ? transform : new Transform(k, transform.x, transform.y);\n  }\n\n  function translate(transform, p0, p1) {\n    var x = p0[0] - p1[0] * transform.k, y = p0[1] - p1[1] * transform.k;\n    return x === transform.x && y === transform.y ? transform : new Transform(transform.k, x, y);\n  }\n\n  function centroid(extent) {\n    return [(+extent[0][0] + +extent[1][0]) / 2, (+extent[0][1] + +extent[1][1]) / 2];\n  }\n\n  function schedule(transition, transform, point) {\n    transition\n        .on(\"start.zoom\", function() { gesture(this, arguments).start(); })\n        .on(\"interrupt.zoom end.zoom\", function() { gesture(this, arguments).end(); })\n        .tween(\"zoom\", function() {\n          var that = this,\n              args = arguments,\n              g = gesture(that, args),\n              e = extent.apply(that, args),\n              p = point == null ? centroid(e) : typeof point === \"function\" ? point.apply(that, args) : point,\n              w = Math.max(e[1][0] - e[0][0], e[1][1] - e[0][1]),\n              a = that.__zoom,\n              b = typeof transform === \"function\" ? transform.apply(that, args) : transform,\n              i = interpolate(a.invert(p).concat(w / a.k), b.invert(p).concat(w / b.k));\n          return function(t) {\n            if (t === 1) t = b; // Avoid rounding error on end.\n            else { var l = i(t), k = w / l[2]; t = new Transform(k, p[0] - l[0] * k, p[1] - l[1] * k); }\n            g.zoom(null, t);\n          };\n        });\n  }\n\n  function gesture(that, args, clean) {\n    return (!clean && that.__zooming) || new Gesture(that, args);\n  }\n\n  function Gesture(that, args) {\n    this.that = that;\n    this.args = args;\n    this.active = 0;\n    this.extent = extent.apply(that, args);\n    this.taps = 0;\n  }\n\n  Gesture.prototype = {\n    start: function() {\n      if (++this.active === 1) {\n        this.that.__zooming = this;\n        this.emit(\"start\");\n      }\n      return this;\n    },\n    zoom: function(key, transform) {\n      if (this.mouse && key !== \"mouse\") this.mouse[1] = transform.invert(this.mouse[0]);\n      if (this.touch0 && key !== \"touch\") this.touch0[1] = transform.invert(this.touch0[0]);\n      if (this.touch1 && key !== \"touch\") this.touch1[1] = transform.invert(this.touch1[0]);\n      this.that.__zoom = transform;\n      this.emit(\"zoom\");\n      return this;\n    },\n    end: function() {\n      if (--this.active === 0) {\n        delete this.that.__zooming;\n        this.emit(\"end\");\n      }\n      return this;\n    },\n    emit: function(type) {\n      customEvent(new ZoomEvent(zoom, type, this.that.__zoom), listeners.apply, listeners, [type, this.that, this.args]);\n    }\n  };\n\n  function wheeled() {\n    if (!filter.apply(this, arguments)) return;\n    var g = gesture(this, arguments),\n        t = this.__zoom,\n        k = Math.max(scaleExtent[0], Math.min(scaleExtent[1], t.k * Math.pow(2, wheelDelta.apply(this, arguments)))),\n        p = mouse(this);\n\n    // If the mouse is in the same location as before, reuse it.\n    // If there were recent wheel events, reset the wheel idle timeout.\n    if (g.wheel) {\n      if (g.mouse[0][0] !== p[0] || g.mouse[0][1] !== p[1]) {\n        g.mouse[1] = t.invert(g.mouse[0] = p);\n      }\n      clearTimeout(g.wheel);\n    }\n\n    // If this wheel event won’t trigger a transform change, ignore it.\n    else if (t.k === k) return;\n\n    // Otherwise, capture the mouse point and location at the start.\n    else {\n      g.mouse = [p, t.invert(p)];\n      interrupt(this);\n      g.start();\n    }\n\n    noevent();\n    g.wheel = setTimeout(wheelidled, wheelDelay);\n    g.zoom(\"mouse\", constrain(translate(scale(t, k), g.mouse[0], g.mouse[1]), g.extent, translateExtent));\n\n    function wheelidled() {\n      g.wheel = null;\n      g.end();\n    }\n  }\n\n  function mousedowned() {\n    if (touchending || !filter.apply(this, arguments)) return;\n    var g = gesture(this, arguments, true),\n        v = select(event.view).on(\"mousemove.zoom\", mousemoved, true).on(\"mouseup.zoom\", mouseupped, true),\n        p = mouse(this),\n        x0 = event.clientX,\n        y0 = event.clientY;\n\n    dragDisable(event.view);\n    nopropagation();\n    g.mouse = [p, this.__zoom.invert(p)];\n    interrupt(this);\n    g.start();\n\n    function mousemoved() {\n      noevent();\n      if (!g.moved) {\n        var dx = event.clientX - x0, dy = event.clientY - y0;\n        g.moved = dx * dx + dy * dy > clickDistance2;\n      }\n      g.zoom(\"mouse\", constrain(translate(g.that.__zoom, g.mouse[0] = mouse(g.that), g.mouse[1]), g.extent, translateExtent));\n    }\n\n    function mouseupped() {\n      v.on(\"mousemove.zoom mouseup.zoom\", null);\n      dragEnable(event.view, g.moved);\n      noevent();\n      g.end();\n    }\n  }\n\n  function dblclicked() {\n    if (!filter.apply(this, arguments)) return;\n    var t0 = this.__zoom,\n        p0 = mouse(this),\n        p1 = t0.invert(p0),\n        k1 = t0.k * (event.shiftKey ? 0.5 : 2),\n        t1 = constrain(translate(scale(t0, k1), p0, p1), extent.apply(this, arguments), translateExtent);\n\n    noevent();\n    if (duration > 0) select(this).transition().duration(duration).call(schedule, t1, p0);\n    else select(this).call(zoom.transform, t1);\n  }\n\n  function touchstarted() {\n    if (!filter.apply(this, arguments)) return;\n    var touches = event.touches,\n        n = touches.length,\n        g = gesture(this, arguments, event.changedTouches.length === n),\n        started, i, t, p;\n\n    nopropagation();\n    for (i = 0; i < n; ++i) {\n      t = touches[i], p = touch(this, touches, t.identifier);\n      p = [p, this.__zoom.invert(p), t.identifier];\n      if (!g.touch0) g.touch0 = p, started = true, g.taps = 1 + !!touchstarting;\n      else if (!g.touch1 && g.touch0[2] !== p[2]) g.touch1 = p, g.taps = 0;\n    }\n\n    if (touchstarting) touchstarting = clearTimeout(touchstarting);\n\n    if (started) {\n      if (g.taps < 2) touchstarting = setTimeout(function() { touchstarting = null; }, touchDelay);\n      interrupt(this);\n      g.start();\n    }\n  }\n\n  function touchmoved() {\n    if (!this.__zooming) return;\n    var g = gesture(this, arguments),\n        touches = event.changedTouches,\n        n = touches.length, i, t, p, l;\n\n    noevent();\n    if (touchstarting) touchstarting = clearTimeout(touchstarting);\n    g.taps = 0;\n    for (i = 0; i < n; ++i) {\n      t = touches[i], p = touch(this, touches, t.identifier);\n      if (g.touch0 && g.touch0[2] === t.identifier) g.touch0[0] = p;\n      else if (g.touch1 && g.touch1[2] === t.identifier) g.touch1[0] = p;\n    }\n    t = g.that.__zoom;\n    if (g.touch1) {\n      var p0 = g.touch0[0], l0 = g.touch0[1],\n          p1 = g.touch1[0], l1 = g.touch1[1],\n          dp = (dp = p1[0] - p0[0]) * dp + (dp = p1[1] - p0[1]) * dp,\n          dl = (dl = l1[0] - l0[0]) * dl + (dl = l1[1] - l0[1]) * dl;\n      t = scale(t, Math.sqrt(dp / dl));\n      p = [(p0[0] + p1[0]) / 2, (p0[1] + p1[1]) / 2];\n      l = [(l0[0] + l1[0]) / 2, (l0[1] + l1[1]) / 2];\n    }\n    else if (g.touch0) p = g.touch0[0], l = g.touch0[1];\n    else return;\n    g.zoom(\"touch\", constrain(translate(t, p, l), g.extent, translateExtent));\n  }\n\n  function touchended() {\n    if (!this.__zooming) return;\n    var g = gesture(this, arguments),\n        touches = event.changedTouches,\n        n = touches.length, i, t;\n\n    nopropagation();\n    if (touchending) clearTimeout(touchending);\n    touchending = setTimeout(function() { touchending = null; }, touchDelay);\n    for (i = 0; i < n; ++i) {\n      t = touches[i];\n      if (g.touch0 && g.touch0[2] === t.identifier) delete g.touch0;\n      else if (g.touch1 && g.touch1[2] === t.identifier) delete g.touch1;\n    }\n    if (g.touch1 && !g.touch0) g.touch0 = g.touch1, delete g.touch1;\n    if (g.touch0) g.touch0[1] = this.__zoom.invert(g.touch0[0]);\n    else {\n      g.end();\n      // If this was a dbltap, reroute to the (optional) dblclick.zoom handler.\n      if (g.taps === 2) {\n        var p = select(this).on(\"dblclick.zoom\");\n        if (p) p.apply(this, arguments);\n      }\n    }\n  }\n\n  zoom.wheelDelta = function(_) {\n    return arguments.length ? (wheelDelta = typeof _ === \"function\" ? _ : constant(+_), zoom) : wheelDelta;\n  };\n\n  zoom.filter = function(_) {\n    return arguments.length ? (filter = typeof _ === \"function\" ? _ : constant(!!_), zoom) : filter;\n  };\n\n  zoom.touchable = function(_) {\n    return arguments.length ? (touchable = typeof _ === \"function\" ? _ : constant(!!_), zoom) : touchable;\n  };\n\n  zoom.extent = function(_) {\n    return arguments.length ? (extent = typeof _ === \"function\" ? _ : constant([[+_[0][0], +_[0][1]], [+_[1][0], +_[1][1]]]), zoom) : extent;\n  };\n\n  zoom.scaleExtent = function(_) {\n    return arguments.length ? (scaleExtent[0] = +_[0], scaleExtent[1] = +_[1], zoom) : [scaleExtent[0], scaleExtent[1]];\n  };\n\n  zoom.translateExtent = function(_) {\n    return arguments.length ? (translateExtent[0][0] = +_[0][0], translateExtent[1][0] = +_[1][0], translateExtent[0][1] = +_[0][1], translateExtent[1][1] = +_[1][1], zoom) : [[translateExtent[0][0], translateExtent[0][1]], [translateExtent[1][0], translateExtent[1][1]]];\n  };\n\n  zoom.constrain = function(_) {\n    return arguments.length ? (constrain = _, zoom) : constrain;\n  };\n\n  zoom.duration = function(_) {\n    return arguments.length ? (duration = +_, zoom) : duration;\n  };\n\n  zoom.interpolate = function(_) {\n    return arguments.length ? (interpolate = _, zoom) : interpolate;\n  };\n\n  zoom.on = function() {\n    var value = listeners.on.apply(listeners, arguments);\n    return value === listeners ? zoom : value;\n  };\n\n  zoom.clickDistance = function(_) {\n    return arguments.length ? (clickDistance2 = (_ = +_) * _, zoom) : Math.sqrt(clickDistance2);\n  };\n\n  return zoom;\n}\n","import * as utils from './utils';\r\nimport CallbackManager from './CallbackManager';\r\n\r\nimport _ from 'underscore';\r\n// @ts-ignore\r\nimport {event} from 'd3-selection';\r\nimport {\r\n  zoom as d3Zoom,\r\n  zoomIdentity as d3ZoomIdentity\r\n} from 'd3-zoom';\r\nimport {D3Selection} from './types';\r\n\r\n/**\r\n * ZoomContainer\r\n */\r\nexport default class ZoomContainer {\r\n  selection: D3Selection;\r\n  container: D3Selection<HTMLDivElement>;\r\n  css3TransformContainer: D3Selection<HTMLDivElement>;\r\n  svg: D3Selection<SVGSVGElement>;\r\n  zoomedSel: D3Selection<SVGGElement>;\r\n  windowTranslate: {x: number, y: number};\r\n  windowScale: number;\r\n\r\n  _scrollBehavior: string;\r\n  _use3dTransform: boolean;\r\n  _panDragOn: boolean;\r\n  _zoomBehavior: any;\r\n  _zoomTimeout: any;\r\n  _svgScale: number;\r\n  _svgTranslate: {x: number, y: number};\r\n\r\n  _3dTransform: string | null;\r\n  _requestedFrame: boolean;\r\n\r\n  callbackManager: CallbackManager;\r\n  /**\r\n   * Make a container that will manage panning and zooming. Creates a new SVG\r\n   * element, with a parent div for CSS3 3D transforms.\r\n   * @param {D3 Selection} selection - A d3 selection of a HTML node to put the\r\n   * zoom container in. Should have a defined width and height.\r\n   * @param {String} scroll_behavior - Either 'zoom' or 'pan'.\r\n   * @param {Boolean} use3dTransform - If true, then use CSS3 3D transform to\r\n   * speed up pan and zoom.\r\n   */\r\n  constructor(selection: D3Selection, scrollBehavior: string, use3dTransform: boolean) {\r\n    // set the selection class\r\n    selection.classed('escher-container', true);\r\n\r\n    // Stop scrolling on mobile\r\n    // Only necessary for Safari because touch-action CSS is supported by all other browsers\r\n    // TODO Zak needs to figure out why this doesn't work on Safari\r\n    if (navigator && navigator.userAgent && navigator.userAgent.indexOf('Safari') !== -1 && navigator.userAgent.indexOf('Mozilla') === -1) {\r\n      selection.on('touchstart touchmove', function() {\r\n        event.stopPropagation();\r\n      });\r\n    }\r\n\r\n    // make the svg\r\n    const container = selection.append('div')\r\n      .attr('class', 'escher-zoom-container');\r\n    const css3TransformContainer = container.append('div')\r\n      .attr('class', 'escher-3d-transform-container');\r\n\r\n    const svg = css3TransformContainer.append('svg')\r\n      .attr('class', 'escher-svg')\r\n      .attr('xmlns', 'http://www.w3.org/2000/svg');\r\n\r\n    // set up the zoom container\r\n    svg.select('.zoom-g').remove();\r\n    const zoomedSel = svg.append('g').attr('class', 'zoom-g');\r\n\r\n    // attributes\r\n    this.selection = selection;\r\n    this.container = container;\r\n    this.css3TransformContainer = css3TransformContainer;\r\n    this.svg = svg;\r\n    this.zoomedSel = zoomedSel;\r\n    this.windowTranslate = {x: 0, y: 0};\r\n    this.windowScale = 1.0;\r\n\r\n    this._scrollBehavior = scrollBehavior;\r\n    this._use3dTransform = use3dTransform;\r\n    this._panDragOn = true;\r\n    this._zoomBehavior = null;\r\n    this._zoomTimeout = null;\r\n    this._svgScale = this.windowScale;\r\n    this._svgTranslate = this.windowTranslate;\r\n    this._3dTransform = null;\r\n    this._requestedFrame = false;\r\n    // this._lastSvgMs = null\r\n\r\n    // set up the callbacks\r\n    this.callbackManager = new CallbackManager();\r\n\r\n    // update the scroll behavior\r\n    this._updateScroll();\r\n  }\r\n\r\n  /**\r\n   * Set up pan or zoom on scroll.\r\n   * @param {String} scroll_behavior - 'none', 'pan' or 'zoom'.\r\n   */\r\n  setScrollBehavior(scrollBehavior: string) {\r\n    this._scrollBehavior = scrollBehavior;\r\n    this._updateScroll();\r\n  }\r\n\r\n  /**\r\n   * Set the option use3dTransform\r\n   */\r\n  setUse3dTransform(use3dTransform: boolean) {\r\n    this._use3dTransform = use3dTransform;\r\n  }\r\n\r\n  /**\r\n   * Toggle the zoom drag and the cursor UI for it.\r\n   */\r\n  togglePanDrag(onOff: boolean) {\r\n    if (_.isUndefined(onOff))\r\n      this._panDragOn = !this._panDragOn;\r\n    else\r\n      this._panDragOn = onOff;\r\n\r\n\r\n    if (this._panDragOn) {\r\n      // turn on the hand. Performance note: In previous versions of Escher, we\r\n      // enabled the \"grabbing\" cursor during pan events. However, this causes a\r\n      // browser layout and costs about 400ms, so we turned it off.\r\n      this.zoomedSel.style('cursor', 'grab');\r\n    } else {\r\n      // turn off the hand\r\n      if (this.zoomedSel.style('cursor') === 'grab')\r\n        this.zoomedSel.style('cursor', null);\r\n    }\r\n\r\n    // update the behaviors\r\n    this._updateScroll();\r\n  }\r\n\r\n  /**\r\n   * Update the pan and zoom behaviors. The behaviors are applied to the\r\n   * css3TransformContainer node.\r\n   */\r\n  _updateScroll() {\r\n    if (!_.contains(['zoom', 'pan', 'none'], this._scrollBehavior))\r\n      throw Error('Bad value for scroll_behavior: ' + this._scrollBehavior);\r\n\r\n\r\n    // clear all behaviors\r\n    this.container.on('mousewheel.zoom', null) // zoom scroll behaviors\r\n      .on('DOMMouseScroll.zoom', null) // disables older versions of Firefox\r\n      .on('wheel.zoom', null) // disables newer versions of Firefox\r\n      .on('dblclick.zoom', null)\r\n      .on('mousewheel.escher', null) // pan scroll behaviors\r\n      .on('DOMMouseScroll.escher', null)\r\n      .on('wheel.escher', null)\r\n      .on('mousedown.zoom', null) // drag behaviors\r\n      .on('touchstart.zoom', null)\r\n      .on('touchmove.zoom', null)\r\n      .on('touchend.zoom', null);\r\n\r\n    // This handles dragging to pan, and touch events (in any scroll mode). It\r\n    // also handles scrolling to zoom (only 'zoom' mode). It also raises an\r\n    // exception in node, so catch that during testing. This may be a bug with\r\n    // d3 related to d3 using the global this.document. TODO look into this.\r\n    this._zoomBehavior = d3Zoom()\r\n      .on('start', () => {\r\n        // Prevent default zoom behavior, specifically for mobile pinch zoom\r\n        if (event.sourceEvent !== null) {\r\n          event.sourceEvent.stopPropagation();\r\n          event.sourceEvent.preventDefault();\r\n        }\r\n      })\r\n      .on('zoom', () => {\r\n        this._goToCallback(event.transform.k, {\r\n          x: event.transform.x,\r\n          y: event.transform.y\r\n        });\r\n      });\r\n\r\n    // Set it up\r\n    this.container.call(this._zoomBehavior);\r\n\r\n    // Always turn off double-clicking to zoom\r\n    this.container.on('dblclick.zoom', null);\r\n\r\n    // If panning is off, then turn off these listeners\r\n    if (!this._panDragOn) {\r\n      this.container.on('mousedown.zoom', null)\r\n        .on('touchstart.zoom', null)\r\n        .on('touchmove.zoom', null)\r\n        .on('touchend.zoom', null);\r\n    }\r\n\r\n    // If scroll to zoom is off, then turn off these listeners\r\n    if (this._scrollBehavior !== 'zoom') {\r\n      this.container\r\n        .on('mousewheel.zoom', null) // zoom scroll behaviors\r\n        .on('DOMMouseScroll.zoom', null) // disables older versions of Firefox\r\n        .on('wheel.zoom', null); // disables newer versions of Firefox\r\n    }\r\n\r\n    // add listeners for scrolling to pan\r\n    if (this._scrollBehavior === 'pan') {\r\n      // Add the wheel listener\r\n      const wheelFn = () => {\r\n        const ev = event;\r\n        const sensitivity = 0.5;\r\n        // stop scroll in parent elements\r\n        ev.stopPropagation();\r\n        ev.preventDefault();\r\n        ev.returnValue = false;\r\n        // change the location\r\n        const getDirectionalDisp = (wheelDelta: number, delta: number) => {\r\n          const theDelt = _.isUndefined(wheelDelta) ? delta : -wheelDelta / 1.5;\r\n          return theDelt * sensitivity;\r\n        };\r\n        const newTranslate = {\r\n          x: this.windowTranslate.x - getDirectionalDisp(ev.wheelDeltaX, ev.deltaX),\r\n          y: this.windowTranslate.y - getDirectionalDisp(ev.wheelDeltaY, ev.deltaY)\r\n        };\r\n        this.goTo(this.windowScale, newTranslate);\r\n      };\r\n\r\n      // apply it\r\n      this.container.on('mousewheel.escher', wheelFn);\r\n      this.container.on('DOMMouseScroll.escher', wheelFn);\r\n      this.container.on('wheel.escher', wheelFn);\r\n    }\r\n\r\n    // Set current location\r\n    this.goTo(this.windowScale, this.windowTranslate);\r\n  }\r\n\r\n  // ------------------------------------------------------------\r\n  // Functions to scale and translate\r\n  // ------------------------------------------------------------\r\n\r\n  /**\r\n   * Zoom the container to a specified location.\r\n   * @param {Number} scale - The scale, between 0 and 1.\r\n   * @param {Object} translate - The location, of the form {x: 2.0, y: 3.0}.\r\n   */\r\n  goTo(scale: number, translate: {x: number, y: number}) {\r\n    // Check inputs\r\n    if (!scale) {\r\n      console.error('Bad scale value');\r\n      return;\r\n    }\r\n    if (!translate || !('x' in translate) || !('y' in translate) ||\r\n        _.isNaN(translate.x) || _.isNaN(translate.y)) {\r\n      console.error('Bad translate value');\r\n      return;\r\n    }\r\n\r\n    // Save to zoom behavior, which will call _goTo_callback\r\n    const newZoom = d3ZoomIdentity\r\n      .translate(translate.x, translate.y)\r\n      .scale(scale);\r\n    this.container.call(this._zoomBehavior.transform, newZoom);\r\n  }\r\n\r\n  /**\r\n   * Execute the zoom called by the d3 zoom behavior.\r\n   * @param {Number} scale - The scale, between 0 and 1\r\n   * @param {Object} translate - The location, of the form { x: 2.0, y: 3.0 }\r\n   */\r\n  _goToCallback(scale: number, translate: {x: number, y: number}) {\r\n    // if the scale changes, run the zoom_change callback\r\n    if (this.windowScale !== scale) {\r\n      this.windowScale = scale;\r\n      this.callbackManager.run('zoom_change');\r\n    }\r\n    this.windowTranslate = translate;\r\n\r\n    if (this._use3dTransform) { // 3d transform\r\n      // cancel all timeouts\r\n      if (!_.isNull(this._zoomTimeout))\r\n        clearTimeout(this._zoomTimeout);\r\n\r\n\r\n      // set the 3d transform\r\n      this._goTo3d(scale, translate, this._svgScale, this._svgTranslate);\r\n\r\n      // if another goTo does not happen within the delay time, then\r\n      // redraw the svg\r\n      this._zoomTimeout = _.delay(() => {\r\n        // redraw the svg\r\n        this._requestedFrame = false;\r\n        this._goToSvg(scale, translate);\r\n      }, 100); // between 100 and 600 seems to be usable\r\n    } else { // no 3d transform\r\n      this._goToSvg(scale, translate);\r\n    }\r\n\r\n    this.callbackManager.run('go_to');\r\n  }\r\n\r\n  _goTo3dFrame() {\r\n    if (!this._requestedFrame) {\r\n      this._requestedFrame = true;\r\n      window.requestAnimationFrame(() => {\r\n        this._requestedFrame = false;\r\n        const transform = this._3dTransform;\r\n        if (transform) {\r\n          this.css3TransformContainer.style('transform', transform);\r\n          this.css3TransformContainer.style('-webkit-transform', transform);\r\n          this.css3TransformContainer.style('transform-origin', '0 0');\r\n          this.css3TransformContainer.style('-webkit-transform-origin', '0 0');\r\n        } else\r\n          console.warn('No _3dTransform defined');\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Zoom & pan the CSS 3D transform container\r\n   */\r\n  _goTo3d(scale: number, translate: {x: number, y: number}, svgScale: number, svgTranslate: {x: number, y: number}) {\r\n    const nScale = scale / svgScale;\r\n    const nTranslate = utils.c_minus_c(translate,\r\n      utils.c_times_scalar(svgTranslate, nScale))!;\r\n    const transform = ('translate(' + nTranslate.x + 'px,' + nTranslate.y + 'px) ' +\r\n                       'scale(' + nScale + ')');\r\n    this._3dTransform = transform;\r\n    this._goTo3dFrame();\r\n  }\r\n\r\n  _clear3d() {\r\n    if (this._3dTransform) {\r\n      this._3dTransform = null;\r\n      this.css3TransformContainer.style('transform', null);\r\n      this.css3TransformContainer.style('-webkit-transform', null);\r\n      this.css3TransformContainer.style('transform-origin', null);\r\n      this.css3TransformContainer.style('-webkit-transform-origin', null);\r\n    }\r\n  }\r\n\r\n  _goToSvgFrame(callback: (() => void) | null = null) {\r\n    if (!this._requestedFrame || callback) {\r\n      this._requestedFrame = true;\r\n      window.requestAnimationFrame(() => {\r\n        this._requestedFrame = false;\r\n\r\n        // reset the 3d transform\r\n        this._clear3d();\r\n\r\n        const scale = this._svgScale;\r\n        const translate = this._svgTranslate;\r\n        this.zoomedSel\r\n          .attr('transform',\r\n            'translate(' + translate.x + ',' + translate.y + ') ' +\r\n                'scale(' + scale + ')');\r\n        if (callback) callback();\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Zoom & pan the svg element. Also runs the svg_start and svg_finish callbacks.\r\n   * @param {Number} scale - The scale, between 0 and 1.\r\n   * @param {Object} translate - The location, of the form {x: 2.0, y: 3.0}.\r\n   * @param {Function} callback - (optional) A callback to run after scaling.\r\n   */\r\n  _goToSvg(scale: number, translate: {x: number, y: number}, callback: (() => void) | null = null) {\r\n    // redraw the svg\r\n    // save svg location\r\n    this._svgScale = scale;\r\n    this._svgTranslate = translate;\r\n    this._goToSvgFrame(callback);\r\n  }\r\n\r\n  /**\r\n   * Zoom by a specified multiplier.\r\n   * @param {Number} amount - A multiplier for the zoom. Greater than 1 zooms in\r\n   * and less than 1 zooms out.\r\n   */\r\n  zoomBy(amount: number) {\r\n    const size = this.get_size();\r\n    const shift = {\r\n      x: size.width / 2 - ((size.width / 2 - this.windowTranslate.x) * amount +\r\n                           this.windowTranslate.x),\r\n      y: size.height / 2 - ((size.height / 2 - this.windowTranslate.y) * amount +\r\n                            this.windowTranslate.y)\r\n    };\r\n    this.goTo(this.windowScale * amount,\r\n      utils.c_plus_c(this.windowTranslate, shift)!);\r\n  }\r\n\r\n  /**\r\n   * Zoom in by the default amount with the default options.\r\n   */\r\n  zoom_in() { // eslint-disable-line camelcase\r\n    this.zoomBy(1.5);\r\n  }\r\n\r\n  /**\r\n   * Zoom out by the default amount with the default options.\r\n   */\r\n  zoom_out() { // eslint-disable-line camelcase\r\n    this.zoomBy(0.667);\r\n  }\r\n\r\n  /**\r\n   * Return the size of the zoom container as coordinates. Throws an error if\r\n   * width or height is not defined.\r\n   * @returns {Object} The size coordinates, e.g. { x: 2, y: 3 }.\r\n   */\r\n  get_size() { // eslint-disable-line camelcase\r\n    const {width, height} = this.selection.node()!.getBoundingClientRect();\r\n    return {width, height};\r\n  }\r\n\r\n  /**\r\n   * Shift window if new reaction will draw off the screen.\r\n   */\r\n  translateOffScreen(coords: {x: number, y: number}) {\r\n    // TODO BUG not accounting for scale correctly\r\n\r\n    const margin = 120; // pixels\r\n    const size = this.get_size();\r\n    const current = {\r\n      x: {\r\n        min: -this.windowTranslate.x / this.windowScale +\r\n          margin / this.windowScale,\r\n        max: -this.windowTranslate.x / this.windowScale +\r\n          (size.width - margin) / this.windowScale\r\n      },\r\n      y: {\r\n        min: -this.windowTranslate.y / this.windowScale +\r\n          margin / this.windowScale,\r\n        max: -this.windowTranslate.y / this.windowScale +\r\n          (size.height - margin) / this.windowScale\r\n      }\r\n    };\r\n\r\n    if (coords.x < current.x.min) {\r\n      this.windowTranslate.x = this.windowTranslate.x -\r\n        (coords.x - current.x.min) * this.windowScale;\r\n      this.goTo(this.windowScale, this.windowTranslate);\r\n    } else if (coords.x > current.x.max) {\r\n      this.windowTranslate.x = this.windowTranslate.x -\r\n        (coords.x - current.x.max) * this.windowScale;\r\n      this.goTo(this.windowScale, this.windowTranslate);\r\n    }\r\n    if (coords.y < current.y.min) {\r\n      this.windowTranslate.y = this.windowTranslate.y -\r\n        (coords.y - current.y.min) * this.windowScale;\r\n      this.goTo(this.windowScale, this.windowTranslate);\r\n    } else if (coords.y > current.y.max) {\r\n      this.windowTranslate.y = this.windowTranslate.y -\r\n        (coords.y - current.y.max) * this.windowScale;\r\n      this.goTo(this.windowScale, this.windowTranslate);\r\n    }\r\n  }\r\n}\r\n","/* eslint-disable camelcase */\r\n/**\r\n * Draw. Manages creating, updating, and removing objects during d3 data\r\n * binding.\r\n *\r\n * Arguments\r\n * ---------\r\n *\r\n * behavior: An escher.Behavior object.\r\n * settings: An escher.Settings object.\r\n *\r\n * Callbacks\r\n * ---------\r\n *\r\n * draw.callback_manager.run('create_membrane', draw, enter_selection)\r\n * draw.callback_manager.run('update_membrane', draw, update_selection)\r\n * draw.callback_manager.run('create_reaction', draw, enter_selection)\r\n * draw.callback_manager.run('update_reaction', draw, update_selection)\r\n * draw.callback_manager.run('create_reaction_label', draw, enter_selection)\r\n * draw.callback_manager.run('update_reaction_label', draw, update_selection)\r\n * draw.callback_manager.run('create_segment', draw, enter_selection)\r\n * draw.callback_manager.run('update_segment', draw, update_selection)\r\n * draw.callback_manager.run('create_bezier', draw, enter_selection)\r\n * draw.callback_manager.run('update_bezier', draw, update_selection)\r\n * draw.callback_manager.run('create_node', draw, enter_selection)\r\n * draw.callback_manager.run('update_node', draw, update_selection)\r\n * draw.callback_manager.run('create_text_label', draw, enter_selection)\r\n * draw.callback_manager.run('update_text_label', draw, update_selection)\r\n *\r\n */\r\n\r\nimport CallbackManager from './CallbackManager';\r\nimport * as utils from './utils';\r\nimport * as dataStyles from './dataStyles';\r\nimport {format as d3_format} from 'd3-format';\r\nimport Behavior from './Behavior';\r\nimport {EscherMap} from './escherMap';\r\nimport Settings from './Settings';\r\nimport {Coord, D3Selection} from './types';\r\nimport Scale from './Scale';\r\n\r\nexport default class Draw {\r\n  behavior: Behavior;\r\n  settings: Settings;\r\n  map: EscherMap;\r\n  callback_manager: CallbackManager;\r\n\r\n  constructor(behavior: Behavior, settings: Settings, map: EscherMap) {\r\n    this.behavior = behavior;\r\n    this.settings = settings;\r\n    this.map = map;\r\n    this.callback_manager = new CallbackManager();\r\n  }\r\n\r\n  /**\r\n * Create membranes in the enter_selection.\r\n * @param {} enter_selection - The D3 enter selection.\r\n * @returns {} The selection of the new nodes.\r\n */\r\n  create_membrane(enter_selection: D3Selection) {\r\n    const rect = enter_selection\r\n      .append('rect')\r\n      .attr('class', 'membrane');\r\n\r\n    this.callback_manager.run('create_membrane', this, enter_selection);\r\n\r\n    return rect;\r\n  }\r\n\r\n  /**\r\n * Update the membrane\r\n */\r\n  update_membrane(update_selection: D3Selection) {\r\n    update_selection\r\n      .attr('width', function(d: any) { return d.width; })\r\n      .attr('height', function(d: any) { return d.height; })\r\n      .attr('transform', function(d: any) { return 'translate(' + d.x + ',' + d.y + ')'; })\r\n      .style('stroke-width', function(d: any) { return 10; })\r\n      .attr('rx', function(d: any) { return 20; })\r\n      .attr('ry', function(d: any) { return 20; });\r\n\r\n    this.callback_manager.run('update_membrane', this, update_selection);\r\n  }\r\n\r\n  /**\r\n * Create reactions in the enter_selection.\r\n * @param {} enter_selection - The D3 enter selection.\r\n * @returns {} The selection of the new nodes.\r\n */\r\n  create_reaction(enter_selection: D3Selection) {\r\n  // attributes for new reaction group\r\n    const group = enter_selection.append('g')\r\n      .attr('id', function(d: any) { return 'r' + d.reaction_id; })\r\n      .attr('class', 'reaction');\r\n    this.create_reaction_label(group);\r\n\r\n    this.callback_manager.run('create_reaction', this, enter_selection);\r\n\r\n    return group;\r\n  }\r\n\r\n  /**\r\n * Run on the update selection for reactions.\r\n * update_selection: The D3.js update selection.\r\n * scale: A Scale object.\r\n * cobra_model: A CobraModel object.\r\n * drawn_nodes: The nodes object (e.g. Map.nodes).\r\n * defs: The defs object generated by utils.setup_defs() (e.g. Map.defs).\r\n * has_data_on_reactions: Boolean to determine whether data needs to be drawn.\r\n */\r\n  update_reaction(update_selection: D3Selection, scale: any, cobra_model: any, drawn_nodes: any,\r\n    defs: any, has_data_on_reactions: boolean) {\r\n  // Update reaction label\r\n    update_selection.select('.reaction-label-group')\r\n      .call((sel: D3Selection<any>) => {\r\n        return this.update_reaction_label(sel, has_data_on_reactions);\r\n      });\r\n\r\n    // draw segments\r\n    utils.draw_a_nested_object(update_selection, '.segment-group', 'segments', 'segment_id',\r\n      this.create_segment.bind(this),\r\n      (sel: D3Selection<any>) => {\r\n        return this.update_segment(sel, scale, cobra_model,\r\n          drawn_nodes, defs,\r\n          has_data_on_reactions);\r\n      },\r\n      (sel: D3Selection<any>) => {\r\n        sel.remove();\r\n      });\r\n\r\n    // run the callback\r\n    this.callback_manager.run('update_reaction', this, update_selection);\r\n  }\r\n\r\n  /**\r\n * Draw reaction labels in the enter selection.\r\n * @param {} enter_selection - The D3 enter selection.\r\n * @returns {} The selection of the new nodes.\r\n */\r\n  create_reaction_label(enter_selection: D3Selection<any>, tool?: any) {\r\n    const group = enter_selection\r\n      .append('g')\r\n      .attr('class', 'reaction-label-group');\r\n    group.append('text').attr('class', 'reaction-label label');\r\n    group.append('g').attr('class', 'all-genes-label-group');\r\n\r\n    this.callback_manager.run('create_reaction_label', this, enter_selection);\r\n\r\n    return group;\r\n  }\r\n\r\n  /**\r\n * Run on the update selection for reaction labels.\r\n * @param {D3 Selection} update_selection - The D3.js update selection.\r\n * @param {Boolean} has_data_on_reactions - Whether data needs to be drawn.\r\n */\r\n  update_reaction_label(update_selection: D3Selection<any>, has_data_on_reactions: boolean) {\r\n    const decimal_format = d3_format('.4g');\r\n    const identifiers_on_map = this.settings.get('identifiers_on_map');\r\n    const reaction_data_styles = this.settings.get('reaction_styles');\r\n    const show_gene_reaction_rules = this.settings.get('show_gene_reaction_rules');\r\n    const hide_all_labels = this.settings.get('hide_all_labels');\r\n    const gene_font_size = this.settings.get('gene_font_size');\r\n    const reactionLabelMouseover = this.behavior.reactionLabelMouseover;\r\n    const reactionLabelMouseout = this.behavior.reactionLabelMouseout;\r\n    const reactionLabelTouch = this.behavior.reactionLabelTouch;\r\n    const geneLabelMouseover = this.behavior.geneLabelMouseover;\r\n    const geneLabelMouseout = this.behavior.geneLabelMouseout;\r\n    const geneLabelTouch = this.behavior.geneLabelTouch;\r\n\r\n    // label location\r\n    update_selection\r\n      .attr('transform', function(d: any) {\r\n        return 'translate(' + d.label_x + ',' + d.label_y + ')';\r\n      })\r\n      .call(this.behavior.turnOffDrag)\r\n      .call(this.behavior.reactionLabelDrag);\r\n\r\n    // update label visibility\r\n    const label = update_selection.select('.reaction-label')\r\n      .attr('visibility', hide_all_labels ? 'hidden' : 'visible');\r\n\r\n    if (!hide_all_labels) {\r\n      label\r\n        .text(function(d: any) {\r\n          let t = d[identifiers_on_map];\r\n          if (has_data_on_reactions &&\r\n            reaction_data_styles.indexOf('text') !== -1)\r\n            t += ' ' + d.data_string;\r\n\r\n          return t;\r\n        })\r\n        .on('mouseover', reactionLabelMouseover)\r\n        .on('mouseout', reactionLabelMouseout)\r\n        .on('touchend', reactionLabelTouch);\r\n    }\r\n\r\n    const add_gene_height = function(y: number, i: number) {\r\n      return y + (gene_font_size * 1.5 * (i + 1));\r\n    };\r\n\r\n    // gene label\r\n    const all_genes_g = update_selection.select('.all-genes-label-group')\r\n      .selectAll('.gene-label-group')\r\n      .data(function(d: any) {\r\n        const show_gene_string = ('gene_string' in d &&\r\n                              d.gene_string !== null &&\r\n                              show_gene_reaction_rules &&\r\n                              (!hide_all_labels) &&\r\n                              reaction_data_styles.indexOf('text') !== -1);\r\n        const show_gene_reaction_rule = ('gene_reaction_rule' in d &&\r\n                                     d.gene_reaction_rule !== null &&\r\n                                     show_gene_reaction_rules &&\r\n                                     (!hide_all_labels));\r\n        if (show_gene_string) {\r\n        // TODO do we ever use gene_string?\r\n          console.warn('Showing gene_string. See TODO in source.');\r\n          return d.gene_string;\r\n        } else if (show_gene_reaction_rule) {\r\n        // make the gene string with no data\r\n          const sd = dataStyles.gene_string_for_data(d.gene_reaction_rule, null,\r\n            d.genes, null,\r\n            identifiers_on_map, null);\r\n          // add coords for tooltip\r\n          sd.forEach(function(td: any, i: number) {\r\n            td.label_x = d.label_x;\r\n            td.label_y = add_gene_height(d.label_y, i);\r\n          });\r\n          return sd;\r\n        } else\r\n          return [];\r\n      });\r\n\r\n    // enter\r\n    const gene_g = all_genes_g.enter()\r\n      .append('g')\r\n      .attr('class', 'gene-label-group');\r\n    gene_g.append('text')\r\n      .attr('class', 'gene-label')\r\n      .style('font-size', gene_font_size + 'px');\r\n\r\n    // update\r\n    const gene_update = gene_g.merge(all_genes_g as D3Selection<any>);\r\n    gene_update.attr('transform', function(d: any, i: number) {\r\n      return 'translate(0, ' + add_gene_height(0, i) + ')';\r\n    });\r\n    // update text\r\n    gene_update\r\n      .select('text')\r\n      .text((d: any) => d.text)\r\n      .on('mouseover', geneLabelMouseover)\r\n      .on('mouseout', geneLabelMouseout)\r\n      .on('touchend', geneLabelTouch);\r\n\r\n    // exit\r\n    all_genes_g.exit().remove();\r\n\r\n    this.callback_manager.run('update_reaction_label', this, update_selection);\r\n  }\r\n\r\n  /**\r\n * Create segments in the enter_selection.\r\n * @param {} enter_selection - The D3 enter selection.\r\n * @returns {} The selection of the new nodes.\r\n */\r\n  create_segment(enter_selection: D3Selection) {\r\n  // create segments\r\n    const g = enter_selection\r\n      .append('g')\r\n      .attr('class', 'segment-group')\r\n      .attr('id', function(d: any) { return 's' + d.segment_id; });\r\n\r\n    // create reaction arrow\r\n    g.append('path')\r\n      .attr('class', 'segment');\r\n\r\n    g.append('g')\r\n      .attr('class', 'arrowheads');\r\n\r\n    g.append('g')\r\n      .attr('class', 'stoichiometry-labels');\r\n\r\n    this.callback_manager.run('create_segment', this, enter_selection);\r\n\r\n    return g;\r\n  }\r\n\r\n  /**\r\n * Update segments in update selection.\r\n * @param {} -\r\n * @param {} -\r\n * @param {} -\r\n * @param {} -\r\n * @param {} -\r\n * @param {} -\r\n * @return {}\r\n */\r\n  update_segment(update_selection: D3Selection, scale: any, cobra_model: any,\r\n    drawn_nodes: any, defs: any, has_data_on_reactions: boolean) {\r\n    const reaction_data_styles = this.settings.get('reaction_styles');\r\n    const should_size = (has_data_on_reactions && reaction_data_styles.indexOf('size') !== -1);\r\n    const should_color = (has_data_on_reactions && reaction_data_styles.indexOf('color') !== -1);\r\n    const no_data_size = this.settings.get('reaction_no_data_size');\r\n    const no_data_color = this.settings.get('reaction_no_data_color');\r\n\r\n    // update segment attributes\r\n    const highlight_missing = this.settings.get('highlight_missing');\r\n    const hide_secondary_metabolites = this.settings.get('hide_secondary_metabolites');\r\n    const primary_r = this.settings.get('primary_metabolite_radius');\r\n    const secondary_r = this.settings.get('secondary_metabolite_radius');\r\n\r\n    const objectMouseover = this.behavior.reactionObjectMouseover;\r\n    const objectMouseout = this.behavior.reactionObjectMouseout;\r\n\r\n    const get_arrow_size = function(data: any, should_size: boolean) {\r\n      let width = 20;\r\n      let height = 13;\r\n      if (should_size) {\r\n        height = (data == null ? no_data_size : scale.reaction_size(data));\r\n        // check for nan\r\n        if (isNaN(height))\r\n          height = no_data_size;\r\n\r\n        width = height * 2;\r\n      }\r\n      return {width: width, height: height};\r\n    };\r\n    const get_disp = function(arrow_size: any, reversibility: boolean, coefficient: number, node_is_primary: boolean) {\r\n      const arrow_height = ((reversibility || coefficient > 0) ?\r\n        arrow_size.height : 0);\r\n      const r = node_is_primary ? primary_r : secondary_r;\r\n      return r + arrow_height + 10;\r\n    };\r\n\r\n    // update arrows\r\n    update_selection\r\n      .selectAll('.segment')\r\n      .datum(function() {\r\n      // Concatenate the segment data with the reaction data from its parent node\r\n      // @ts-ignore\r\n      // eslint-disable-next-line no-invalid-this\r\n        return Object.assign({}, this.parentNode.__data__, this.parentNode.parentNode.__data__);\r\n      })\r\n      .style('visibility', function(d: any) {\r\n        const start = drawn_nodes[d.from_node_id];\r\n        const end = drawn_nodes[d.to_node_id];\r\n        if (hide_secondary_metabolites &&\r\n          ((end['node_type'] === 'metabolite' && !end.node_is_primary) ||\r\n           (start['node_type'] === 'metabolite' && !start.node_is_primary)))\r\n          return 'hidden';\r\n\r\n        return null;\r\n      })\r\n      .attr('d', function(d: any) {\r\n        if (d.from_node_id == null || d.to_node_id == null)\r\n          return null;\r\n\r\n        let start = drawn_nodes[d.from_node_id];\r\n        let end = drawn_nodes[d.to_node_id];\r\n        const b1 = d.b1;\r\n        const b2 = d.b2;\r\n        // if metabolite, then displace the arrow\r\n        if (start['node_type'] === 'metabolite') {\r\n          const arrow_size = get_arrow_size(d.data, should_size);\r\n          const disp = get_disp(arrow_size, d.reversibility,\r\n            d.from_node_coefficient,\r\n            start.node_is_primary);\r\n          const direction = (b1 == null) ? end : b1;\r\n          start = displacedCoords(disp, start, direction, 'start');\r\n        }\r\n        if (end['node_type'] == 'metabolite') {\r\n          const arrow_size = get_arrow_size(d.data, should_size);\r\n          const disp = get_disp(arrow_size, d.reversibility,\r\n            d.to_node_coefficient,\r\n            end.node_is_primary);\r\n          const direction = (b2 == null) ? start : b2;\r\n          end = displacedCoords(disp, direction, end, 'end');\r\n        }\r\n        let curve = ('M' + start.x + ',' + start.y + ' ');\r\n        if (b1 !== null && b2 !== null) {\r\n          curve += ('C' + b1.x + ',' + b1.y + ' ' +\r\n                  b2.x + ',' + b2.y + ' ');\r\n        }\r\n        curve += (end.x + ',' + end.y);\r\n        return curve;\r\n      })\r\n      .style('stroke', function(d: any) {\r\n        // @ts-ignore\r\n        // eslint-disable-next-line no-invalid-this\r\n        const reaction_id = this.parentNode.parentNode.__data__.bigg_id;\r\n        const show_missing = (highlight_missing &&\r\n                          cobra_model !== null &&\r\n                          !(reaction_id in cobra_model.reactions));\r\n        if (show_missing)\r\n          return 'red';\r\n\r\n        if (should_color) {\r\n          const f = d.data;\r\n          return f == null ? no_data_color : scale.reaction_color(f);\r\n        }\r\n        return null;\r\n      })\r\n      .style('stroke-width', function(d) {\r\n        if (should_size) {\r\n          const f = d.data;\r\n          return f == null ? no_data_size : scale.reaction_size(f);\r\n        } else\r\n          return null;\r\n      })\r\n      .attr('pointer-events', 'visibleStroke')\r\n      .on('mouseover', objectMouseover)\r\n      .on('mouseout', objectMouseout);\r\n\r\n    // new arrowheads\r\n    const arrowheads = update_selection.select('.arrowheads')\r\n      .selectAll('.arrowhead')\r\n      .data(function(d: any) {\r\n        const arrowheads: any[] = [];\r\n        const start = drawn_nodes[d.from_node_id];\r\n        const b1 = d.b1;\r\n        const end = drawn_nodes[d.to_node_id];\r\n        const b2 = d.b2;\r\n        // hide_secondary_metabolites option\r\n        if (hide_secondary_metabolites &&\r\n          ((end['node_type'] === 'metabolite' && !end.node_is_primary) ||\r\n           (start['node_type'] === 'metabolite' && !start.node_is_primary)))\r\n          return arrowheads;\r\n\r\n\r\n        if (start.node_type === 'metabolite' &&\r\n          (d.reversibility || d.from_node_coefficient > 0)) {\r\n          const arrow_size = get_arrow_size(d.data, should_size);\r\n          const disp = get_disp(arrow_size, d.reversibility,\r\n            d.from_node_coefficient,\r\n            start.node_is_primary);\r\n          const direction = (b1 == null) ? end : b1;\r\n          const rotation = utils.to_degrees(utils.get_angle([start, direction])) + 90;\r\n          const loc = displacedCoords(disp, start, direction, 'start');\r\n          arrowheads.push({\r\n            data: d.data,\r\n            x: loc!.x,\r\n            y: loc!.y,\r\n            size: arrow_size,\r\n            rotation: rotation,\r\n            show_arrowhead_flux: (((d.from_node_coefficient < 0) === d.reverse_flux) || d.data === 0)\r\n          });\r\n        }\r\n\r\n        if (end.node_type === 'metabolite' &&\r\n          (d.reversibility || d.to_node_coefficient > 0)) {\r\n          const arrow_size = get_arrow_size(d.data, should_size);\r\n          const disp = get_disp(arrow_size, d.reversibility,\r\n            d.to_node_coefficient,\r\n            end.node_is_primary);\r\n          const direction = (b2 == null) ? start : b2;\r\n          const rotation = utils.to_degrees(utils.get_angle([end, direction])) + 90;\r\n          const loc = displacedCoords(disp, direction, end, 'end');\r\n          arrowheads.push({\r\n            data: d.data,\r\n            x: loc!.x,\r\n            y: loc!.y,\r\n            size: arrow_size,\r\n            rotation: rotation,\r\n            show_arrowhead_flux: (((d.to_node_coefficient < 0) === d.reverse_flux) || d.data === 0)\r\n          });\r\n        }\r\n\r\n        if (d.unconnected_segment_with_arrow) {\r\n          const arrow_size = get_arrow_size(d.data, should_size);\r\n          const direction = end;\r\n          const rotation = utils.to_degrees(utils.get_angle([start, direction])) + 90;\r\n          arrowheads.push({\r\n            data: d.data,\r\n            x: start.x,\r\n            y: start.y,\r\n            size: arrow_size,\r\n            rotation: rotation,\r\n            show_arrowhead_flux: (((d.to_node_coefficient < 0) === d.reverse_flux) || d.data === 0)\r\n          });\r\n        }\r\n\r\n        return arrowheads;\r\n      });\r\n    arrowheads.enter().append('path')\r\n      .classed('arrowhead', true)\r\n    // update arrowheads\r\n    // @ts-ignore\r\n      .merge(arrowheads)\r\n      .attr('d', function(d) {\r\n        return ('M' + [-d.size.width / 2, 0] +\r\n              ' L' + [0, d.size.height] +\r\n              ' L' + [d.size.width / 2, 0] + ' Z');\r\n      }).attr('transform', function(d) {\r\n        return 'translate(' + d.x + ',' + d.y + ')rotate(' + d.rotation + ')';\r\n      }).style('fill', function(d) {\r\n        if (should_color) {\r\n          if (d.show_arrowhead_flux) {\r\n          // show the flux\r\n            const f = d.data;\r\n            return f == null ? no_data_color : scale.reaction_color(f);\r\n          } else {\r\n          // if the arrowhead is not filled because it is reversed\r\n            return '#FFFFFF';\r\n          }\r\n        }\r\n        // default fill color\r\n        return null;\r\n      }).style('stroke', function(d) {\r\n        if (should_color) {\r\n        // show the flux color in the stroke whether or not the fill is present\r\n          const f = d.data;\r\n          return f == null ? no_data_color : scale.reaction_color(f);\r\n        }\r\n        // default stroke color\r\n        return null;\r\n      });\r\n    // remove\r\n    arrowheads.exit().remove();\r\n\r\n    // new stoichiometry labels\r\n    const stoichiometry_labels = update_selection.select('.stoichiometry-labels')\r\n      .selectAll('.stoichiometry-label')\r\n      .data(function(d: any) {\r\n        const labels: any[] = [];\r\n        const start = drawn_nodes[d.from_node_id];\r\n        const b1 = d.b1;\r\n        const end = drawn_nodes[d.to_node_id];\r\n        const b2 = d.b2;\r\n        const disp_factor = 1.5;\r\n\r\n        // hide_secondary_metabolites option\r\n        if (hide_secondary_metabolites &&\r\n          ((end['node_type'] == 'metabolite' && !end.node_is_primary) ||\r\n           (start['node_type'] == 'metabolite' && !start.node_is_primary)))\r\n          return labels;\r\n\r\n\r\n        if (start.node_type === 'metabolite' && (Math.abs(d.from_node_coefficient) != 1)) {\r\n          const arrow_size = get_arrow_size(d.data, should_size);\r\n          const disp = disp_factor * get_disp(arrow_size, false, 0, end.node_is_primary);\r\n          let direction = (b1 == null) ? end : b1;\r\n          direction = utils.c_plus_c(direction, utils.rotate_coords(direction, 0.5, start));\r\n          let loc = displacedCoords(disp, start, direction, 'start');\r\n          loc = utils.c_plus_c(loc, {x: 0, y: 7})!;\r\n          labels.push({\r\n            coefficient: Math.abs(d.from_node_coefficient),\r\n            x: loc.x,\r\n            y: loc.y,\r\n            data: d.data,\r\n          });\r\n        }\r\n\r\n        if (end.node_type === 'metabolite' && (Math.abs(d.to_node_coefficient) !== 1)) {\r\n          const arrow_size = get_arrow_size(d.data, should_size);\r\n          const disp = disp_factor * get_disp(arrow_size, false, 0, end.node_is_primary);\r\n          let direction = (b2 == null) ? start : b2;\r\n          direction = utils.c_plus_c(direction,\r\n            utils.rotate_coords(direction, 0.5, end));\r\n          let loc = displacedCoords(disp, direction, end, 'end');\r\n          loc = utils.c_plus_c(loc, {x: 0, y: 7})!;\r\n          labels.push({\r\n            coefficient: Math.abs(d.to_node_coefficient),\r\n            x: loc.x,\r\n            y: loc.y,\r\n            data: d.data,\r\n          });\r\n        }\r\n        return labels;\r\n      });\r\n\r\n    // add labels\r\n    stoichiometry_labels.enter()\r\n      .append('text')\r\n      .attr('class', 'stoichiometry-label')\r\n      .attr('text-anchor', 'middle')\r\n    // update stoichiometry_labels\r\n    // @ts-ignore\r\n      .merge(stoichiometry_labels)\r\n      .attr('transform', function(d) {\r\n        return 'translate(' + d.x + ',' + d.y + ')';\r\n      })\r\n      .text(function(d) {\r\n        return d.coefficient;\r\n      })\r\n      .style('fill', function(d) {\r\n        if (should_color) {\r\n        // show the flux color\r\n          const f = d.data;\r\n          return f == null ? no_data_color : scale.reaction_color(f);\r\n        }\r\n        // default segment color\r\n        return null;\r\n      });\r\n\r\n    // remove\r\n    stoichiometry_labels.exit().remove();\r\n\r\n    this.callback_manager.run('update_segment', this, update_selection);\r\n  }\r\n\r\n  /**\r\n * Create beziers in the enter_selection.\r\n * @param {} enter_selection - The D3 enter selection.\r\n * @returns {} The selection of the new nodes.\r\n */\r\n  create_bezier(enter_selection: D3Selection) {\r\n    const g = enter_selection.append('g')\r\n      .attr('id', function(d: any) { return d.bezier_id; })\r\n      .attr('class', function(d: any) { return 'bezier'; });\r\n    g.append('path')\r\n      .attr('class', 'connect-line');\r\n    g.append('circle')\r\n      .attr('class', function(d: any) { return 'bezier-circle ' + d.bezier; })\r\n      .style('stroke-width', String(1) + 'px')\r\n      .attr('r', String(7) + 'px');\r\n\r\n    this.callback_manager.run('create_bezier', this, enter_selection);\r\n\r\n    return g;\r\n  }\r\n\r\n  /**\r\n * Update beziers in update_selection.\r\n */\r\n  update_bezier(update_selection: D3Selection, show_beziers: boolean, drag_behavior: any,\r\n    mouseover: any, mouseout: any, drawn_nodes: any, drawn_reactions: any) {\r\n    const hide_secondary_metabolites = this.settings.get('hide_secondary_metabolites');\r\n\r\n    if (!show_beziers) {\r\n      update_selection.attr('visibility', 'hidden');\r\n      return;\r\n    } else\r\n      update_selection.attr('visibility', 'visible');\r\n\r\n\r\n    // hide secondary\r\n    update_selection\r\n      .style('visibility', function(d: any) {\r\n        const seg_data = drawn_reactions[d.reaction_id].segments[d.segment_id];\r\n        const start = drawn_nodes[seg_data.from_node_id];\r\n        const end = drawn_nodes[seg_data.to_node_id];\r\n        if (hide_secondary_metabolites &&\r\n          ((end['node_type'] === 'metabolite' && !end.node_is_primary) ||\r\n           (start['node_type'] === 'metabolite' && !start.node_is_primary)))\r\n          return 'hidden';\r\n\r\n        return null;\r\n      });\r\n\r\n    // Draw bezier points\r\n    update_selection.select('.bezier-circle')\r\n      // @ts-ignore\r\n      .call(this.behavior.turnOffDrag)\r\n      // @ts-ignore\r\n      .call(drag_behavior)\r\n      .on('mouseover', mouseover)\r\n      .on('mouseout', mouseout)\r\n      .attr('transform', function(d: any) {\r\n        if (d.x == null || d.y == null) return '';\r\n        return 'translate(' + d.x + ',' + d.y + ')';\r\n      });\r\n\r\n    // Update bezier line\r\n    update_selection\r\n      .select('.connect-line')\r\n      .attr('d', function(d: any) {\r\n        const segment_d = drawn_reactions[d.reaction_id].segments[d.segment_id];\r\n        const node = d.bezier === 'b1' ?\r\n          drawn_nodes[segment_d.from_node_id] :\r\n          drawn_nodes[segment_d.to_node_id];\r\n        if (d.x == null || d.y == null || node.x == null || node.y == null)\r\n          return '';\r\n\r\n        return 'M' + d.x + ', ' + d.y + ' ' + node.x + ',' + node.y;\r\n      });\r\n\r\n    this.callback_manager.run('update_bezier', this, update_selection);\r\n  }\r\n\r\n  /**\r\n * Create nodes in the enter_selection.\r\n * @param {} enter_selection - The D3 enter selection.\r\n * @param {} drawn_nodes - The nodes object (e.g. Map.nodes).\r\n * @param {} drawn_reactions - The reactions object (e.g. Map.reactions).\r\n * @returns {} The selection of the new nodes.\r\n */\r\n  create_node(enter_selection: D3Selection, drawn_nodes: any, drawn_reactions: any) {\r\n  // create nodes\r\n    const g = enter_selection\r\n      .append('g')\r\n      .attr('class', 'node')\r\n      .attr('id', function(d: any) { return 'n' + d.node_id; });\r\n\r\n    // create metabolite circle and label\r\n    g.append('circle')\r\n      .attr('class', function(d: any) {\r\n        let c = 'node-circle';\r\n        if (d.node_type !== null)\r\n          c += (' ' + d.node_type + '-circle');\r\n        return c;\r\n      });\r\n\r\n    // labels\r\n    const metabolite_groups = g.filter(function(d: any) {\r\n      return d.node_type === 'metabolite';\r\n    });\r\n\r\n    metabolite_groups.append('text')\r\n      .attr('class', 'node-label label');\r\n\r\n    this.callback_manager.run('create_node', this, enter_selection);\r\n\r\n    return g;\r\n  }\r\n\r\n  /**\r\n * Run on the update selection for nodes.\r\n * @param {D3 Selection} update_selection - The D3.js update selection.\r\n * @param {Scale} scale - A Scale object.\r\n * @param {Boolean} has_data_on_nodes - Boolean to determine whether data needs to be drawn.\r\n * @param {Function} mousedown_fn - A function to call on mousedown for a node.\r\n * @param {Function} click_fn - A function to call on click for a node.\r\n * @param {Function} mouseover_fn - A function to call on mouseover for a node.\r\n * @param {Function} mouseout_fn - A function to call on mouseout for a node.\r\n * @param {D3 Behavior} drag_behavior - The D3.js drag behavior object for the nodes.\r\n * @param {D3 Behavior} label_drag_behavior - The D3.js drag behavior object for the node labels.\r\n */\r\n  update_node(update_selection: D3Selection<any>, scale: Scale, has_data_on_nodes: boolean,\r\n    mousedown_fn: any, click_fn: any, mouseover_fn: any, mouseout_fn: any,\r\n    drag_behavior: any, label_drag_behavior: any) {\r\n  // update circle and label location\r\n    const hide_secondary_metabolites = this.settings.get('hide_secondary_metabolites');\r\n    const primary_r = this.settings.get('primary_metabolite_radius');\r\n    const secondary_r = this.settings.get('secondary_metabolite_radius');\r\n    const marker_r = this.settings.get('marker_radius');\r\n    const hide_all_labels = this.settings.get('hide_all_labels');\r\n    const identifiers_on_map = this.settings.get('identifiers_on_map');\r\n    const metabolite_data_styles = this.settings.get('metabolite_styles');\r\n    const no_data_style = {color: this.settings.get('metabolite_no_data_color'),\r\n      size: this.settings.get('metabolite_no_data_size')};\r\n    const labelMouseover = this.behavior.nodeLabelMouseover;\r\n    const labelMouseout = this.behavior.nodeLabelMouseout;\r\n    const labelTouch = this.behavior.nodeLabelTouch;\r\n    const objectMouseover = this.behavior.nodeObjectMouseover;\r\n    const objectMouseout = this.behavior.nodeObjectMouseout;\r\n\r\n    const mg = update_selection\r\n      .select('.node-circle')\r\n      .attr('transform', function(d: any) {\r\n        return 'translate(' + d.x + ',' + d.y + ')';\r\n      })\r\n      .style('visibility', function(d: any) {\r\n        return hideNode(d, hide_secondary_metabolites) ? 'hidden' : null;\r\n      })\r\n      .attr('r', function(d: any) {\r\n        if (d.node_type === 'metabolite') {\r\n          const should_scale = (has_data_on_nodes &&\r\n                            metabolite_data_styles.indexOf('size') !== -1);\r\n          if (should_scale) {\r\n            const f = d.data;\r\n            return f == null ? no_data_style['size'] : scale.metabolite_size(f);\r\n          } else\r\n            return d.node_is_primary ? primary_r : secondary_r;\r\n        }\r\n        // midmarkers and multimarkers\r\n        return marker_r;\r\n      })\r\n      .style('fill', function(d: any) {\r\n        if (d.node_type === 'metabolite') {\r\n          const should_color_data = (has_data_on_nodes &&\r\n                                 metabolite_data_styles.indexOf('color') !== -1);\r\n          if (should_color_data) {\r\n            const f = d.data;\r\n            return f == null ? no_data_style['color'] : scale.metabolite_color(f);\r\n          } else\r\n            return null;\r\n        }\r\n        // midmarkers and multimarkers\r\n        return null;\r\n      })\r\n      // @ts-ignore\r\n      .call(this.behavior.turnOffDrag)\r\n      .call(drag_behavior)\r\n      .on('mousedown', mousedown_fn)\r\n      .on('click', click_fn)\r\n      .on('mouseover', objectMouseover)\r\n      .on('mouseout', objectMouseout);\r\n\r\n    // update node label visibility\r\n    const node_label = update_selection\r\n      .select('.node-label')\r\n      .attr('visibility', hide_all_labels ? 'hidden' : 'visible');\r\n    if (!hide_all_labels) {\r\n      node_label\r\n        .style('visibility', function(d: any) {\r\n          return hideNode(d, hide_secondary_metabolites) ? 'hidden' : null;\r\n        })\r\n        .attr('transform', function(d: any) {\r\n          return 'translate(' + d.label_x + ',' + d.label_y + ')';\r\n        })\r\n        .text(function(d: any) {\r\n          let t = d[identifiers_on_map];\r\n          if (has_data_on_nodes && metabolite_data_styles.indexOf('text') !== -1)\r\n            t += ' ' + d.data_string;\r\n          return t;\r\n        })\r\n        // @ts-ignore\r\n        .call(this.behavior.turnOffDrag)\r\n        .call(label_drag_behavior)\r\n        .on('mouseover', labelMouseover)\r\n        .on('mouseout', labelMouseout)\r\n        .on('touchend', labelTouch);\r\n    }\r\n\r\n    this.callback_manager.run('update_node', this, update_selection);\r\n\r\n    function hideNode(d: any, hide_secondary_metabolites: boolean) {\r\n      return (d.node_type === 'metabolite' &&\r\n            hide_secondary_metabolites &&\r\n            !d.node_is_primary);\r\n    }\r\n  }\r\n\r\n  /**\r\n * Create text labels in the enter_selection.\r\n * @param {} enter_selection - The D3 enter selection.\r\n * @returns {} The selection of the new nodes.\r\n */\r\n  create_text_label(enter_selection: D3Selection) {\r\n    const g = enter_selection.append('g')\r\n      .attr('id', function(d: any) { return 'l' + d.text_label_id; })\r\n      .attr('class', 'text-label');\r\n    g.append('text')\r\n      .attr('class', 'label');\r\n\r\n    this.callback_manager.run('create_text_label', this, enter_selection);\r\n\r\n    return g;\r\n  }\r\n\r\n  update_text_label(update_selection: D3Selection<any>) {\r\n    const mousedown = this.behavior.textLabelMousedown;\r\n    const click = this.behavior.textLabelClick;\r\n    const turnOffDrag = this.behavior.turnOffDrag;\r\n    const drag = this.behavior.selectableDrag;\r\n\r\n    update_selection\r\n      .select('.label')\r\n      .text(function(d: any) { return d.text; })\r\n      .attr('transform', function(d: any) {\r\n        return 'translate(' + d.x + ',' + d.y + ')';\r\n      })\r\n      .on('mousedown', mousedown)\r\n      .on('click', click)\r\n      .call(turnOffDrag as any)\r\n      .call(drag as any);\r\n\r\n    this.callback_manager.run('update_text_label', this, update_selection);\r\n  }\r\n}\r\n\r\nexport function displacedCoords(reactionArrowDisplacement: number, start: Coord, end: Coord, displace: string) {\r\n  const length = reactionArrowDisplacement;\r\n  const hyp = utils.distance(start, end);\r\n  if (!length || !hyp) {\r\n    console.warn('No space for displacement');\r\n    return {x: start.x, y: start.y};\r\n  }\r\n  if (displace === 'start') {\r\n    return {\r\n      x: start.x + length * (end.x - start.x) / hyp,\r\n      y: start.y + length * (end.y - start.y) / hyp\r\n    };\r\n  } else if (displace === 'end') {\r\n    return {\r\n      x: end.x - length * (end.x - start.x) / hyp,\r\n      y: end.y - length * (end.y - start.y) / hyp\r\n    };\r\n  } else\r\n    console.error('bad displace value: ' + displace);\r\n}\r\n","/**\r\n * Functions for building new reactions.\r\n */\r\n\r\nimport {CobraMetabolite, CobraReaction, Coord, MapNode, MapReaction, MapSegment} from './types';\r\nimport * as utils from './utils';\r\nimport _ from 'underscore';\r\n\r\nfunction getLabelLoc(angle: number) {\r\n  if (Math.abs(angle) > Math.PI)\r\n    throw new Error('Angle must be between -PI and PI');\r\n\r\n  if (Math.abs(angle) < Math.PI / 7 || Math.abs(angle - Math.PI) < Math.PI / 7) {\r\n    // Close to 0 or PI\r\n    return {x: -50, y: -40};\r\n  } else if (angle > 0) {\r\n    // Bottom quadrants\r\n    return {\r\n      x: 15 * (1 - (Math.abs(angle - Math.PI / 2)) / (Math.PI / 2)),\r\n      y: 10 + (angle - Math.PI / 2) * 50\r\n    };\r\n  } else {\r\n    // Top quadrants\r\n    return {\r\n      x: 15 * (1 - (Math.abs(angle + Math.PI / 2)) / (Math.PI / 2)),\r\n      y: 10 - (Math.abs(angle) - Math.PI / 2) * 50\r\n    };\r\n  }\r\n}\r\n\r\n/**\r\n * Get the location for a new metabolite label.\r\n * @param angleRaw - angle in radians\r\n * @param index\r\n * @param count\r\n * @param isPrimary\r\n * @param biggId\r\n * @param primaryIndex\r\n */\r\nexport function getMetLabelLoc(angleRaw: number, index: number, count: number, isPrimary: boolean, biggId: string,\r\n  primaryIndex: number) {\r\n  const angle = utils.angleNorm(angleRaw);\r\n  const width = biggId.length * 18;\r\n  const leftRight = (index - (index > primaryIndex ? 1 : 0) - (count / 2)) >= -1;\r\n  if (Math.abs(angle) < Math.PI / 7) {\r\n    // Close to 0\r\n    if (isPrimary || leftRight) {\r\n      // Primary or bottom\r\n      return {x: -width * 0.3, y: 40};\r\n    } else {\r\n      // Top\r\n      return {x: -width * 0.3, y: -20};\r\n    }\r\n  } else if (Math.abs(angle - Math.PI) < Math.PI / 7) {\r\n    // Close to PI\r\n    if (isPrimary || !leftRight) {\r\n      // Primary or bottom\r\n      return {x: -width * 0.3, y: 40};\r\n    } else {\r\n      // Top\r\n      return {x: -width * 0.3, y: -20};\r\n    }\r\n  } else {\r\n    if (isPrimary) {\r\n      // Primary\r\n      return {\r\n        x: 25 - 38 * Math.abs(Math.abs(angle) - Math.PI / 2),\r\n        y: (Math.abs(angle) - Math.PI / 2) * ((angle > 0 ? 1 : 0) * 2 - 1) * 50\r\n      };\r\n    } else if ((angle < 0 && leftRight) || (angle > 0 && !leftRight)) {\r\n      // Right\r\n      return {x: 15, y: 0};\r\n    } else {\r\n      // Left\r\n      return {x: -width * 0.5, y: 30};\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * New reaction.\r\n * @param {Number} direction - clockwise from 'right', in degrees.\r\n */\r\nexport function newReaction(biggId: string, cobraReaction: CobraReaction, cobraMetabolites: { [key: string]: CobraMetabolite },\r\n  selectedNodeId: string, selectedNode: MapNode, largestIds: {reactions: number, nodes: number, segments: number},\r\n  cofactors: string[], direction: number) {\r\n  // Convert to radians, and force to domain - PI/2 to PI/2\r\n  const angle = utils.to_radians_norm(direction);\r\n\r\n  // Generate a new integer id\r\n  const newReactionId = String(++largestIds.reactions);\r\n\r\n  // Calculate coordinates of reaction\r\n  const selectedNodeCoords = {x: selectedNode.x, y: selectedNode.y};\r\n\r\n  // Rotate main axis around angle with distance\r\n  const reactionLength = 350;\r\n  const mainAxis: Coord[] = [\r\n    selectedNodeCoords,\r\n    utils.c_plus_c(selectedNodeCoords, {x: reactionLength, y: 0}) as Coord\r\n  ];\r\n  const center = {\r\n    x: (mainAxis[0].x + mainAxis[1].x) / 2,\r\n    y: (mainAxis[0].y + mainAxis[1].y) / 2\r\n  };\r\n\r\n  // Relative label location\r\n  const labelD = getLabelLoc(angle);\r\n\r\n  // Relative anchor node distance\r\n  const anchorDistance = 20;\r\n\r\n  // New reaction structure\r\n  const newReactionCobra: CobraReaction = {\r\n    name: cobraReaction.name,\r\n    bigg_id: cobraReaction.bigg_id,\r\n    reversibility: cobraReaction.reversibility,\r\n    gene_reaction_rule: cobraReaction.gene_reaction_rule,\r\n    genes: utils.clone(cobraReaction.genes),\r\n    metabolites: utils.clone(cobraReaction.metabolites)\r\n  };\r\n  utils.extend(newReactionCobra, {\r\n    label_x: center.x + labelD.x,\r\n    label_y: center.y + labelD.y,\r\n    segments: {}\r\n  });\r\n\r\n  // Set primary metabolites and count reactants/products\r\n\r\n  // Look for the selected metabolite, and record the indices\r\n  const reactantRanks = [];\r\n  const productRanks = [];\r\n  let reactantCount = 0;\r\n  let productCount = 0;\r\n  let reactionIsReversed = false;\r\n  for (const metBiggId in newReactionCobra.metabolites) {\r\n    // Make the metabolites into objects\r\n    const metabolite = cobraMetabolites[metBiggId] as CobraMetabolite;\r\n    const coefficient = newReactionCobra.metabolites[metBiggId];\r\n    const formula = metabolite.formula;\r\n    const newMetabolite: CobraMetabolite = {\r\n      coefficient: coefficient,\r\n      bigg_id: metBiggId,\r\n      name: metabolite.name\r\n    };\r\n    if (coefficient < 0) {\r\n      newMetabolite.index = reactantCount;\r\n      // score the metabolites. Infinity == selected, >= 1 == carbon containing\r\n      const carbons = /C([0-9]+)/.exec(formula || '');\r\n      if (selectedNode.bigg_id === newMetabolite.bigg_id)\r\n        reactantRanks.push([newMetabolite.index, Infinity]);\r\n      else if (carbons && cofactors.indexOf(utils.decompartmentalize(newMetabolite.bigg_id || '')[0]!) === -1)\r\n        reactantRanks.push([newMetabolite.index, parseInt(carbons[1])]);\r\n\r\n      reactantCount++;\r\n    } else {\r\n      newMetabolite.index = productCount;\r\n      const carbons = /C([0-9]+)/.exec(formula || '');\r\n      if (selectedNode.bigg_id === newMetabolite.bigg_id) {\r\n        productRanks.push([newMetabolite.index, Infinity]);\r\n        reactionIsReversed = true;\r\n      } else if (carbons && cofactors.indexOf(utils.decompartmentalize(newMetabolite.bigg_id)[0]!) === -1)\r\n        productRanks.push([newMetabolite.index, parseInt(carbons[1])]);\r\n\r\n      productCount++;\r\n    }\r\n    // @ts-ignore here to avoid type errors, but metabolites attr where name -> coef is overwritten to map style reaction, with metabolites as objects\r\n    newReactionCobra.metabolites[metBiggId] = newMetabolite;\r\n  }\r\n\r\n  const newReaction: MapReaction = newReactionCobra as unknown as MapReaction;\r\n\r\n  // get the rank with the highest score\r\n  const maxRank = (old: number[], current: number[]) => current[1] > old[1] ? current : old;\r\n  const primaryReactantIndex = reactantRanks.reduce(maxRank, [0, 0])[0];\r\n  const primaryProductIndex = productRanks.reduce(maxRank, [0, 0])[0];\r\n\r\n  // set primary metabolites, and keep track of the total counts\r\n  for (const metBiggId in newReaction.metabolites) {\r\n    const metabolite = newReaction.metabolites[metBiggId];\r\n    if (metabolite.coefficient < 0) {\r\n      metabolite.is_primary = metabolite.index === primaryReactantIndex;\r\n      metabolite.count = reactantCount;\r\n    } else {\r\n      metabolite.is_primary = metabolite.index === primaryProductIndex;\r\n      metabolite.count = productCount;\r\n    }\r\n  }\r\n\r\n  // generate anchor nodes\r\n  const newAnchors: { [key: string]: MapNode } = {};\r\n  const anchors = [\r\n    {\r\n      node_type: 'anchor_reactants',\r\n      dis: {x: anchorDistance * (reactionIsReversed ? 1 : -1), y: 0}\r\n    },\r\n    {node_type: 'center', dis: {x: 0, y: 0}},\r\n    {\r\n      node_type: 'anchor_products',\r\n      dis: {x: anchorDistance * (reactionIsReversed ? -1 : 1), y: 0}\r\n    }\r\n  ];\r\n  const anchorIds: { [key: string]: string } = {};\r\n  anchors.map((n) => {\r\n    const newId = String(++largestIds.nodes);\r\n    const generalNodeType = n.node_type === 'center' ? 'midmarker' : 'multimarker';\r\n    newAnchors[newId] = {\r\n      node_type: generalNodeType,\r\n      x: center.x + n.dis.x,\r\n      y: center.y + n.dis.y,\r\n      connected_segments: [],\r\n      name: null,\r\n      bigg_id: null,\r\n      label_x: null,\r\n      label_y: null,\r\n      node_is_primary: null,\r\n      data: null\r\n    } as unknown as MapNode;\r\n    anchorIds[n.node_type] = newId;\r\n  });\r\n\r\n  // add the segments, outside to inside\r\n  const newAnchorGroups = [\r\n    [anchorIds['anchor_reactants'], anchorIds['center'], 'reactants'],\r\n    [anchorIds['anchor_products'], anchorIds['center'], 'products']\r\n  ];\r\n  newAnchorGroups.map((l) => {\r\n    const fromId = l[0];\r\n    const toId = l[1];\r\n    const newSegmentId = String(++largestIds.segments);\r\n    const unconnectedSeg = (\r\n      (reactantCount === 0 && l[2] === 'reactants' && newReaction.reversibility) ||\r\n      (productCount === 0 && l[2] === 'products')\r\n    );\r\n    newReaction.segments[newSegmentId] = {\r\n      b1: null,\r\n      b2: null,\r\n      from_node_id: fromId,\r\n      to_node_id: toId,\r\n      from_node_coefficient: null,\r\n      to_node_coefficient: null,\r\n      reversibility: newReaction.reversibility,\r\n      data: newReaction.data,\r\n      reverse_flux: newReaction.reverse_flux,\r\n      unconnected_segment_with_arrow: unconnectedSeg\r\n    };\r\n    newAnchors[fromId].connected_segments.push({\r\n      segment_id: newSegmentId,\r\n      reaction_id: newReactionId\r\n    });\r\n    newAnchors[toId].connected_segments.push({\r\n      segment_id: newSegmentId,\r\n      reaction_id: newReactionId\r\n    });\r\n  });\r\n\r\n  // Add the metabolites, keeping track of total reactants and products.\r\n  const newNodes = newAnchors;\r\n  for (const metBiggId in newReaction.metabolites) {\r\n    const metabolite = newReaction.metabolites[metBiggId] as CobraMetabolite;\r\n    let primaryIndex;\r\n    let fromNodeId;\r\n    if (metabolite.coefficient < 0) {\r\n      primaryIndex = primaryReactantIndex;\r\n      fromNodeId = anchorIds['anchor_reactants'];\r\n    } else {\r\n      primaryIndex = primaryProductIndex;\r\n      fromNodeId = anchorIds['anchor_products'];\r\n    }\r\n\r\n    // calculate coordinates of metabolite components\r\n    const metLoc = calculateNewMetaboliteCoordinates(\r\n      metabolite,\r\n      primaryIndex,\r\n      mainAxis,\r\n      center,\r\n      reactionLength,\r\n      reactionIsReversed\r\n    );\r\n\r\n    // if this is the existing metabolite\r\n    if (selectedNode.bigg_id === metabolite.bigg_id) {\r\n      const newSegmentId = String(++largestIds.segments);\r\n      newReaction.segments[newSegmentId] = {\r\n        b1: metLoc.b1,\r\n        b2: metLoc.b2,\r\n        from_node_id: fromNodeId,\r\n        to_node_id: selectedNodeId,\r\n        from_node_coefficient: null,\r\n        to_node_coefficient: metabolite.coefficient,\r\n        reversibility: newReaction.reversibility\r\n      };\r\n      // Update the existing node\r\n      selectedNode.connected_segments.push({\r\n        segment_id: newSegmentId,\r\n        reaction_id: newReactionId\r\n      });\r\n      newNodes[fromNodeId].connected_segments.push({\r\n        segment_id: newSegmentId,\r\n        reaction_id: newReactionId\r\n      });\r\n    } else {\r\n      // save new metabolite\r\n      const newSegmentId = String(++largestIds.segments);\r\n      const newNodeId = String(++largestIds.nodes);\r\n      newReaction.segments[newSegmentId] = {\r\n        b1: metLoc.b1,\r\n        b2: metLoc.b2,\r\n        from_node_id: fromNodeId,\r\n        to_node_id: newNodeId,\r\n        from_node_coefficient: null,\r\n        to_node_coefficient: metabolite.coefficient,\r\n        reversibility: newReaction.reversibility\r\n      };\r\n      // save new node\r\n      const metLabelD = getMetLabelLoc(\r\n        angle,\r\n        metabolite.index!,\r\n        metabolite.count!,\r\n        metabolite.is_primary!,\r\n        metabolite.bigg_id,\r\n        primaryIndex\r\n      );\r\n      newNodes[newNodeId] = {\r\n        connected_segments: [{\r\n          segment_id: newSegmentId,\r\n          reaction_id: newReactionId\r\n        }],\r\n        x: metLoc.circle!.x,\r\n        y: metLoc.circle!.y,\r\n        node_is_primary: metabolite.is_primary,\r\n        label_x: metLoc.circle!.x + metLabelD.x,\r\n        label_y: metLoc.circle!.y + metLabelD.y,\r\n        name: metabolite.name!,\r\n        bigg_id: metabolite.bigg_id,\r\n        node_type: 'metabolite'\r\n      };\r\n      newNodes[fromNodeId].connected_segments.push({\r\n        segment_id: newSegmentId,\r\n        reaction_id: newReactionId\r\n      });\r\n    }\r\n  }\r\n\r\n  // now take out the extra reaction details\r\n  const metabolitesArray = [];\r\n  for (const biggId in newReaction.metabolites) {\r\n    metabolitesArray.push({\r\n      bigg_id: biggId,\r\n      coefficient: newReaction.metabolites[biggId].coefficient\r\n    });\r\n  }\r\n  newReaction.metabolites = metabolitesArray;\r\n\r\n  // newReactions object\r\n  const newReactions: { [key: string]: MapReaction } = {};\r\n  newReactions[newReactionId] = newReaction;\r\n\r\n  // new_beziers object\r\n  const newBeziers = newBeziersForReactions(newReactions);\r\n\r\n  // add the selected node for rotation, and return it as a new (updated) node\r\n  newNodes[selectedNodeId] = selectedNode;\r\n  rotateNodes(newNodes, newReactions, newBeziers, angle, selectedNodeCoords);\r\n\r\n  return {\r\n    new_reactions: newReactions,\r\n    new_beziers: newBeziers,\r\n    new_nodes: newNodes\r\n  };\r\n}\r\n\r\n/**\r\n * Rotate the nodes around center.\r\n * @param selected_nodes - Nodes to rotate.\r\n * @param reactions - Only updates beziers for these reactions.\r\n * @param beziers - Also update the bezier points.\r\n * @param angle - Angle to rotate in radians.\r\n * @param center - Point to rotate around.\r\n */\r\nexport function rotateNodes(selectedNodes: { [key: string]: MapNode }, reactions: { [key: string]: MapReaction }, beziers: any, angle: number, center: Coord) {\r\n  const rotateAround = (coord: Coord | null) => {\r\n    if (coord == null)\r\n      return null;\r\n\r\n    return utils.rotate_coords(coord, angle, center);\r\n  };\r\n\r\n  // recalculate: node\r\n  const updatedNodeIds: string[] = [];\r\n  let updatedReactionIds: string[] = [];\r\n  for (const nodeId in selectedNodes) {\r\n    const node = selectedNodes[nodeId];\r\n    // rotation distance\r\n    const displacement = rotateAround({x: node.x, y: node.y});\r\n    // move the node\r\n    const updated = moveNodeAndLabels(node, reactions, displacement!);\r\n    // move the bezier points\r\n    node.connected_segments.map((segmentObj) => {\r\n      const reaction = reactions[segmentObj.reaction_id];\r\n      // If the reaction was not passed in the reactions argument, then ignore\r\n      if (reaction === undefined) return;\r\n\r\n      // rotate the beziers\r\n      const segmentId = segmentObj.segment_id;\r\n      const segment = reaction.segments[segmentId];\r\n      if (segment.to_node_id === nodeId && segment.b2) {\r\n        const displacement = rotateAround(segment.b2);\r\n        const bezId = bezierIdForSegmentId(segmentId, 'b2');\r\n        segment.b2 = utils.c_plus_c(segment.b2, displacement!);\r\n        beziers[bezId].x = segment.b2!.x;\r\n        beziers[bezId].y = segment.b2!.y;\r\n      } else if (segment.from_node_id === nodeId && segment.b1) {\r\n        const displacement = rotateAround(segment.b1);\r\n        const bezId = bezierIdForSegmentId(segmentId, 'b1');\r\n        segment.b1 = utils.c_plus_c(segment.b1!, displacement!);\r\n        beziers[bezId].x = segment.b1!.x;\r\n        beziers[bezId].y = segment.b1!.y;\r\n      }\r\n    });\r\n\r\n    updatedReactionIds = utils.uniqueConcat([updatedReactionIds, updated.reaction_ids]);\r\n    updatedNodeIds.push(nodeId);\r\n  }\r\n\r\n  return {\r\n    node_ids: updatedNodeIds,\r\n    reaction_ids: updatedReactionIds\r\n  };\r\n}\r\n\r\n/**\r\n * Move the node and its labels and beziers.\r\n */\r\nexport function moveNodeAndDependents(node: MapNode, nodeId: string, reactions: { [key: string]: MapReaction }, beziers: any,\r\n  displacement: Coord) {\r\n  const updated = moveNodeAndLabels(node, reactions, displacement);\r\n\r\n  // move beziers\r\n  node.connected_segments.map((segmentObj) => {\r\n    const reaction = reactions[segmentObj.reaction_id];\r\n    // If the reaction was not passed in the reactions argument, then ignore\r\n    if (_.isUndefined(reaction)) return;\r\n\r\n    // Update beziers\r\n    const segmentId = segmentObj.segment_id;\r\n    const segment = reaction.segments[segmentId];\r\n    const cs = [['b1', 'from_node_id'], ['b2', 'to_node_id']];\r\n    cs.forEach((c) => {\r\n      const bez = c[0] as keyof MapSegment;\r\n      const node = c[1] as keyof MapSegment;\r\n      if (segment[node] === nodeId && segment[bez]) {\r\n        segment[bez] = utils.c_plus_c(segment[bez], displacement);\r\n        const tbez = beziers[bezierIdForSegmentId(segmentId, bez)];\r\n        tbez.x = segment[bez].x;\r\n        tbez.y = segment[bez].y;\r\n      }\r\n    });\r\n\r\n    // add to list of updated reaction ids if it isn't already there\r\n    if (updated.reaction_ids.indexOf(segmentObj.reaction_id) < 0)\r\n      updated.reaction_ids.push(segmentObj.reaction_id);\r\n  });\r\n  return updated;\r\n}\r\n\r\nfunction moveNodeAndLabels(node: MapNode, reactions: { [key: string]: MapReaction }, displacement: Coord) {\r\n  node.x = node.x + displacement.x;\r\n  node.y = node.y + displacement.y;\r\n\r\n  // recalculate: node label\r\n  node.label_x = node.label_x + displacement.x;\r\n  node.label_y = node.label_y + displacement.y;\r\n\r\n  // recalculate: reaction label\r\n  const updatedReactionIds: string[] = [];\r\n  node.connected_segments.map((segmentObj) => {\r\n    const reaction = reactions[segmentObj.reaction_id];\r\n    // add to list of updated reaction ids if it isn't already there\r\n    if (updatedReactionIds.indexOf(segmentObj.reaction_id) < 0) {\r\n      updatedReactionIds.push(segmentObj.reaction_id);\r\n\r\n      // update reaction label (but only once per reaction\r\n      if (node.node_type === 'midmarker') {\r\n        reaction.label_x = reaction.label_x + displacement.x;\r\n        reaction.label_y = reaction.label_y + displacement.y;\r\n      }\r\n    }\r\n  });\r\n  return {reaction_ids: updatedReactionIds};\r\n}\r\n\r\n/**\r\n * Calculate the distance of mets from main reaction axis.\r\n * @param {Number} w - Scaling factor\r\n * @param {Number} draw_at_index - Index of metabolite\r\n * @param {Number} num_slots - Number of metabolites\r\n */\r\nfunction metIndexDisp(w: number, drawAtIndex: number, numSlots: number) {\r\n  const half = Math.floor(numSlots / 2);\r\n  return w * (drawAtIndex - half + (drawAtIndex >= half ? 1 : 0));\r\n}\r\n\r\nfunction metSecondaryDisp(secondaryW: number, secondaryDis: number, drawAtIndex: number, numSlots: number) {\r\n  const half = Math.floor(numSlots / 2);\r\n  return secondaryDis + Math.abs(drawAtIndex - half + (drawAtIndex >= half ? 1 : 0)) * secondaryW;\r\n}\r\n\r\n/**\r\n * Calculate metabolite coordinates for a new reaction metabolite.\r\n */\r\nfunction calculateNewMetaboliteCoordinates(met: CobraMetabolite, primaryIndex: number, mainAxis: Coord[], center: Coord,\r\n  dis: number, isReversed: boolean) {\r\n  // new local coordinate system\r\n  const displacement = mainAxis[0];\r\n  mainAxis = [\r\n    utils.c_minus_c(mainAxis[0], displacement)!,\r\n    utils.c_minus_c(mainAxis[1], displacement)!\r\n  ];\r\n  center = utils.c_minus_c(center, displacement)!;\r\n\r\n  // Curve parameters\r\n  const w = 80; // distance between reactants and between products\r\n  const b1Strength = 0.4;\r\n  const b2Strength = 0.25;\r\n  const w2 = w * 0.3; // bezier target poin\r\n  const secondaryDis = 50; // y distance of first secondary mets\r\n  const secondaryW = 20; // y distance of each other secondary met\r\n\r\n  // Secondary mets\r\n  const numSlots = met.count! - 1;\r\n\r\n  // Size and spacing for primary and secondary metabolites\r\n  let ds;\r\n  let drawAtIndex: number | undefined;\r\n  if (met.is_primary) { // primary\r\n    ds = 20;\r\n  } else { // secondary\r\n    ds = 10;\r\n    // don't use center slot\r\n    if (met.index! > primaryIndex) drawAtIndex = met.index! - 1;\r\n    else drawAtIndex = met.index!;\r\n  }\r\n\r\n  const de = dis - ds; // distance between ends of line axis\r\n  const reactionAxis = [{x: ds, y: 0}, {x: de, y: 0}];\r\n\r\n  // Define line parameters and axis.\r\n  // Begin with unrotated coordinate system. +y = Down, +x = Right.\r\n  let end;\r\n  let circle;\r\n  let b1;\r\n  let b2;\r\n\r\n  // Reactants\r\n  if (((met.coefficient < 0) !== isReversed) && met.is_primary) { // Ali == BADASS\r\n    end = {\r\n      x: reactionAxis[0].x,\r\n      y: reactionAxis[0].y\r\n    };\r\n    b1 = {\r\n      x: center.x * (1 - b1Strength) + reactionAxis[0].x * b1Strength,\r\n      y: center.y * (1 - b1Strength) + reactionAxis[0].y * b1Strength\r\n    };\r\n    b2 = {\r\n      x: center.x * b2Strength + end.x * (1 - b2Strength),\r\n      y: center.y * b2Strength + end.y * (1 - b2Strength)\r\n    };\r\n    circle = {\r\n      x: mainAxis[0].x,\r\n      y: mainAxis[0].y\r\n    };\r\n  } else if ((met.coefficient < 0) !== isReversed) {\r\n    end = {\r\n      x: reactionAxis[0].x + metSecondaryDisp(secondaryW, secondaryDis,\r\n        drawAtIndex!, numSlots),\r\n      y: reactionAxis[0].y + metIndexDisp(w2, drawAtIndex!, numSlots)\r\n    };\r\n    b1 = {\r\n      x: center.x * (1 - b1Strength) + reactionAxis[0].x * b1Strength,\r\n      y: center.y * (1 - b1Strength) + reactionAxis[0].y * b1Strength\r\n    };\r\n    b2 = {\r\n      x: center.x * b2Strength + end.x * (1 - b2Strength),\r\n      y: center.y * b2Strength + end.y * (1 - b2Strength)\r\n    };\r\n    circle = {\r\n      x: mainAxis[0].x + metSecondaryDisp(secondaryW, secondaryDis, drawAtIndex!, numSlots),\r\n      y: mainAxis[0].y + metIndexDisp(w, drawAtIndex!, numSlots)\r\n    };\r\n  } else if (((met.coefficient > 0) !== isReversed) && met.is_primary) { // products\r\n    end = {\r\n      x: reactionAxis[1].x,\r\n      y: reactionAxis[1].y\r\n    };\r\n    b1 = {\r\n      x: center.x * (1 - b1Strength) + reactionAxis[1].x * b1Strength,\r\n      y: center.y * (1 - b1Strength) + reactionAxis[1].y * b1Strength\r\n    };\r\n    b2 = {\r\n      x: center.x * b2Strength + end.x * (1 - b2Strength),\r\n      y: center.y * b2Strength + end.y * (1 - b2Strength)\r\n    };\r\n    circle = {\r\n      x: mainAxis[1].x,\r\n      y: mainAxis[1].y\r\n    };\r\n  } else if ((met.coefficient > 0) !== isReversed) {\r\n    end = {\r\n      x: reactionAxis[1].x - metSecondaryDisp(secondaryW, secondaryDis, drawAtIndex!, numSlots),\r\n      y: reactionAxis[1].y + metIndexDisp(w2, drawAtIndex!, numSlots)\r\n    };\r\n    b1 = {\r\n      x: center.x * (1 - b1Strength) + reactionAxis[1].x * b1Strength,\r\n      y: center.y * (1 - b1Strength) + reactionAxis[1].y * b1Strength\r\n    };\r\n    b2 = {\r\n      x: center.x * b2Strength + end.x * (1 - b2Strength),\r\n      y: center.y * b2Strength + end.y * (1 - b2Strength)\r\n    };\r\n    circle = {\r\n      x: mainAxis[1].x - metSecondaryDisp(secondaryW, secondaryDis, drawAtIndex!, numSlots),\r\n      y: mainAxis[1].y + metIndexDisp(w, drawAtIndex!, numSlots)\r\n    };\r\n  }\r\n\r\n  return {\r\n    b1: utils.c_plus_c(displacement, b1),\r\n    b2: utils.c_plus_c(displacement, b2),\r\n    circle: utils.c_plus_c(displacement, circle)\r\n  };\r\n}\r\n\r\nexport function newTextLabel(largestIds: { text_labels: number }, text: string, coords: Coord) {\r\n  const newId = String(++largestIds.text_labels);\r\n  const newLabel = {text: text, x: coords.x, y: coords.y};\r\n  return {id: newId, label: newLabel};\r\n}\r\n\r\nexport function bezierIdForSegmentId(segmentId: string, bez: string) {\r\n  return segmentId + '_' + bez;\r\n}\r\n\r\n/**\r\n * Return an array of beziers ids for the array of reaction ids.\r\n * @param {Object} reactions - A reactions object, e.g. a subset of\r\n * *escher.Map.reactions*.\r\n */\r\nexport function bezierIdsForReactionIds(reactions: { [key: string]: MapReaction }) {\r\n  const bezierIds: string[] = [];\r\n  for (const reactionId in reactions) {\r\n    const reaction = reactions[reactionId];\r\n\r\n    for (const segmentId in reaction.segments) {\r\n      const segment = reaction.segments[segmentId];\r\n\r\n      const bezs = ['b1', 'b2'];\r\n      bezs.forEach(function(bez) {\r\n        const segBez = segment[bez as keyof MapSegment];\r\n        if (segBez !== null)\r\n          bezierIds.push(bezierIdForSegmentId(segmentId, bez));\r\n      });\r\n    }\r\n  }\r\n  return bezierIds;\r\n}\r\n\r\n/**\r\n * Return an object containing beziers for the segments object.\r\n * segments: A segments object, e.g. *escher.Map.segments*.\r\n * reaction_id: The reaction id for the segments.\r\n */\r\nexport function newBeziersForSegments(segments: { [key: string]: MapSegment }, reactionId: string) {\r\n  const beziers: { [key: string]: any } = {};\r\n  for (const segmentId in segments) {\r\n    const segment = segments[segmentId]\r\n\r\n    ;['b1', 'b2'].forEach(function(bez) {\r\n      const segBez = segment[bez as keyof MapSegment];\r\n      if (segBez !== null) {\r\n        const bezierId = bezierIdForSegmentId(segmentId, bez);\r\n        beziers[bezierId] = {\r\n          bezier: bez,\r\n          x: segBez.x,\r\n          y: segBez.y,\r\n          reaction_id: reactionId,\r\n          segment_id: segmentId\r\n        };\r\n      }\r\n    });\r\n  }\r\n  return beziers;\r\n}\r\n\r\n/**\r\n * Return an object containing beziers for the reactions object.\r\n * @param {Object} reactions - A reactions object, e.g. *escher.Map.reactions*.\r\n */\r\nexport function newBeziersForReactions(reactions: { [key: string]: MapReaction }) {\r\n  const beziers: { [key: string]: any } = {};\r\n  for (const reactionId in reactions) {\r\n    const reaction = reactions[reactionId];\r\n    const these = newBeziersForSegments(reaction.segments, reactionId);\r\n    utils.extend(beziers, these);\r\n  }\r\n  return beziers;\r\n}\r\n","/* eslint-disable no-invalid-this */\r\nimport * as utils from './utils';\r\nimport * as build from './build';\r\nimport {drag as d3Drag} from 'd3-drag';\r\nimport * as d3Selection from 'd3-selection';\r\nimport {EscherMap} from './escherMap';\r\nimport UndoStack from './UndoStack';\r\nimport {Coord, D3Selection, MapNode, MapSegment} from './types';\r\nconst d3Select = d3Selection.select;\r\n// @ts-ignore, somehow there are no types for this, but its there\r\nconst d3Mouse = d3Selection.mouse! as any;\r\n\r\n// @ts-ignore, somehow there are no types for this, but its there\r\nconst getD3Event = (): any => d3Selection.event;\r\n\r\n/**\r\n * Behavior. Defines the set of click and drag behaviors for the map, and keeps\r\n * track of which behaviors are activated.\r\n * @param map {Map} -\r\n * @param undoStack {UndoStack} -\r\n */\r\nexport default class Behavior {\r\n  map: EscherMap;\r\n  undoStack: UndoStack;\r\n  emptyBehavior: () => void;\r\n  rotationModeEnabled: boolean;\r\n  rotationDrag: any;\r\n  selectableMousedown: any;\r\n  textLabelMousedown: any;\r\n  selectableClick: any;\r\n  nodeMouseover: any;\r\n  nodeMouseout: any;\r\n  textEditMousedown: any;\r\n  textLabelClick: any;\r\n  selectableDrag: any;\r\n  nodeLabelMouseover: any;\r\n  nodeLabelTouch: any;\r\n  nodeLabelMouseout: any;\r\n  reactionLabelMouseover: any;\r\n  reactionLabelTouch: any;\r\n  reactionLabelMouseout: any;\r\n  geneLabelMouseover: any;\r\n  geneLabelTouch: any;\r\n  geneLabelMouseout: any;\r\n  nodeObjectMouseover: any;\r\n  nodeObjectMouseout: any;\r\n  reactionObjectMouseover: any;\r\n  reactionObjectMouseout: any;\r\n  bezierDrag: any;\r\n  bezierMouseover: any;\r\n  bezierMouseout: any;\r\n  reactionLabelDrag: any;\r\n  nodeLabelDrag: any;\r\n  dragging: boolean;\r\n  center: any;\r\n  parentNode: any;\r\n  labelDrag: null | (() => void) = null;\r\n  labelTouch: null | ((type: string, d: any) => void) = null;\r\n  objectTouch: null | ((type: string, d: any) => void) = null;\r\n\r\n\r\n  constructor(map: EscherMap, undoStack: UndoStack) {\r\n    this.map = map;\r\n    this.undoStack = undoStack;\r\n\r\n    // make an empty function that can be called as a behavior and does nothing\r\n    this.emptyBehavior = () => {};\r\n\r\n    // rotation mode operates separately from the rest\r\n    this.rotationModeEnabled = false;\r\n    this.rotationDrag = d3Drag();\r\n\r\n    // behaviors to be applied\r\n    this.selectableMousedown = null;\r\n    this.textLabelMousedown = null;\r\n    this.textLabelClick = null;\r\n    this.selectableDrag = this.emptyBehavior;\r\n\r\n    this.nodeLabelMouseover = null;\r\n    this.nodeLabelTouch = null;\r\n    this.nodeLabelMouseout = null;\r\n    this.reactionLabelMouseover = null;\r\n    this.reactionLabelTouch = null;\r\n    this.reactionLabelMouseout = null;\r\n    this.geneLabelMouseover = null;\r\n    this.geneLabelTouch = null;\r\n    this.geneLabelMouseout = null;\r\n\r\n    this.nodeObjectMouseover = null;\r\n    this.nodeObjectMouseout = null;\r\n    this.reactionObjectMouseover = null;\r\n    this.reactionObjectMouseout = null;\r\n\r\n    this.bezierDrag = this.emptyBehavior;\r\n    this.bezierMouseover = null;\r\n    this.bezierMouseout = null;\r\n    this.reactionLabelDrag = this.emptyBehavior;\r\n    this.nodeLabelDrag = this.emptyBehavior;\r\n    this.dragging = false;\r\n  }\r\n\r\n  averageLocation(nodes: { [key: string]: MapNode }) {\r\n    const xs = [];\r\n    const ys = [];\r\n    for (const nodeId in nodes) {\r\n      const node = nodes[nodeId];\r\n      if (node.x !== undefined) xs.push(node.x);\r\n      if (node.y !== undefined) ys.push(node.y);\r\n    }\r\n    return {\r\n      x: utils.mean(xs),\r\n      y: utils.mean(ys)\r\n    };\r\n  }\r\n\r\n  showCenter() {\r\n    const sel = this.map.sel.selectAll('#rotation-center').data([0]);\r\n    const enterSel = sel.enter().append('g').attr('id', 'rotation-center');\r\n\r\n    enterSel.append('path').attr('d', 'M-32 0 L32 0')\r\n      .attr('class', 'rotation-center-line');\r\n    enterSel.append('path').attr('d', 'M0 -32 L0 32')\r\n      .attr('class', 'rotation-center-line');\r\n\r\n    const updateSel = enterSel.merge(sel as any);\r\n\r\n    updateSel.attr('transform',\r\n      'translate(' + this.center.x + ',' + this.center.y + ')')\r\n      .attr('visibility', 'visible')\r\n      .on('mouseover', function() {\r\n        const current = parseFloat(updateSel.selectAll('path').style('stroke-width'));\r\n        updateSel.selectAll('path').style('stroke-width', current * 2 + 'px');\r\n      })\r\n      .on('mouseout', function() {\r\n        updateSel.selectAll('path').style('stroke-width', null);\r\n      })\r\n      // @ts-ignore\r\n      .call(d3Drag().on('drag', (_: any) => {\r\n        const cur = utils.d3_transform_catch(updateSel.attr('transform'));\r\n        const newLoc = [\r\n          // @ts-ignore\r\n          (getD3Event()?.dx ?? 0) + cur.translate[0],\r\n          // @ts-ignore\r\n          (getD3Event()?.dy ?? 0) + cur.translate[1]\r\n        ];\r\n        updateSel.attr('transform', 'translate(' + newLoc + ')');\r\n        this.center = {x: newLoc[0], y: newLoc[1]};\r\n      }));\r\n  }\r\n\r\n  hideCenter() {\r\n    this.map.sel.select('#rotation-center')\r\n      .attr('visibility', 'hidden');\r\n  }\r\n\r\n  /**\r\n   * Listen for rotation, and rotate selected nodes.\r\n   */\r\n  toggleRotationMode(onOff: boolean | undefined) {\r\n    if (onOff === undefined)\r\n      this.rotationModeEnabled = !this.rotationModeEnabled;\r\n    else\r\n      this.rotationModeEnabled = onOff;\r\n\r\n\r\n    const selectionNode = this.map.sel.selectAll('.node-circle');\r\n    const selectionBackground = this.map.sel.selectAll('#canvas');\r\n\r\n    if (this.rotationModeEnabled) {\r\n      const selectedNodes = this.map.getSelectedNodes();\r\n      if (Object.keys(selectedNodes).length === 0) {\r\n        console.warn('No selected nodes');\r\n        return;\r\n      }\r\n\r\n      // show center\r\n      this.center = this.averageLocation(selectedNodes);\r\n      this.showCenter();\r\n\r\n      // this.setStatus('Drag to rotate.')\r\n      const map = this.map;\r\n      const selectedNodeIds = Object.keys(selectedNodes);\r\n      const reactions = this.map.reactions;\r\n      const nodes = this.map.nodes;\r\n      const beziers = this.map.beziers;\r\n\r\n      const startFn = (_: any) => {\r\n        // silence other listeners\r\n        // @ts-ignore\r\n        getD3Event()?.sourceEvent?.stopPropagation();\r\n      };\r\n      const dragFn = (d: any, angle: any, totalAngle: any, center: any) => {\r\n        const updated = build.rotateNodes(selectedNodes, reactions,\r\n          beziers, angle, center);\r\n        map.draw_these_nodes(updated.node_ids);\r\n        map.draw_these_reactions(updated.reaction_ids);\r\n      };\r\n      const endFn = (_: any) => {};\r\n      const undoFn = (d: any, totalAngle: number, center: Coord) => {\r\n        // undo\r\n        const theseNodes: { [key: string]: MapNode } = {};\r\n        selectedNodeIds.forEach(function(id) {\r\n          theseNodes[id] = nodes[id];\r\n        });\r\n        const updated = build.rotateNodes(theseNodes, reactions,\r\n          beziers, -totalAngle,\r\n          center);\r\n        map.draw_these_nodes(updated.node_ids);\r\n        map.draw_these_reactions(updated.reaction_ids);\r\n      };\r\n      const redoFn = (d: any, totalAngle: number, center: Coord) => {\r\n        // redo\r\n        const theseNodes: { [key: string]: MapNode } = {};\r\n        selectedNodeIds.forEach((id) => {\r\n          theseNodes[id] = nodes[id];\r\n        });\r\n        const updated = build.rotateNodes(theseNodes, reactions,\r\n          beziers, totalAngle,\r\n          center);\r\n        map.draw_these_nodes(updated.node_ids);\r\n        map.draw_these_reactions(updated.reaction_ids);\r\n      };\r\n      const centerFn = () => this.center;\r\n      this.rotationDrag = this.getGenericAngularDrag(startFn, dragFn,\r\n        endFn, undoFn,\r\n        redoFn, centerFn,\r\n        this.map.sel);\r\n      selectionBackground.call(this.rotationDrag);\r\n      this.selectableDrag = this.rotationDrag;\r\n    } else {\r\n      // turn off all listeners\r\n      this.hideCenter();\r\n      selectionNode.on('mousedown.center', null);\r\n      selectionBackground.on('mousedown.center', null);\r\n      selectionBackground.on('mousedown.drag', null);\r\n      selectionBackground.on('touchstart.drag', null);\r\n      this.rotationDrag = null;\r\n      this.selectableDrag = null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * With no argument, toggle the node click on or off. Pass in a boolean argument\r\n   * to set the on/off state.\r\n   */\r\n  toggleSelectableClick(onOff: boolean | undefined) {\r\n    if (onOff === undefined)\r\n      onOff = this.selectableMousedown == null;\r\n\r\n    if (onOff) {\r\n      const map = this.map;\r\n      this.selectableMousedown = (_: any) => {\r\n        // stop propogation for the buildinput to work right\r\n        getD3Event().stopPropagation();\r\n        // this.parentNode.__data__.wasSelected = d3Select(this.parentNode).classed('selected')\r\n        // d3Select(this.parentNode).classed('selected', true)\r\n      };\r\n      this.selectableClick = function(d: any) {\r\n        // stop propogation for the buildinput to work right\r\n        getD3Event().stopPropagation();\r\n        // click suppressed. This DOES have en effect.\r\n        if (getD3Event().defaultPrevented) return;\r\n        // turn off the temporary selection so select_selectable\r\n        // works. This is a bit of a hack.\r\n        // if (!this.parentNode.__data__.wasSelected)\r\n        //     d3Select(this.parentNode).classed('selected', false)\r\n        // @ts-ignore\r\n        map.select_selectable(this, d, getD3Event().shiftKey);\r\n        // this.parentNode.__data__.wasSelected = false\r\n      };\r\n      this.nodeMouseover = function(d: any) {\r\n        // @ts-ignore\r\n        d3Select(this).style('stroke-width', null);\r\n        // @ts-ignore\r\n        const current = parseFloat(d3Select(this).style('stroke-width'));\r\n        if (!d3Select(this.parentNode).classed('selected'))\r\n          // @ts-ignore\r\n          d3Select(this).style('stroke-width', current * 3 + 'px');\r\n      };\r\n      this.nodeMouseout = function(d: any) {\r\n        // @ts-ignore\r\n        d3Select(this).style('stroke-width', null);\r\n      };\r\n    } else {\r\n      this.selectableMousedown = null;\r\n      this.selectableClick = null;\r\n      this.nodeMouseover = null;\r\n      this.nodeMouseout = null;\r\n      this.map.sel.select('#nodes')\r\n        .selectAll('.node-circle').style('stroke-width', null);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * With no argument, toggle the text edit on mousedown on/off. Pass in a boolean\r\n   * argument to set the on/off state. The backup state is equal to\r\n   * selectableMousedown.\r\n   */\r\n  toggleTextLabelEdit(onOff: boolean | undefined) {\r\n    if (onOff === undefined)\r\n      onOff = this.textEditMousedown == null;\r\n\r\n    if (onOff) {\r\n      const map = this.map;\r\n      this.textLabelMousedown = function() {\r\n        if (getD3Event().defaultPrevented)\r\n          return; // mousedown suppressed\r\n\r\n        // run the callback\r\n        // @ts-ignore\r\n        const coordsA = utils.d3_transform_catch(d3Select(this).attr('transform')).translate;\r\n        const coords = {x: coordsA[0], y: coordsA[1]};\r\n        // @ts-ignore\r\n        map.callback_manager.run('edit_text_label', null, d3Select(this), coords);\r\n        getD3Event().stopPropagation();\r\n      };\r\n      this.textLabelClick = null;\r\n      this.map.sel.select('#text-labels')\r\n        .selectAll('.label')\r\n        .style('cursor', 'text');\r\n      // add the new-label listener\r\n      this.map.sel.on('mousedown.new_text_label', function(node: any) {\r\n        // silence other listeners\r\n        getD3Event().preventDefault();\r\n        const coords = {\r\n          x: d3Mouse(node)[0],\r\n          y: d3Mouse(node)[1]\r\n        };\r\n        // @ts-ignore\r\n        this.map.callback_manager.run('new_text_label', null, coords);\r\n      }.bind(this, this.map.sel.node()));\r\n    } else {\r\n      this.textLabelMousedown = this.selectableMousedown;\r\n      this.textLabelClick = this.selectableClick;\r\n      this.map.sel.select('#text-labels')\r\n        .selectAll('.label')\r\n        .style('cursor', null);\r\n      // remove the new-label listener\r\n      this.map.sel.on('mousedown.new_text_label', null);\r\n      this.map.callback_manager.run('hide_text_label_editor');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * With no argument, toggle the node drag & bezier drag on or off. Pass in a\r\n   * boolean argument to set the on/off state.\r\n   */\r\n  toggleSelectableDrag(onOff: boolean | undefined) {\r\n    if (onOff === undefined)\r\n      onOff = this.selectableDrag === this.emptyBehavior;\r\n\r\n    if (onOff) {\r\n      this.selectableDrag = this.getSelectableDrag(this.map, this.undoStack);\r\n      this.bezierDrag = this.getBezierDrag(this.map);\r\n    } else {\r\n      this.selectableDrag = this.emptyBehavior;\r\n      this.bezierDrag = this.emptyBehavior;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * With no argument, toggle the label drag on or off. Pass in a boolean argument\r\n   * to set the on/off state.\r\n   * @param {Boolean} onOff - The new on/off state.\r\n   */\r\n  toggleLabelDrag(onOff: boolean | undefined) {\r\n    if (onOff === undefined)\r\n      onOff = this.labelDrag === this.emptyBehavior;\r\n\r\n    if (onOff) {\r\n      this.reactionLabelDrag = this.getReactionLabelDrag(this.map);\r\n      this.nodeLabelDrag = this.getNodeLabelDrag(this.map);\r\n    } else {\r\n      this.reactionLabelDrag = this.emptyBehavior;\r\n      this.nodeLabelDrag = this.emptyBehavior;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * With no argument, toggle the tooltips on mouseover labels.\r\n   * @param {Boolean} onOff - The new on/off state.\r\n   */\r\n  toggleLabelMouseover(onOff: boolean | undefined) {\r\n    if (onOff === undefined)\r\n      onOff = this.nodeLabelMouseover == null;\r\n\r\n\r\n    if (onOff) {\r\n      // Show/hide tooltip.\r\n      // @param {String} type - 'reactionLabel' or 'nodeLabel'\r\n      // @param {Object} d - D3 data for DOM element\r\n      const getMouseover = (type: string) => (d: any) => {\r\n        if (!this.dragging)\r\n          this.map.callback_manager.run('show_tooltip', null, type, d);\r\n      };\r\n      const mouseout = () => {\r\n        this.map.callback_manager.run('delay_hide_tooltip');\r\n      };\r\n      this.nodeLabelMouseover = getMouseover('node_label');\r\n      this.nodeLabelTouch = getMouseover('node_label');\r\n      this.nodeLabelMouseout = mouseout;\r\n      this.reactionLabelMouseover = getMouseover('reaction_label');\r\n      this.reactionLabelTouch = getMouseover('reaction_label');\r\n      this.reactionLabelMouseout = mouseout;\r\n      this.geneLabelMouseover = getMouseover('gene_label');\r\n      this.geneLabelTouch = getMouseover('gene_label');\r\n      this.geneLabelMouseout = mouseout;\r\n    } else {\r\n      this.nodeLabelMouseover = null;\r\n      this.nodeLabelTouch = null;\r\n      this.nodeLabelMouseout = null;\r\n      this.reactionLabelMouseover = null;\r\n      this.reactionLabelTouch = null;\r\n      this.reactionLabelMouseout = null;\r\n      this.geneLabelMouseover = null;\r\n      this.geneLabelTouch = null;\r\n      this.geneLabelMouseout = null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * With no argument, toggle the tooltips on mouseover of nodes or arrows.\r\n   * @param {Boolean} onOff - The new on/off state.\r\n   */\r\n  toggleObjectMouseover(onOff: boolean | undefined) {\r\n    if (onOff === undefined)\r\n      onOff = this.nodeObjectMouseover == null;\r\n\r\n\r\n    if (onOff) {\r\n      // Show/hide tooltip.\r\n      // @param {String} type - 'reaction_object' or 'node_object'\r\n      // @param {Object} d - D3 data for DOM element\r\n      const getMouseover = (type: string) => {\r\n        const behavior = this;\r\n        return function(d: any) {\r\n          if (!behavior.dragging) {\r\n            if (type === 'reaction_object') {\r\n              // @ts-ignore\r\n              // eslint-disable-next-line no-invalid-this\r\n              const mouseEvent = d3Mouse(this);\r\n              // Add the current mouse position to the segment's datum\r\n              const newD = Object.assign(\r\n                {}, d, {xPos: mouseEvent[0], yPos: mouseEvent[1]}\r\n              );\r\n              behavior.map.callback_manager.run('show_tooltip', null, type, newD);\r\n            } else\r\n              behavior.map.callback_manager.run('show_tooltip', null, type, d);\r\n          }\r\n        };\r\n      };\r\n      const mouseout = () => {\r\n        this.map.callback_manager.run('delay_hide_tooltip');\r\n      };\r\n      this.nodeObjectMouseover = getMouseover('node_object');\r\n      this.nodeObjectMouseout = mouseout;\r\n      this.reactionObjectMouseover = getMouseover('reaction_object');\r\n      this.reactionObjectMouseout = mouseout;\r\n    } else {\r\n      this.nodeObjectMouseover = null;\r\n      this.nodeObjectMouseout = null;\r\n      this.reactionObjectMouseover = null;\r\n      this.reactionObjectMouseout = null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * With no argument, toggle the tooltips upon touching of nodes or arrows.\r\n   * @param {Boolean} onOff - The new on/off state. If this argument is not provided, then toggle the state.\r\n   */\r\n  toggleObjectTouch(onOff: boolean | undefined) {\r\n    if (onOff === undefined)\r\n      onOff = this.labelTouch == null;\r\n\r\n\r\n    if (onOff) {\r\n      this.objectTouch = (type: string, d: any) => {\r\n        if (!this.dragging)\r\n          this.map.callback_manager.run('show_tooltip', null, type, d);\r\n      };\r\n    } else\r\n      this.objectTouch = null;\r\n  }\r\n\r\n  /**\r\n   * With no argument, toggle the bezier drag on or off. Pass in a boolean\r\n   * argument to set the on/off state.\r\n   */\r\n  toggleBezierDrag(onOff: boolean | undefined) {\r\n    if (onOff === undefined)\r\n      onOff = this.bezierDrag === this.emptyBehavior;\r\n\r\n    if (onOff) {\r\n      this.bezierDrag = this.getBezierDrag(this.map);\r\n      this.bezierMouseover = function(d: any) {\r\n        // @ts-ignore\r\n        d3Select(this).style('stroke-width', '3px');\r\n      };\r\n      this.bezierMouseout = function(d: any) {\r\n        // @ts-ignore\r\n        d3Select(this).style('stroke-width', '1px');\r\n      };\r\n    } else {\r\n      this.bezierDrag = this.emptyBehavior;\r\n      this.bezierMouseover = null;\r\n      this.bezierMouseout = null;\r\n    }\r\n  }\r\n\r\n  turnOffDrag(sel: D3Selection) {\r\n    sel.on('mousedown.drag', null);\r\n    sel.on('touchstart.drag', null);\r\n  }\r\n\r\n  combineNodesAndDraw(fixedNodeId: string, draggedNodeId: string) {\r\n    const map = this.map;\r\n    const draggedNode = map.nodes[draggedNodeId];\r\n    const fixedNode = map.nodes[fixedNodeId];\r\n    const updatedSegmentObjs: MapSegment[] = [];\r\n    draggedNode.connected_segments.forEach((segmentObj) => {\r\n      // change the segments to reflect\r\n      let segment = null;\r\n      try {\r\n        segment = map.reactions[segmentObj.reaction_id].segments[segmentObj.segment_id];\r\n        if (segment === undefined) throw new Error('undefined segment');\r\n      } catch (e) {\r\n        console.warn('Could not find connected segment ' + segmentObj.segment_id);\r\n        return;\r\n      }\r\n      if (segment.from_node_id === draggedNodeId) segment.from_node_id = fixedNodeId;\r\n      else if (segment.to_node_id === draggedNodeId) segment.to_node_id = fixedNodeId;\r\n      else {\r\n        console.error('Segment does not connect to dragged node');\r\n        return;\r\n      }\r\n      // moved segmentObj to fixedNode\r\n      fixedNode.connected_segments.push(segmentObj);\r\n      updatedSegmentObjs.push(utils.clone(segmentObj) as MapSegment);\r\n    });\r\n    // delete the old node\r\n    map.delete_node_data([draggedNodeId]);\r\n    // turn off the class\r\n    map.sel.selectAll('.node-to-combine').classed('node-to-combine', false);\r\n    // draw\r\n    map.draw_everything();\r\n    // return for undo\r\n    return updatedSegmentObjs;\r\n  }\r\n\r\n  /**\r\n   * Drag the selected nodes and text labels.\r\n   * @param {} map -\r\n   * @param {} undo_stack -\r\n   */\r\n  getSelectableDrag(map: EscherMap, undoStack: UndoStack) {\r\n    // define some variables\r\n    const behavior = d3Drag();\r\n    let theTimeout: any = null;\r\n    let totalDisplacement: Coord | null = null;\r\n    // for nodes\r\n    let nodeIdsToDrag: string[] | null = null;\r\n    let reactionIds: string[] | null = null;\r\n    // for text labels\r\n    let textLabelIdsToDrag: string[] | null = null;\r\n    const moveLabel = (textLabelId: string, displacement: Coord) => {\r\n      const textLabel = map.text_labels[textLabelId];\r\n      textLabel.x = textLabel.x + displacement.x;\r\n      textLabel.y = textLabel.y + displacement.y;\r\n    };\r\n    const setDragging = (onOff: boolean) => {\r\n      this.dragging = onOff;\r\n    };\r\n\r\n    behavior.on('start', function(d) {\r\n      setDragging(true);\r\n\r\n      // silence other listeners (e.g. nodes BELOW this one)\r\n      getD3Event().sourceEvent.stopPropagation();\r\n      // remember the total displacement for later\r\n      totalDisplacement = {x: 0, y: 0};\r\n\r\n      // If a text label is selected, the rest is not necessary\r\n      // @ts-ignore\r\n      // eslint-disable-next-line no-invalid-this\r\n      if (d3Select(this).attr('class').indexOf('label') === -1) {\r\n        // Note that drag start is called even for a click event\r\n        // @ts-ignore\r\n        const data = this.parentNode.__data__;\r\n        const biggId = data.bigg_id;\r\n        const nodeGroup = this.parentNode!;\r\n        // Move element to back (for the next step to work). Wait 200ms\r\n        // before making the move, becuase otherwise the element will be\r\n        // deleted before the click event gets called, and selection\r\n        // will stop working.\r\n        theTimeout = setTimeout(() => {\r\n          nodeGroup.parentNode!.insertBefore(nodeGroup, nodeGroup.parentNode!.firstChild);\r\n        }, 200);\r\n        // prepare to combine metabolites\r\n        map.sel.selectAll('.metabolite-circle')\r\n          .on('mouseover.combine', function(d) {\r\n            if (d.bigg_id === biggId && d.node_id !== data.node_id)\r\n              d3Select(this).classed('node-to-combine', true);\r\n          })\r\n          .on('mouseout.combine', (d) => {\r\n            if (d.bigg_id === biggId)\r\n              map.sel.selectAll('.node-to-combine').classed('node-to-combine', false);\r\n          });\r\n      }\r\n    });\r\n\r\n    behavior.on('drag', function(d) {\r\n      // if this node is not already selected, then select this one and\r\n      // deselect all other nodes. Otherwise, leave the selection alone.\r\n      // @ts-ignore\r\n      if (!d3Select(this.parentNode!).classed('selected'))\r\n        map.select_selectable(this, d);\r\n\r\n\r\n      // get the grabbed id\r\n      const grabbed: { type: string, id: string } = {type: '', id: ''};\r\n      if (d3Select(this).attr('class').indexOf('label') === -1) {\r\n        // if it is a node\r\n        grabbed['type'] = 'node';\r\n        // @ts-ignore\r\n        grabbed['id'] = this.parentNode!.__data__!.node_id;\r\n      } else {\r\n        // if it is a text label\r\n        grabbed['type'] = 'label';\r\n        // @ts-ignore\r\n        grabbed['id'] = this.__data__.text_label_id;\r\n      }\r\n\r\n      const selectedNodeIds = map.get_selected_node_ids();\r\n      const selectedTextLabelIds = map.get_selected_text_label_ids();\r\n      nodeIdsToDrag = [];\r\n      textLabelIdsToDrag = [];\r\n      // choose the nodes and text labels to drag\r\n      if (grabbed['type'] === 'node' &&\r\n          selectedNodeIds.indexOf(grabbed['id']) === -1)\r\n        nodeIdsToDrag.push(grabbed['id']);\r\n      else if (grabbed['type'] === 'label' &&\r\n                 selectedTextLabelIds.indexOf(grabbed['id']) === -1)\r\n        textLabelIdsToDrag.push(grabbed['id']);\r\n      else {\r\n        nodeIdsToDrag = selectedNodeIds;\r\n        textLabelIdsToDrag = selectedTextLabelIds;\r\n      }\r\n      reactionIds = [];\r\n      const displacement = {\r\n        x: getD3Event().dx,\r\n        y: getD3Event().dy\r\n      };\r\n      totalDisplacement = utils.c_plus_c(totalDisplacement, displacement);\r\n      nodeIdsToDrag.forEach((nodeId) => {\r\n        // update data\r\n        const node = map.nodes[nodeId];\r\n        const updated = build.moveNodeAndDependents(node, nodeId, map.reactions,\r\n          map.beziers, displacement);\r\n        reactionIds = utils.uniqueConcat([reactionIds, updated.reaction_ids]);\r\n        // remember the displacements\r\n        // if (!(nodeId in totalDisplacement))  totalDisplacement[nodeId] = { x: 0, y: 0 }\r\n        // totalDisplacement[nodeId] = utils.c_plus_c(totalDisplacement[nodeId], displacement)\r\n      });\r\n      textLabelIdsToDrag.forEach((textLabelId) => {\r\n        moveLabel(textLabelId, displacement);\r\n        // remember the displacements\r\n        // if (!(nodeId in totalDisplacement))  totalDisplacement[nodeId] = { x: 0, y: 0 }\r\n        // totalDisplacement[nodeId] = utils.c_plus_c(totalDisplacement[nodeId], displacement)\r\n      });\r\n      // draw\r\n      map.draw_these_nodes(nodeIdsToDrag);\r\n      map.draw_these_reactions(reactionIds);\r\n      map.draw_these_text_labels(textLabelIdsToDrag);\r\n    });\r\n\r\n    const combineNodesAndDraw = this.combineNodesAndDraw.bind(this);\r\n    behavior.on('end', function() {\r\n      setDragging(false);\r\n\r\n      if (nodeIdsToDrag == null) {\r\n        // Drag end can be called when drag has not been called. In this, case, do\r\n        // nothing.\r\n        totalDisplacement = null;\r\n        nodeIdsToDrag = null;\r\n        textLabelIdsToDrag = null;\r\n        reactionIds = null;\r\n        theTimeout = null;\r\n        return;\r\n      }\r\n\r\n      // look for mets to combine\r\n      const nodeToCombineArray: string[] = [];\r\n      map.sel.selectAll('.node-to-combine').each((d: any) => {\r\n        nodeToCombineArray.push(d.node_id);\r\n      });\r\n\r\n      if (nodeToCombineArray.length === 1) {\r\n        // If a node is ready for it, combine nodes\r\n        const fixedNodeId = nodeToCombineArray[0];\r\n        // @ts-ignore\r\n        const draggedNodeId = this.parentNode!.__data__!.node_id;\r\n        const savedDraggedNode = utils.clone(map.nodes[draggedNodeId]);\r\n        const segmentObjsMovedToCombine = combineNodesAndDraw(fixedNodeId,\r\n          draggedNodeId);\r\n        const savedDisplacement = utils.clone(totalDisplacement!) as Coord;\r\n        undoStack.push(() => {\r\n          // undo\r\n          // put the old node back\r\n          map.nodes[draggedNodeId] = savedDraggedNode;\r\n          const fixedNode = map.nodes[fixedNodeId];\r\n          const updatedReactions: string[] = [];\r\n          segmentObjsMovedToCombine.forEach((segmentObj) => {\r\n            const segment = map.reactions[segmentObj.reaction_id!].segments[segmentObj.segment_id!];\r\n            if (segment.from_node_id === fixedNodeId)\r\n              segment.from_node_id = draggedNodeId;\r\n            else if (segment.to_node_id === fixedNodeId)\r\n              segment.to_node_id = draggedNodeId;\r\n            else\r\n              console.error('Segment does not connect to fixed node');\r\n\r\n            // removed this segmentObj from the fixed node\r\n            fixedNode.connected_segments = fixedNode.connected_segments.filter((x) => {\r\n              return !(x.reaction_id === segmentObj.reaction_id && x.segment_id === segmentObj.segment_id);\r\n            });\r\n            if (updatedReactions.indexOf(segmentObj.reaction_id!) === -1)\r\n              updatedReactions.push(segmentObj.reaction_id!);\r\n          });\r\n          // move the node back\r\n          build.moveNodeAndDependents(\r\n            savedDraggedNode,\r\n            draggedNodeId,\r\n            map.reactions,\r\n            map.beziers,\r\n            utils.c_times_scalar(savedDisplacement, -1)\r\n          );\r\n          map.draw_these_nodes([draggedNodeId]);\r\n          map.draw_these_reactions(updatedReactions);\r\n        }, () => {\r\n          // redo\r\n          // move node before combining for reliable undo/redo looping\r\n          build.moveNodeAndDependents(\r\n            savedDraggedNode,\r\n            draggedNodeId,\r\n            map.reactions,\r\n            map.beziers,\r\n            utils.c_times_scalar(savedDisplacement, 1)\r\n          );\r\n          combineNodesAndDraw(fixedNodeId, draggedNodeId);\r\n        });\r\n      } else {\r\n        // otherwise, drag node\r\n\r\n        // add to undo/redo stack\r\n        // remember the displacement, dragged nodes, and reactions\r\n        const savedDisplacement = utils.clone(totalDisplacement!) as Coord;\r\n        // BUG TODO this variable disappears!\r\n        // Happens sometimes when you drag a node, then delete it, then undo twice\r\n        const savedNodeIds = utils.clone(nodeIdsToDrag!) as string[];\r\n        const savedTextLabelIds = utils.clone(textLabelIdsToDrag!) as string[];\r\n        const savedReactionIds = utils.clone(reactionIds!) as string[];\r\n        undoStack.push(() => {\r\n          // undo\r\n          savedNodeIds.forEach((nodeId: string) => {\r\n            const node = map.nodes[nodeId];\r\n            build.moveNodeAndDependents(\r\n              node,\r\n              nodeId,\r\n              map.reactions,\r\n              map.beziers,\r\n              utils.c_times_scalar(savedDisplacement, -1)\r\n            );\r\n          });\r\n          savedTextLabelIds.forEach((textLabelId: string) => {\r\n            moveLabel(textLabelId,\r\n              utils.c_times_scalar(savedDisplacement, -1));\r\n          });\r\n          map.draw_these_nodes(savedNodeIds);\r\n          map.draw_these_reactions(savedReactionIds);\r\n          map.draw_these_text_labels(savedTextLabelIds);\r\n        }, () => {\r\n          // redo\r\n          savedNodeIds.forEach((nodeId: string) => {\r\n            const node = map.nodes[nodeId];\r\n            build.moveNodeAndDependents(node, nodeId, map.reactions,\r\n              map.beziers,\r\n              savedDisplacement);\r\n          });\r\n          savedTextLabelIds.forEach((textLabelId: string) => {\r\n            moveLabel(textLabelId, savedDisplacement);\r\n          });\r\n          map.draw_these_nodes(savedNodeIds);\r\n          map.draw_these_reactions(savedReactionIds);\r\n          map.draw_these_text_labels(savedTextLabelIds);\r\n        });\r\n      }\r\n\r\n      // stop combining metabolites\r\n      map.sel.selectAll('.metabolite-circle')\r\n        .on('mouseover.combine', null)\r\n        .on('mouseout.combine', null);\r\n\r\n      // clear the timeout\r\n      clearTimeout(theTimeout);\r\n\r\n      // clear the shared variables\r\n      totalDisplacement = null;\r\n      nodeIdsToDrag = null;\r\n      textLabelIdsToDrag = null;\r\n      reactionIds = null;\r\n      theTimeout = null;\r\n    });\r\n\r\n    return behavior;\r\n  }\r\n\r\n  getBezierDrag(map: EscherMap) {\r\n    const moveBezier = (reactionId: string, segmentId: string, bez: string, bezierId: string, displacement: Coord) => {\r\n      const segment = map.reactions[reactionId].segments[segmentId];\r\n      (segment[bez as keyof MapSegment] as Coord) = utils.c_plus_c(segment[bez as keyof MapSegment] as Coord, displacement);\r\n      map.beziers[bezierId].x = (segment[bez as keyof MapSegment] as Coord).x;\r\n      map.beziers[bezierId].y = (segment[bez as keyof MapSegment] as Coord).y;\r\n    };\r\n    const startFn = (d: any) => {\r\n      d.dragging = true;\r\n    };\r\n    const dragFn = (d: any, displacement: Coord, totalDisplacement: Coord) => {\r\n      // draw\r\n      moveBezier(d.reaction_id, d.segment_id, d.bezier, d.bezier_id,\r\n        displacement);\r\n      map.draw_these_reactions([d.reaction_id], false);\r\n      map.draw_these_beziers([d.bezier_id]);\r\n    };\r\n    const endFn = (d: any) => {\r\n      d.dragging = false;\r\n    };\r\n    const undoFn = (d: any, displacement: Coord) => {\r\n      moveBezier(d.reaction_id, d.segment_id, d.bezier, d.bezier_id,\r\n        utils.c_times_scalar(displacement, -1));\r\n      map.draw_these_reactions([d.reaction_id], false);\r\n      map.draw_these_beziers([d.bezier_id]);\r\n    };\r\n    const redoFn = (d: any, displacement: Coord) => {\r\n      moveBezier(d.reaction_id, d.segment_id, d.bezier, d.bezier_id,\r\n        displacement);\r\n      map.draw_these_reactions([d.reaction_id], false);\r\n      map.draw_these_beziers([d.bezier_id]);\r\n    };\r\n    return this.getGenericDrag(startFn, dragFn, endFn, undoFn, redoFn,\r\n      this.map.sel);\r\n  }\r\n\r\n  getReactionLabelDrag(map: EscherMap) {\r\n    const moveLabel = (reactionId: string, displacement: Coord) => {\r\n      const reaction = map.reactions[reactionId];\r\n      reaction.label_x = reaction.label_x + displacement.x;\r\n      reaction.label_y = reaction.label_y + displacement.y;\r\n    };\r\n    const startFn = (d: any) => {\r\n      // hide tooltips when drag starts\r\n      map.callback_manager.run('hide_tooltip');\r\n    };\r\n    const dragFn = (d: any, displacement: Coord, totalDisplacement: Coord) => {\r\n      // draw\r\n      moveLabel(d.reaction_id, displacement);\r\n      map.draw_these_reactions([d.reaction_id]);\r\n    };\r\n    const endFn = () => {};\r\n    const undoFn = (d: any, displacement: Coord) => {\r\n      moveLabel(d.reaction_id, utils.c_times_scalar(displacement, -1));\r\n      map.draw_these_reactions([d.reaction_id]);\r\n    };\r\n    const redoFn = (d: any, displacement: Coord) => {\r\n      moveLabel(d.reaction_id, displacement);\r\n      map.draw_these_reactions([d.reaction_id]);\r\n    };\r\n    return this.getGenericDrag(startFn, dragFn, endFn, undoFn, redoFn,\r\n      this.map.sel);\r\n  }\r\n\r\n  getNodeLabelDrag(map: EscherMap) {\r\n    const moveLabel = (nodeId: string, displacement: Coord) => {\r\n      const node = map.nodes[nodeId];\r\n      node.label_x = node.label_x + displacement.x;\r\n      node.label_y = node.label_y + displacement.y;\r\n    };\r\n    const startFn = (d: any) => {\r\n      // hide tooltips when drag starts\r\n      map.callback_manager.run('hide_tooltip');\r\n    };\r\n    const dragFn = (d: any, displacement: Coord, totalDisplacement: Coord) => {\r\n      // draw\r\n      moveLabel(d.node_id, displacement);\r\n      map.draw_these_nodes([d.node_id]);\r\n    };\r\n    const endFn = () => {};\r\n    const undoFn = (d: any, displacement: Coord) => {\r\n      moveLabel(d.node_id, utils.c_times_scalar(displacement, -1));\r\n      map.draw_these_nodes([d.node_id]);\r\n    };\r\n    const redoFn = (d: any, displacement: Coord) => {\r\n      moveLabel(d.node_id, displacement);\r\n      map.draw_these_nodes([d.node_id]);\r\n    };\r\n    return this.getGenericDrag(startFn, dragFn, endFn, undoFn, redoFn,\r\n      this.map.sel);\r\n  }\r\n\r\n  /**\r\n   * Make a generic drag behavior, with undo/redo.\r\n   *\r\n   * startFn: function (d) Called at drag start.\r\n   *\r\n   * dragFn: function (d, displacement, totalDisplacement) Called during drag.\r\n   *\r\n   * endFn\r\n   *\r\n   * undoFn\r\n   *\r\n   * redoFn\r\n   *\r\n   * relativeToSelection: a d3 selection that the locations are calculated\r\n   * against.\r\n   *\r\n   */\r\n  getGenericDrag(startFn: (d: any) => void, dragFn: (d: any, displacement: Coord, totalDisplacement: Coord, location: Coord) => void, endFn: (d: any) => void, undoFn: (d: any, displacement: Coord, location: Coord) => void, redoFn: (d: any, displacement: Coord, location: Coord) => void,\r\n    relativeToSelection: D3Selection) {\r\n    // define some variables\r\n    const behavior = d3Drag();\r\n    const undoStack = this.undoStack;\r\n    const rel = relativeToSelection.node();\r\n    let totalDisplacement: Coord | null = null;\r\n\r\n    behavior.on('start', (d) => {\r\n      this.dragging = true;\r\n\r\n      // silence other listeners\r\n      // @ts-ignore\r\n      getD3Event().sourceEvent.stopPropagation();\r\n      totalDisplacement = {x: 0, y: 0};\r\n      startFn(d);\r\n    });\r\n\r\n    behavior.on('drag', (d) => {\r\n      // update data\r\n      const displacement = {\r\n        // @ts-ignore\r\n        x: getD3Event().dx,\r\n        y: getD3Event().dy\r\n      };\r\n      const location: Coord = {\r\n        x: d3Mouse(rel)[0],\r\n        y: d3Mouse(rel)[1]\r\n      };\r\n\r\n      // remember the displacement\r\n      totalDisplacement = utils.c_plus_c(totalDisplacement, displacement);\r\n      dragFn(d, displacement, totalDisplacement!, location);\r\n    });\r\n\r\n    behavior.on('end', (d) => {\r\n      this.dragging = false;\r\n\r\n      // add to undo/redo stack\r\n      // remember the displacement, dragged nodes, and reactions\r\n      const savedD = utils.clone(d);\r\n      const savedDisplacement = utils.clone(totalDisplacement!) as Coord; // BUG TODO this variable disappears!\r\n      const savedLocation = {\r\n        x: d3Mouse(rel)[0],\r\n        y: d3Mouse(rel)[1]\r\n      };\r\n\r\n      undoStack.push(function() {\r\n        // undo\r\n        undoFn(savedD, savedDisplacement, savedLocation);\r\n      }, function() {\r\n        // redo\r\n        redoFn(savedD, savedDisplacement, savedLocation);\r\n      });\r\n      endFn(d);\r\n    });\r\n\r\n    return behavior;\r\n  }\r\n\r\n  /** Make a generic drag behavior, with undo/redo. Supplies angles in place of\r\n   * displacements.\r\n   *\r\n   * startFn: function (d) Called at drag start.\r\n   *\r\n   * dragFn: function (d, displacement, totalDisplacement) Called during drag.\r\n   *\r\n   * endFn:\r\n   *\r\n   * undoFn:\r\n   *\r\n   * redoFn:\r\n   *\r\n   * getCenter:\r\n   *\r\n   * relativeToSelection: a d3 selection that the locations are calculated\r\n   * against.\r\n   *\r\n   */\r\n  getGenericAngularDrag(startFn: (d: any) => void, dragFn: (d: any, angle: number, totalAngle: number, center: Coord) => void, endFn: (d: any) => void, undoFn: (d: any, angle: number, center: Coord) => void, redoFn: (d: any, angle: number, center: Coord) => void,\r\n    getCenter: () => Coord, relativeToSelection: D3Selection) {\r\n    // define some variables\r\n    const behavior = d3Drag();\r\n    const undoStack = this.undoStack;\r\n    const rel = relativeToSelection.node();\r\n    let totalAngle: number = 0;\r\n\r\n    behavior.on('start', (d) => {\r\n      this.dragging = true;\r\n\r\n      // silence other listeners\r\n      getD3Event().sourceEvent.stopPropagation();\r\n      totalAngle = 0;\r\n      startFn(d);\r\n    });\r\n\r\n    behavior.on('drag', (d) => {\r\n      // update data\r\n      const displacement = {\r\n        x: getD3Event().dx,\r\n        y: getD3Event().dy\r\n      };\r\n      const location = {\r\n        x: d3Mouse(rel)[0],\r\n        y: d3Mouse(rel)[1]\r\n      };\r\n      const center = getCenter();\r\n      const angle = utils.angle_for_event(displacement, location, center);\r\n      // remember the displacement\r\n      totalAngle = totalAngle + angle;\r\n      dragFn(d, angle, totalAngle, center);\r\n    });\r\n\r\n    behavior.on('end', (d) => {\r\n      this.dragging = false;\r\n\r\n      // add to undo/redo stack\r\n      // remember the displacement, dragged nodes, and reactions\r\n      const savedD = utils.clone(d);\r\n      const savedAngle = totalAngle;\r\n      const savedCenter = utils.clone(getCenter());\r\n\r\n      undoStack.push(\r\n        () => undoFn(savedD, savedAngle, savedCenter),\r\n        () => redoFn(savedD, savedAngle, savedCenter)\r\n      );\r\n\r\n      endFn(d);\r\n    });\r\n\r\n    return behavior;\r\n  }\r\n}\r\n","const scalePresets: { [key: string]: { type: string, value?: number, color: string, size: number }[] } = {\r\n  GaBuGeRd: [\r\n    {type: 'min', color: '#c8c8c8', size: 12},\r\n    {type: 'value', value: 0.01, color: '#9696ff', size: 16},\r\n    {type: 'value', value: 20, color: '#209123', size: 20},\r\n    {type: 'max', color: '#ff0000', size: 25}\r\n  ],\r\n  GaBuRd: [\r\n    {type: 'min', color: '#c8c8c8', size: 12},\r\n    {type: 'median', color: '#9696ff', size: 20},\r\n    {type: 'max', color: '#ff0000', size: 25}\r\n  ],\r\n  RdYlBu: [\r\n    {type: 'min', color: '#d7191c', size: 12},\r\n    {type: 'median', color: '#ffffbf', size: 20},\r\n    {type: 'max', color: '#2c7bb6', size: 25}\r\n  ],\r\n  GeGaRd: [\r\n    {type: 'min', color: '#209123', size: 25},\r\n    {type: 'value', value: 0, color: '#c8c8c8', size: 12},\r\n    {type: 'max', color: '#ff0000', size: 25}\r\n  ],\r\n  WhYlRd: [\r\n    {type: 'min', color: '#fffaf0', size: 20},\r\n    {type: 'median', color: '#f1c470', size: 30},\r\n    {type: 'max', color: '#800000', size: 40}\r\n  ]\r\n};\r\n\r\nexport default scalePresets;\r\n","export default function(a, b) {\n  return a < b ? -1 : a > b ? 1 : a >= b ? 0 : NaN;\n}\n","import ascending from \"./ascending\";\nimport bisector from \"./bisector\";\n\nvar ascendingBisect = bisector(ascending);\nexport var bisectRight = ascendingBisect.right;\nexport var bisectLeft = ascendingBisect.left;\nexport default bisectRight;\n","import ascending from \"./ascending\";\n\nexport default function(compare) {\n  if (compare.length === 1) compare = ascendingComparator(compare);\n  return {\n    left: function(a, x, lo, hi) {\n      if (lo == null) lo = 0;\n      if (hi == null) hi = a.length;\n      while (lo < hi) {\n        var mid = lo + hi >>> 1;\n        if (compare(a[mid], x) < 0) lo = mid + 1;\n        else hi = mid;\n      }\n      return lo;\n    },\n    right: function(a, x, lo, hi) {\n      if (lo == null) lo = 0;\n      if (hi == null) hi = a.length;\n      while (lo < hi) {\n        var mid = lo + hi >>> 1;\n        if (compare(a[mid], x) > 0) hi = mid;\n        else lo = mid + 1;\n      }\n      return lo;\n    }\n  };\n}\n\nfunction ascendingComparator(f) {\n  return function(d, x) {\n    return ascending(f(d), x);\n  };\n}\n","var array = Array.prototype;\n\nexport var slice = array.slice;\nexport var map = array.map;\n","var e10 = Math.sqrt(50),\n    e5 = Math.sqrt(10),\n    e2 = Math.sqrt(2);\n\nexport default function(start, stop, count) {\n  var reverse,\n      i = -1,\n      n,\n      ticks,\n      step;\n\n  stop = +stop, start = +start, count = +count;\n  if (start === stop && count > 0) return [start];\n  if (reverse = stop < start) n = start, start = stop, stop = n;\n  if ((step = tickIncrement(start, stop, count)) === 0 || !isFinite(step)) return [];\n\n  if (step > 0) {\n    start = Math.ceil(start / step);\n    stop = Math.floor(stop / step);\n    ticks = new Array(n = Math.ceil(stop - start + 1));\n    while (++i < n) ticks[i] = (start + i) * step;\n  } else {\n    start = Math.floor(start * step);\n    stop = Math.ceil(stop * step);\n    ticks = new Array(n = Math.ceil(start - stop + 1));\n    while (++i < n) ticks[i] = (start - i) / step;\n  }\n\n  if (reverse) ticks.reverse();\n\n  return ticks;\n}\n\nexport function tickIncrement(start, stop, count) {\n  var step = (stop - start) / Math.max(0, count),\n      power = Math.floor(Math.log(step) / Math.LN10),\n      error = step / Math.pow(10, power);\n  return power >= 0\n      ? (error >= e10 ? 10 : error >= e5 ? 5 : error >= e2 ? 2 : 1) * Math.pow(10, power)\n      : -Math.pow(10, -power) / (error >= e10 ? 10 : error >= e5 ? 5 : error >= e2 ? 2 : 1);\n}\n\nexport function tickStep(start, stop, count) {\n  var step0 = Math.abs(stop - start) / Math.max(0, count),\n      step1 = Math.pow(10, Math.floor(Math.log(step0) / Math.LN10)),\n      error = step0 / step1;\n  if (error >= e10) step1 *= 10;\n  else if (error >= e5) step1 *= 5;\n  else if (error >= e2) step1 *= 2;\n  return stop < start ? -step1 : step1;\n}\n","var array = Array.prototype;\n\nexport var map = array.map;\nexport var slice = array.slice;\n","import value from \"./value.js\";\nimport numberArray, {isNumberArray} from \"./numberArray.js\";\n\nexport default function(a, b) {\n  return (isNumberArray(b) ? numberArray : genericArray)(a, b);\n}\n\nexport function genericArray(a, b) {\n  var nb = b ? b.length : 0,\n      na = a ? Math.min(nb, a.length) : 0,\n      x = new Array(na),\n      c = new Array(nb),\n      i;\n\n  for (i = 0; i < na; ++i) x[i] = value(a[i], b[i]);\n  for (; i < nb; ++i) c[i] = b[i];\n\n  return function(t) {\n    for (i = 0; i < na; ++i) c[i] = x[i](t);\n    return c;\n  };\n}\n","export default function(a, b) {\n  var d = new Date;\n  return a = +a, b = +b, function(t) {\n    return d.setTime(a * (1 - t) + b * t), d;\n  };\n}\n","import value from \"./value.js\";\n\nexport default function(a, b) {\n  var i = {},\n      c = {},\n      k;\n\n  if (a === null || typeof a !== \"object\") a = {};\n  if (b === null || typeof b !== \"object\") b = {};\n\n  for (k in b) {\n    if (k in a) {\n      i[k] = value(a[k], b[k]);\n    } else {\n      c[k] = b[k];\n    }\n  }\n\n  return function(t) {\n    for (k in i) c[k] = i[k](t);\n    return c;\n  };\n}\n","export default function(a, b) {\n  if (!b) b = [];\n  var n = a ? Math.min(b.length, a.length) : 0,\n      c = b.slice(),\n      i;\n  return function(t) {\n    for (i = 0; i < n; ++i) c[i] = a[i] * (1 - t) + b[i] * t;\n    return c;\n  };\n}\n\nexport function isNumberArray(x) {\n  return ArrayBuffer.isView(x) && !(x instanceof DataView);\n}\n","import {color} from \"d3-color\";\nimport rgb from \"./rgb.js\";\nimport {genericArray} from \"./array.js\";\nimport date from \"./date.js\";\nimport number from \"./number.js\";\nimport object from \"./object.js\";\nimport string from \"./string.js\";\nimport constant from \"./constant.js\";\nimport numberArray, {isNumberArray} from \"./numberArray.js\";\n\nexport default function(a, b) {\n  var t = typeof b, c;\n  return b == null || t === \"boolean\" ? constant(b)\n      : (t === \"number\" ? number\n      : t === \"string\" ? ((c = color(b)) ? (b = c, rgb) : string)\n      : b instanceof color ? rgb\n      : b instanceof Date ? date\n      : isNumberArray(b) ? numberArray\n      : Array.isArray(b) ? genericArray\n      : typeof b.valueOf !== \"function\" && typeof b.toString !== \"function\" || isNaN(b) ? object\n      : number)(a, b);\n}\n","export default function(a, b) {\n  return a = +a, b = +b, function(t) {\n    return Math.round(a * (1 - t) + b * t);\n  };\n}\n","export default function(x) {\n  return +x;\n}\n","import {bisect} from \"d3-array\";\nimport {interpolate as interpolateValue, interpolateRound} from \"d3-interpolate\";\nimport {map, slice} from \"./array\";\nimport constant from \"./constant\";\nimport number from \"./number\";\n\nvar unit = [0, 1];\n\nexport function deinterpolateLinear(a, b) {\n  return (b -= (a = +a))\n      ? function(x) { return (x - a) / b; }\n      : constant(b);\n}\n\nfunction deinterpolateClamp(deinterpolate) {\n  return function(a, b) {\n    var d = deinterpolate(a = +a, b = +b);\n    return function(x) { return x <= a ? 0 : x >= b ? 1 : d(x); };\n  };\n}\n\nfunction reinterpolateClamp(reinterpolate) {\n  return function(a, b) {\n    var r = reinterpolate(a = +a, b = +b);\n    return function(t) { return t <= 0 ? a : t >= 1 ? b : r(t); };\n  };\n}\n\nfunction bimap(domain, range, deinterpolate, reinterpolate) {\n  var d0 = domain[0], d1 = domain[1], r0 = range[0], r1 = range[1];\n  if (d1 < d0) d0 = deinterpolate(d1, d0), r0 = reinterpolate(r1, r0);\n  else d0 = deinterpolate(d0, d1), r0 = reinterpolate(r0, r1);\n  return function(x) { return r0(d0(x)); };\n}\n\nfunction polymap(domain, range, deinterpolate, reinterpolate) {\n  var j = Math.min(domain.length, range.length) - 1,\n      d = new Array(j),\n      r = new Array(j),\n      i = -1;\n\n  // Reverse descending domains.\n  if (domain[j] < domain[0]) {\n    domain = domain.slice().reverse();\n    range = range.slice().reverse();\n  }\n\n  while (++i < j) {\n    d[i] = deinterpolate(domain[i], domain[i + 1]);\n    r[i] = reinterpolate(range[i], range[i + 1]);\n  }\n\n  return function(x) {\n    var i = bisect(domain, x, 1, j) - 1;\n    return r[i](d[i](x));\n  };\n}\n\nexport function copy(source, target) {\n  return target\n      .domain(source.domain())\n      .range(source.range())\n      .interpolate(source.interpolate())\n      .clamp(source.clamp());\n}\n\n// deinterpolate(a, b)(x) takes a domain value x in [a,b] and returns the corresponding parameter t in [0,1].\n// reinterpolate(a, b)(t) takes a parameter t in [0,1] and returns the corresponding domain value x in [a,b].\nexport default function continuous(deinterpolate, reinterpolate) {\n  var domain = unit,\n      range = unit,\n      interpolate = interpolateValue,\n      clamp = false,\n      piecewise,\n      output,\n      input;\n\n  function rescale() {\n    piecewise = Math.min(domain.length, range.length) > 2 ? polymap : bimap;\n    output = input = null;\n    return scale;\n  }\n\n  function scale(x) {\n    return (output || (output = piecewise(domain, range, clamp ? deinterpolateClamp(deinterpolate) : deinterpolate, interpolate)))(+x);\n  }\n\n  scale.invert = function(y) {\n    return (input || (input = piecewise(range, domain, deinterpolateLinear, clamp ? reinterpolateClamp(reinterpolate) : reinterpolate)))(+y);\n  };\n\n  scale.domain = function(_) {\n    return arguments.length ? (domain = map.call(_, number), rescale()) : domain.slice();\n  };\n\n  scale.range = function(_) {\n    return arguments.length ? (range = slice.call(_), rescale()) : range.slice();\n  };\n\n  scale.rangeRound = function(_) {\n    return range = slice.call(_), interpolate = interpolateRound, rescale();\n  };\n\n  scale.clamp = function(_) {\n    return arguments.length ? (clamp = !!_, rescale()) : clamp;\n  };\n\n  scale.interpolate = function(_) {\n    return arguments.length ? (interpolate = _, rescale()) : interpolate;\n  };\n\n  return rescale();\n}\n","export default function(x) {\n  return function() {\n    return x;\n  };\n}\n","import {ticks, tickIncrement} from \"d3-array\";\nimport {interpolateNumber as reinterpolate} from \"d3-interpolate\";\nimport {default as continuous, copy, deinterpolateLinear as deinterpolate} from \"./continuous\";\nimport tickFormat from \"./tickFormat\";\n\nexport function linearish(scale) {\n  var domain = scale.domain;\n\n  scale.ticks = function(count) {\n    var d = domain();\n    return ticks(d[0], d[d.length - 1], count == null ? 10 : count);\n  };\n\n  scale.tickFormat = function(count, specifier) {\n    return tickFormat(domain(), count, specifier);\n  };\n\n  scale.nice = function(count) {\n    if (count == null) count = 10;\n\n    var d = domain(),\n        i0 = 0,\n        i1 = d.length - 1,\n        start = d[i0],\n        stop = d[i1],\n        step;\n\n    if (stop < start) {\n      step = start, start = stop, stop = step;\n      step = i0, i0 = i1, i1 = step;\n    }\n\n    step = tickIncrement(start, stop, count);\n\n    if (step > 0) {\n      start = Math.floor(start / step) * step;\n      stop = Math.ceil(stop / step) * step;\n      step = tickIncrement(start, stop, count);\n    } else if (step < 0) {\n      start = Math.ceil(start * step) / step;\n      stop = Math.floor(stop * step) / step;\n      step = tickIncrement(start, stop, count);\n    }\n\n    if (step > 0) {\n      d[i0] = Math.floor(start / step) * step;\n      d[i1] = Math.ceil(stop / step) * step;\n      domain(d);\n    } else if (step < 0) {\n      d[i0] = Math.ceil(start * step) / step;\n      d[i1] = Math.floor(stop * step) / step;\n      domain(d);\n    }\n\n    return scale;\n  };\n\n  return scale;\n}\n\nexport default function linear() {\n  var scale = continuous(deinterpolate, reinterpolate);\n\n  scale.copy = function() {\n    return copy(scale, linear());\n  };\n\n  return linearish(scale);\n}\n","import {tickStep} from \"d3-array\";\nimport {format, formatPrefix, formatSpecifier, precisionFixed, precisionPrefix, precisionRound} from \"d3-format\";\n\nexport default function(domain, count, specifier) {\n  var start = domain[0],\n      stop = domain[domain.length - 1],\n      step = tickStep(start, stop, count == null ? 10 : count),\n      precision;\n  specifier = formatSpecifier(specifier == null ? \",f\" : specifier);\n  switch (specifier.type) {\n    case \"s\": {\n      var value = Math.max(Math.abs(start), Math.abs(stop));\n      if (specifier.precision == null && !isNaN(precision = precisionPrefix(step, value))) specifier.precision = precision;\n      return formatPrefix(specifier, value);\n    }\n    case \"\":\n    case \"e\":\n    case \"g\":\n    case \"p\":\n    case \"r\": {\n      if (specifier.precision == null && !isNaN(precision = precisionRound(step, Math.max(Math.abs(start), Math.abs(stop))))) specifier.precision = precision - (specifier.type === \"e\");\n      break;\n    }\n    case \"f\":\n    case \"%\": {\n      if (specifier.precision == null && !isNaN(precision = precisionFixed(step))) specifier.precision = precision - (specifier.type === \"%\") * 2;\n      break;\n    }\n  }\n  return format(specifier);\n}\n","import exponent from \"./exponent.js\";\n\nexport default function(step, value) {\n  return Math.max(0, Math.max(-8, Math.min(8, Math.floor(exponent(value) / 3))) * 3 - exponent(Math.abs(step)));\n}\n","import exponent from \"./exponent.js\";\n\nexport default function(step, max) {\n  step = Math.abs(step), max = Math.abs(max) - step;\n  return Math.max(0, exponent(max) - exponent(step)) + 1;\n}\n","import exponent from \"./exponent.js\";\n\nexport default function(step) {\n  return Math.max(0, -exponent(Math.abs(step)));\n}\n","export default function(s) {\n  return s.match(/.{6}/g).map(function(x) {\n    return \"#\" + x;\n  });\n}\n","import colors from \"./colors\";\n\nexport default colors(\"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf\");\n","import colors from \"./colors\";\n\nexport default colors(\"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6\");\n","import colors from \"./colors\";\n\nexport default colors(\"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9\");\n","import colors from \"./colors\";\n\nexport default colors(\"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5\");\n","export var deg2rad = Math.PI / 180;\nexport var rad2deg = 180 / Math.PI;\n","import define, {extend} from \"./define.js\";\nimport {Color, rgbConvert, Rgb, darker, brighter} from \"./color.js\";\nimport {deg2rad, rad2deg} from \"./math.js\";\n\nvar A = -0.14861,\n    B = +1.78277,\n    C = -0.29227,\n    D = -0.90649,\n    E = +1.97294,\n    ED = E * D,\n    EB = E * B,\n    BC_DA = B * C - D * A;\n\nfunction cubehelixConvert(o) {\n  if (o instanceof Cubehelix) return new Cubehelix(o.h, o.s, o.l, o.opacity);\n  if (!(o instanceof Rgb)) o = rgbConvert(o);\n  var r = o.r / 255,\n      g = o.g / 255,\n      b = o.b / 255,\n      l = (BC_DA * b + ED * r - EB * g) / (BC_DA + ED - EB),\n      bl = b - l,\n      k = (E * (g - l) - C * bl) / D,\n      s = Math.sqrt(k * k + bl * bl) / (E * l * (1 - l)), // NaN if l=0 or l=1\n      h = s ? Math.atan2(k, bl) * rad2deg - 120 : NaN;\n  return new Cubehelix(h < 0 ? h + 360 : h, s, l, o.opacity);\n}\n\nexport default function cubehelix(h, s, l, opacity) {\n  return arguments.length === 1 ? cubehelixConvert(h) : new Cubehelix(h, s, l, opacity == null ? 1 : opacity);\n}\n\nexport function Cubehelix(h, s, l, opacity) {\n  this.h = +h;\n  this.s = +s;\n  this.l = +l;\n  this.opacity = +opacity;\n}\n\ndefine(Cubehelix, cubehelix, extend(Color, {\n  brighter: function(k) {\n    k = k == null ? brighter : Math.pow(brighter, k);\n    return new Cubehelix(this.h, this.s, this.l * k, this.opacity);\n  },\n  darker: function(k) {\n    k = k == null ? darker : Math.pow(darker, k);\n    return new Cubehelix(this.h, this.s, this.l * k, this.opacity);\n  },\n  rgb: function() {\n    var h = isNaN(this.h) ? 0 : (this.h + 120) * deg2rad,\n        l = +this.l,\n        a = isNaN(this.s) ? 0 : this.s * l * (1 - l),\n        cosh = Math.cos(h),\n        sinh = Math.sin(h);\n    return new Rgb(\n      255 * (l + a * (A * cosh + B * sinh)),\n      255 * (l + a * (C * cosh + D * sinh)),\n      255 * (l + a * (E * cosh)),\n      this.opacity\n    );\n  }\n}));\n","import {cubehelix as colorCubehelix} from \"d3-color\";\nimport color, {hue} from \"./color.js\";\n\nfunction cubehelix(hue) {\n  return (function cubehelixGamma(y) {\n    y = +y;\n\n    function cubehelix(start, end) {\n      var h = hue((start = colorCubehelix(start)).h, (end = colorCubehelix(end)).h),\n          s = color(start.s, end.s),\n          l = color(start.l, end.l),\n          opacity = color(start.opacity, end.opacity);\n      return function(t) {\n        start.h = h(t);\n        start.s = s(t);\n        start.l = l(Math.pow(t, y));\n        start.opacity = opacity(t);\n        return start + \"\";\n      };\n    }\n\n    cubehelix.gamma = cubehelixGamma;\n\n    return cubehelix;\n  })(1);\n}\n\nexport default cubehelix(hue);\nexport var cubehelixLong = cubehelix(color);\n","import colors from \"./colors\";\n\nfunction ramp(range) {\n  var n = range.length;\n  return function(t) {\n    return range[Math.max(0, Math.min(n - 1, Math.floor(t * n)))];\n  };\n}\n\nexport default ramp(colors(\"44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725\"));\n\nexport var magma = ramp(colors(\"00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf\"));\n\nexport var inferno = ramp(colors(\"00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4\"));\n\nexport var plasma = ramp(colors(\"0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921\"));\n","import {cubehelix} from \"d3-color\";\nimport {interpolateCubehelixLong} from \"d3-interpolate\";\n\nexport default interpolateCubehelixLong(cubehelix(300, 0.5, 0.0), cubehelix(-240, 0.5, 1.0));\n","import {cubehelix} from \"d3-color\";\nimport {interpolateCubehelixLong} from \"d3-interpolate\";\n\nexport var warm = interpolateCubehelixLong(cubehelix(-100, 0.75, 0.35), cubehelix(80, 1.50, 0.8));\n\nexport var cool = interpolateCubehelixLong(cubehelix(260, 0.75, 0.35), cubehelix(80, 1.50, 0.8));\n\nvar rainbow = cubehelix();\n\nexport default function(t) {\n  if (t < 0 || t > 1) t -= Math.floor(t);\n  var ts = Math.abs(t - 0.5);\n  rainbow.h = 360 * t - 100;\n  rainbow.s = 1.5 - 1.5 * ts;\n  rainbow.l = 0.8 - 0.9 * ts;\n  return rainbow + \"\";\n}\n","import scalePresets from './scalePresets';\r\nimport {ScaleLinear, scaleLinear} from 'd3-scale';\r\nimport Settings from './Settings';\r\nimport {EscherMap} from './escherMap';\r\n\r\nexport default class Scale {\r\n  x: ScaleLinear<number, number>;\r\n  y: ScaleLinear<number, number>;\r\n  x_size: ScaleLinear<number, number>;\r\n  y_size: ScaleLinear<number, number>;\r\n  size: ScaleLinear<number, number>;\r\n  reaction_color: ScaleLinear<number, number>;\r\n  reaction_size: ScaleLinear<number, number>;\r\n  metabolite_color: ScaleLinear<number, number>;\r\n  metabolite_size: ScaleLinear<number, number>;\r\n\r\n  constructor() {\r\n    this.x = scaleLinear();\r\n    this.y = scaleLinear();\r\n    this.x_size = scaleLinear();\r\n    this.y_size = scaleLinear();\r\n    this.size = scaleLinear();\r\n    this.reaction_color = scaleLinear().clamp(true);\r\n    this.reaction_size = scaleLinear().clamp(true);\r\n    this.metabolite_color = scaleLinear().clamp(true);\r\n    this.metabolite_size = scaleLinear().clamp(true);\r\n  }\r\n\r\n  connectToSettings(settings: Settings, map: EscherMap, getDataStatistics: () => { reaction: any, metabolite: any }) {\r\n    // Wire up default scales. First warn if preset and scale are set. Use\r\n    // presets to set scales, avoiding loops.\r\n    const types = ['reaction', 'metabolite'];\r\n    types.forEach((type) => {\r\n      const scale = `${type}_scale`;\r\n      const preset = `${type}_scale_preset`;\r\n\r\n      // initial\r\n      const presetVal = settings.get(preset);\r\n      const scaleVal = settings.get(scale);\r\n      if (presetVal && scaleVal && scaleVal !== scalePresets[presetVal]) {\r\n        console.warn(`Both ${scale} and ${preset} are defined. Ignoring ${preset}. Set ${preset} to \"false\" to hide this warning.`);\r\n        settings.set(preset, null);\r\n      } else if (presetVal)\r\n        settings.set(scale, scalePresets[presetVal]);\r\n      else if (!scaleVal)\r\n        console.error(`Must provide a ${scale} or ${preset}`);\r\n\r\n\r\n      // Warn if scales are too short\r\n      if (settings.get(scale) && settings.get(scale).length < 2)\r\n        console.error(`Bad value for option ${scale}. Scales must have at least 2 points.`);\r\n      else\r\n        this.setScale(type, scaleVal, getDataStatistics);\r\n\r\n\r\n      // reactive\r\n      settings.streams[scale].onValue((val) => {\r\n        // if the scale did not come from the preset, then reset the preset setting\r\n        if (val && val !== scalePresets[settings.get(preset)])\r\n          settings.set(preset, null);\r\n\r\n        this.setScale(type, val, getDataStatistics);\r\n      });\r\n      settings.streams[preset].onValue((val) => {\r\n        // if there is a new preset, then set the scale\r\n        if (val)\r\n          settings.set(scale, scalePresets[val]);\r\n      });\r\n\r\n      // stats changes\r\n      map.callback_manager.set(`calc_data_stats__${type}`, (changed) => {\r\n        if (changed)\r\n          this.setScale(type, settings.get(`${type}_scale`), getDataStatistics);\r\n      });\r\n    });\r\n  }\r\n\r\n  sortScale(scale: { type: string, value: number, color: string, size: number }[], stats: { [key: string]: number }) {\r\n    const sorted = scale.map((x) => {\r\n      let v;\r\n      if (x.type in stats)\r\n        v = stats[x.type];\r\n      else if (x.type === 'value')\r\n        v = x.value;\r\n      else\r\n        throw new Error('Bad domain type ' + x.type);\r\n\r\n      return {v, color: x.color, size: x.size};\r\n    }).sort((a, b) => {\r\n      return a.v - b.v;\r\n    });\r\n    return {\r\n      domain: sorted.map((x) => { return x.v; }),\r\n      color_range: sorted.map((x) => { return x.color; }),\r\n      size_range: sorted.map((x) => { return x.size; })\r\n    };\r\n  }\r\n\r\n  setScale(type: string, scale: { type: string, value: number, color: string, size: number }[], getDataStatistics: () => { reaction: any, metabolite: any }) {\r\n    if (type === 'reaction')\r\n      this.setReactionScale(scale, getDataStatistics);\r\n    else\r\n      this.setMetaboliteScale(scale, getDataStatistics);\r\n  }\r\n\r\n  setReactionScale(scale: { type: string, value: number, color: string, size: number }[], getDataStatistics: () => { reaction: any, metabolite: any }) {\r\n    const stats = getDataStatistics().reaction;\r\n    // If stats are null, then no data, so don't worry about it.\r\n    if (stats !== null) {\r\n      const out = this.sortScale(scale, stats);\r\n      this.reaction_color.domain(out.domain);\r\n      this.reaction_size.domain(out.domain);\r\n      this.reaction_color.range(out.color_range as any);\r\n      this.reaction_size.range(out.size_range);\r\n    }\r\n  }\r\n\r\n  setMetaboliteScale(scale: { type: string, value: number, color: string, size: number }[], getDataStatistics: () => { reaction: any, metabolite: any }) {\r\n    const stats = getDataStatistics().metabolite;\r\n    // If stats are null, then no data, so don't worry about it.\r\n    if (stats !== null) {\r\n      const out = this.sortScale(scale, stats);\r\n      this.metabolite_color.domain(out.domain);\r\n      this.metabolite_size.domain(out.domain);\r\n      this.metabolite_color.range(out.color_range as any);\r\n      this.metabolite_size.range(out.size_range);\r\n    }\r\n  }\r\n}\r\n","function incr(a: number, l: number) {\r\n  return a + 1 > l - 1 ? 0 : a + 1;\r\n}\r\n\r\nfunction decr(a: number, l: number) {\r\n  return a - 1 < 0 ? l - 1 : a - 1;\r\n}\r\n\r\n/** UndoStack. A constructor that can be used to store undo info. */\r\nexport default class UndoStack {\r\n  stack: any[];\r\n  current: number;\r\n  oldest: number;\r\n  newest: number;\r\n  endOfStack: boolean;\r\n  topOfStack: boolean;\r\n  constructor() {\r\n    const stackSize = 40;\r\n    this.stack = Array(stackSize);\r\n    this.current = -1;\r\n    this.oldest = -1;\r\n    this.newest = -1;\r\n    this.endOfStack = true;\r\n    this.topOfStack = true;\r\n  }\r\n\r\n  push(undo: () => void, redo: () => void) {\r\n    this.current = incr(this.current, this.stack.length);\r\n    // change the oldest\r\n    if (this.endOfStack)\r\n      this.oldest = this.current;\r\n    else if (this.oldest === this.current)\r\n      this.oldest = incr(this.oldest, this.stack.length);\r\n\r\n    this.stack[this.current] = {undo, redo};\r\n    this.newest = this.current;\r\n\r\n    // top of the stack\r\n    this.topOfStack = true;\r\n    this.endOfStack = false;\r\n\r\n    return {do: () => redo()};\r\n  }\r\n\r\n  undo() {\r\n    // check that we haven't reached the end\r\n    if (this.endOfStack) return console.warn('End of stack.');\r\n    // run the lastest stack function\r\n    this.stack[this.current].undo();\r\n    if (this.current === this.oldest) {\r\n      // if the next index is less than the oldest, then the stack is dead\r\n      this.endOfStack = true;\r\n    } else {\r\n      // reference the next fn\r\n      this.current = decr(this.current, this.stack.length);\r\n    }\r\n\r\n    // not at the top of the stack\r\n    this.topOfStack = false;\r\n  }\r\n\r\n  redo() {\r\n    // check that we haven't reached the end\r\n    if (this.topOfStack) return console.warn('Top of stack.');\r\n\r\n    if (!this.endOfStack)\r\n      this.current = incr(this.current, this.stack.length);\r\n\r\n    this.stack[this.current].redo();\r\n\r\n    // if at top of stack\r\n    if (this.current === this.newest)\r\n      this.topOfStack = true;\r\n\r\n\r\n    // not at the end of the stack\r\n    this.endOfStack = false;\r\n  }\r\n}\r\n","import Mousetrap from 'mousetrap';\r\nimport _ from 'underscore';\r\nimport Settings from './Settings';\r\n\r\n/**\r\n * If ctrlEqualsCmd is true and key has ctrl+ in it, return an array with ctrl+\r\n * and meta+ variations.\r\n */\r\nfunction addCmd(key: string | string[], ctrlEqualsCmd: boolean) {\r\n  if (!ctrlEqualsCmd) return key;\r\n  const keyAr = _.isArray(key) ? key : [key];\r\n  const newAr = keyAr.reduce((c, k) => {\r\n    const n = k.replace('ctrl+', 'meta+');\r\n    if (n !== k) c.push(n);\r\n    return c;\r\n  }, keyAr.slice());\r\n  return newAr.length === keyAr.length ? key : newAr;\r\n}\r\n\r\n/**\r\n * KeyManager - Manage key listeners and events.\r\n * @param assignedKeys (default: {}): An object defining keys to bind.\r\n * @param inputList (default: []): A list of inputs that will override keyboard shortcuts when in focus.\r\n * @param selection (default: global): A node to bind the events to.\r\n * @param ctrlEqualsCmd (default: false): If true, then control and command have the same effect.\r\n */\r\nexport default class KeyManager {\r\n  assignedKeys: any;\r\n  inputList: any;\r\n  mousetrap: any;\r\n  ctrlEqualsCmd: any;\r\n  escapeQueue: any;\r\n  removeEscapeListener: any;\r\n  settings: Settings | null;\r\n  enabled: boolean;\r\n  constructor(\r\n    assignedKeys = {},\r\n    inputList = [],\r\n    selection = null,\r\n    ctrlEqualsCmd = false,\r\n    settings = null\r\n  ) {\r\n    // default Arguments\r\n    this.assignedKeys = assignedKeys;\r\n    this.inputList = inputList;\r\n    this.mousetrap = selection ? new Mousetrap(selection) : new Mousetrap();\r\n    this.ctrlEqualsCmd = ctrlEqualsCmd;\r\n\r\n    // Fix mousetrap behavior; by default, it ignore shortcuts when inputs are\r\n    // in focus.\r\n    // TODO NOT WORKING https://craig.is/killing/mice\r\n    // consider swithching to https://github.com/PolicyStat/combokeys\r\n    this.mousetrap.stopCallback = () => false;\r\n\r\n    this.escapeQueue = [];\r\n    this.removeEscapeListener = null;\r\n\r\n    // to check settings when running a key\r\n    this.settings = settings;\r\n\r\n    this.enabled = true;\r\n    this.update();\r\n  }\r\n\r\n  /**\r\n   * Updated key bindings if attributes have changed.\r\n   */\r\n  update() {\r\n    this.mousetrap.reset();\r\n    if (!this.enabled) return;\r\n\r\n    // loop through keys\r\n    for (const keyId in this.assignedKeys) {\r\n      const assignedKey = this.assignedKeys[keyId];\r\n\r\n      // OK if this is missing\r\n      if (!assignedKey.key) continue;\r\n\r\n      const keyToBind = addCmd(assignedKey.key, this.ctrlEqualsCmd);\r\n      // remember the inputList\r\n      assignedKey.inputList = this.inputList;\r\n      this.mousetrap.bind(keyToBind, (e: any) => {\r\n        // check requires\r\n        if (assignedKey.requires && !this.settings?.get(assignedKey.requires))\r\n          return;\r\n\r\n\r\n        // check inputs\r\n        let inputBlocking = false;\r\n        if (assignedKey.ignoreWithInput) {\r\n          for (let i = 0, l = assignedKey.inputList.length; i < l; i++) {\r\n            const thisInputVal = assignedKey.inputList[i];\r\n            const thisInput = _.isFunction(thisInputVal) ?\r\n              thisInputVal() :\r\n              thisInputVal;\r\n            if (thisInput !== null && thisInput.is_visible()) {\r\n              inputBlocking = true;\r\n              break;\r\n            }\r\n          }\r\n        }\r\n\r\n        if (!inputBlocking) {\r\n          if (assignedKey.fn) assignedKey.fn.call(assignedKey.target);\r\n          else console.warn('No function for key: ' + assignedKey.key);\r\n          e.preventDefault();\r\n        }\r\n      }, 'keydown');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Turn the key manager on or off.\r\n   */\r\n  toggle(onOff: boolean) {\r\n    if (_.isUndefined(onOff)) onOff = !this.enabled;\r\n    this.enabled = onOff;\r\n    this.update();\r\n  }\r\n\r\n  /**\r\n   * Call the callback when the enter key is pressed, then unregisters the\r\n   * listener.\r\n   */\r\n  addEnterListener(callback: any, oneTime?: boolean) {\r\n    return this.addKeyListener('enter', callback, oneTime);\r\n  }\r\n\r\n  /**\r\n   * If the list is empty, drop the listener. could get called after the\r\n   * listener is already removed\r\n   */\r\n  _tryDropEscapeListener() {\r\n    if (this.escapeQueue.length === 0 && this.removeEscapeListener) {\r\n      this.removeEscapeListener();\r\n      this.removeEscapeListener = null;\r\n    }\r\n  }\r\n  /**\r\n   * Call the callback when the escape key is pressed, then unregisters the\r\n   * listener.\r\n   *\r\n   * Unlike the other listeners, addEscapeListener keeps a queue of listeners\r\n   * that are called in order then popped off the list.\r\n   *\r\n   * Escape listeners also only work one time.\r\n   */\r\n  addEscapeListener(callback: any) {\r\n    // if the listener is not set, then add it\r\n    if (this.removeEscapeListener == null) {\r\n      this.removeEscapeListener = this.addKeyListener('escape', () => {\r\n        // pop and run the top callback\r\n        if (this.escapeQueue.length > 0) {\r\n          const top = this.escapeQueue.pop();\r\n          top();\r\n        }\r\n        this._tryDropEscapeListener();\r\n      });\r\n    }\r\n\r\n    // push the new callback onto the queue\r\n    this.escapeQueue.push(callback);\r\n\r\n    // return a function to pop the callback out of the list\r\n    return () => {\r\n      // find it if it's in the queue\r\n      const index = this.escapeQueue.indexOf(callback);\r\n      // if it's the last one, then pop and activate next\r\n      if (index > -1) {\r\n        // remove it\r\n        this.escapeQueue.splice(index, 1);\r\n      }\r\n      this._tryDropEscapeListener();\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Call the callback when the key is pressed, then unregisters the listener.\r\n   * Returns a function that will unbind the event.\r\n   * @param callback: The callback function with no arguments.\r\n   * @param key_name: A key name, or list of key names, as defined by the\r\n   *                  mousetrap library: https://craig.is/killing/mice\r\n   * @param one_time: If True, then cancel the listener after the first execution.\r\n   */\r\n  addKeyListener(keyName: string | string[], callback: any, oneTime = false) {\r\n    // unbind function ready to go\r\n    const unbind = this.mousetrap.unbind.bind(this.mousetrap, keyName);\r\n\r\n    this.mousetrap.bind(addCmd(keyName, this.ctrlEqualsCmd), (e: any) => {\r\n      e.preventDefault();\r\n      callback();\r\n      if (oneTime) unbind();\r\n    });\r\n\r\n    return unbind;\r\n  }\r\n}\r\n","import * as utils from './utils';\r\nimport CallbackManager from './CallbackManager';\r\n\r\nimport {drag as d3Drag} from 'd3-drag';\r\n// @ts-ignore\r\nimport {selection as d3Selection, event} from 'd3-selection';\r\nimport _ from 'underscore';\r\nimport {D3Selection} from './types';\r\n\r\n/**\r\n * Canvas. Defines a canvas that accepts drag/zoom events and can be resized.\r\n * Canvas(selection, x, y, width, height)\r\n * Adapted from http://bl.ocks.org/mccannf/1629464.\r\n */\r\nexport default class Canvas {\r\n  selection: D3Selection;\r\n  x: number;\r\n  y: number;\r\n  width: number;\r\n  height: number;\r\n  resizeEnabled: boolean;\r\n  callbackManager: CallbackManager;\r\n  mouseNode: any = null;\r\n  constructor(selection: D3Selection, sizeAndLocation: {x: number, y: number, width: number, height: number}) {\r\n    this.selection = selection;\r\n    this.x = sizeAndLocation.x;\r\n    this.y = sizeAndLocation.y;\r\n    this.width = sizeAndLocation.width;\r\n    this.height = sizeAndLocation.height;\r\n\r\n    // enable by default\r\n    this.resizeEnabled = true;\r\n\r\n    // set up the callbacks\r\n    this.callbackManager = new CallbackManager();\r\n\r\n    this.setup();\r\n  }\r\n\r\n  /**\r\n   * Turn the resize on or off\r\n   */\r\n  toggleResize(onOff: boolean) {\r\n    if (_.isUndefined(onOff)) onOff = !this.resizeEnabled;\r\n\r\n    if (onOff) {\r\n      this.selection.selectAll('.drag-rect')\r\n        .style('pointer-events', 'auto');\r\n    } else {\r\n      this.selection.selectAll('.drag-rect')\r\n        .style('pointer-events', 'none');\r\n    }\r\n  }\r\n\r\n  setup() {\r\n    const dragbarWidth = 100;\r\n    const mouseNodeMult = 10;\r\n    const newSel = this.selection.append('g')\r\n      .classed('canvas-group', true)\r\n      .data([{x: this.x, y: this.y}]);\r\n\r\n    const stopPropagation = () => {\r\n      event.sourceEvent.stopPropagation();\r\n    };\r\n\r\n    const transformString = (x: number | null, y: number | null, currentTransform: string) => {\r\n      const tr = utils.d3_transform_catch(currentTransform);\r\n      const translate = tr.translate;\r\n      if (x !== null) translate[0] = x;\r\n      if (y !== null) translate[1] = y;\r\n      return 'translate(' + translate + ')';\r\n    };\r\n\r\n    const mouseNode = newSel.append('rect')\r\n      .attr('id', 'mouse-node')\r\n      .attr('width', this.width * mouseNodeMult)\r\n      .attr('height', this.height * mouseNodeMult)\r\n      .attr('transform', 'translate(' + [this.x - this.width * mouseNodeMult / 2, this.y - this.height * mouseNodeMult / 2] + ')')\r\n      .attr('pointer-events', 'all');\r\n    this.mouseNode = mouseNode;\r\n\r\n    const rect = newSel.append('rect')\r\n      .attr('id', 'canvas')\r\n      .attr('width', this.width)\r\n      .attr('height', this.height)\r\n      .attr('transform', 'translate(' + [this.x, this.y] + ')');\r\n\r\n    const dragLeft = d3Drag()\r\n      .on('start', stopPropagation)\r\n      .on('drag', (d) => {\r\n        const oldX = d.x;\r\n        d.x = Math.min(d.x + this.width - (dragbarWidth / 2), event.x);\r\n        this.x = d.x;\r\n        this.width = this.width + (oldX - d.x);\r\n        left.attr('transform', (d) => {\r\n          return transformString(d.x - (dragbarWidth / 2), null, left.attr('transform'));\r\n        });\r\n        mouseNode.attr('transform', (d) => {\r\n          return transformString(d.x, null, mouseNode.attr('transform'));\r\n        }).attr('width', this.width * mouseNodeMult);\r\n        rect.attr('transform', (d) => {\r\n          return transformString(d.x, null, rect.attr('transform'));\r\n        }).attr('width', this.width);\r\n        top.attr('transform', (d) => transformString(d.x + (dragbarWidth / 2), null, top.attr('transform')))\r\n          .attr('width', this.width - dragbarWidth);\r\n        bottom.attr('transform', (d) => transformString(d.x + (dragbarWidth / 2), null, bottom.attr('transform')))\r\n          .attr('width', this.width - dragbarWidth);\r\n\r\n        this.callbackManager.run('resize');\r\n      });\r\n\r\n    const left = newSel.append('rect')\r\n      .classed('drag-rect', true)\r\n      .attr('transform', (d) => 'translate(' + [d.x - (dragbarWidth / 2), d.y + (dragbarWidth / 2)] + ')')\r\n      .attr('height', this.height - dragbarWidth)\r\n      .attr('id', 'dragleft')\r\n      .attr('width', dragbarWidth)\r\n      .attr('cursor', 'ew-resize')\r\n      .classed('resize-rect', true)\r\n      .call(dragLeft as any);\r\n\r\n    const dragRight = d3Drag()\r\n      .on('start', stopPropagation)\r\n      .on('drag', (d) => {\r\n        event.sourceEvent.stopPropagation();\r\n        const dragX = Math.max(d.x + (dragbarWidth / 2),\r\n          d.x + this.width + event.dx);\r\n        // recalculate width\r\n        this.width = dragX - d.x;\r\n        // move the right drag handle\r\n        right.attr('transform', (d) =>\r\n          transformString(dragX - (dragbarWidth / 2), null, right.attr('transform'))\r\n        );\r\n        // resize the drag rectangle. as we are only resizing from the\r\n        // right, the x coordinate does not need to change\r\n        mouseNode.attr('width', this.width * mouseNodeMult);\r\n        rect.attr('width', this.width);\r\n        top.attr('width', this.width - dragbarWidth);\r\n        bottom.attr('width', this.width - dragbarWidth);\r\n\r\n        this.callbackManager.run('resize');\r\n      });\r\n\r\n    const right = newSel.append('rect')\r\n      .classed('drag-rect', true)\r\n      .attr('transform', (d) => {\r\n        return 'translate(' +\r\n            [d.x + this.width - (dragbarWidth / 2), d.y + (dragbarWidth / 2)] +\r\n            ')';\r\n      })\r\n      .attr('id', 'dragright')\r\n      .attr('height', this.height - dragbarWidth)\r\n      .attr('width', dragbarWidth)\r\n      .attr('cursor', 'ew-resize')\r\n      .classed('resize-rect', true)\r\n      .call(dragRight as any);\r\n\r\n    const dragTop = d3Drag()\r\n      .on('start', stopPropagation)\r\n      .on('drag', (d) => {\r\n        event.sourceEvent.stopPropagation();\r\n        const oldY = d.y;\r\n        d.y = Math.min(d.y + this.height - (dragbarWidth / 2), event.y);\r\n        this.y = d.y;\r\n        this.height = this.height + (oldY - d.y);\r\n        top.attr('transform', (d) => {\r\n          return transformString(null, d.y - (dragbarWidth / 2), top.attr('transform'));\r\n        });\r\n        mouseNode.attr('transform', (d) => {\r\n          return transformString(null, d.y, mouseNode.attr('transform'));\r\n        }).attr('width', this.height * mouseNodeMult);\r\n        rect.attr('transform', (d) => {\r\n          return transformString(null, d.y, rect.attr('transform'));\r\n        }).attr('height', this.height);\r\n        left.attr('transform', (d) => {\r\n          return transformString(null, d.y + (dragbarWidth / 2), left.attr('transform'));\r\n        }).attr('height', this.height - dragbarWidth);\r\n        right.attr('transform', (d) => {\r\n          return transformString(null, d.y + (dragbarWidth / 2), right.attr('transform'));\r\n        }).attr('height', this.height - dragbarWidth);\r\n\r\n        this.callbackManager.run('resize');\r\n      });\r\n\r\n    const top = newSel.append('rect')\r\n      .classed('drag-rect', true)\r\n      .attr('transform', (d) => {\r\n        return 'translate(' +\r\n            [d.x + (dragbarWidth / 2), d.y - (dragbarWidth / 2)] +\r\n            ')';\r\n      })\r\n      .attr('height', dragbarWidth)\r\n      .attr('width', this.width - dragbarWidth)\r\n      .attr('cursor', 'ns-resize')\r\n      .classed('resize-rect', true)\r\n      .call(dragTop as any);\r\n\r\n    const dragBottom = d3Drag()\r\n      .on('start', stopPropagation)\r\n      .on('drag', (d) => {\r\n        event.sourceEvent.stopPropagation();\r\n        const dragY = Math.max(d.y + (dragbarWidth / 2),\r\n          d.y + this.height + event.dy);\r\n        // recalculate width\r\n        this.height = dragY - d.y;\r\n        // move the right drag handle\r\n        bottom.attr('transform', (d) => transformString(null,\r\n          dragY - (dragbarWidth / 2),\r\n          bottom.attr('transform')));\r\n        // resize the drag rectangle. as we are only resizing from the\r\n        // right, the x coordinate does not need to change\r\n        mouseNode.attr('height', this.height * mouseNodeMult);\r\n        rect.attr('height', this.height);\r\n        left.attr('height', this.height - dragbarWidth);\r\n        right.attr('height', this.height - dragbarWidth);\r\n\r\n        this.callbackManager.run('resize');\r\n      });\r\n\r\n    const bottom = newSel.append('rect')\r\n      .classed('drag-rect', true)\r\n      .attr('transform', (d) => 'translate(' + [d.x + (dragbarWidth / 2), d.y + this.height - (dragbarWidth / 2)] + ')')\r\n      .attr('height', dragbarWidth)\r\n      .attr('width', this.width - dragbarWidth)\r\n      .attr('cursor', 'ns-resize')\r\n      .classed('resize-rect', true)\r\n      .call(dragBottom as any);\r\n  }\r\n\r\n  sizeAndLocation() {\r\n    return {\r\n      x: this.x,\r\n      y: this.y,\r\n      width: this.width,\r\n      height: this.height\r\n    };\r\n  }\r\n}\r\n","/**\r\n * SearchIndex. Define an index for searching for reaction and metabolites in\r\n * the map. The index is stored in SearchIndex.index, an object of id/record\r\n * pairs.\r\n */\r\nexport default class SearchIndex {\r\n  index: { [key: string]: any };\r\n  constructor() {\r\n    this.index = {};\r\n  }\r\n\r\n  /**\r\n   * Insert a record into the index.\r\n   * @param id - A unique string id.\r\n   * @param record - Records have the form: { 'name': '', 'data': {} }\r\n   * Search is performed on substrings of the name.\r\n   * @param overwrite - (Default false) For faster performance, make overwrite true,\r\n   * and records will be inserted without checking for an existing record.\r\n   * @param check_record - (Default false) For faster performance, make\r\n   * check_record * false. If true, records will be checked to make sure they\r\n   * have name and * data attributes.\r\n   */\r\n  insert(id: string, record: any, overwrite?: boolean, checkRecord?: boolean) {\r\n    if (!overwrite && (id in this.index))\r\n      throw new Error('id is already in the index');\r\n\r\n    if (checkRecord && !(('name' in record) && ('data' in record)))\r\n      throw new Error('malformed record');\r\n\r\n    this.index[id] = record;\r\n  }\r\n\r\n  /**\r\n   * Remove the matching record. Returns true is a record is found, or false if\r\n   * no match is found.\r\n   */\r\n  remove(recordId: string) {\r\n    if (recordId in this.index) {\r\n      delete this.index[recordId];\r\n      return true;\r\n    } else\r\n      return false;\r\n  }\r\n\r\n  /**\r\n   * Find a record that matches the substring. Returns an array of data from\r\n   * matching records.\r\n   */\r\n  find(substring: string) {\r\n    const re = RegExp(substring, 'i'); // ignore case\r\n    const matches = [];\r\n    for (const id in this.index) {\r\n      const record = this.index[id];\r\n      if (re.exec(record.name))\r\n        matches.push(record.data);\r\n    }\r\n    return matches;\r\n  }\r\n}\r\n","import {EscherMap} from './escherMap';\r\nimport {IDType} from './types';\r\n\r\nexport function findShortestPath(map: EscherMap, fromNodeBiggId: IDType, toNodeBiggId: IDType) {\r\n  // todo: add skipped paths for kth shortest path\r\n  const reactionOrder = (coef: number) => coef > 0 ? 1 : -1;\r\n\r\n  // create node oriented graph\r\n  const graph: { [key: string]: { [key: string]: { coefficient: number; reaction_id: string; reaction_name: string; }; }; } = {};\r\n  // the path should only be built between primary metabolites\r\n  const primaryMetabolitBiggIds = new Set(Object.values(map.nodes).filter((node) => node.node_type === 'metabolite' && node.node_is_primary).map((node) => node.bigg_id));\r\n\r\n  for (const reactionId in map.reactions) {\r\n    const reaction = map.reactions[reactionId];\r\n    for (const metabolite of reaction.metabolites) {\r\n      if (metabolite.coefficient > 0 && !reaction.reversibility) // only add forward or reversible reactions\r\n        continue;\r\n      if (!graph[metabolite.bigg_id])\r\n        graph[metabolite.bigg_id] = {};\r\n\r\n      const metaboliteReactionOrder = reactionOrder(metabolite.coefficient);\r\n      reaction.metabolites.filter((met) => met.bigg_id !== metabolite.bigg_id && reactionOrder(met.coefficient) !== metaboliteReactionOrder && primaryMetabolitBiggIds.has(met.bigg_id)).forEach((met) => {\r\n        graph[metabolite.bigg_id][met.bigg_id] = {coefficient: met.coefficient, reaction_id: reaction.reaction_id, reaction_name: reaction.bigg_id};\r\n      });\r\n    }\r\n  }\r\n\r\n  // find shortest path using djikstra\r\n  const visited: { [key: string]: boolean } = {};\r\n  const distance: { [key: string]: number } = {};\r\n  const previous: { [key: string]: { met: string; reaction_id: string; } } = {};\r\n  // initialize distances\r\n  Object.values(map.nodes).filter((node) => node.node_type == 'metabolite').forEach((node) => distance[node.bigg_id] = Infinity);\r\n  const queue = [fromNodeBiggId];\r\n\r\n  distance[fromNodeBiggId] = 0;\r\n  while (queue.length > 0) {\r\n    const node = queue.sort((a, b) => distance[a] - distance[b])[0];\r\n    queue.splice(0, 1);\r\n    if (visited[node])\r\n      continue;\r\n\r\n    visited[node] = true;\r\n    if (node === toNodeBiggId)\r\n      break;\r\n\r\n    for (const neighbor in graph[node]) {\r\n      const alt = distance[node] + 1; // TODO: use reaction weight later\r\n      if (alt < distance[neighbor]) {\r\n        distance[neighbor] = alt;\r\n        previous[neighbor] = {met: node, reaction_id: graph[node][neighbor].reaction_id};\r\n        queue.push(neighbor);\r\n      }\r\n    }\r\n  }\r\n\r\n  // reconstruct path\r\n  const path = [{met: toNodeBiggId, reaction_id: null as string | null}];\r\n  let node = previous[toNodeBiggId];\r\n\r\n  while (node) {\r\n    path.unshift(node);\r\n    node = previous[node.met];\r\n  }\r\n  return path;\r\n}\r\n\r\n\r\nexport function findKthShortestPath(map: EscherMap, fromNodeBiggId: IDType, toNodeBiggId: IDType, k = 1) {\r\n  const reactionOrder = (coef: number) => coef > 0 ? 1 : -1;\r\n  //const primaryMetabolitBiggIds = new Set(Object.values(map.nodes).filter((node) => node.node_type === 'metabolite' && node.node_is_primary).map((node) => node.bigg_id));\r\n\r\n  const graph: { [key: string]: { [key: string]: { coefficient: number; reaction_id: string; reaction_name?: string; }; }; } = {};\r\n\r\n  // Build the graph structure\r\n  for (const reactionId in map.reactions) {\r\n    const reaction = map.reactions[reactionId];\r\n    for (const metabolite of reaction.metabolites) {\r\n      if (metabolite.coefficient > 0 && !reaction.reversibility) continue;\r\n      if (!graph[metabolite.bigg_id]) graph[metabolite.bigg_id] = {};\r\n      const metaboliteReactionOrder = reactionOrder(metabolite.coefficient);\r\n      reaction.metabolites.filter((met) => met.bigg_id !== metabolite.bigg_id && reactionOrder(met.coefficient) !== metaboliteReactionOrder\r\n        // && primaryMetabolitBiggIds.has(met.bigg_id)\r\n      ).forEach((met) => {\r\n        graph[metabolite.bigg_id][met.bigg_id] = {coefficient: met.coefficient, reaction_id: reaction.reaction_id};\r\n      });\r\n    }\r\n  }\r\n\r\n  // Helper function for finding shortest path with Dijkstra's algorithm\r\n  function dijkstra(fromNode: IDType, toNode: IDType) {\r\n    const visited: { [key: string]: boolean } = {};\r\n    const distance: { [key: string]: number } = {};\r\n    const previous: { [key: string]: { met: string; reaction_id: string; } } = {};\r\n\r\n    Object.values(map.nodes).filter((node) => node.node_type == 'metabolite').forEach((node) => distance[node.bigg_id] = Infinity);\r\n    distance[fromNode] = 0;\r\n    const queue = [fromNode];\r\n\r\n    while (queue.length > 0) {\r\n      const node = queue.sort((a, b) => distance[a] - distance[b])[0];\r\n      queue.splice(0, 1);\r\n      if (visited[node]) continue;\r\n      visited[node] = true;\r\n      if (node === toNode) break;\r\n\r\n      for (const neighbor in graph[node]) {\r\n        const alt = distance[node] + 1;\r\n        const curReaction = graph[node][neighbor].reaction_id;\r\n        const curPath = getReactionPath(node);\r\n\r\n        if (alt < distance[neighbor] && !curPath.includes(curReaction)) {\r\n          distance[neighbor] = alt;\r\n          previous[neighbor] = {met: node, reaction_id: graph[node][neighbor].reaction_id};\r\n          queue.push(neighbor);\r\n        }\r\n      }\r\n    }\r\n\r\n    // Reconstruct path\r\n\r\n    function getReactionPath(node: IDType) {\r\n      const path: string[] = [];\r\n      let n = previous[node];\r\n      while (n) {\r\n        path.unshift(n.reaction_id);\r\n        n = previous[n.met];\r\n      }\r\n      return path;\r\n    }\r\n    const path = [{met: toNodeBiggId, reaction_id: null as string | null}];\r\n    let node = previous[toNode];\r\n    while (node) {\r\n      path.unshift(node);\r\n      node = previous[node.met];\r\n    }\r\n    return {path, length: distance[toNode]};\r\n  }\r\n\r\n  // Initialize paths list with the first shortest path\r\n  const paths: { path: { met: string; reaction_id: string | null; }[]; length: number; }[] = [];\r\n  const {path: shortestPath, length: shortestLength} = dijkstra(fromNodeBiggId, toNodeBiggId);\r\n  if (shortestPath.length === 0) return null; // No path found\r\n  paths.push({path: shortestPath, length: shortestLength});\r\n\r\n  // Priority queue for candidate paths\r\n  const candidates = [];\r\n\r\n  for (let i = 1; i < k; i++) {\r\n    const lastPath = paths[i - 1].path;\r\n\r\n    for (let j = 0; j < lastPath.length - 1; j++) {\r\n      const spurNode = lastPath[j].met;\r\n      const rootPath = lastPath.slice(0, j);\r\n      // Temporarily remove edges that overlap with the current path\r\n      const removedEdges: [string, string, { coefficient: number; reaction_id: string; reaction_name?: string; }][] = [];\r\n      for (const p of paths) {\r\n        if (p.path.slice(0, j).every((step, idx) => step.met === rootPath[idx].met)) {\r\n          const nextNode = p.path[j + 1].met;\r\n          if (graph[spurNode] && graph[spurNode][nextNode]) {\r\n            removedEdges.push([spurNode, nextNode, graph[spurNode][nextNode]]);\r\n            delete graph[spurNode][nextNode];\r\n          }\r\n        }\r\n      }\r\n\r\n      const spurPath = dijkstra(spurNode, toNodeBiggId);\r\n      if (spurPath.path.length > 0) {\r\n        const totalPath = [...rootPath, ...spurPath.path];\r\n        const totalLength = rootPath.length + spurPath.length;\r\n        candidates.push({path: totalPath, length: totalLength});\r\n      }\r\n\r\n      // Restore removed edges\r\n      for (const [from, to, edgeData] of removedEdges)\r\n        graph[from][to] = edgeData;\r\n    }\r\n\r\n    if (candidates.length === 0) break;\r\n\r\n    // Sort candidates and add the shortest candidate path to paths\r\n    candidates.sort((a, b) => a.length - b.length);\r\n\r\n    const existingPathHashes = paths.map((p) => p.path.map((a) => `${a.met}-${a.reaction_id}`).join('-'));\r\n    const bestCandidate = candidates.filter((can) => new Set(can.path.map((a) => a.reaction_id)).size === can.path.length)\r\n      .filter((can) => !existingPathHashes.includes(can.path.map((a) => `${a.met}-${a.reaction_id}`).join('-')))\r\n      .shift();\r\n    if (bestCandidate)\r\n      paths.push(bestCandidate);\r\n    else\r\n      paths.push(paths[paths.length - 1]);\r\n  }\r\n\r\n  // Return the k-th shortest path if available\r\n  return paths[k - 1] ? paths[k - 1].path : null;\r\n}\r\n\r\nexport const pathSeparatorString = '-*-*-';\r\n\r\nexport function findOutGoing(map: EscherMap, nodeBiggId: IDType) {\r\n  const reactionOrder = (coef: number) => coef > 0 ? 1 : -1;\r\n  //const primaryMetabolitBiggIds = new Set(Object.values(map.nodes).filter((node) => node.node_type === 'metabolite' && node.node_is_primary).map((node) => node.bigg_id));\r\n\r\n  const graph: { [key: string]: { [key: string]: { coefficient: number; reaction_id: string; reaction_name?: string; }; }; } = {};\r\n\r\n  // Build the graph structure\r\n  for (const reactionId in map.reactions) {\r\n    const reaction = map.reactions[reactionId];\r\n    for (const metabolite of reaction.metabolites) {\r\n      if (metabolite.coefficient > 0 && !reaction.reversibility) continue;\r\n      if (!graph[metabolite.bigg_id]) graph[metabolite.bigg_id] = {};\r\n      const metaboliteReactionOrder = reactionOrder(metabolite.coefficient);\r\n      reaction.metabolites.filter((met) => met.bigg_id !== metabolite.bigg_id && reactionOrder(met.coefficient) !== metaboliteReactionOrder\r\n        // && primaryMetabolitBiggIds.has(met.bigg_id)\r\n      ).forEach((met) => {\r\n        graph[metabolite.bigg_id][met.bigg_id] = {coefficient: met.coefficient, reaction_id: reaction.reaction_id};\r\n      });\r\n    }\r\n  }\r\n  const outGoings = new Set<string>();\r\n  for (const otherMet in graph[nodeBiggId] == null ? {} : graph[nodeBiggId])\r\n    outGoings.add(`${graph[nodeBiggId][otherMet].reaction_id}${pathSeparatorString}${otherMet}`);\r\n\r\n  return Array.from(outGoings);\r\n}\r\n\r\nexport function findInGoing(map: EscherMap, nodeBiggId: IDType) {\r\n  const reactionOrder = (coef: number) => coef > 0 ? 1 : -1;\r\n  //const primaryMetabolitBiggIds = new Set(Object.values(map.nodes).filter((node) => node.node_type === 'metabolite' && node.node_is_primary).map((node) => node.bigg_id));\r\n\r\n  const graph: { [key: string]: { [key: string]: { coefficient: number; reaction_id: string; reaction_name?: string; }; }; } = {};\r\n\r\n  // Build the graph structure\r\n  for (const reactionId in map.reactions) {\r\n    const reaction = map.reactions[reactionId];\r\n    for (const metabolite of reaction.metabolites) {\r\n      if (metabolite.coefficient > 0 && !reaction.reversibility) continue;\r\n      if (!graph[metabolite.bigg_id]) graph[metabolite.bigg_id] = {};\r\n      const metaboliteReactionOrder = reactionOrder(metabolite.coefficient);\r\n      reaction.metabolites.filter((met) => met.bigg_id !== metabolite.bigg_id && reactionOrder(met.coefficient) !== metaboliteReactionOrder\r\n        // && primaryMetabolitBiggIds.has(met.bigg_id)\r\n      ).forEach((met) => {\r\n        graph[metabolite.bigg_id][met.bigg_id] = {coefficient: met.coefficient, reaction_id: reaction.reaction_id};\r\n      });\r\n    }\r\n  }\r\n  const inGoing = new Set<string>();\r\n\r\n\r\n  for (const otherMet in graph) {\r\n    if (!graph[otherMet][nodeBiggId]) continue;\r\n    const reactionInfo = graph[otherMet][nodeBiggId];\r\n    inGoing.add(`${reactionInfo.reaction_id}${pathSeparatorString}${otherMet}`);\r\n  }\r\n  return Array.from(inGoing);\r\n}\r\n\r\n\r\nexport function getReactionPathSegments(map: EscherMap, fromNodeBiggId: IDType, toNodeBiggId: IDType, reactionId: IDType) {\r\n  const reaction = map.reactions[reactionId];\r\n  if (!reaction)\r\n    return;\r\n\r\n  const fromNode = Object.values(map.nodes).find((node) => node.bigg_id === fromNodeBiggId && node.connected_segments.map((seg) => seg.reaction_id).includes(reactionId));\r\n  const toNode = Object.values(map.nodes).find((node) => node.bigg_id === toNodeBiggId && node.connected_segments.map((seg) => seg.reaction_id).includes(reactionId));\r\n  const fromNodeId = fromNode ? fromNode.node_id : null;\r\n  const toNodeId = toNode ? toNode.node_id : null;\r\n  if (!fromNodeId || !toNodeId)\r\n    return;\r\n\r\n\r\n  // create graph\r\n  const graph: { [key: string]: { [key: string]: string; }; } = {};\r\n  for (const segmentId of Object.keys(reaction.segments)) {\r\n    const segment = reaction.segments[segmentId];\r\n    if (!graph[segment.from_node_id])\r\n      graph[segment.from_node_id] = {};\r\n\r\n    if (!graph[segment.to_node_id])\r\n      graph[segment.to_node_id] = {};\r\n\r\n    graph[segment.from_node_id][segment.to_node_id] = segmentId;\r\n    graph[segment.to_node_id][segment.from_node_id] = segmentId;\r\n  }\r\n\r\n  // find shortest path using djikstra\r\n  const visited: { [key: string]: boolean } = {};\r\n  const distance: { [key: string]: number } = {};\r\n  const previous: { [key: string]: { nodeId: string; segmentId: string; } } = {};\r\n  // initialize distances\r\n  Object.keys(graph).forEach((nodeId) => distance[nodeId] = Infinity);\r\n  distance[fromNodeId] = 0;\r\n  const queue = [fromNodeId];\r\n  while (queue.length > 0) {\r\n    const nodeId = queue.sort((a, b) => distance[a] - distance[b])[0];\r\n    queue.splice(0, 1);\r\n    if (visited[nodeId])\r\n      continue;\r\n\r\n    visited[nodeId] = true;\r\n    if (nodeId === toNodeId)\r\n      break;\r\n\r\n\r\n    for (const neighborId of Object.keys(graph[nodeId])) {\r\n      const alt = distance[nodeId] + 1;\r\n      if (alt < distance[neighborId]) {\r\n        distance[neighborId] = alt;\r\n        previous[neighborId] = {nodeId, segmentId: graph[nodeId][neighborId]};\r\n        queue.push(neighborId);\r\n      }\r\n    }\r\n  }\r\n\r\n  // reconstruct path\r\n  const path: (string | null)[] = [];\r\n  let node = {nodeId: toNodeId, segmentId: null as string | null};\r\n  while (node) {\r\n    path.unshift(node.segmentId);\r\n    node = previous[node.nodeId];\r\n  }\r\n  return path.filter(Boolean) as string[];\r\n}\r\n","/* eslint-disable no-invalid-this */\r\n/* eslint-disable camelcase */\r\nimport * as utils from './utils';\r\nimport Draw from './Draw';\r\nimport Behavior from './Behavior';\r\nimport Scale from './Scale';\r\nimport * as build from './build';\r\nimport UndoStack from './UndoStack';\r\nimport CallbackManager from './CallbackManager';\r\nimport KeyManager from './KeyManager';\r\nimport Canvas from './Canvas';\r\nimport * as dataStyles from './dataStyles';\r\nimport SearchIndex from './SearchIndex';\r\n\r\nimport bacon from 'baconjs';\r\nimport _ from 'underscore';\r\nimport {BaseType, select as d3Select} from 'd3-selection';\r\nimport {findOutGoing, findInGoing, getReactionPathSegments, findKthShortestPath, pathSeparatorString} from './algo';\r\nimport {Coord, D3Selection, D3SVGSelection, EscherMapDataType, IDType, MapData, MapNode, MapReaction, MapSegment, SettingsType, TextLabel} from './types';\r\nimport Settings from './Settings';\r\nimport ZoomContainer from './ZoomContainer';\r\nimport CobraModel from './CobraModel';\r\n\r\n// interface ZoomContainer {\r\n//   get_size(): { width: number; height: number };\r\n//   goTo(zoom: number, pos: { x: number; y: number }): void;\r\n//   windowScale: number;\r\n//   windowTranslate: { x: number; y: number };\r\n//   _goToSvg(scale: number, translate: { x: number; y: number }, callback: () => void): void;\r\n// }\r\n\r\n\r\ninterface BezierDisplacement {\r\n  reactionId: string;\r\n  segmentId: string;\r\n  bez: string;\r\n  bezierId: string;\r\n  displacement: { x: number; y: number };\r\n}\r\n\r\nfunction _on_array(fn: Function) {\r\n  return function(array: Array<any>) { return fn(...array); };\r\n}\r\n\r\n/**\r\n * Map - Defines the metabolic map data, and manages drawing and building.\r\n * @param svg: The parent SVG container for the map.\r\n * @param css:\r\n * @param selection: A d3 selection for a node to place the map inside.\r\n * @param selection:\r\n * @param zoomContainer:\r\n * @param settings:\r\n * @param cobra_model:\r\n * @param canvas_size_and_loc:\r\n * @param enable_search:\r\n * @param map_name: (Optional, Default: 'new map')\r\n * @param map_id: (Optional, Default: A string of random characters.)\r\n * @param map_description: (Optional, Default: '')\r\n *\r\n * Callbacks\r\n * ---------\r\n *\r\n * map.callback_manager.run('set_status', null, status)\r\n * map.callback_manager.run('toggle_beziers', null, beziers_enabled)\r\n * map.callback_manager.run('select_metabolite_with_id', null, selected_node, coords)\r\n * map.callback_manager.run('select_selectable', null, node_count, selected_node, coords)\r\n * map.callback_manager.run('deselect_nodes')\r\n * map.callback_manager.run('select_text_label')\r\n * map.callback_manager.run('before_svg_export')\r\n * map.callback_manager.run('after_svg_export')\r\n * map.callback_manager.run('before_png_export')\r\n * map.callback_manager.run('after_png_export')\r\n * map.callback_manager.run('before_convert_map')\r\n * map.callback_manager.run('after_convert_map')\r\n * this.callback_manager.run('calc_data_stats__reaction', null, changed)\r\n * this.callback_manager.run('calc_data_stats__metabolite', null, changed)\r\n *\r\n */\r\nexport class EscherMap {\r\n  callback_manager: CallbackManager;\r\n  svg: D3SVGSelection;\r\n  defs: D3Selection<SVGDefsElement>;\r\n  canvas: Canvas;\r\n  sel: D3Selection<Element>;\r\n  zoomContainer: ZoomContainer;\r\n  settings: Settings;\r\n  cobra_model: CobraModel | null;\r\n  reactions: { [key: string]: MapReaction };\r\n  nodes: { [key: string]: MapNode };\r\n  text_labels: { [key: string]: TextLabel };\r\n  largest_ids: {\r\n    reactions: number\r\n    nodes: number\r\n    segments: number\r\n    text_labels: number\r\n  };\r\n  undo_stack: UndoStack;\r\n  behavior: Behavior;\r\n  draw: Draw;\r\n  key_manager: KeyManager;\r\n  enable_search: boolean;\r\n  search_index: SearchIndex;\r\n  map_name: string;\r\n  map_id: string;\r\n  map_description: string;\r\n  beziers_enabled: boolean;\r\n  has_data_on_reactions: boolean;\r\n  has_data_on_nodes: boolean;\r\n  imported_reaction_data: any;\r\n  imported_metabolite_data: any;\r\n  imported_gene_data: any;\r\n  beziers: any;\r\n  data_statistics: any;\r\n  rotation_on: boolean;\r\n  scale: any;\r\n  private _status_timer?: NodeJS.Timeout | null | number;\r\n  last_action: {function: keyof EscherMap, args: any[]} | null = null;\r\n  shortestPathInfo: { hash: string; k: number; } | null = null;\r\n  outGoingInfo: { hash: string; k: number; } | null = null;\r\n  inGoingInfo: { hash: string; k: number; } | null = null;\r\n  // save action that will be set from outside\r\n  //todo: add types here\r\n\r\n  constructor(svg: D3SVGSelection,\r\n    css: string,\r\n    selection: D3Selection<Element>,\r\n    zoomContainer: ZoomContainer,\r\n    settings: Settings,\r\n    cobra_model: CobraModel | null,\r\n    canvas_size_and_loc: { x: number, y: number, width: number, height: number } | null = null,\r\n    enable_search: boolean = false,\r\n    map_name: string = '',\r\n    map_id: string = '',\r\n    map_description: string = '') {\r\n    if (canvas_size_and_loc == null) {\r\n      const size = zoomContainer.get_size();\r\n      canvas_size_and_loc = {\r\n        x: -size.width,\r\n        y: -size.height,\r\n        width: size.width * 3,\r\n        height: size.height * 3\r\n      };\r\n    }\r\n\r\n    if (_.isUndefined(map_name) || map_name == null || map_name === '')\r\n      map_name = 'new_map';\r\n    else\r\n      map_name = String(map_name);\r\n\r\n\r\n    if (_.isUndefined(map_id) || map_id == null || map_id === '')\r\n      map_id = utils.generate_map_id();\r\n    else\r\n      map_id = String(map_id);\r\n\r\n\r\n    if (_.isUndefined(map_description) || map_description == null)\r\n      map_description = '';\r\n    else\r\n      map_description = String(map_description);\r\n\r\n\r\n    // set up the callbacks\r\n    this.callback_manager = new CallbackManager();\r\n\r\n    // set up the defs\r\n    this.svg = svg;\r\n    this.defs = utils.setup_defs(svg as D3Selection<any>, css);\r\n\r\n    // make the canvas\r\n    this.canvas = new Canvas(selection, canvas_size_and_loc);\r\n\r\n    this.setup_containers(selection);\r\n    this.sel = selection;\r\n    this.zoomContainer = zoomContainer;\r\n\r\n    this.settings = settings;\r\n\r\n    // set the model AFTER loading the datasets\r\n    this.cobra_model = cobra_model;\r\n\r\n    this.largest_ids = {\r\n      reactions: -1,\r\n      nodes: -1,\r\n      segments: -1,\r\n      text_labels: -1\r\n    };\r\n\r\n    // make the undo/redo stack\r\n    this.undo_stack = new UndoStack();\r\n\r\n    // make a behavior object\r\n    this.behavior = new Behavior(this, this.undo_stack);\r\n\r\n    // draw manager\r\n    this.draw = new Draw(this.behavior, this.settings, this);\r\n\r\n    // make a key manager\r\n    this.key_manager = new KeyManager();\r\n    this.key_manager.settings = settings;\r\n    this.key_manager.ctrlEqualsCmd = true;\r\n\r\n    // make the search index\r\n    this.enable_search = enable_search;\r\n    this.search_index = new SearchIndex();\r\n\r\n    // map properties\r\n    this.map_name = map_name;\r\n    this.map_id = map_id;\r\n    this.map_description = map_description;\r\n\r\n    // deal with the window\r\n    const window_translate = {x: 0, y: 0};\r\n    const window_scale = 1;\r\n\r\n    // hide beziers\r\n    this.beziers_enabled = false;\r\n\r\n    // data\r\n    this.has_data_on_reactions = false;\r\n    this.has_data_on_nodes = false;\r\n    this.imported_reaction_data = null;\r\n    this.imported_metabolite_data = null;\r\n    this.imported_gene_data = null;\r\n\r\n    this.nodes = {};\r\n    this.reactions = {};\r\n    this.beziers = {};\r\n    this.text_labels = {};\r\n\r\n    // Update data with null to populate data-specific attributes. Also calculates\r\n    // data stats for the first time.\r\n    this.apply_reaction_data_to_map(null);\r\n    this.apply_metabolite_data_to_map(null);\r\n    this.apply_gene_data_to_map(null);\r\n\r\n    // make the scales\r\n    this.scale = new Scale();\r\n    // initialize stats\r\n    this.scale.connectToSettings(this.settings, this, this.get_data_statistics.bind(this));\r\n\r\n    // rotation mode off\r\n    this.rotation_on = false;\r\n  }\r\n\r\n  /**\r\n   * Load a json map and add necessary fields for rendering.\r\n   */\r\n  static from_data(map_data: EscherMapDataType, svg: D3SVGSelection, css: string, selection: D3Selection, zoomContainer: ZoomContainer, settings: Settings,\r\n    cobra_model: CobraModel | null, enable_search: boolean = false): EscherMap {\r\n    const canvas = map_data[1].canvas;\r\n    const map_name = map_data[0].map_name;\r\n    const map_id = map_data[0].map_id;\r\n    const map_description = (map_data[0].map_description.replace(/(\\nLast Modified.*)+$/g, '') +\r\n                           '\\nLast Modified ' + new Date(Date.now()).toString());\r\n    const map = new EscherMap(svg, css, selection, zoomContainer, settings, cobra_model,\r\n      canvas, enable_search, map_name, map_id, map_description);\r\n\r\n    map.reactions = map_data[1].reactions;\r\n    map.nodes = map_data[1].nodes;\r\n    map.text_labels = map_data[1].text_labels;\r\n\r\n    for (const n_id in map.nodes) {\r\n      const node = map.nodes[n_id];\r\n\r\n      // clear all the connected segments\r\n      node.connected_segments = [];\r\n\r\n      //  populate the nodes search index.\r\n      if (enable_search) {\r\n        if (node.node_type !== 'metabolite') continue;\r\n        map.search_index.insert('n' + n_id, {name: node.bigg_id,\r\n          data: {type: 'metabolite',\r\n            node_id: n_id}});\r\n        map.search_index.insert('n_name' + n_id, {name: node.name,\r\n          data: {type: 'metabolite',\r\n            node_id: n_id}});\r\n      }\r\n    }\r\n\r\n    // Propagate coefficients and reversibility, build the connected\r\n    // segments, add bezier points, and populate the reaction search index.\r\n    for (const r_id in map.reactions) {\r\n      const reaction = map.reactions[r_id];\r\n\r\n      // reaction search index\r\n      if (enable_search) {\r\n        map.search_index.insert('r' + r_id,\r\n          {'name': reaction.bigg_id,\r\n            'data': {type: 'reaction',\r\n              reaction_id: r_id}});\r\n        map.search_index.insert('r_name' + r_id,\r\n          {'name': reaction.name,\r\n            'data': {type: 'reaction',\r\n              reaction_id: r_id}});\r\n        for (const g_id in reaction.genes) {\r\n          const gene = reaction.genes[g_id];\r\n          map.search_index.insert('r' + r_id + '_g' + g_id,\r\n            {'name': gene.bigg_id,\r\n              'data': {type: 'reaction',\r\n                reaction_id: r_id}});\r\n          map.search_index.insert('r' + r_id + '_g_name' + g_id,\r\n            {'name': gene.name,\r\n              'data': {type: 'reaction',\r\n                reaction_id: r_id}});\r\n        }\r\n      }\r\n\r\n      // keep track of any bad segments\r\n      const segments_to_delete = [];\r\n      for (const s_id in reaction.segments) {\r\n        const segment = reaction.segments[s_id];\r\n\r\n        // propagate reversibility\r\n        segment.reversibility = reaction.reversibility;\r\n\r\n        // if there is an error with to_ or from_ nodes, remove this segment\r\n        if (!(segment.from_node_id in map.nodes) || !(segment.to_node_id in map.nodes)) {\r\n          console.warn('Bad node references in segment ' + s_id + '. Deleting segment.');\r\n          segments_to_delete.push(s_id);\r\n          continue;\r\n        }\r\n\r\n        const from_node = map.nodes[segment.from_node_id];\r\n        const to_node = map.nodes[segment.to_node_id];\r\n\r\n        // propagate coefficients\r\n        reaction.metabolites.forEach(function(met) {\r\n          if (met.bigg_id === from_node.bigg_id)\r\n            segment.from_node_coefficient = met.coefficient;\r\n          else if (met.bigg_id === to_node.bigg_id)\r\n            segment.to_node_coefficient = met.coefficient;\r\n        })\r\n\r\n        // build connected segments\r\n        ;[from_node, to_node].forEach(function(node) {\r\n          node.connected_segments.push({segment_id: s_id,\r\n            reaction_id: r_id});\r\n        });\r\n\r\n        // If the metabolite has no bezier points, then add them.\r\n        const start = map.nodes[segment.from_node_id];\r\n        const end = map.nodes[segment.to_node_id];\r\n        if (start['node_type'] == 'metabolite' || end['node_type'] == 'metabolite') {\r\n          const midpoint = utils.c_plus_c(start, utils.c_times_scalar(utils.c_minus_c(end, start)!, 0.5));\r\n          if (segment.b1 == null) segment.b1 = midpoint;\r\n          if (segment.b2 == null) segment.b2 = midpoint;\r\n        }\r\n      }\r\n      // delete the bad segments\r\n      segments_to_delete.forEach(function(s_id) {\r\n        delete reaction.segments[s_id];\r\n      });\r\n    }\r\n\r\n    // add text_labels to the search index\r\n    if (enable_search) {\r\n      for (const label_id in map.text_labels) {\r\n        const label = map.text_labels[label_id];\r\n        map.search_index.insert('l' + label_id, {'name': label.text,\r\n          'data': {type: 'text_label',\r\n            text_label_id: label_id}});\r\n      }\r\n    }\r\n\r\n    // populate the beziers\r\n    map.beziers = build.newBeziersForReactions(map.reactions);\r\n\r\n    // get largest ids for adding new reactions, nodes, text labels, and\r\n    // segments\r\n    map.largest_ids.reactions = get_largest_id(map.reactions);\r\n    map.largest_ids.nodes = get_largest_id(map.nodes);\r\n    map.largest_ids.text_labels = get_largest_id(map.text_labels);\r\n\r\n    let largest_segment_id = 0;\r\n    for (const id in map.reactions) {\r\n      largest_segment_id = get_largest_id(map.reactions[id].segments,\r\n        largest_segment_id);\r\n    }\r\n    map.largest_ids.segments = largest_segment_id;\r\n\r\n    // update data with null to populate data-specific attributes\r\n    map.apply_reaction_data_to_map(null);\r\n    map.apply_metabolite_data_to_map(null);\r\n    map.apply_gene_data_to_map(null);\r\n\r\n    return map;\r\n\r\n    /**\r\n     * Return the largest integer key in obj, or current_largest, whichever is\r\n     * bigger.\r\n     */\r\n    function get_largest_id(obj: any, current_largest?: number) {\r\n      if (_.isUndefined(current_largest)) current_largest = 0;\r\n      if (_.isUndefined(obj)) return current_largest;\r\n      return Math.max.apply(null, Object.keys(obj).map(function(x) {\r\n        return parseInt(x);\r\n      }).concat([current_largest]));\r\n    }\r\n  }\r\n\r\n  // ---------------------------------------------------------------------\r\n  // more setup\r\n  // ---------------------------------------------------------------------\r\n\r\n  setup_containers(sel: D3Selection) {\r\n    sel.append('g')\r\n      .attr('id', 'reactions');\r\n    sel.append('g')\r\n      .attr('id', 'nodes');\r\n    sel.append('g')\r\n      .attr('id', 'beziers');\r\n    sel.append('g')\r\n      .attr('id', 'text-labels');\r\n  }\r\n\r\n  reset_containers() {\r\n    this.sel.select('#reactions')\r\n      .selectAll('.reaction')\r\n      .remove();\r\n    this.sel.select('#nodes')\r\n      .selectAll('.node')\r\n      .remove();\r\n    this.sel.select('#beziers')\r\n      .selectAll('.bezier')\r\n      .remove();\r\n    this.sel.select('#text-labels')\r\n      .selectAll('.text-label')\r\n      .remove();\r\n  }\r\n\r\n  // -------------------------------------------------------------------------\r\n  // Appearance\r\n  // -------------------------------------------------------------------------\r\n\r\n  /** Set the status of the map, with an optional expiration\r\n      time. Rendering the status is taken care of by the Builder.\r\n\r\n      Arguments\r\n      ---------\r\n\r\n      status: The status string.\r\n\r\n      time: An optional time, in ms, after which the status is set to ''.\r\n\r\n  */\r\n\r\n  set_status(status: string | null, time?: number) {\r\n    this.callback_manager.run('set_status', null, status);\r\n    // clear any other timers on the status bar\r\n    if (this._status_timer)\r\n      clearTimeout(this._status_timer);\r\n    this._status_timer = null;\r\n\r\n    if (time !== undefined) {\r\n      this._status_timer = setTimeout(() => {\r\n        this.callback_manager.run('set_status', null, '');\r\n      }, time);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear the map data\r\n   */\r\n  clearMapData() {\r\n    this.reactions = {};\r\n    this.beziers = {};\r\n    this.nodes = {};\r\n    this.text_labels = {};\r\n    this.map_name = 'new_map';\r\n    this.map_id = utils.generate_map_id();\r\n    this.map_description = '';\r\n  }\r\n\r\n  has_cobra_model() {\r\n    return (this.cobra_model !== null);\r\n  }\r\n\r\n  /**\r\n   * Draw the all reactions, nodes, & text labels.\r\n   */\r\n  draw_everything() {\r\n    this.draw_all_reactions(true, true); // also draw beziers\r\n    this.draw_all_nodes(true);\r\n    this.draw_all_text_labels();\r\n    this.unhighlightShortestPaths();\r\n  }\r\n\r\n  /** Draw all reactions, and clear deleted reactions.\r\n\r\n      Arguments\r\n      ---------\r\n\r\n      draw_beziers: (Boolean, default True) Whether to also draw the bezier\r\n      control points.\r\n\r\n      clear_deleted: (Optional, Default: true) Boolean, if true, then also\r\n      clear deleted nodes.\r\n\r\n  */\r\n  draw_all_reactions(draw_beziers: boolean, clear_deleted: boolean) {\r\n    if (_.isUndefined(draw_beziers)) draw_beziers = true;\r\n    if (_.isUndefined(clear_deleted)) clear_deleted = true;\r\n\r\n    // Draw all reactions.\r\n    const reaction_ids = [];\r\n    for (const reaction_id in this.reactions)\r\n      reaction_ids.push(reaction_id);\r\n\r\n    // If draw_beziers is true, just draw them all, rather than deciding\r\n    // which ones to draw.\r\n    this.draw_these_reactions(reaction_ids, false);\r\n    if (draw_beziers && this.beziers_enabled)\r\n      this.draw_all_beziers();\r\n\r\n    // Clear all deleted reactions.\r\n    if (clear_deleted)\r\n      this.clear_deleted_reactions(draw_beziers);\r\n  }\r\n\r\n  /**\r\n   * Draw specific reactions. Does nothing with exit selection. Use\r\n   * clear_deleted_reactions to remove reactions from the DOM.\r\n   * reactions_ids: An array of reaction_ids to update.\r\n   * draw_beziers: (Boolean, default True) Whether to also draw the bezier control\r\n   * points.\r\n   */\r\n  draw_these_reactions(reaction_ids: string[], draw_beziers?: boolean) {\r\n    if (_.isUndefined(draw_beziers)) draw_beziers = true;\r\n\r\n    // find reactions for reaction_ids\r\n    const reaction_subset = utils.object_slice_for_ids_ref(this.reactions,\r\n      reaction_ids);\r\n\r\n    // function to update reactions\r\n    const update_fn = (sel: D3Selection) => {\r\n      return this.draw.update_reaction(sel, this.scale, this.cobra_model,\r\n        this.nodes, this.defs,\r\n        this.has_data_on_reactions);\r\n    };\r\n\r\n    // draw the reactions\r\n    utils.draw_an_object(this.sel, '#reactions', '.reaction', reaction_subset,\r\n      'reaction_id', this.draw.create_reaction.bind(this.draw),\r\n      update_fn);\r\n\r\n    if (draw_beziers) {\r\n      // particular beziers to draw\r\n      const bezier_ids = build.bezierIdsForReactionIds(reaction_subset);\r\n      this.draw_these_beziers(bezier_ids);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Remove any reactions that are not in *this.reactions*.\r\n   * draw_beziers: (Boolean, default True) Whether to also clear deleted bezier\r\n   * control points.\r\n   */\r\n  clear_deleted_reactions(draw_beziers?: boolean) {\r\n    if (_.isUndefined(draw_beziers)) draw_beziers = true;\r\n\r\n    // Remove deleted reactions and segments\r\n    utils.draw_an_object(\r\n      this.sel, '#reactions', '.reaction', this.reactions, 'reaction_id', null,\r\n      function(update_selection: D3Selection<any>) {\r\n        // Draw segments\r\n        utils.draw_a_nested_object(\r\n          update_selection, '.segment-group', 'segments', 'segment_id', null,\r\n          null, function(sel: any) { sel.remove(); }\r\n        );\r\n      },\r\n      function(sel: D3Selection) {\r\n        sel.remove();\r\n      }\r\n    );\r\n\r\n    if (draw_beziers === true)\r\n      this.clear_deleted_beziers();\r\n  }\r\n\r\n  /**\r\n   * Draw all nodes, and clear deleted nodes.\r\n   * @param clear_deleted: (Optional, Default: true) Boolean, if true, then also\r\n   * @param clear deleted nodes.\r\n   */\r\n  draw_all_nodes(clear_deleted?: boolean) {\r\n    if (clear_deleted == undefined) clear_deleted = true;\r\n\r\n    const node_ids = [];\r\n    for (const node_id in this.nodes)\r\n      node_ids.push(node_id);\r\n\r\n    this.draw_these_nodes(node_ids);\r\n\r\n    // clear the deleted nodes\r\n    if (clear_deleted)\r\n      this.clear_deleted_nodes();\r\n  }\r\n\r\n  /** Draw specific nodes.\r\n\r\n      Does nothing with exit selection. Use clear_deleted_nodes to remove\r\n      nodes from the DOM.\r\n\r\n      Arguments\r\n      ---------\r\n\r\n      nodes_ids: An array of node_ids to update.\r\n\r\n  */\r\n  draw_these_nodes(node_ids: IDType[]) {\r\n    // find reactions for reaction_ids\r\n    const node_subset = utils.object_slice_for_ids_ref(this.nodes, node_ids);\r\n\r\n    // functions to create and update nodes\r\n    const create_fn = (sel: D3Selection) => {\r\n      return this.draw.create_node(sel,\r\n        this.nodes,\r\n        this.reactions);\r\n    };\r\n    const update_fn = (sel: D3Selection) => {\r\n      return this.draw.update_node(sel,\r\n        this.scale,\r\n        this.has_data_on_nodes,\r\n        this.behavior.selectableMousedown,\r\n        this.behavior.selectableClick,\r\n        this.behavior.nodeMouseover,\r\n        this.behavior.nodeMouseout,\r\n        this.behavior.selectableDrag,\r\n        this.behavior.nodeLabelDrag);\r\n    };\r\n\r\n    // draw the nodes\r\n    utils.draw_an_object(this.sel, '#nodes', '.node', node_subset, 'node_id',\r\n      create_fn, update_fn);\r\n  }\r\n\r\n  /**\r\n   * Remove any nodes that are not in *this.nodes*.\r\n   */\r\n  clear_deleted_nodes() {\r\n    // Run remove for exit selection\r\n    utils.draw_an_object(this.sel, '#nodes', '.node', this.nodes, 'node_id',\r\n      null, null, function(sel: D3Selection) { sel.remove(); });\r\n  }\r\n\r\n  /**\r\n   * Draw all text_labels.\r\n   */\r\n  draw_all_text_labels() {\r\n    this.draw_these_text_labels(Object.keys(this.text_labels));\r\n\r\n    // Clear all deleted text_labels\r\n    this.clear_deleted_text_labels();\r\n  }\r\n\r\n  /**\r\n   * Draw specific text_labels. Does nothing with exit selection. Use\r\n   * clear_deleted_text_labels to remove text_labels from the DOM.\r\n   * @param {Array} text_labels_ids - An array of text_label_ids to update.\r\n   */\r\n  draw_these_text_labels(text_label_ids: IDType[]) {\r\n    // Find reactions for reaction_ids\r\n    const text_label_subset = utils.object_slice_for_ids_ref(this.text_labels, text_label_ids);\r\n\r\n    // Draw the text_labels\r\n    utils.draw_an_object(this.sel, '#text-labels', '.text-label',\r\n      text_label_subset, 'text_label_id',\r\n      this.draw.create_text_label.bind(this.draw),\r\n      this.draw.update_text_label.bind(this.draw));\r\n  }\r\n\r\n  /**\r\n   * Remove any text_labels that are not in *this.text_labels*.\r\n   */\r\n  clear_deleted_text_labels() {\r\n    utils.draw_an_object(this.sel, '#text-labels', '.text-label',\r\n      this.text_labels, 'text_label_id', null, null,\r\n      function(sel: D3Selection) { sel.remove(); });\r\n  }\r\n\r\n  /**\r\n   * Draw all beziers, and clear deleted reactions.\r\n   */\r\n  draw_all_beziers() {\r\n    const bezier_ids = [];\r\n    for (const bezier_id in this.beziers)\r\n      bezier_ids.push(bezier_id);\r\n\r\n    this.draw_these_beziers(bezier_ids);\r\n\r\n    // clear delete beziers\r\n    this.clear_deleted_beziers();\r\n  }\r\n\r\n  draw_these_beziers(bezier_ids: IDType[]) {\r\n    /** Draw specific beziers.\r\n\r\n        Does nothing with exit selection. Use clear_deleted_beziers to remove\r\n        beziers from the DOM.\r\n\r\n        Arguments\r\n        ---------\r\n\r\n        beziers_ids: An array of bezier_ids to update.\r\n\r\n    */\r\n    // find reactions for reaction_ids\r\n    const bezier_subset = utils.object_slice_for_ids_ref(this.beziers, bezier_ids);\r\n\r\n    // function to update beziers\r\n    const update_fn = (sel: D3Selection) => {\r\n      return this.draw.update_bezier(sel,\r\n        this.beziers_enabled,\r\n        this.behavior.bezierDrag,\r\n        this.behavior.bezierMouseover,\r\n        this.behavior.bezierMouseout,\r\n        this.nodes,\r\n        this.reactions);\r\n    };\r\n\r\n    // draw the beziers\r\n    utils.draw_an_object(this.sel, '#beziers', '.bezier', bezier_subset,\r\n      'bezier_id', this.draw.create_bezier.bind(this.draw),\r\n      update_fn);\r\n  }\r\n\r\n  clear_deleted_beziers() {\r\n    /** Remove any beziers that are not in *this.beziers*.\r\n\r\n     */\r\n    // remove deleted\r\n    utils.draw_an_object(this.sel, '#beziers', '.bezier', this.beziers,\r\n      'bezier_id', null, null,\r\n      function(sel: D3Selection) { sel.remove(); });\r\n  }\r\n\r\n  show_beziers() {\r\n    this.toggle_beziers(true);\r\n  }\r\n\r\n  hide_beziers() {\r\n    this.toggle_beziers(false);\r\n  }\r\n\r\n  toggle_beziers(on_off?: boolean) {\r\n    if (_.isUndefined(on_off)) this.beziers_enabled = !this.beziers_enabled;\r\n    else this.beziers_enabled = on_off;\r\n    this.draw_all_beziers();\r\n    this.callback_manager.run('toggle_beziers', null, this.beziers_enabled);\r\n  }\r\n\r\n  /**\r\n   * Returns True if the scale has changed.\r\n   * @param {Array} keys - (Optional) The keys in reactions to apply data to.\r\n   */\r\n  apply_reaction_data_to_map(data: { [key: string]: (number | string | null)[] }, keys?: any) {\r\n    const styles = this.settings.get('reaction_styles');\r\n    const compareStyle = this.settings.get('reaction_compare_style');\r\n    const hasData = dataStyles.apply_reaction_data_to_reactions(\r\n      this.reactions,\r\n      data,\r\n      styles,\r\n      compareStyle,\r\n      keys\r\n    );\r\n    this.has_data_on_reactions = hasData;\r\n    this.imported_reaction_data = hasData ? data : null;\r\n\r\n    return this.calc_data_stats('reaction');\r\n  }\r\n\r\n  /**\r\n   * Returns True if the scale has changed.\r\n   * @param {Array} keys - (Optional) The keys in nodes to apply data to.\r\n   */\r\n  apply_metabolite_data_to_map(data: { [key: string]: (number | string | null)[] }, keys?: any) {\r\n    const styles = this.settings.get('metabolite_styles');\r\n    const compare_style = this.settings.get('metabolite_compare_style');\r\n\r\n    const has_data = dataStyles.apply_metabolite_data_to_nodes(this.nodes,\r\n      data, styles,\r\n      compare_style,\r\n      keys);\r\n    this.has_data_on_nodes = has_data;\r\n    this.imported_metabolite_data = has_data ? data : null;\r\n\r\n    return this.calc_data_stats('metabolite');\r\n  }\r\n\r\n  /**\r\n   * Returns True if the scale has changed.\r\n   * gene_data_obj: The gene data object, with the following style:\r\n   * { reaction_id: { rule: 'rule_string', genes: { gene_id: value } } }\r\n   * @param {Array} keys - (Optional) The keys in reactions to apply data to.\r\n   */\r\n  apply_gene_data_to_map(gene_data_obj: any, keys?: any) {\r\n    const styles = this.settings.get('reaction_styles');\r\n    const compare_style = this.settings.get('reaction_compare_style');\r\n    const identifiers_on_map = this.settings.get('identifiers_on_map');\r\n    const and_method_in_gene_reaction_rule = this.settings.get('and_method_in_gene_reaction_rule');\r\n\r\n    const has_data = dataStyles.apply_gene_data_to_reactions(this.reactions, gene_data_obj,\r\n      styles, identifiers_on_map,\r\n      compare_style,\r\n      and_method_in_gene_reaction_rule,\r\n      keys);\r\n    this.has_data_on_reactions = has_data;\r\n    this.imported_gene_data = has_data ? gene_data_obj : null;\r\n\r\n    return this.calc_data_stats('reaction');\r\n  }\r\n\r\n  // ------------------------------------------------\r\n  // Data domains\r\n  // ------------------------------------------------\r\n\r\n  get_data_statistics() {\r\n    return this.data_statistics;\r\n  }\r\n\r\n  /**\r\n   * Returns True if the stats have changed.\r\n   * @param {String} type - Either 'metabolite' or 'reaction'\r\n   */\r\n  calc_data_stats(type: string) {\r\n    if (['reaction', 'metabolite'].indexOf(type) === -1)\r\n      throw new Error('Bad type ' + type);\r\n\r\n\r\n    // make the data structure\r\n    if (!this.data_statistics) {\r\n      this.data_statistics = {};\r\n      this.data_statistics[type] = null;\r\n    } else if (!(type in this.data_statistics))\r\n      this.data_statistics[type] = null;\r\n\r\n\r\n    // default min and max\r\n    const vals: any[] = [];\r\n    if (type === 'metabolite') {\r\n      for (const node_id in this.nodes) {\r\n        const node = this.nodes[node_id];\r\n        // check number\r\n        if (_.isUndefined(node.data))\r\n          console.error('metabolite missing ');\r\n        else if (node.data !== null)\r\n          vals.push(node.data);\r\n      }\r\n    } else if (type == 'reaction') {\r\n      for (const reaction_id in this.reactions) {\r\n        const reaction = this.reactions[reaction_id];\r\n        // check number\r\n        if (_.isUndefined(reaction.data))\r\n          console.error('reaction data missing ');\r\n        else if (reaction.data !== null)\r\n          vals.push(reaction.data);\r\n      }\r\n    }\r\n\r\n    // If no vals, then set to null\r\n    if (vals.length === 0) {\r\n      const wasNull = this.data_statistics[type] == null;\r\n      this.data_statistics[type] = null;\r\n      if (type === 'reaction')\r\n        this.callback_manager.run('calc_data_stats__reaction', null, !wasNull);\r\n      else\r\n        this.callback_manager.run('calc_data_stats__metabolite', null, !wasNull);\r\n\r\n      return !wasNull; // true means did change which means was not null\r\n    }\r\n\r\n    // If there are vals and it was previously null, then create an object\r\n    if (this.data_statistics[type] == null)\r\n      this.data_statistics[type] = {};\r\n\r\n\r\n    let same = true;\r\n\r\n    // calculate these statistics\r\n    const quartiles = utils.quartiles(vals);\r\n    const funcs = [\r\n      ['min', _on_array(Math.min)],\r\n      ['max', _on_array(Math.max)],\r\n      ['mean', utils.mean],\r\n      ['Q1', function() { return quartiles[0]; }],\r\n      ['median', function() { return quartiles[1]; }],\r\n      ['Q3', function() { return quartiles[2]; }],\r\n    ];\r\n    funcs.forEach((ar) => {\r\n      let new_val;\r\n      const name = ar[0];\r\n      if (vals.length === 0)\r\n        new_val = null;\r\n      else {\r\n        const fn = ar[1] as (array: number[]) => number;\r\n        new_val = fn(vals as number[]);\r\n      }\r\n      if (new_val != this.data_statistics[type][name as any])\r\n        same = false;\r\n\r\n      this.data_statistics[type][name as any] = new_val;\r\n    });\r\n\r\n    // Deal with max === min\r\n    if (this.data_statistics[type]['min'] === this.data_statistics[type]['max'] &&\r\n        this.data_statistics[type]['min'] !== null) {\r\n      const min = this.data_statistics[type]['min'];\r\n      const max = this.data_statistics[type]['max'];\r\n      this.data_statistics[type]['min'] = min - 1 - (Math.abs(min) * 0.1);\r\n      this.data_statistics[type]['max'] = max + 1 + (Math.abs(max) * 0.1);\r\n    }\r\n\r\n    if (type === 'reaction')\r\n      this.callback_manager.run('calc_data_stats__reaction', null, !same);\r\n    else\r\n      this.callback_manager.run('calc_data_stats__metabolite', null, !same);\r\n\r\n    return !same;\r\n  }\r\n\r\n  // ---------------------------------------------------------------------\r\n  // Node interaction\r\n  // ---------------------------------------------------------------------\r\n\r\n  get_coords_for_node(node_id: IDType) {\r\n    const node = this.nodes[node_id];\r\n    const coords = node ? {x: node.x, y: node.y} : null;\r\n    return coords;\r\n  }\r\n\r\n  get_selected_node_ids() {\r\n    const selected_node_ids: IDType[] = [];\r\n    this.sel.select('#nodes')\r\n      .selectAll('.selected')\r\n      .each((d: any) => { selected_node_ids.push(d.node_id); });\r\n    return selected_node_ids;\r\n  }\r\n\r\n  getSelectedNodes() {\r\n    const selected_nodes: {[key: IDType]: MapNode} = {};\r\n    this.sel.select('#nodes')\r\n      .selectAll('.selected')\r\n      .each((d: any) => {\r\n        selected_nodes[d.node_id] = this.nodes[d.node_id];\r\n      });\r\n    return selected_nodes;\r\n  }\r\n\r\n  get_selected_text_label_ids() {\r\n    const selected_text_label_ids: IDType[] = [];\r\n    this.sel.select('#text-labels')\r\n      .selectAll('.selected')\r\n      .each(function(d: any) { selected_text_label_ids.push(d.text_label_id); });\r\n    return selected_text_label_ids;\r\n  }\r\n\r\n  get_selected_text_labels() {\r\n    const selected_text_labels: Record<IDType, TextLabel> = {};\r\n    this.sel.select('#text-labels')\r\n      .selectAll('.selected')\r\n      .each((d: any) => {\r\n        selected_text_labels[d.text_label_id] = this.text_labels[d.text_label_id];\r\n      });\r\n    return selected_text_labels;\r\n  }\r\n\r\n  select_all() {\r\n    /** Select all nodes and text labels.\r\n\r\n     */\r\n    this.sel.selectAll('#nodes,#text-labels')\r\n      .selectAll('.node,.text-label')\r\n      .classed('selected', true);\r\n  }\r\n\r\n  select_none() {\r\n    /** Deselect all nodes and text labels.\r\n\r\n     */\r\n    this.sel.selectAll('.selected')\r\n      .classed('selected', false);\r\n  }\r\n\r\n  invert_selection() {\r\n    /** Invert selection of nodes and text labels.\r\n\r\n     */\r\n    const selection = this.sel.selectAll('#nodes,#text-labels')\r\n      .selectAll('.node,.text-label');\r\n    selection.classed('selected', function() {\r\n      return !d3Select(this).classed('selected');\r\n    });\r\n  }\r\n\r\n  select_metabolite_with_id(node_id: IDType) {\r\n    /** Select a metabolite with the given id, and turn off the reaction\r\n        target.\r\n\r\n    */\r\n    // deselect all text labels\r\n    this.deselect_text_labels();\r\n\r\n    const node_selection = this.sel.select('#nodes').selectAll('.node');\r\n    let coords;\r\n    let selected_node;\r\n    node_selection.classed('selected', (d: any) => {\r\n      const selected = String(d.node_id) == String(node_id);\r\n      if (selected) {\r\n        selected_node = d;\r\n        coords = {x: d.x, y: d.y};\r\n      }\r\n      return selected;\r\n    });\r\n    this.sel.selectAll('.start-reaction-target').style('visibility', 'hidden');\r\n    this.callback_manager.run('select_metabolite_with_id', null, selected_node, coords);\r\n  }\r\n\r\n  select_selectable(node: BaseType, _d: any, shift_key_on?: boolean) {\r\n    /** Select a metabolite or text label, and manage the shift key. */\r\n    shift_key_on = _.isUndefined(shift_key_on) ? false : shift_key_on;\r\n    const classable_selection = this.sel.selectAll('#nodes,#text-labels')\r\n      .selectAll('.node,.text-label');\r\n    let classable_node;\r\n    if (d3Select(node).attr('class').indexOf('text-label') == -1) {\r\n      // node\r\n      //@ts-ignore\r\n      classable_node = node!.parentNode;\r\n    } else {\r\n      // text-label\r\n      classable_node = node;\r\n    }\r\n    // toggle selection\r\n    if (shift_key_on) {\r\n      // toggle this node\r\n      d3Select(classable_node)\r\n        .classed('selected', !d3Select(classable_node).classed('selected'));\r\n    } else {\r\n      // unselect all other nodes, and select this one\r\n      classable_selection.classed('selected', false);\r\n      d3Select(classable_node).classed('selected', true);\r\n    }\r\n    // run the select_metabolite callback\r\n    const selected_nodes = this.sel.select('#nodes').selectAll('.selected');\r\n    let node_count = 0;\r\n    let coords;\r\n    let selected_node;\r\n    selected_nodes.each(function(d: any) {\r\n      selected_node = d;\r\n      coords = {x: d.x, y: d.y};\r\n      node_count++;\r\n    });\r\n    this.callback_manager.run('select_selectable', null, node_count, selected_node, coords);\r\n  }\r\n\r\n  /**\r\n   * Unselect all but one selected node, and return the node. If no nodes are\r\n   * selected, return null.\r\n   */\r\n  select_single_node(): MapNode | null {\r\n    let out = null;\r\n    const node_selection = this.sel.select('#nodes').selectAll('.selected');\r\n    node_selection.classed('selected', function(d, i) {\r\n      if (i === 0) {\r\n        out = d;\r\n        return true;\r\n      } else\r\n        return false;\r\n    });\r\n    return out;\r\n  }\r\n\r\n  deselect_nodes() {\r\n    const node_selection = this.sel.select('#nodes').selectAll('.node');\r\n    node_selection.classed('selected', false);\r\n    this.callback_manager.run('deselect_nodes');\r\n  }\r\n\r\n  select_text_label(sel: D3Selection, d: any) {\r\n    // deselect all nodes\r\n    this.deselect_nodes();\r\n    // Find the new selection. Ignore shift key and only allow single selection\r\n    // for now.\r\n    const text_label_selection = this.sel.select('#text-labels').selectAll('.text-label');\r\n    text_label_selection.classed('selected', function(p) { return d === p; });\r\n    const selected_text_labels = this.sel.select('#text-labels').selectAll('.selected');\r\n    let coords;\r\n    selected_text_labels.each(function(d: any) {\r\n      coords = {x: d.x, y: d.y};\r\n    });\r\n    this.callback_manager.run('select_text_label');\r\n  }\r\n\r\n  deselect_text_labels() {\r\n    const text_label_selection = this.sel.select('#text-labels').selectAll('.text-label');\r\n    text_label_selection.classed('selected', false);\r\n  }\r\n\r\n\r\n  /**\r\n   * Align selected nodes and/or reactions vertically. Undoable.\r\n   */\r\n  align_vertical() {\r\n    return this._align(false);\r\n  }\r\n\r\n  /**\r\n   * Align selected nodes and/or reactions horizontally. Undoable\r\n   */\r\n  align_horizontal() {\r\n    return this._align(true);\r\n  }\r\n\r\n  /**\r\n   * Generic function for aligning nodes.\r\n   * @param {Boolean} isHorizontal - If true, align horizontal; else vertical.\r\n   */\r\n  _align(isHorizontal?: boolean) {\r\n    const selected = this.getSelectedNodes();\r\n    // Get markers and primary nodes\r\n    const markersAndPrimary = _.pick(\r\n      selected,\r\n      (node) => node.node_type !== 'metabolite' || !!node.node_is_primary\r\n    );\r\n\r\n    // 1. generally operates on markers and primary nodes, bringing along\r\n    // unconnected secondary nodes and beziers\r\n    // 2. if only selected secondary nodes, then align those\r\n    const alignByPrimary = Object.keys(markersAndPrimary).length > 0;\r\n    const toAlign = alignByPrimary ? markersAndPrimary : selected;\r\n    const keysToAlign = Object.keys(toAlign);\r\n\r\n    // Get new x location\r\n    const mean = keysToAlign.reduce((accum, val) => {\r\n      return accum + (isHorizontal ? toAlign[val]!.y : toAlign[val]!.x);\r\n    }, 0) / keysToAlign.length;\r\n\r\n    // Align. Remember displacements for undo/redo.\r\n    const displacements = _.pairs(toAlign).map(([nodeId, node]) => ({\r\n      nodeId,\r\n      displacement: isHorizontal ? {x: 0, y: mean - node!.y} : {x: mean - node!.x, y: 0}\r\n    }));\r\n    const bezierDisplacements: BezierDisplacement[] = [];\r\n    const movedSecondaryNodes: { [key: string]: boolean } = {};\r\n\r\n    // Align unconnected secondary metabolites\r\n    if (alignByPrimary) {\r\n      _.mapObject(toAlign, (node, nodeId) => {\r\n        if (!node) return;\r\n        node.connected_segments.map((segmentLink) => {\r\n          // get each connected node\r\n          const segmentId = segmentLink.segment_id;\r\n          const reactionId = segmentLink.reaction_id;\r\n          const segment = this.reactions[reactionId].segments[segmentId];\r\n          const isToNode = segment.to_node_id === node.node_id;\r\n          const otherNodeId = isToNode ? segment.from_node_id : segment.to_node_id;\r\n          const otherNode = this.nodes[otherNodeId];\r\n          if (!otherNode) return;\r\n          const bez = isToNode ? 'b2' : 'b1';\r\n\r\n          // align this side bezier if the other node is selected (and that node\r\n          // will handle its bezier)\r\n          if (otherNode.node_id! in selected && segment[bez]) {\r\n            const bezierId = build.bezierIdForSegmentId(segmentId, bez);\r\n            bezierDisplacements.push({\r\n              reactionId,\r\n              segmentId,\r\n              bez,\r\n              bezierId,\r\n              displacement: (isHorizontal ?\r\n                {x: 0, y: node.y - segment[bez].y} :\r\n                {x: node.x - segment[bez].x, y: 0})\r\n            });\r\n\r\n            // If the node is secondary and unconnected, then move it along with\r\n            // the current node.\r\n            if (otherNode.node_type === 'metabolite' &&\r\n                !otherNode.node_is_primary &&\r\n                !(otherNodeId in movedSecondaryNodes)) {\r\n              // If all the connected segments are connected to selected nodes, then move it\r\n              const connected = otherNode.connected_segments.filter((segmentLink) => {\r\n                const segment = this.reactions[reactionId].segments[segmentId];\r\n                const isToNode = segment.to_node_id === otherNode.node_id;\r\n                return isToNode ? segment.from_node_id in selected : segment.to_node_id in selected;\r\n              });\r\n              if (otherNode.connected_segments.length <= connected.length) {\r\n                // then move it with the same displacement as the parent\r\n                displacements.push({\r\n                  nodeId: otherNodeId,\r\n                  displacement: isHorizontal ? {x: 0, y: mean - node.y} : {x: mean - node.x, y: 0}\r\n                });\r\n                // remember not to move this again\r\n                movedSecondaryNodes[otherNodeId] = true;\r\n              }\r\n            }\r\n          }\r\n        });\r\n      });\r\n    }\r\n\r\n    // reusable movement function for aligning and undo/redo\r\n    const _moveNodes = (disps: { nodeId: string; displacement: { x: number; y: number } }[], bezDisps: { reactionId: string; segmentId: string; bez: string; bezierId: string; displacement: { x: number; y: number } }[]) => {\r\n      let reactionIds: string[] = [];\r\n      disps.map((d) => {\r\n        // TODO abstract this approach in a function because the alternative\r\n        // (saving the node itself) causes bugs)\r\n        const node = this.nodes[d.nodeId];\r\n        const updated = build.moveNodeAndDependents(\r\n          node,\r\n          d.nodeId,\r\n          this.reactions,\r\n          this.beziers,\r\n          d.displacement\r\n        );\r\n        reactionIds = utils.uniqueConcat([reactionIds, updated.reaction_ids]);\r\n      });\r\n      // move beziers\r\n      bezDisps.map((d) => {\r\n        const segment = this.reactions[d.reactionId].segments[d.segmentId];\r\n        const bez = d.bez as keyof typeof segment;\r\n        (segment[bez] as Coord) = utils.c_plus_c(segment[bez] as Coord, d.displacement as Coord)!;\r\n        this.beziers[d.bezierId].x = segment[bez].x;\r\n        this.beziers[d.bezierId].y = segment[bez].y;\r\n      });\r\n\r\n      this.draw_these_nodes(disps.map((d) => d.nodeId));\r\n      this.draw_these_reactions(reactionIds, true); // and beziers\r\n    };\r\n\r\n    // undo /redo\r\n    this.undo_stack.push(\r\n      // undo\r\n      () => {\r\n        const reverse = (disps: ({ nodeId: string; displacement: { x: number; y: number } } & any)[]) => disps.map((d) => ({\r\n          ...d,\r\n          displacement: {x: -d.displacement.x, y: -d.displacement.y}\r\n        }));\r\n        _moveNodes(reverse(displacements), reverse(bezierDisplacements));\r\n      },\r\n      // redo\r\n      () => {\r\n        _moveNodes(displacements, bezierDisplacements);\r\n      }\r\n    ).do(); // do the first time\r\n\r\n    // finish\r\n    this.set_status(alignByPrimary ? 'Aligned reactions' : 'Aligned nodes', 3000);\r\n  }\r\n\r\n\r\n  // ---------------------------------------------------------------------\r\n  // Delete\r\n  // ---------------------------------------------------------------------\r\n\r\n  /**\r\n   * Delete the selected nodes and associated segments and reactions, and selected\r\n   * labels. Undoable.\r\n   */\r\n  delete_selected() {\r\n    const selected_nodes = this.getSelectedNodes();\r\n    const selected_text_labels = this.get_selected_text_labels();\r\n    if (Object.keys(selected_nodes).length >= 1 ||\r\n        Object.keys(selected_text_labels).length >= 1)\r\n      this.delete_selectable(selected_nodes, selected_text_labels, true);\r\n  }\r\n\r\n  /**\r\n   * Delete the nodes and associated segments and reactions. Undoable.\r\n   * selected_nodes: An object that is a subset of map.nodes.\r\n   * selected_text_labels: An object that is a subset of map.text_labels.\r\n   * should_draw: A boolean argument to determine whether to draw the changes to\r\n   * the map.\r\n   */\r\n  delete_selectable(selected_nodes: { [key: string]: MapNode }, selected_text_labels: { [key: string]: TextLabel }, should_draw: boolean) {\r\n    const out = this.segments_and_reactions_for_nodes(selected_nodes);\r\n    let segment_objs_w_segments = out.segment_objs_w_segments; // TODO repeated values here\r\n    let reactions = out.reactions;\r\n\r\n    // copy nodes to undelete\r\n    const saved_nodes = utils.clone(selected_nodes);\r\n    const saved_segment_objs_w_segments = utils.clone(segment_objs_w_segments);\r\n    const saved_reactions = utils.clone(reactions);\r\n    const saved_text_labels = utils.clone(selected_text_labels);\r\n    const delete_and_draw = (nodes: any, reactions: any, segment_objs: any,\r\n      selected_text_labels: any) => {\r\n      // delete nodes, segments, and reactions with no segments\r\n      this.delete_node_data(Object.keys(selected_nodes));\r\n      this.delete_segment_data(segment_objs); // also deletes beziers\r\n      this.delete_reaction_data(Object.keys(reactions));\r\n      this.delete_text_label_data(Object.keys(selected_text_labels));\r\n\r\n      // apply the reaction and node data\r\n      let changed_r_scale = false;\r\n      let changed_m_scale = false;\r\n      if (this.has_data_on_reactions)\r\n        changed_r_scale = this.calc_data_stats('reaction');\r\n\r\n      if (this.has_data_on_nodes)\r\n        changed_m_scale = this.calc_data_stats('metabolite');\r\n\r\n\r\n      // redraw\r\n      if (should_draw) {\r\n        if (changed_r_scale)\r\n          this.draw_all_reactions(true, true);\r\n        else\r\n          this.clear_deleted_reactions(); // also clears segments and beziers\r\n        if (changed_m_scale)\r\n          this.draw_all_nodes(true);\r\n        else\r\n          this.clear_deleted_nodes();\r\n        this.clear_deleted_text_labels();\r\n      }\r\n    };\r\n\r\n    // delete\r\n    delete_and_draw(selected_nodes, reactions, segment_objs_w_segments,\r\n      selected_text_labels);\r\n\r\n    // add to undo/redo stack\r\n    this.undo_stack.push(() => {\r\n      // undo\r\n      // redraw the saved nodes, reactions, and segments\r\n\r\n      this.extend_nodes(saved_nodes);\r\n      this.extend_reactions(saved_reactions);\r\n      const reaction_ids_to_draw = Object.keys(saved_reactions);\r\n      for (const segment_id in saved_segment_objs_w_segments) {\r\n        const segment_obj = saved_segment_objs_w_segments[segment_id];\r\n\r\n        const segment = segment_obj.segment;\r\n        this.reactions[segment_obj.reaction_id]\r\n          .segments[segment_obj.segment_id] = segment;\r\n\r\n        // updated connected nodes\r\n        const to_from = [segment.from_node_id, segment.to_node_id];\r\n        to_from.forEach((node_id) => {\r\n          // not necessary for the deleted nodes\r\n          if (node_id in saved_nodes) return;\r\n          const node = this.nodes[node_id];\r\n          node.connected_segments.push({reaction_id: segment_obj.reaction_id,\r\n            segment_id: segment_obj.segment_id});\r\n        });\r\n\r\n        // extend the beziers\r\n        const seg_id = segment_obj.segment_id;\r\n        const r_id = segment_obj.reaction_id;\r\n        const seg_o: any = {};\r\n        seg_o[seg_id] = segment_obj.segment;\r\n        utils.extend(this.beziers, build.newBeziersForSegments(seg_o, r_id));\r\n\r\n        if (reaction_ids_to_draw.indexOf(segment_obj.reaction_id) === -1)\r\n          reaction_ids_to_draw.push(segment_obj.reaction_id);\r\n      }\r\n\r\n      // Apply the reaction and node data. If the scale changes, redraw\r\n      // everything.\r\n      if (this.has_data_on_reactions) {\r\n        const scale_changed = this.calc_data_stats('reaction');\r\n        if (scale_changed) this.draw_all_reactions(true, false);\r\n        else this.draw_these_reactions(reaction_ids_to_draw);\r\n      } else\r\n        if (should_draw) this.draw_these_reactions(reaction_ids_to_draw);\r\n\r\n      if (this.has_data_on_nodes) {\r\n        const scale_changed = this.calc_data_stats('metabolite');\r\n        if (should_draw) {\r\n          if (scale_changed) this.draw_all_nodes(false);\r\n          else this.draw_these_nodes(Object.keys(saved_nodes));\r\n        }\r\n      } else\r\n        if (should_draw) this.draw_these_nodes(Object.keys(saved_nodes));\r\n\r\n\r\n      // redraw the saved text_labels\r\n      utils.extend(this.text_labels, saved_text_labels);\r\n      if (should_draw) this.draw_these_text_labels(Object.keys(saved_text_labels));\r\n      // copy text_labels to re-delete\r\n      selected_text_labels = utils.clone(saved_text_labels);\r\n\r\n      // copy nodes to re-delete\r\n      selected_nodes = utils.clone(saved_nodes);\r\n      segment_objs_w_segments = utils.clone(saved_segment_objs_w_segments);\r\n      reactions = utils.clone(saved_reactions);\r\n    }, function() {\r\n      // redo\r\n      // clone the nodes and reactions, to redo this action later\r\n      delete_and_draw(selected_nodes, reactions, segment_objs_w_segments,\r\n        selected_text_labels);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Delete nodes, and remove from search index.\r\n   */\r\n  delete_node_data(nodeIds: IDType[]) {\r\n    nodeIds.forEach((nodeId) => {\r\n      if (this.enable_search && this.nodes[nodeId].node_type === 'metabolite') {\r\n        const found = (this.search_index.remove('n' + nodeId) &&\r\n                     this.search_index.remove('n_name' + nodeId));\r\n        if (!found)\r\n          console.warn('Could not find deleted metabolite in search index');\r\n      }\r\n      delete this.nodes[nodeId];\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Delete segments, update connected_segments in nodes, and delete bezier\r\n   * points.\r\n   * @param {Object} segment_objs - Object with values like\r\n   *                                { reaction_id: '123', segment_id: '456' }\r\n   */\r\n  delete_segment_data(segment_objs: { reaction_id: string; segment_id: string }[]) {\r\n    for (const segment_id in segment_objs) {\r\n      const segment_obj = segment_objs[segment_id];\r\n      const reaction = this.reactions[segment_obj.reaction_id];\r\n\r\n      // segment already deleted\r\n      if (!(segment_obj.segment_id in reaction.segments)) return;\r\n\r\n      const segment = reaction.segments[segment_obj.segment_id]\r\n      // updated connected nodes\r\n      ;[segment.from_node_id, segment.to_node_id].forEach((node_id) => {\r\n        if (!(node_id in this.nodes)) return;\r\n        const node = this.nodes[node_id];\r\n        node.connected_segments = node.connected_segments.filter(function(so) {\r\n          return so.segment_id != segment_obj.segment_id;\r\n        });\r\n      })\r\n\r\n      // remove beziers\r\n      ;['b1', 'b2'].forEach((bez) => {\r\n        const bez_id = build.bezierIdForSegmentId(segment_obj.segment_id, bez);\r\n        delete this.beziers[bez_id];\r\n      });\r\n\r\n      delete reaction.segments[segment_obj.segment_id];\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Delete reactions, segments, and beziers, and remove reaction from search\r\n   * index.\r\n   */\r\n  delete_reaction_data(reaction_ids: IDType[]) {\r\n    reaction_ids.forEach((reaction_id) => {\r\n      // remove beziers\r\n      const reaction = this.reactions[reaction_id];\r\n      for (const segment_id in reaction.segments) {\r\n        ;['b1', 'b2'].forEach((bez) => {\r\n          const bez_id = build.bezierIdForSegmentId(segment_id, bez);\r\n          delete this.beziers[bez_id];\r\n        });\r\n      }\r\n      // delete reaction\r\n      delete this.reactions[reaction_id];\r\n      // remove from search index\r\n      const found = (this.search_index.remove('r' + reaction_id) &&\r\n                   this.search_index.remove('r_name' + reaction_id));\r\n      if (!found) {\r\n        console.warn('Could not find deleted reaction ' +\r\n                     reaction_id + ' in search index');\r\n      }\r\n      for (const g_id in reaction.genes) {\r\n        const found = (this.search_index.remove('r' + reaction_id + '_g' + g_id) &&\r\n                     this.search_index.remove('r' + reaction_id + '_g_name' + g_id));\r\n        if (!found) {\r\n          console.warn('Could not find deleted gene ' +\r\n                       g_id + ' in search index');\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Delete text labels for an array of IDs\r\n   */\r\n  delete_text_label_data(text_label_ids: IDType[]) {\r\n    text_label_ids.forEach((text_label_id) => {\r\n      // delete label\r\n      delete this.text_labels[text_label_id];\r\n      // remove from search index\r\n      const found = this.search_index.remove('l' + text_label_id);\r\n      if (!found)\r\n        console.warn('Could not find deleted text label in search index');\r\n    });\r\n  }\r\n\r\n  // ---------------------------------------------------------------------\r\n  // Building\r\n  // ---------------------------------------------------------------------\r\n\r\n  _extend_and_draw_metabolite(new_nodes: { [key: string]: MapNode }, selected_node_id: string) {\r\n    this.extend_nodes(new_nodes);\r\n    const keys = [selected_node_id];\r\n    if (this.has_data_on_nodes) {\r\n      if (this.imported_metabolite_data == null)\r\n        throw new Error('imported_metabolite_data should not be null');\r\n\r\n      const scale_changed = this.apply_metabolite_data_to_map(this.imported_metabolite_data,\r\n        keys);\r\n      if (scale_changed)\r\n        this.draw_all_nodes(false);\r\n      else\r\n        this.draw_these_nodes(keys);\r\n    } else\r\n      this.draw_these_nodes(keys);\r\n  }\r\n\r\n  /**\r\n   * Draw a reaction on a blank canvas.\r\n   * @param {String} starting_reaction - bigg_id for a reaction to draw.\r\n   * @param {Coords} coords - coordinates to start drawing\r\n   */\r\n  new_reaction_from_scratch(starting_reaction: string, coords: { x: number; y: number }, direction: number) {\r\n    // If there is no cobra model, error\r\n    if (!this.cobra_model) {\r\n      console.error('No CobraModel. Cannot build new reaction');\r\n      return;\r\n    }\r\n\r\n    // Set reaction coordinates and angle. Be sure to clone the reaction.\r\n    const cobra_reaction = utils.clone(this.cobra_model.reactions[starting_reaction]);\r\n\r\n    // check for empty reactions\r\n    if (_.size(cobra_reaction.metabolites) === 0)\r\n      throw Error('No metabolites in reaction ' + cobra_reaction.bigg_id);\r\n\r\n\r\n    // create the first node\r\n    const reactant_ids = _.map(cobra_reaction.metabolites,\r\n      (coeff: number, met_id: string) => [coeff, met_id])\r\n      .filter((x) => Number(x[0]) < 0) // coeff < 0\r\n      .map((x) => x[1]); // metabolite id\r\n    // get the first reactant or else the first product\r\n    const metaboliteId = reactant_ids.length > 0 ?\r\n      reactant_ids[0] :\r\n      Object.keys(cobra_reaction.metabolites)[0];\r\n    const metabolite = this.cobra_model.metabolites[metaboliteId];\r\n    const selected_node_id = String(++this.largest_ids.nodes);\r\n    const label_d = build.getMetLabelLoc(utils.to_radians(direction), 0, 1,\r\n      true, metaboliteId as IDType, 1);\r\n    const selected_node: MapNode = {\r\n      connected_segments: [],\r\n      x: coords.x,\r\n      y: coords.y,\r\n      node_is_primary: true,\r\n      label_x: coords.x + label_d.x,\r\n      label_y: coords.y + label_d.y,\r\n      name: metabolite.name,\r\n      //@ts-ignore\r\n      bigg_id: metaboliteId,\r\n      node_type: 'metabolite'\r\n    };\r\n    let new_nodes: { [key: string]: MapNode } = {};\r\n    new_nodes[selected_node_id] = selected_node;\r\n\r\n    // draw\r\n    this._extend_and_draw_metabolite(new_nodes, selected_node_id);\r\n\r\n    // clone the nodes and reactions, to redo this action later\r\n    const saved_nodes = utils.clone(new_nodes);\r\n\r\n    // draw the reaction\r\n    const out = this.new_reaction_for_metabolite(starting_reaction,\r\n      selected_node_id,\r\n      direction, false);\r\n    const reaction_redo = out.redo;\r\n    const reaction_undo = out.undo;\r\n\r\n    // add to undo/redo stack\r\n    this.undo_stack.push(() => {\r\n      // Undo. First undo the reaction.\r\n      reaction_undo();\r\n      // Get the nodes to delete\r\n      this.delete_node_data(Object.keys(new_nodes));\r\n      // Save the nodes and reactions again, for redo\r\n      new_nodes = utils.clone(saved_nodes);\r\n      // Draw\r\n      this.clear_deleted_nodes();\r\n      // Deselect\r\n      this.deselect_nodes();\r\n    }, () => {\r\n      // Redo. Clone the nodes and reactions, to redo this action later.\r\n      this._extend_and_draw_metabolite(new_nodes, selected_node_id);\r\n      // Now redo the reaction\r\n      reaction_redo();\r\n    });\r\n\r\n    return;\r\n  }\r\n\r\n  /**\r\n   * Add new nodes to data and search index.\r\n   */\r\n  extend_nodes(new_nodes: { [key: string]: MapNode }) {\r\n    if (this.enable_search) {\r\n      for (const node_id in new_nodes) {\r\n        const node = new_nodes[node_id];\r\n        if (node.node_type != 'metabolite')\r\n          continue;\r\n        this.search_index.insert('n' + node_id,\r\n          {'name': node.bigg_id,\r\n            'data': {type: 'metabolite',\r\n              node_id: node_id}});\r\n        this.search_index.insert('n_name' + node_id,\r\n          {'name': node.name,\r\n            'data': {type: 'metabolite',\r\n              node_id: node_id}});\r\n      }\r\n    }\r\n    utils.extend(this.nodes, new_nodes);\r\n  }\r\n\r\n  /**\r\n   * Add new reactions to data and search index.\r\n   */\r\n  extend_reactions(new_reactions: { [key: string]: MapReaction }) {\r\n    if (this.enable_search) {\r\n      for (const r_id in new_reactions) {\r\n        const reaction = new_reactions[r_id];\r\n        this.search_index.insert('r' + r_id, {'name': reaction.bigg_id,\r\n          'data': {type: 'reaction',\r\n            reaction_id: r_id}});\r\n        this.search_index.insert('r_name' + r_id, {'name': reaction.name,\r\n          'data': {type: 'reaction',\r\n            reaction_id: r_id}});\r\n        for (const g_id in reaction.genes) {\r\n          const gene = reaction.genes[g_id];\r\n          this.search_index.insert('r' + r_id + '_g' + g_id,\r\n            {'name': gene.bigg_id,\r\n              'data': {type: 'reaction',\r\n                reaction_id: r_id}});\r\n          this.search_index.insert('r' + r_id + '_g_name' + g_id,\r\n            {'name': gene.name,\r\n              'data': {type: 'reaction',\r\n                reaction_id: r_id}});\r\n        }\r\n      }\r\n    }\r\n    utils.extend(this.reactions, new_reactions);\r\n  }\r\n\r\n\r\n  _extend_and_draw_reaction(new_nodes: { [key: string]: MapNode }, new_reactions: { [key: string]: MapReaction }, new_beziers: { [key: string]: any },\r\n    selected_node_id: string) {\r\n    this.extend_reactions(new_reactions);\r\n    utils.extend(this.beziers, new_beziers);\r\n    // Remove the selected node so it can be updated\r\n    this.delete_node_data([selected_node_id]); // TODO this is a hack. fix\r\n    this.extend_nodes(new_nodes);\r\n\r\n    // Apply the reaction and node data to the scales. If the scale changes,\r\n    // redraw everything.\r\n    const keys = Object.keys(new_reactions);\r\n    if (this.has_data_on_reactions) {\r\n      let scale_changed = false;\r\n      if (this.imported_reaction_data) {\r\n        scale_changed = this.apply_reaction_data_to_map(this.imported_reaction_data,\r\n          keys);\r\n      } else if (this.imported_gene_data)\r\n        scale_changed = this.apply_gene_data_to_map(this.imported_gene_data, keys);\r\n      else {\r\n        throw new Error('imported_gene_data or imported_reaction_data should ' +\r\n                        'not be null');\r\n      }\r\n      if (scale_changed)\r\n        this.draw_all_reactions(true, false);\r\n      else\r\n        this.draw_these_reactions(keys);\r\n    } else\r\n      this.draw_these_reactions(keys);\r\n\r\n\r\n    const node_keys = Object.keys(new_nodes);\r\n    if (this.has_data_on_nodes) {\r\n      if (this.imported_metabolite_data == null)\r\n        throw new Error('imported_metabolite_data should not be null');\r\n\r\n      const scale_changed = this.apply_metabolite_data_to_map(this.imported_metabolite_data,\r\n        node_keys);\r\n      if (scale_changed)\r\n        this.draw_all_nodes(false);\r\n      else\r\n        this.draw_these_nodes(node_keys);\r\n    } else\r\n      this.draw_these_nodes(node_keys);\r\n\r\n\r\n    // select new primary metabolite\r\n    for (const node_id in new_nodes) {\r\n      const node = new_nodes[node_id];\r\n      if (node.node_is_primary && node_id != selected_node_id) {\r\n        this.select_metabolite_with_id(node_id);\r\n        const new_coords = {x: node.x, y: node.y};\r\n        if (this.zoomContainer)\r\n          this.zoomContainer.translateOffScreen(new_coords);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Build a new reaction starting with selected_met. Undoable.\r\n   * @param {String} reaction_bigg_id - The BiGG ID of the reaction to draw.\r\n   * @param {String} selected_node_id - The ID of the node to begin drawing with.\r\n   * @param {Number} direction - The direction to draw in.\r\n   * @param {Boolean} [apply_undo_redo=true] - If true, then add to the undo\r\n   * stack. Otherwise, just return the undo and redo functions.\r\n   * @return An object of undo and redo functions:\r\n   *   { undo: undo_function, redo: redo_function }\r\n   */\r\n  new_reaction_for_metabolite(reaction_bigg_id: IDType, selected_node_id: IDType,\r\n    direction: number, apply_undo_redo?: boolean) {\r\n    // default args\r\n    if (apply_undo_redo === undefined) apply_undo_redo = true;\r\n\r\n    // get the metabolite node\r\n    const selected_node = this.nodes[selected_node_id];\r\n\r\n    // Set reaction coordinates and angle. Be sure to copy the reaction\r\n    // recursively.\r\n    const cobra_reaction = this.cobra_model!.reactions[reaction_bigg_id];\r\n\r\n    // build the new reaction\r\n    const out = build.newReaction(\r\n      reaction_bigg_id,\r\n      cobra_reaction,\r\n      this.cobra_model!.metabolites,\r\n      selected_node_id,\r\n      utils.clone(selected_node),\r\n      this.largest_ids,\r\n      this.settings.get('cofactors'),\r\n      direction\r\n    );\r\n    let new_nodes = out.new_nodes;\r\n    let new_reactions = out.new_reactions;\r\n    let new_beziers = out.new_beziers;\r\n\r\n    // Draw\r\n    this._extend_and_draw_reaction(new_nodes, new_reactions,\r\n      new_beziers, selected_node_id);\r\n\r\n    // Clone the nodes and reactions, to redo this action later\r\n    const saved_nodes = utils.clone(new_nodes);\r\n    const saved_reactions = utils.clone(new_reactions);\r\n    const saved_beziers = utils.clone(new_beziers);\r\n\r\n    // Add to undo/redo stack\r\n    const undo_fn = () => {\r\n      // Undo. Get the nodes to delete.\r\n      delete new_nodes[selected_node_id];\r\n      this.delete_node_data(Object.keys(new_nodes));\r\n      this.delete_reaction_data(Object.keys(new_reactions)); // also deletes beziers\r\n      this.select_metabolite_with_id(selected_node_id);\r\n      // Save the nodes and reactions again, for redo\r\n      new_nodes = utils.clone(saved_nodes);\r\n      new_reactions = utils.clone(saved_reactions);\r\n      new_beziers = utils.clone(saved_beziers);\r\n      // Draw\r\n      if (this.has_data_on_reactions) {\r\n        const scale_changed = this.calc_data_stats('reaction');\r\n        if (scale_changed)\r\n          this.draw_all_reactions(true, true);\r\n        else {\r\n          // Also clears segments and beziers\r\n          this.clear_deleted_reactions(true);\r\n        }\r\n      } else {\r\n        // Also clears segments and beziers\r\n        this.clear_deleted_reactions(true);\r\n      }\r\n      if (this.has_data_on_nodes) {\r\n        const scaleChanged = this.calc_data_stats('metabolite');\r\n        if (scaleChanged)\r\n          this.draw_all_nodes(true);\r\n        else\r\n          this.clear_deleted_nodes();\r\n      } else\r\n        this.clear_deleted_nodes();\r\n    };\r\n    const redo_fn = () => {\r\n      // redo\r\n      // clone the nodes and reactions, to redo this action later\r\n      this._extend_and_draw_reaction(new_nodes, new_reactions,\r\n        new_beziers, selected_node_id);\r\n    };\r\n\r\n    if (apply_undo_redo)\r\n      this.undo_stack.push(undo_fn, redo_fn);\r\n\r\n\r\n    return {undo: undo_fn, redo: redo_fn};\r\n  }\r\n\r\n  cycle_primary_node() {\r\n    const selected_nodes = this.getSelectedNodes();\r\n    if (_.isEmpty(selected_nodes)) return;\r\n    // Get the first node\r\n    const node_id = Object.keys(selected_nodes)[0];\r\n    const node = selected_nodes[node_id];\r\n    const reactions = this.reactions;\r\n    const nodes = this.nodes;\r\n    // make the other reactants or products secondary\r\n    // 1. Get the connected anchor nodes for the node\r\n    const connected_anchor_ids: IDType[] = [];\r\n    let reactions_to_draw: IDType[] = [];\r\n    nodes[node_id].connected_segments.forEach(function(segment_info) {\r\n      reactions_to_draw = [segment_info.reaction_id];\r\n      let segment: MapSegment;\r\n      try {\r\n        segment = reactions[segment_info.reaction_id].segments[segment_info.segment_id];\r\n        if (segment === undefined) throw new Error('undefined segment');\r\n      } catch (e: any) {\r\n        console.warn('Could not find connected segment ' + segment_info.segment_id);\r\n        return;\r\n      }\r\n      connected_anchor_ids.push(segment.from_node_id == node_id ?\r\n        segment.to_node_id : segment.from_node_id);\r\n    });\r\n    // can only be connected to one anchor\r\n    if (connected_anchor_ids.length != 1) {\r\n      console.error('Only connected nodes with a single reaction can be selected');\r\n      return;\r\n    }\r\n    const connected_anchor_id = connected_anchor_ids[0];\r\n    // 2. find nodes connected to the anchor that are metabolites\r\n    const related_node_ids = [node_id];\r\n    nodes[connected_anchor_id].connected_segments.forEach(function(segment_info) { // deterministic order\r\n      let segment: MapSegment;\r\n      try {\r\n        segment = reactions[segment_info.reaction_id].segments[segment_info.segment_id];\r\n        if (segment === undefined) throw new Error('undefined segment');\r\n      } catch (e) {\r\n        console.warn('Could not find connected segment ' + segment_info.segment_id);\r\n        return;\r\n      }\r\n      const conn_met_id = segment.from_node_id == connected_anchor_id ? segment.to_node_id : segment.from_node_id;\r\n      const conn_node = nodes[conn_met_id];\r\n      if (conn_node.node_type == 'metabolite' && conn_met_id != node_id)\r\n        related_node_ids.push(String(conn_met_id));\r\n    });\r\n    // 3. make sure they only have 1 reaction connection, and check if\r\n    // they match the other selected nodes\r\n    for (let i = 0; i < related_node_ids.length; i++) {\r\n      if (nodes[related_node_ids[i]].connected_segments.length > 1) {\r\n        console.error('Only connected nodes with a single reaction can be selected');\r\n        return;\r\n      }\r\n    }\r\n    for (const a_selected_node_id in selected_nodes) {\r\n      if (a_selected_node_id != node_id && related_node_ids.indexOf(a_selected_node_id) == -1) {\r\n        console.warn('Selected nodes are not on the same reaction');\r\n        return;\r\n      }\r\n    }\r\n    // 4. change the primary node, and change coords, label coords, and beziers\r\n    const nodes_to_draw: IDType[] = [];\r\n    let last_i = related_node_ids.length - 1;\r\n    const last_node = nodes[related_node_ids[last_i]];\r\n    let last_is_primary = last_node.node_is_primary;\r\n    let last_coords = {x: last_node.x, y: last_node.y,\r\n      label_x: last_node.label_x, label_y: last_node.label_y};\r\n    if (last_node.connected_segments.length > 1)\r\n      console.warn('Too many connected segments for node ' + last_node.node_id);\r\n    const last_segment_info = last_node.connected_segments[0]; // guaranteed above to have only one\r\n    let last_segment: MapSegment;\r\n    try {\r\n      last_segment = reactions[last_segment_info.reaction_id].segments[last_segment_info.segment_id];\r\n      if (last_segment === undefined) throw new Error('undefined segment');\r\n    } catch (e) {\r\n      console.error('Could not find connected segment ' + last_segment_info.segment_id);\r\n      return;\r\n    }\r\n    let last_bezier = {b1: last_segment.b1, b2: last_segment.b2};\r\n    let primary_node_id: IDType | undefined;\r\n    related_node_ids.forEach(function(related_node_id) {\r\n      const node = nodes[related_node_id];\r\n      const this_is_primary = node.node_is_primary;\r\n      const these_coords = {x: node.x, y: node.y,\r\n        label_x: node.label_x, label_y: node.label_y};\r\n      const this_segment_info = node.connected_segments[0];\r\n      const this_segment = reactions[this_segment_info.reaction_id].segments[this_segment_info.segment_id];\r\n      const this_bezier = {b1: this_segment.b1, b2: this_segment.b2};\r\n      node.node_is_primary = last_is_primary;\r\n      node.x = last_coords.x; node.y = last_coords.y;\r\n      node.label_x = last_coords.label_x; node.label_y = last_coords.label_y;\r\n      this_segment.b1 = last_bezier.b1; this_segment.b2 = last_bezier.b2;\r\n      last_is_primary = this_is_primary;\r\n      last_coords = these_coords;\r\n      last_bezier = this_bezier;\r\n      if (node.node_is_primary) primary_node_id = related_node_id;\r\n      nodes_to_draw.push(related_node_id);\r\n    });\r\n    // 5. cycle the connected_segments array so the next time, it cycles differently\r\n    const old_connected_segments = nodes[connected_anchor_id].connected_segments;\r\n    last_i = old_connected_segments.length - 1;\r\n    const new_connected_segments = [old_connected_segments[last_i]];\r\n    old_connected_segments.forEach(function(segment, i) {\r\n      if (last_i == i) return;\r\n      new_connected_segments.push(segment);\r\n    });\r\n    nodes[connected_anchor_id].connected_segments = new_connected_segments;\r\n    // 6. draw the nodes\r\n    this.draw_these_nodes(nodes_to_draw);\r\n    this.draw_these_reactions(reactions_to_draw);\r\n    // 7. select the primary node\r\n    if (primary_node_id)\r\n      this.select_metabolite_with_id(primary_node_id);\r\n\r\n    return;\r\n  }\r\n\r\n  /**\r\n   * Toggle the primary/secondary status of each selected node. Undoable.\r\n   */\r\n  toggle_selected_node_primary() {\r\n    const selected_node_ids = this.get_selected_node_ids();\r\n    const go = (ids: IDType[]) => {\r\n      const nodes_to_draw: { [key: string]: MapNode } = {};\r\n      const hide_secondary_metabolites = this.settings.get('hide_secondary_metabolites');\r\n      ids.forEach((id) => {\r\n        if (!(id in this.nodes)) {\r\n          console.warn('Could not find node: ' + id);\r\n          return;\r\n        }\r\n        const node = this.nodes[id];\r\n        if (node.node_type == 'metabolite') {\r\n          node.node_is_primary = !node.node_is_primary;\r\n          nodes_to_draw[id] = node;\r\n        }\r\n      });\r\n      // draw the nodes\r\n      this.draw_these_nodes(Object.keys(nodes_to_draw));\r\n      // draw associated reactions\r\n      if (hide_secondary_metabolites) {\r\n        const out = this.segments_and_reactions_for_nodes(nodes_to_draw);\r\n        const reaction_ids_to_draw_o: { [key: string]: boolean } = {};\r\n        for (const id in out.segment_objs_w_segments) {\r\n          const r_id = out.segment_objs_w_segments[id].reaction_id;\r\n          reaction_ids_to_draw_o[r_id] = true;\r\n        }\r\n        this.draw_these_reactions(Object.keys(reaction_ids_to_draw_o));\r\n      }\r\n    };\r\n\r\n    // go\r\n    go(selected_node_ids);\r\n\r\n    // add to the undo stack\r\n    this.undo_stack.push(function() {\r\n      go(selected_node_ids);\r\n    }, function() {\r\n      go(selected_node_ids);\r\n    });\r\n  }\r\n\r\n  segments_and_reactions_for_nodes(nodes: { [key: string]: MapNode }) {\r\n    /** Get segments and reactions that should be deleted with node deletions\r\n\r\n     */\r\n    const segment_objs_w_segments: { [key: string]: { reaction_id: string; segment_id: string; segment: MapSegment } } = {};\r\n    const these_reactions: { [key: string]: MapReaction } = {};\r\n    const segment_ids_for_reactions: { [key: string]: string[] } = {};\r\n    const reactions = this.reactions;\r\n    // for each node\r\n    for (const node_id in nodes) {\r\n      const node = nodes[node_id];\r\n      // find associated segments and reactions\r\n      node.connected_segments.forEach(function(segment_obj) {\r\n        let segment;\r\n        try {\r\n          segment = reactions[segment_obj.reaction_id].segments[segment_obj.segment_id];\r\n          if (segment === undefined) throw new Error('undefined segment');\r\n        } catch (e) {\r\n          console.warn('Could not find connected segments for node');\r\n          return;\r\n        }\r\n        const segment_obj_w_segment = utils.clone(segment_obj);\r\n        //@ts-ignore\r\n        segment_obj_w_segment['segment'] = utils.clone(segment);\r\n        //@ts-ignore\r\n        segment_objs_w_segments[segment_obj.segment_id] = segment_obj_w_segment;\r\n        if (!(segment_obj.reaction_id in segment_ids_for_reactions))\r\n          segment_ids_for_reactions[segment_obj.reaction_id] = [];\r\n        segment_ids_for_reactions[segment_obj.reaction_id].push(segment_obj.segment_id);\r\n      });\r\n    }\r\n    // find the reactions that should be deleted because they have no segments left\r\n    for (const reaction_id in segment_ids_for_reactions) {\r\n      const reaction = reactions[reaction_id];\r\n      const these_ids = segment_ids_for_reactions[reaction_id];\r\n      let has = true;\r\n      for (const segment_id in reaction.segments)\r\n        if (these_ids.indexOf(segment_id) == -1) has = false;\r\n\r\n      if (has) these_reactions[reaction_id] = reaction;\r\n    }\r\n    return {segment_objs_w_segments: segment_objs_w_segments, reactions: these_reactions};\r\n  }\r\n\r\n  add_label_to_search_index(id: IDType, text: string) {\r\n    this.search_index.insert('l' + id, {\r\n      name: text,\r\n      data: {type: 'text_label', text_label_id: id}\r\n    });\r\n  }\r\n\r\n  new_text_label(coords: { x: number; y: number }, text: string) {\r\n    // Make an label\r\n    const out = build.newTextLabel(this.largest_ids, text, coords);\r\n    this.text_labels[out.id] = out.label;\r\n    this.draw_these_text_labels([out.id]);\r\n    // Add to the search index\r\n    if (text !== '')\r\n      this.add_label_to_search_index(out.id, text);\r\n\r\n    return out.id;\r\n  }\r\n\r\n  /**\r\n   * Edit a text label. Undoable.\r\n   * @param {} text_label_id -\r\n   * @param {String} new_value -\r\n   * @param {Boolean} should_draw -\r\n   * @param {Boolean} [is_new=false] - If true, then the text label is all new, so\r\n   * delete it on undo and create it again on redo.\r\n   */\r\n  edit_text_label(text_label_id: IDType, new_value: string, should_draw: boolean, is_new?: boolean) {\r\n    if (_.isUndefined(is_new)) is_new = false;\r\n\r\n    if (new_value === '')\r\n      throw new Error('Should not be called for empty string');\r\n\r\n\r\n    const edit_and_draw = (new_val: string, should_draw: boolean) => {\r\n      // set the new value\r\n      const label = this.text_labels[text_label_id];\r\n      label.text = new_val;\r\n      if (should_draw)\r\n        this.draw_these_text_labels([text_label_id]);\r\n\r\n      // Update in the search index\r\n      const record_id = 'l' + text_label_id;\r\n      const found = this.search_index.remove(record_id);\r\n      if (!is_new && !found)\r\n        console.warn('Could not find modified text label in search index');\r\n\r\n      this.search_index.insert(record_id, {\r\n        name: new_val,\r\n        data: {type: 'text_label', text_label_id: text_label_id}\r\n      });\r\n    };\r\n\r\n    // Save old value\r\n    const saved_label = utils.clone(this.text_labels[text_label_id]);\r\n\r\n    // Edit the label\r\n    edit_and_draw(new_value, should_draw);\r\n\r\n    // Add to undo stack\r\n    this.undo_stack.push(() => {\r\n      if (is_new) {\r\n        this.delete_text_label_data([text_label_id]);\r\n        this.clear_deleted_text_labels();\r\n      } else\r\n        edit_and_draw(saved_label.text, true);\r\n    }, () => {\r\n      if (is_new) {\r\n        this.text_labels[text_label_id] = utils.clone(saved_label);\r\n        this.text_labels[text_label_id].text = new_value;\r\n        this.draw_these_text_labels([text_label_id]);\r\n        this.add_label_to_search_index(text_label_id, new_value);\r\n      } else\r\n        edit_and_draw(new_value, true);\r\n    });\r\n  }\r\n\r\n  // -------------------------------------------------------------------------\r\n  // Zoom\r\n  // -------------------------------------------------------------------------\r\n\r\n  /**\r\n   * Zoom to fit all the nodes. Returns error if one is raised.\r\n   * @param {} margin - optional argument to set the margins as a fraction of\r\n   * height.\r\n   */\r\n  zoom_extent_nodes(margin?: number) {\r\n    this._zoom_extent(margin, 'nodes');\r\n  }\r\n\r\n  /**\r\n   * Zoom to fit the canvas. Returns error if one is raised.\r\n   * @param {} margin - optional argument to set the margins as a fraction of\r\n   * height.\r\n   */\r\n  zoom_extent_canvas(margin?: number) {\r\n    this._zoom_extent(margin, 'canvas');\r\n  }\r\n\r\n  /**\r\n   * Zoom to fit the canvas or all the nodes. Returns error if one is raised.\r\n   * @param {} margin - optional argument to set the margins.\r\n   * @param {} mode - Values are 'nodes', 'canvas'.\r\n   */\r\n  _zoom_extent(margin?: number, mode?: 'nodes' | 'canvas') {\r\n    // Optional args\r\n    if (_.isUndefined(margin)) margin = (mode === 'nodes' ? 0.2 : 0);\r\n    if (_.isUndefined(mode)) mode = 'canvas';\r\n\r\n    let new_zoom;\r\n    let new_pos;\r\n    const size = this.get_size();\r\n    // scale margin to window size\r\n    margin = margin * size.height;\r\n\r\n    if (mode === 'nodes') {\r\n      // get the extent of the nodes\r\n      const min: { x: number | null; y: number | null } = {x: null, y: null}; // TODO make infinity?\r\n      const max: { x: number | null; y: number | null } = {x: null, y: null};\r\n      for (const node_id in this.nodes) {\r\n        const node = this.nodes[node_id];\r\n        if (min.x == null) min.x = node.x;\r\n        if (min.y == null) min.y = node.y;\r\n        if (max.x == null) max.x = node.x;\r\n        if (max.y == null) max.y = node.y;\r\n\r\n        min.x = Math.min(min.x, node.x);\r\n        min.y = Math.min(min.y, node.y);\r\n        max.x = Math.max(max.x, node.x);\r\n        max.y = Math.max(max.y, node.y);\r\n      }\r\n      // set the zoom\r\n      new_zoom = Math.min((size.width - margin * 2) / (max.x! - min.x!),\r\n        (size.height - margin * 2) / (max.y! - min.y!));\r\n      new_pos = {x: - (min.x! * new_zoom) + margin + ((size.width - margin * 2 - (max.x! - min.x!) * new_zoom) / 2),\r\n        y: - (min.y! * new_zoom) + margin + ((size.height - margin * 2 - (max.y! - min.y!) * new_zoom) / 2)};\r\n    } else if (mode == 'canvas') {\r\n      // center the canvas\r\n      new_zoom = Math.min((size.width - margin * 2) / (this.canvas.width),\r\n        (size.height - margin * 2) / (this.canvas.height));\r\n      new_pos = {x: - (this.canvas.x * new_zoom) + margin + ((size.width - margin * 2 - this.canvas.width * new_zoom) / 2),\r\n        y: - (this.canvas.y * new_zoom) + margin + ((size.height - margin * 2 - this.canvas.height * new_zoom) / 2)};\r\n    } else\r\n      return console.error('Did not recognize mode');\r\n\r\n    this.zoomContainer.goTo(new_zoom, new_pos);\r\n    return null;\r\n  }\r\n\r\n  get_size() {\r\n    return this.zoomContainer.get_size();\r\n  }\r\n\r\n  zoom_to_reaction(reaction_id: IDType) {\r\n    const reaction = this.reactions[reaction_id];\r\n    const new_zoom = 0.5;\r\n    const size = this.get_size();\r\n    const new_pos = {x: - reaction.label_x * new_zoom + size.width / 2,\r\n      y: - reaction.label_y * new_zoom + size.height / 2};\r\n    this.zoomContainer.goTo(new_zoom, new_pos);\r\n  }\r\n\r\n  zoom_to_node(node_id: IDType) {\r\n    const node = this.nodes[node_id];\r\n    const new_zoom = 0.5;\r\n    const size = this.get_size();\r\n    const new_pos = {\r\n      x: - node.label_x * new_zoom + size.width / 2,\r\n      y: - node.label_y * new_zoom + size.height / 2,\r\n    };\r\n    this.zoomContainer.goTo(new_zoom, new_pos);\r\n  }\r\n\r\n  zoom_to_text_label(text_label_id: IDType) {\r\n    const text_label = this.text_labels[text_label_id];\r\n    const new_zoom = 0.5;\r\n    const size = this.get_size();\r\n    const new_pos = {\r\n      x: - text_label.x * new_zoom + size.width / 2,\r\n      y: - text_label.y * new_zoom + size.height / 2,\r\n    };\r\n    this.zoomContainer.goTo(new_zoom, new_pos);\r\n  }\r\n\r\n  highlight_reaction(reaction_id: IDType) {\r\n    this.highlight(this.sel.selectAll('#r' + reaction_id).selectAll('text'));\r\n  }\r\n\r\n  highlight_node(node_id: IDType) {\r\n    this.highlight(this.sel.selectAll('#n' + node_id).selectAll('text'));\r\n  }\r\n\r\n  highlight_text_label(text_label_id: IDType) {\r\n    this.highlight(this.sel.selectAll('#l' + text_label_id).selectAll('text'));\r\n  }\r\n\r\n  highlight(sel?: D3Selection | null) {\r\n    this.sel.selectAll('.highlight')\r\n      .classed('highlight', false);\r\n    if (sel !== null)\r\n      sel.classed('highlight', true);\r\n  }\r\n\r\n  // -------------------------------------------------------------------------\r\n  // IO\r\n  // -------------------------------------------------------------------------\r\n\r\n  save() {\r\n    utils.download_json(this.map_for_export(), this.map_name);\r\n  }\r\n\r\n  map_for_export() {\r\n    const out = [{map_name: this.map_name,\r\n      map_id: this.map_id,\r\n      map_description: this.map_description,\r\n      homepage: 'https://escher.github.io',\r\n      schema: 'https://escher.github.io/escher/jsonschema/1-0-0#'\r\n    },\r\n    {reactions: utils.clone(this.reactions),\r\n      nodes: utils.clone(this.nodes),\r\n      text_labels: utils.clone(this.text_labels),\r\n      canvas: this.canvas.sizeAndLocation()}\r\n    ];\r\n\r\n    // remove extra data\r\n    for (const r_id in out[1].reactions) {\r\n      const reaction = out[1].reactions[r_id];\r\n      const new_reaction: { [key: string]: any } = {};\r\n      const attrs = ['name', 'bigg_id', 'reversibility', 'label_x', 'label_y',\r\n        'gene_reaction_rule', 'genes', 'metabolites'];\r\n      attrs.forEach(function(attr) {\r\n        new_reaction[attr] = reaction[attr];\r\n      });\r\n      new_reaction['segments'] = {};\r\n      for (const s_id in reaction.segments) {\r\n        const segment = reaction.segments[s_id];\r\n        const new_segment: { [key: string]: any } = {};\r\n        const attrs = ['from_node_id', 'to_node_id', 'b1', 'b2'];\r\n        attrs.forEach(function(attr) {\r\n          new_segment[attr] = segment[attr as keyof MapSegment];\r\n        });\r\n        new_reaction['segments'][s_id] = new_segment;\r\n      }\r\n      out[1].reactions[r_id] = new_reaction as MapReaction;\r\n    }\r\n    for (const n_id in out[1].nodes) {\r\n      const node = out[1].nodes[n_id];\r\n      const new_node: { [key: string]: any } = {};\r\n      let attrs: string[] = [];\r\n      if (node.node_type === 'metabolite') {\r\n        attrs = ['node_type', 'x', 'y', 'bigg_id', 'name', 'label_x', 'label_y',\r\n          'node_is_primary'];\r\n      } else\r\n        attrs = ['node_type', 'x', 'y'];\r\n\r\n      attrs.forEach(function(attr) {\r\n        new_node[attr] = node[attr];\r\n      });\r\n      out[1].nodes[n_id] = new_node as MapNode;\r\n    }\r\n    for (const t_id in out[1].text_labels) {\r\n      const text_label = out[1].text_labels[t_id];\r\n      const new_text_label: { [key: string]: any } = {};\r\n      const attrs = ['x', 'y', 'text'];\r\n      attrs.forEach(function(attr) {\r\n        new_text_label[attr] = text_label[attr as keyof TextLabel];\r\n      });\r\n      out[1].text_labels[t_id] = new_text_label as TextLabel;\r\n    }\r\n    // canvas\r\n    const canvas_el = out[1].canvas;\r\n    const new_canvas_el: { [key: string]: any } = {};\r\n    const attrs = ['x', 'y', 'width', 'height'];\r\n    attrs.forEach(function(attr) {\r\n      new_canvas_el[attr] = canvas_el![attr as keyof typeof canvas_el];\r\n    });\r\n    out[1].canvas = new_canvas_el as typeof canvas_el;\r\n\r\n    return out;\r\n  }\r\n\r\n  /**\r\n   * Rescale the canvas and save as svg/png.\r\n   */\r\n  saveMap(callbackBefore: string, callbackAfter: string, mapType: 'svg' | 'png') {\r\n    // Run the before callback\r\n    this.callback_manager.run(callbackBefore);\r\n\r\n    // Turn off zoom and translate so that illustrator likes the map\r\n    const windowScale = this.zoomContainer.windowScale;\r\n    const windowTranslate = this.zoomContainer.windowTranslate;\r\n    const canvasSizeAndLoc = this.canvas.sizeAndLocation();\r\n    const mouseNodeSizeAndTrans = {\r\n      w: this.canvas.mouseNode.attr('width'),\r\n      h: this.canvas.mouseNode.attr('height'),\r\n      transform: this.canvas.mouseNode.attr('transform')\r\n    };\r\n\r\n    this.zoomContainer._goToSvg(\r\n      1.0,\r\n      {x: -canvasSizeAndLoc.x, y: -canvasSizeAndLoc.y},\r\n      () => {\r\n        this.svg.attr('width', canvasSizeAndLoc.width);\r\n        this.svg.attr('height', canvasSizeAndLoc.height);\r\n        this.canvas.mouseNode.attr('width', '0px');\r\n        this.canvas.mouseNode.attr('height', '0px');\r\n        this.canvas.mouseNode.attr('transform', null);\r\n\r\n        // hide the segment control points\r\n        const hidden_sel = this.sel.selectAll('.multimarker-circle,.midmarker-circle,#canvas,.bezier,#rotation-center,.direction-arrow,.start-reaction-target')\r\n          .style('visibility', 'hidden');\r\n\r\n        // do the export\r\n        if ( mapType === 'svg')\r\n          utils.downloadSvg('saved_map', this.svg as D3Selection<any>, true);\r\n        else if (mapType === 'png')\r\n          utils.downloadPng('saved_map', this.svg);\r\n\r\n\r\n        // revert everything\r\n        this.zoomContainer._goToSvg(windowScale, windowTranslate, () => {\r\n          this.svg.attr('width', null);\r\n          this.svg.attr('height', null);\r\n          this.canvas.mouseNode.attr('width', mouseNodeSizeAndTrans.w);\r\n          this.canvas.mouseNode.attr('height', mouseNodeSizeAndTrans.h);\r\n          this.canvas.mouseNode.attr('transform', mouseNodeSizeAndTrans.transform);\r\n          // unhide the segment control points\r\n          hidden_sel.style('visibility', null);\r\n\r\n          // run the after callback\r\n          this.callback_manager.run(callbackAfter);\r\n        });\r\n      }\r\n    );\r\n  }\r\n\r\n  save_svg() {\r\n    this.saveMap('before_svg_export', 'after_svg_export', 'svg');\r\n  }\r\n\r\n  save_png() {\r\n    this.saveMap('before_png_export', 'after_png_export', 'png');\r\n  }\r\n\r\n  /**\r\n   * Assign the descriptive names and gene_reaction_rules from the model to the\r\n   * map. If no map is loaded, then throw an Error. If some reactions are not in\r\n   * the model, then warn in the status.\r\n   */\r\n  convert_map() {\r\n    // Run the before callback\r\n    this.callback_manager.run('before_convert_map');\r\n\r\n    // Check the model\r\n    if (!this.has_cobra_model())\r\n      throw Error('No COBRA model loaded.');\r\n\r\n    const model = this.cobra_model;\r\n\r\n    // IDs for reactions and metabolites not found in the model\r\n    const reactions_not_found: { [key: string]: boolean } = {};\r\n    const reaction_attrs = ['name', 'gene_reaction_rule', 'genes'];\r\n    const met_nodes_not_found: { [key: string]: boolean } = {};\r\n    const metabolite_attrs = ['name'];\r\n    let found = false;\r\n    // convert reactions\r\n    for (const reaction_id in this.reactions) {\r\n      const reaction = this.reactions[reaction_id];\r\n      found = false;\r\n      // find in cobra model\r\n      for (const model_reaction_id in model!.reactions) {\r\n        const modelReaction = model!.reactions[model_reaction_id];\r\n        if (modelReaction.bigg_id == reaction.bigg_id) {\r\n          reaction_attrs.forEach((attr) => {\r\n            reaction[attr] = modelReaction[attr];\r\n          });\r\n          // check matching metabolites & warn if not matching. if matching, check\r\n          // & reverse\r\n          let matches = true;\r\n          let looksReversed = null;\r\n          for (const metId in modelReaction.metabolites) {\r\n            const modelCoeff = modelReaction.metabolites[metId];\r\n            const mapMet = _.find(reaction.metabolites, (x) => x.bigg_id === metId);\r\n            if (mapMet === undefined) {\r\n              matches = false;\r\n              break;\r\n            }\r\n            const mapCoeff = mapMet.coefficient;\r\n            // keep track of whether any of these are reversed\r\n            if (looksReversed == null)\r\n              looksReversed = (modelCoeff > 0) !== (mapCoeff > 0);\r\n\r\n            // make sure there are no mismatches in reversibility direction\r\n            if ((looksReversed === true && ((modelCoeff > 0) === (mapCoeff > 0))) ||\r\n                (looksReversed === false && ((modelCoeff > 0) !== (mapCoeff > 0)))) {\r\n              matches = false;\r\n              break;\r\n            }\r\n          }\r\n          if (looksReversed && matches) {\r\n            // looks reversed with not mismatches, then reverse the direction\r\n            reaction.metabolites.forEach((met) => {\r\n              met.coefficient = -met.coefficient;\r\n            });\r\n            // propagate changes into segments\r\n            for (const segmentId in reaction.segments) {\r\n              const segment = reaction.segments[segmentId];\r\n\r\n              // propagate reversibility\r\n              segment.reversibility = reaction.reversibility;\r\n\r\n              const from_node = this.nodes[segment.from_node_id];\r\n              const to_node = this.nodes[segment.to_node_id];\r\n\r\n              // propagate coefficients\r\n              reaction.metabolites.forEach((met) => {\r\n                if (met.bigg_id === from_node.bigg_id)\r\n                  segment.from_node_coefficient = met.coefficient;\r\n                else if (met.bigg_id === to_node.bigg_id)\r\n                  segment.to_node_coefficient = met.coefficient;\r\n              });\r\n            }\r\n          }\r\n          if (!matches) {\r\n            console.warn(`Metabolites for ${modelReaction.bigg_id} are different in model and map. Could\r\n not check and fix direction.`);\r\n            break;\r\n          }\r\n          found = true;\r\n        }\r\n      }\r\n      if (!found) reactions_not_found[reaction_id] = true;\r\n    }\r\n    // convert metabolites\r\n    for (const node_id in this.nodes) {\r\n      const node = this.nodes[node_id];\r\n      // only look at metabolites\r\n      if (node.node_type != 'metabolite') continue;\r\n      found = false;\r\n      // find in cobra model\r\n      for (const model_metabolite_id in model!.metabolites) {\r\n        const model_metabolite = model!.metabolites[model_metabolite_id];\r\n        if (model_metabolite.bigg_id == node.bigg_id) {\r\n          metabolite_attrs.forEach(function(attr) {\r\n            node[attr] = model_metabolite[attr];\r\n          });\r\n          found = true;\r\n        }\r\n      }\r\n      if (!found)\r\n        met_nodes_not_found[node_id] = true;\r\n    }\r\n\r\n    // status\r\n    const n_reactions_not_found = Object.keys(reactions_not_found).length;\r\n    const n_met_nodes_not_found = Object.keys(met_nodes_not_found).length;\r\n    const status_delay = 10000;\r\n    if (n_reactions_not_found === 0 && n_met_nodes_not_found === 0)\r\n      this.set_status('Successfully converted attributes.', status_delay);\r\n    else if (n_met_nodes_not_found === 0) {\r\n      this.set_status('Converted attributes, but count not find ' + n_reactions_not_found +\r\n                      ' reactions in the model.', status_delay);\r\n      this.settings.set('highlight_missing', true);\r\n    } else if (n_reactions_not_found === 0) {\r\n      this.set_status('Converted attributes, but count not find ' + n_met_nodes_not_found +\r\n                      ' metabolites in the model.', status_delay);\r\n      this.settings.set('highlight_missing', true);\r\n    } else {\r\n      this.set_status('Converted attributes, but count not find ' + n_reactions_not_found +\r\n                      ' reactions and ' + n_met_nodes_not_found + ' metabolites in the model.',\r\n      status_delay);\r\n      this.settings.set('highlight_missing', true);\r\n    }\r\n\r\n    // redraw\r\n    this.draw_everything();\r\n\r\n    // run the after callback\r\n    this.callback_manager.run('after_convert_map');\r\n  }\r\n\r\n  mergeSelectedNodes() {\r\n    try {\r\n      const selNodes = this.getSelectedNodes();\r\n      const nodeObjs = Object.values(selNodes);\r\n      const nodeKeys = Object.keys(selNodes);\r\n      if (Object.values(selNodes).length != 2)\r\n        return;\r\n      const firstNodeId = nodeKeys[0];\r\n      const secondNodeId = nodeKeys[1];\r\n      if (nodeObjs.every((a) => a.bigg_id) && nodeObjs[0].bigg_id == nodeObjs[1].bigg_id) {\r\n        this.nodes[firstNodeId].connected_segments.forEach((seg) => {\r\n          this.nodes[secondNodeId].connected_segments.push({...seg});\r\n        });\r\n        this.nodes[firstNodeId] && (delete this.nodes[firstNodeId]);\r\n        Object.values(this.reactions).forEach((r) => {\r\n          Object.values(r.segments).forEach((seg) => {\r\n            if (seg.from_node_id == firstNodeId)\r\n              seg.from_node_id = secondNodeId;\r\n            if (seg.to_node_id == firstNodeId)\r\n              seg.to_node_id = secondNodeId;\r\n          });\r\n        });\r\n\r\n        this.sel.selectAll('.selected').classed('selected', false);\r\n        this.draw_everything();\r\n      }\r\n    } catch (e) {\r\n      console.error(e);\r\n    }\r\n  }\r\n\r\n  highlightSameNodes() {\r\n    try {\r\n      const selNodes = Object.values(this.getSelectedNodes());\r\n      if (selNodes.length === 1 && selNodes[0].node_type == 'metabolite' && selNodes[0].bigg_id) {\r\n        const nodeBiggId = selNodes[0].bigg_id;\r\n        const applicableNodeIds = Object.entries(this.nodes).filter(([nodeId, node]) => node.node_type == 'metabolite' && node.bigg_id == nodeBiggId).map(([nodeId, _]) => nodeId);\r\n        this.sel.selectAll(applicableNodeIds.map((id) => `#n${id}`).join(',')).classed('selected', true);\r\n\r\n        // Object.values(this.nodes).forEach((n) => {\r\n        //   if (n.bigg_id === this.nodes[selNodeId].bigg_id) {\r\n        //     this.sel.selectAll('#n' + n.node_id).selectAll('text').classed('highlight', true);\r\n        //   }\r\n        // })\r\n      }\r\n    } catch (e) {\r\n      console.error(e);\r\n    }\r\n  }\r\n\r\n  findAndHighlightShortest(inc = 0) {\r\n    this.last_action = null;\r\n\r\n    const nodes = Array.from(new Set(Object.values(this.getSelectedNodes())\r\n      .sort((node1, node2) => ((!!node1.selectionOrder ? node1.selectionOrder : 0) - (!!node2.selectionOrder ? node2.selectionOrder : 0)))\r\n      .map((a) => a.bigg_id)));\r\n    if (nodes.length !== 2)\r\n      return;\r\n\r\n    let path;\r\n    let k;\r\n    try {\r\n      const reactionHash = `r${nodes[0]}_r${nodes[1]}`;\r\n      k = typeof inc === 'string' ? Number.parseInt(inc) : inc == 0 ? 1 : Math.max(this.shortestPathInfo ? (this.shortestPathInfo.hash === reactionHash ? this.shortestPathInfo.k + inc : 1) : 1, 1);\r\n      if (k === 0)\r\n        k = 1;\r\n      path = findKthShortestPath(this, nodes[0], nodes[1], k);\r\n      this.shortestPathInfo = {hash: reactionHash, k};\r\n      this.outGoingInfo = null;\r\n      this.inGoingInfo = null;\r\n    } catch (e) {\r\n      console.error(`Error finding ${k}th shortest path`, e);\r\n      return;\r\n    }\r\n    this.unhighlightShortestPaths();\r\n    //const kthPath = findKthShortestPath(this, nodes[0], nodes[1], 20);\r\n    if (!path)\r\n      return;\r\n    for (let i = 0; i < path.length - 1; i++) {\r\n      const reactionId = path[i].reaction_id;\r\n      const firtNodeBiggId = path[i].met;\r\n      const secondNodeBiggId = path[i + 1].met;\r\n      if (!reactionId || !firtNodeBiggId || !secondNodeBiggId)\r\n        continue;\r\n      const segments = getReactionPathSegments(this, firtNodeBiggId, secondNodeBiggId, reactionId);\r\n      segments?.forEach((seg) => {\r\n        this.sel.select(`#s${seg}.segment-group`).classed('shortest-path', true);\r\n      });\r\n    }\r\n\r\n    // path.filter(p => p.reaction_id != null).forEach(p => {\r\n    //   this.sel.select(`#r${p.reaction_id}.reaction`).classed('shortest-path', true)\r\n    // })\r\n    this.last_action = {\r\n      function: 'findAndHighlightShortest',\r\n      args: [k.toString()]\r\n    };\r\n  }\r\n\r\n  findKthOutOrIngoingReactions(inc: string | number, outGoingFlag = true) {\r\n    this.last_action = null;\r\n    const nodes = Array.from(new Set(Object.values(this.getSelectedNodes()).map((a) => a.bigg_id)));\r\n    if (nodes.length !== 1)\r\n      return;\r\n    let k: number;\r\n\r\n    const biggId = nodes[0];\r\n    this.unhighlightShortestPaths();\r\n\r\n    const getSavedInfo = () => outGoingFlag ? this.outGoingInfo : this.inGoingInfo;\r\n    const setSavedInfo = (info: { hash: string; k: number; }) => outGoingFlag ? (this.outGoingInfo = info) : (this.inGoingInfo = info);\r\n    const calcFunc = outGoingFlag ? findOutGoing : findInGoing;\r\n    // If you want to set k explicitely, pass inc as string\r\n    k = typeof inc === 'string' ? Number.parseInt(inc) : inc == 0 ? 1 : Math.max(getSavedInfo() ? (getSavedInfo()!.hash === biggId ? getSavedInfo()!.k + inc : 1) : 1, 1);\r\n    if (k === 0)\r\n      k = 1;\r\n    this.outGoingInfo = null;\r\n    this.inGoingInfo = null;\r\n    this.shortestPathInfo = null;\r\n    setSavedInfo({hash: biggId, k});\r\n    const visitedMetabolites = new Set<IDType>();\r\n    const visitedReactions = new Set<string>();\r\n    const newMetabolites = new Set<IDType>();\r\n    // outGoing.forEach((o) => {\r\n    //   visitedMetabolites.add(o[1]);\r\n    //   visitedReactions.add(o[0]);\r\n    // });\r\n    const sign = (num: number) => num >= 0 ? 1 : -1;\r\n\r\n    const queue: IDType[] = [biggId];\r\n    for (let iter = 0; iter < k; iter++) {\r\n      newMetabolites.clear();\r\n      while (queue.length > 0) {\r\n        const currentId = queue.shift() as IDType;\r\n        if (visitedMetabolites.has(currentId))\r\n          continue;\r\n        visitedMetabolites.add(currentId);\r\n        const outGoing = calcFunc(this, currentId).map((a) => a.split(pathSeparatorString));\r\n        outGoing.forEach((o) => {\r\n          const reactionId = o[0];\r\n          const toId = o[1];\r\n          if (!visitedReactions.has([currentId, o[0], o[1]].join(pathSeparatorString)) && !visitedMetabolites.has(toId)) {\r\n            newMetabolites.add(toId);\r\n            // what we need to do here is to go through every reaction and find ones which have from and to metabolites in correct order\r\n            const reactionIds: IDType[] = [];\r\n            Object.values(this.reactions).forEach((reaction) => {\r\n              const reactionMets = reaction.metabolites;\r\n              const fromMet = reactionMets.find((m) => m.bigg_id === currentId);\r\n              const toMet = reactionMets.find((m) => m.bigg_id === toId);\r\n              if (fromMet && toMet && (reaction.reversibility ||\r\n                (outGoingFlag && sign(fromMet.coefficient) === -1 && sign(toMet.coefficient) === 1) ||\r\n                (!outGoingFlag && sign(fromMet.coefficient) === 1 && sign(toMet.coefficient) === -1)\r\n              ))\r\n                reactionIds.push(reaction.reaction_id);\r\n            });\r\n            reactionIds.forEach((rId) => {\r\n              const segments = getReactionPathSegments(this, currentId, toId, rId);\r\n              segments && segments.forEach((seg) => {\r\n                const nthShortest = Math.max(Math.min(k, 4), 1);\r\n                this.sel.select(`#s${seg}.segment-group`).classed('shortest-path', true);\r\n              //.classed(`shortest-path-${nthShortest}`, true);\r\n              });\r\n            });\r\n          }\r\n        });\r\n\r\n        outGoing.forEach((o) => {\r\n          visitedReactions.add([currentId, o[0], o[1]].join(pathSeparatorString));\r\n        });\r\n      }\r\n      Array.from(newMetabolites).forEach((m) => queue.push(m));\r\n    }\r\n\r\n    this.last_action = {\r\n      function: 'findKthOutOrIngoingReactions',\r\n      args: [k.toString(), outGoingFlag]\r\n    };\r\n  }\r\n\r\n  select_nodes(nodeIds: IDType[]) {\r\n    nodeIds.filter((id) => id && id.toString()).forEach((id) => this.sel.selectAll('#n' + id.toString()).classed('selected', true));\r\n  }\r\n\r\n  selectionChanged() {\r\n    // handle different things when selection changes\r\n    const element = document.getElementById('selection-info-container');\r\n    const prefix = 'Selected: ';\r\n    if (!element)\r\n      return;\r\n    const nodes = Array.from(new Set(Object.values(this.getSelectedNodes())\r\n      .sort((node1, node2) => ((!!node1.selectionOrder ? node1.selectionOrder : 0) - (!!node2.selectionOrder ? node2.selectionOrder : 0)))\r\n      .map((a) => a.bigg_id)));\r\n\r\n    if (nodes.length === 0) {\r\n      element.innerHTML = '';\r\n      return;\r\n    }\r\n    if (nodes.length === 1) {\r\n      element.innerHTML = `<h3>${prefix}${nodes[0]}</h3>`;\r\n      return;\r\n    }\r\n    if (nodes.length === 2) {\r\n      element.innerHTML = `<h3>${prefix}${nodes[0]} - ${nodes[1]}</h3>`;\r\n      return;\r\n    }\r\n\r\n    element.innerHTML = ``;\r\n  }\r\n\r\n  unhighlightShortestPaths() {\r\n    this.sel.selectAll('.shortest-path').classed('shortest-path', false);\r\n    this.sel.selectAll('.shortest-path-1').classed('shortest-path-1', false);\r\n    this.sel.selectAll('.shortest-path-2').classed('shortest-path-2', false);\r\n    this.sel.selectAll('.shortest-path-3').classed('shortest-path-3', false);\r\n    this.sel.selectAll('.shortest-path-4').classed('shortest-path-4', false);\r\n    this.last_action = null;\r\n  }\r\n}\r\n","export default function(x) {\n  return function() {\n    return x;\n  };\n}\n","export default function(target, type, selection) {\n  this.target = target;\n  this.type = type;\n  this.selection = selection;\n}\n","import {event} from \"d3-selection\";\n\nexport function nopropagation() {\n  event.stopImmediatePropagation();\n}\n\nexport default function() {\n  event.preventDefault();\n  event.stopImmediatePropagation();\n}\n","import {dispatch} from \"d3-dispatch\";\nimport {dragDisable, dragEnable} from \"d3-drag\";\nimport {interpolate} from \"d3-interpolate\";\nimport {customEvent, event, mouse, select} from \"d3-selection\";\nimport {interrupt} from \"d3-transition\";\nimport constant from \"./constant\";\nimport BrushEvent from \"./event\";\nimport noevent, {nopropagation} from \"./noevent\";\n\nvar MODE_DRAG = {name: \"drag\"},\n    MODE_SPACE = {name: \"space\"},\n    MODE_HANDLE = {name: \"handle\"},\n    MODE_CENTER = {name: \"center\"};\n\nvar X = {\n  name: \"x\",\n  handles: [\"e\", \"w\"].map(type),\n  input: function(x, e) { return x && [[x[0], e[0][1]], [x[1], e[1][1]]]; },\n  output: function(xy) { return xy && [xy[0][0], xy[1][0]]; }\n};\n\nvar Y = {\n  name: \"y\",\n  handles: [\"n\", \"s\"].map(type),\n  input: function(y, e) { return y && [[e[0][0], y[0]], [e[1][0], y[1]]]; },\n  output: function(xy) { return xy && [xy[0][1], xy[1][1]]; }\n};\n\nvar XY = {\n  name: \"xy\",\n  handles: [\"n\", \"e\", \"s\", \"w\", \"nw\", \"ne\", \"se\", \"sw\"].map(type),\n  input: function(xy) { return xy; },\n  output: function(xy) { return xy; }\n};\n\nvar cursors = {\n  overlay: \"crosshair\",\n  selection: \"move\",\n  n: \"ns-resize\",\n  e: \"ew-resize\",\n  s: \"ns-resize\",\n  w: \"ew-resize\",\n  nw: \"nwse-resize\",\n  ne: \"nesw-resize\",\n  se: \"nwse-resize\",\n  sw: \"nesw-resize\"\n};\n\nvar flipX = {\n  e: \"w\",\n  w: \"e\",\n  nw: \"ne\",\n  ne: \"nw\",\n  se: \"sw\",\n  sw: \"se\"\n};\n\nvar flipY = {\n  n: \"s\",\n  s: \"n\",\n  nw: \"sw\",\n  ne: \"se\",\n  se: \"ne\",\n  sw: \"nw\"\n};\n\nvar signsX = {\n  overlay: +1,\n  selection: +1,\n  n: null,\n  e: +1,\n  s: null,\n  w: -1,\n  nw: -1,\n  ne: +1,\n  se: +1,\n  sw: -1\n};\n\nvar signsY = {\n  overlay: +1,\n  selection: +1,\n  n: -1,\n  e: null,\n  s: +1,\n  w: null,\n  nw: -1,\n  ne: -1,\n  se: +1,\n  sw: +1\n};\n\nfunction type(t) {\n  return {type: t};\n}\n\n// Ignore right-click, since that should open the context menu.\nfunction defaultFilter() {\n  return !event.button;\n}\n\nfunction defaultExtent() {\n  var svg = this.ownerSVGElement || this;\n  return [[0, 0], [svg.width.baseVal.value, svg.height.baseVal.value]];\n}\n\n// Like d3.local, but with the name “__brush” rather than auto-generated.\nfunction local(node) {\n  while (!node.__brush) if (!(node = node.parentNode)) return;\n  return node.__brush;\n}\n\nfunction empty(extent) {\n  return extent[0][0] === extent[1][0]\n      || extent[0][1] === extent[1][1];\n}\n\nexport function brushSelection(node) {\n  var state = node.__brush;\n  return state ? state.dim.output(state.selection) : null;\n}\n\nexport function brushX() {\n  return brush(X);\n}\n\nexport function brushY() {\n  return brush(Y);\n}\n\nexport default function() {\n  return brush(XY);\n}\n\nfunction brush(dim) {\n  var extent = defaultExtent,\n      filter = defaultFilter,\n      listeners = dispatch(brush, \"start\", \"brush\", \"end\"),\n      handleSize = 6,\n      touchending;\n\n  function brush(group) {\n    var overlay = group\n        .property(\"__brush\", initialize)\n      .selectAll(\".overlay\")\n      .data([type(\"overlay\")]);\n\n    overlay.enter().append(\"rect\")\n        .attr(\"class\", \"overlay\")\n        .attr(\"pointer-events\", \"all\")\n        .attr(\"cursor\", cursors.overlay)\n      .merge(overlay)\n        .each(function() {\n          var extent = local(this).extent;\n          select(this)\n              .attr(\"x\", extent[0][0])\n              .attr(\"y\", extent[0][1])\n              .attr(\"width\", extent[1][0] - extent[0][0])\n              .attr(\"height\", extent[1][1] - extent[0][1]);\n        });\n\n    group.selectAll(\".selection\")\n      .data([type(\"selection\")])\n      .enter().append(\"rect\")\n        .attr(\"class\", \"selection\")\n        .attr(\"cursor\", cursors.selection)\n        .attr(\"fill\", \"#777\")\n        .attr(\"fill-opacity\", 0.3)\n        .attr(\"stroke\", \"#fff\")\n        .attr(\"shape-rendering\", \"crispEdges\");\n\n    var handle = group.selectAll(\".handle\")\n      .data(dim.handles, function(d) { return d.type; });\n\n    handle.exit().remove();\n\n    handle.enter().append(\"rect\")\n        .attr(\"class\", function(d) { return \"handle handle--\" + d.type; })\n        .attr(\"cursor\", function(d) { return cursors[d.type]; });\n\n    group\n        .each(redraw)\n        .attr(\"fill\", \"none\")\n        .attr(\"pointer-events\", \"all\")\n        .style(\"-webkit-tap-highlight-color\", \"rgba(0,0,0,0)\")\n        .on(\"mousedown.brush touchstart.brush\", started);\n  }\n\n  brush.move = function(group, selection) {\n    if (group.selection) {\n      group\n          .on(\"start.brush\", function() { emitter(this, arguments).beforestart().start(); })\n          .on(\"interrupt.brush end.brush\", function() { emitter(this, arguments).end(); })\n          .tween(\"brush\", function() {\n            var that = this,\n                state = that.__brush,\n                emit = emitter(that, arguments),\n                selection0 = state.selection,\n                selection1 = dim.input(typeof selection === \"function\" ? selection.apply(this, arguments) : selection, state.extent),\n                i = interpolate(selection0, selection1);\n\n            function tween(t) {\n              state.selection = t === 1 && empty(selection1) ? null : i(t);\n              redraw.call(that);\n              emit.brush();\n            }\n\n            return selection0 && selection1 ? tween : tween(1);\n          });\n    } else {\n      group\n          .each(function() {\n            var that = this,\n                args = arguments,\n                state = that.__brush,\n                selection1 = dim.input(typeof selection === \"function\" ? selection.apply(that, args) : selection, state.extent),\n                emit = emitter(that, args).beforestart();\n\n            interrupt(that);\n            state.selection = selection1 == null || empty(selection1) ? null : selection1;\n            redraw.call(that);\n            emit.start().brush().end();\n          });\n    }\n  };\n\n  function redraw() {\n    var group = select(this),\n        selection = local(this).selection;\n\n    if (selection) {\n      group.selectAll(\".selection\")\n          .style(\"display\", null)\n          .attr(\"x\", selection[0][0])\n          .attr(\"y\", selection[0][1])\n          .attr(\"width\", selection[1][0] - selection[0][0])\n          .attr(\"height\", selection[1][1] - selection[0][1]);\n\n      group.selectAll(\".handle\")\n          .style(\"display\", null)\n          .attr(\"x\", function(d) { return d.type[d.type.length - 1] === \"e\" ? selection[1][0] - handleSize / 2 : selection[0][0] - handleSize / 2; })\n          .attr(\"y\", function(d) { return d.type[0] === \"s\" ? selection[1][1] - handleSize / 2 : selection[0][1] - handleSize / 2; })\n          .attr(\"width\", function(d) { return d.type === \"n\" || d.type === \"s\" ? selection[1][0] - selection[0][0] + handleSize : handleSize; })\n          .attr(\"height\", function(d) { return d.type === \"e\" || d.type === \"w\" ? selection[1][1] - selection[0][1] + handleSize : handleSize; });\n    }\n\n    else {\n      group.selectAll(\".selection,.handle\")\n          .style(\"display\", \"none\")\n          .attr(\"x\", null)\n          .attr(\"y\", null)\n          .attr(\"width\", null)\n          .attr(\"height\", null);\n    }\n  }\n\n  function emitter(that, args) {\n    return that.__brush.emitter || new Emitter(that, args);\n  }\n\n  function Emitter(that, args) {\n    this.that = that;\n    this.args = args;\n    this.state = that.__brush;\n    this.active = 0;\n  }\n\n  Emitter.prototype = {\n    beforestart: function() {\n      if (++this.active === 1) this.state.emitter = this, this.starting = true;\n      return this;\n    },\n    start: function() {\n      if (this.starting) this.starting = false, this.emit(\"start\");\n      return this;\n    },\n    brush: function() {\n      this.emit(\"brush\");\n      return this;\n    },\n    end: function() {\n      if (--this.active === 0) delete this.state.emitter, this.emit(\"end\");\n      return this;\n    },\n    emit: function(type) {\n      customEvent(new BrushEvent(brush, type, dim.output(this.state.selection)), listeners.apply, listeners, [type, this.that, this.args]);\n    }\n  };\n\n  function started() {\n    if (event.touches) { if (event.changedTouches.length < event.touches.length) return noevent(); }\n    else if (touchending) return;\n    if (!filter.apply(this, arguments)) return;\n\n    var that = this,\n        type = event.target.__data__.type,\n        mode = (event.metaKey ? type = \"overlay\" : type) === \"selection\" ? MODE_DRAG : (event.altKey ? MODE_CENTER : MODE_HANDLE),\n        signX = dim === Y ? null : signsX[type],\n        signY = dim === X ? null : signsY[type],\n        state = local(that),\n        extent = state.extent,\n        selection = state.selection,\n        W = extent[0][0], w0, w1,\n        N = extent[0][1], n0, n1,\n        E = extent[1][0], e0, e1,\n        S = extent[1][1], s0, s1,\n        dx,\n        dy,\n        moving,\n        shifting = false, // ZK disable shift key\n        lockX,\n        lockY,\n        point0 = mouse(that),\n        point = point0,\n        emit = emitter(that, arguments).beforestart();\n\n    if (type === \"overlay\") {\n      state.selection = selection = [\n        [w0 = dim === Y ? W : point0[0], n0 = dim === X ? N : point0[1]],\n        [e0 = dim === Y ? E : w0, s0 = dim === X ? S : n0]\n      ];\n    } else {\n      w0 = selection[0][0];\n      n0 = selection[0][1];\n      e0 = selection[1][0];\n      s0 = selection[1][1];\n    }\n\n    w1 = w0;\n    n1 = n0;\n    e1 = e0;\n    s1 = s0;\n\n    var group = select(that)\n        .attr(\"pointer-events\", \"none\");\n\n    var overlay = group.selectAll(\".overlay\")\n        .attr(\"cursor\", cursors[type]);\n\n    if (event.touches) {\n      group\n          .on(\"touchmove.brush\", moved, true)\n          .on(\"touchend.brush touchcancel.brush\", ended, true);\n    } else {\n      var view = select(event.view)\n          .on(\"keydown.brush\", keydowned, true)\n          .on(\"keyup.brush\", keyupped, true)\n          .on(\"mousemove.brush\", moved, true)\n          .on(\"mouseup.brush\", ended, true);\n\n      dragDisable(event.view);\n    }\n\n    nopropagation();\n    interrupt(that);\n    redraw.call(that);\n    emit.start();\n\n    function moved() {\n      var point1 = mouse(that);\n      if (shifting && !lockX && !lockY) {\n        if (Math.abs(point1[0] - point[0]) > Math.abs(point1[1] - point[1])) lockY = true;\n        else lockX = true;\n      }\n      point = point1;\n      moving = true;\n      noevent();\n      move();\n    }\n\n    function move() {\n      var t;\n\n      dx = point[0] - point0[0];\n      dy = point[1] - point0[1];\n\n      switch (mode) {\n        case MODE_SPACE:\n        case MODE_DRAG: {\n          if (signX) dx = Math.max(W - w0, Math.min(E - e0, dx)), w1 = w0 + dx, e1 = e0 + dx;\n          if (signY) dy = Math.max(N - n0, Math.min(S - s0, dy)), n1 = n0 + dy, s1 = s0 + dy;\n          break;\n        }\n        case MODE_HANDLE: {\n          if (signX < 0) dx = Math.max(W - w0, Math.min(E - w0, dx)), w1 = w0 + dx, e1 = e0;\n          else if (signX > 0) dx = Math.max(W - e0, Math.min(E - e0, dx)), w1 = w0, e1 = e0 + dx;\n          if (signY < 0) dy = Math.max(N - n0, Math.min(S - n0, dy)), n1 = n0 + dy, s1 = s0;\n          else if (signY > 0) dy = Math.max(N - s0, Math.min(S - s0, dy)), n1 = n0, s1 = s0 + dy;\n          break;\n        }\n        case MODE_CENTER: {\n          if (signX) w1 = Math.max(W, Math.min(E, w0 - dx * signX)), e1 = Math.max(W, Math.min(E, e0 + dx * signX));\n          if (signY) n1 = Math.max(N, Math.min(S, n0 - dy * signY)), s1 = Math.max(N, Math.min(S, s0 + dy * signY));\n          break;\n        }\n      }\n\n      if (e1 < w1) {\n        signX *= -1;\n        t = w0, w0 = e0, e0 = t;\n        t = w1, w1 = e1, e1 = t;\n        if (type in flipX) overlay.attr(\"cursor\", cursors[type = flipX[type]]);\n      }\n\n      if (s1 < n1) {\n        signY *= -1;\n        t = n0, n0 = s0, s0 = t;\n        t = n1, n1 = s1, s1 = t;\n        if (type in flipY) overlay.attr(\"cursor\", cursors[type = flipY[type]]);\n      }\n\n      if (state.selection) selection = state.selection; // May be set by brush.move!\n      if (lockX) w1 = selection[0][0], e1 = selection[1][0];\n      if (lockY) n1 = selection[0][1], s1 = selection[1][1];\n\n      if (selection[0][0] !== w1\n          || selection[0][1] !== n1\n          || selection[1][0] !== e1\n          || selection[1][1] !== s1) {\n        state.selection = [[w1, n1], [e1, s1]];\n        redraw.call(that);\n        emit.brush();\n      }\n    }\n\n    function ended() {\n      nopropagation();\n      if (event.touches) {\n        if (event.touches.length) return;\n        if (touchending) clearTimeout(touchending);\n        touchending = setTimeout(function() { touchending = null; }, 500); // Ghost clicks are delayed!\n        group.on(\"touchmove.brush touchend.brush touchcancel.brush\", null);\n      } else {\n        dragEnable(event.view, moving);\n        view.on(\"keydown.brush keyup.brush mousemove.brush mouseup.brush\", null);\n      }\n      group.attr(\"pointer-events\", \"all\");\n      overlay.attr(\"cursor\", cursors.overlay);\n      if (state.selection) selection = state.selection; // May be set by brush.move (on start)!\n      if (empty(selection)) state.selection = null, redraw.call(that);\n      emit.end();\n    }\n\n    function keydowned() {\n      switch (event.keyCode) {\n        case 16: { // SHIFT\n          shifting = signX && signY;\n          break;\n        }\n        case 18: { // ALT\n          if (mode === MODE_HANDLE) {\n            if (signX) e0 = e1 - dx * signX, w0 = w1 + dx * signX;\n            if (signY) s0 = s1 - dy * signY, n0 = n1 + dy * signY;\n            mode = MODE_CENTER;\n            move();\n          }\n          break;\n        }\n        case 32: { // SPACE; takes priority over ALT\n          if (mode === MODE_HANDLE || mode === MODE_CENTER) {\n            if (signX < 0) e0 = e1 - dx; else if (signX > 0) w0 = w1 - dx;\n            if (signY < 0) s0 = s1 - dy; else if (signY > 0) n0 = n1 - dy;\n            mode = MODE_SPACE;\n            overlay.attr(\"cursor\", cursors.selection);\n            move();\n          }\n          break;\n        }\n        default: return;\n      }\n      noevent();\n    }\n\n    function keyupped() {\n      switch (event.keyCode) {\n        case 16: { // SHIFT\n          if (shifting) {\n            lockX = lockY = shifting = false;\n            move();\n          }\n          break;\n        }\n        case 18: { // ALT\n          if (mode === MODE_CENTER) {\n            if (signX < 0) e0 = e1; else if (signX > 0) w0 = w1;\n            if (signY < 0) s0 = s1; else if (signY > 0) n0 = n1;\n            mode = MODE_HANDLE;\n            move();\n          }\n          break;\n        }\n        case 32: { // SPACE\n          if (mode === MODE_SPACE) {\n            if (event.altKey) {\n              if (signX) e0 = e1 - dx * signX, w0 = w1 + dx * signX;\n              if (signY) s0 = s1 - dy * signY, n0 = n1 + dy * signY;\n              mode = MODE_CENTER;\n            } else {\n              if (signX < 0) e0 = e1; else if (signX > 0) w0 = w1;\n              if (signY < 0) s0 = s1; else if (signY > 0) n0 = n1;\n              mode = MODE_HANDLE;\n            }\n            overlay.attr(\"cursor\", cursors[type]);\n            move();\n          }\n          break;\n        }\n        default: return;\n      }\n      noevent();\n    }\n  }\n\n  function initialize() {\n    var state = this.__brush || {selection: null};\n    state.extent = extent.apply(this, arguments);\n    state.dim = dim;\n    return state;\n  }\n\n  brush.extent = function(_) {\n    return arguments.length ? (extent = typeof _ === \"function\" ? _ : constant([[+_[0][0], +_[0][1]], [+_[1][0], +_[1][1]]]), brush) : extent;\n  };\n\n  brush.filter = function(_) {\n    return arguments.length ? (filter = typeof _ === \"function\" ? _ : constant(!!_), brush) : filter;\n  };\n\n  brush.handleSize = function(_) {\n    return arguments.length ? (handleSize = +_, brush) : handleSize;\n  };\n\n  brush.on = function() {\n    var value = listeners.on.apply(listeners, arguments);\n    return value === listeners ? brush : value;\n  };\n\n  return brush;\n}\n","import {\r\n  brush as d3Brush,\r\n  brushSelection as d3BrushSelection\r\n} from 'd3-brush';\r\n// @ts-ignore, somehow there are no types for this, but its there\r\nimport {event} from 'd3-selection';\r\nimport {D3Selection} from './types';\r\nimport {EscherMap} from './escherMap';\r\n\r\n/**\r\n * Define a brush to select elements in a map.\r\n * @param {D3 Selection} selection - A d3 selection to place the brush in.\r\n * @param {Boolean} is_enabled - Whether to turn the brush on.\r\n * @param {escher.Map} map - The map where the brush will be active.\r\n * @param {String} insert_after - A d3 selector string to choose the svg element\r\n *                                that the brush will be inserted after. Often a\r\n *                                canvas element (e.g. '.canvas-group').\r\n */\r\nexport default class Brush {\r\n  brushSel: D3Selection<SVGGElement>;\r\n  enabled: boolean;\r\n  map: EscherMap;\r\n\r\n  constructor(selection: D3Selection, isEnabled: boolean, map: EscherMap, insertAfter: string) {\r\n    this.brushSel = selection.append('g').attr('id', 'brush-container');\r\n    const node = this.brushSel.node();\r\n    const insertBeforeNode = (selection.select(insertAfter).node()! as Element).nextSibling as Node;\r\n    if (node !== insertBeforeNode)\r\n      node!.parentNode!.insertBefore(node!, insertBeforeNode);\r\n\r\n    this.enabled = isEnabled;\r\n    this.map = map;\r\n  }\r\n\r\n  /**\r\n   * Returns a boolean for the on/off status of the brush\r\n   * @return {Boolean}\r\n   */\r\n  brushIsEnabled() {\r\n    return this.map.sel.select('.brush').empty();\r\n  }\r\n\r\n  /**\r\n   * Turn the brush on or off\r\n   * @param {Boolean} on_off\r\n   */\r\n  toggle(onOff: boolean | undefined) {\r\n    if (onOff === undefined)\r\n      onOff = !this.enabled;\r\n\r\n    if (onOff)\r\n      this.setupSelectionBrush();\r\n    else\r\n      this.brushSel.selectAll('*').remove();\r\n  }\r\n\r\n  /**\r\n   * Turn off the mouse crosshair\r\n   */\r\n  turnOffCrosshair(sel: D3Selection<SVGGElement>) {\r\n    sel.selectAll('rect').attr('cursor', null);\r\n  }\r\n\r\n  setupSelectionBrush() {\r\n    const map = this.map;\r\n    const selection = this.brushSel;\r\n    const selectableSelection = map.sel.selectAll('#nodes,#text-labels');\r\n    const sizeAndLocation = map.canvas.sizeAndLocation();\r\n    const width = sizeAndLocation.width;\r\n    const height = sizeAndLocation.height;\r\n    const x = sizeAndLocation.x;\r\n    const y = sizeAndLocation.y;\r\n    const turnOffCrosshair = this.turnOffCrosshair.bind(this);\r\n\r\n    // Clear existing brush\r\n    selection.selectAll('*').remove();\r\n\r\n    // Set a flag so we know that the brush is being cleared at the end of a\r\n    // successful brush\r\n    let clearingFlag = false;\r\n\r\n    const brush = d3Brush()\r\n      .extent([[x, y], [x + width, y + height]])\r\n      .on('start', () => {\r\n        this.turnOffCrosshair(selection);\r\n        // unhide secondary metabolites if they are hidden\r\n        if (map.settings.get('hide_secondary_metabolites')) {\r\n          map.settings.set('hide_secondary_metabolites', false);\r\n          map.draw_everything();\r\n          map.set_status('Showing secondary metabolites. You can hide them ' +\r\n                           'again in Settings.', 2000);\r\n        }\r\n      })\r\n      .on('brush', function() {\r\n        const shiftKeyOn = event.sourceEvent.shiftKey;\r\n        // @ts-ignore\r\n        // eslint-disable-next-line no-invalid-this\r\n        const rect = d3BrushSelection(this as any);\r\n        // Check for no selection (e.g. after clearing brush)\r\n        if (rect !== null) {\r\n          // When shift is pressed, ignore the currently selected nodes.\r\n          // Otherwise, brush all nodes.\r\n          const selection = shiftKeyOn ?\r\n            selectableSelection.selectAll('.node:not(.selected),.text-label:not(.selected)') :\r\n            selectableSelection.selectAll('.node,.text-label');\r\n          selection.classed('selected', (d: any) => {\r\n            const sx = d.x;\r\n            const sy = d.y;\r\n            // @ts-ignore\r\n            return (rect[0][0] <= sx && sx < rect[1][0] && rect[0][1] <= sy && sy < rect[1][1]);\r\n          });\r\n        }\r\n      })\r\n      .on('end', function() {\r\n        turnOffCrosshair(selection);\r\n        // Clear brush\r\n        // @ts-ignore\r\n        // eslint-disable-next-line no-invalid-this\r\n        const rect = d3BrushSelection(this as any);\r\n        if (rect == null) {\r\n          if (clearingFlag)\r\n            clearingFlag = false;\r\n          else {\r\n            // Empty selection, deselect all\r\n            map.select_none();\r\n          }\r\n        } else {\r\n          // Not empty, then clear the box\r\n          clearingFlag = true;\r\n          selection.call(brush.move, null);\r\n        }\r\n      });\r\n\r\n    selection\r\n    // Initialize brush\r\n      .call(brush);\r\n\r\n    // Turn off the pan grab icons\r\n    turnOffCrosshair(selection);\r\n  }\r\n}\r\n","import * as bacon from 'baconjs';\r\nimport _ from 'underscore';\r\nimport {SettingsType} from './types';\r\n\r\n/**\r\n * Hold on to event when holdProperty is true, and only keep them if\r\n * acceptProperty is true (when holdProperty becomes false).\r\n */\r\nfunction convertToConditionalStream(valueStream: bacon.Bus<unknown>, statusStream: bacon.Bus<unknown>) {\r\n  // Combine values with status to revert to last value when a reject is passed.\r\n  const init: any = {\r\n    savedValue: null,\r\n    currentValue: null,\r\n    lastStatus: null\r\n  };\r\n\r\n  const held = bacon.combineAsArray(valueStream, statusStream.toProperty(null))\r\n    .scan(init, ({savedValue, currentValue, lastStatus}, [value, status]) => {\r\n      // See if the status was just set\r\n      const newStatus = lastStatus !== status;\r\n\r\n      if (newStatus && status === 'hold') {\r\n        // Record the currentValue as the savedValue\r\n        return {\r\n          savedValue: currentValue,\r\n          currentValue,\r\n          lastStatus: status\r\n        };\r\n      } else if (!newStatus && status === 'hold') {\r\n        // Record the current value, and keep the savedValue unchanged\r\n        return {\r\n          savedValue,\r\n          currentValue: value,\r\n          lastStatus: status\r\n        };\r\n      } else if (newStatus && status === 'abandon') {\r\n        // Keep the saved value\r\n        return {\r\n          savedValue: null,\r\n          currentValue: savedValue,\r\n          lastStatus: status\r\n        };\r\n      } else if (newStatus && status === 'accept') {\r\n        // Keep the new value\r\n        return {\r\n          savedValue: null,\r\n          currentValue,\r\n          lastStatus: status\r\n        };\r\n      } else {\r\n        // Not held, so keep the value\r\n        return {\r\n          savedValue: null,\r\n          currentValue: value,\r\n          lastStatus: status\r\n        };\r\n      }\r\n    })\r\n  // Skip the initial null value\r\n    .skip(1)\r\n  // Get the current value\r\n    .map(({currentValue}) => currentValue)\r\n  // Skip duplicate values\r\n    .skipDuplicates()\r\n  // property -> event stream\r\n    .toEventStream();\r\n\r\n  return held;\r\n}\r\n\r\n/**\r\n * Settings. A class to manage settings for a Map.\r\n *\r\n * Arguments\r\n * ---------\r\n *\r\n * setOption: A function, fn(key), that returns the option value for the key.\r\n *\r\n * getOption: A function, fn(key, value), that sets the option for the key and\r\n * value.\r\n *\r\n * conditionalOptions: The options to that are conditionally accepted when\r\n * changed. Changes can be abandoned by calling abandonChanges(), or accepted\r\n * by calling acceptChanges().\r\n  * @param optionsWithDefaults - The current option values\r\n  * @param conditionalOptions - The options to that are conditionally accepted\r\n  *                             when changed. Changes can be abandoned by calling\r\n  *                             abandon_changes(), or accepted by calling\r\n  *                             accept_changes().\r\n  */\r\nexport default class Settings {\r\n  private _options: SettingsType & {[key: string]: any};\r\n  statusBus: bacon.Bus<unknown>;\r\n  busses: _.Dictionary<bacon.Bus<any>>;\r\n  streams: _.Dictionary<bacon.EventStream<any>>;\r\n  acceptedStreams: _.Dictionary<bacon.EventStream<any>>;\r\n  get options() {\r\n    return this._options;\r\n  }\r\n  constructor(optionsWithDefaults: SettingsType, conditionalOptions: (keyof SettingsType)[] = []) {\r\n    this._options = optionsWithDefaults;\r\n\r\n    // Manage accepting/abandoning changes\r\n    this.statusBus = new bacon.Bus()\r\n\r\n    // Create the options\r\n    //@ts-ignore\r\n    ;[this.busses, this.streams, this.acceptedStreams] = _.chain(optionsWithDefaults)\r\n      .mapObject((value, key) => {\r\n        const isConditional = _.contains(conditionalOptions, key);\r\n        const {bus, stream, acceptedStream} = this.createSetting(key, value, isConditional);\r\n        return [bus, stream, acceptedStream];\r\n      }) // { k: [ b, s ], ... }\r\n      .pairs() // [ [ k, [ b, s ] ], ... ]\r\n      .map(([name, [bus, stream, acceptedStream]]) => [\r\n        [name, bus],\r\n        [name, stream],\r\n        [name, acceptedStream]\r\n      ]) // [ [ [ k, b ], [ k, s ] ], ... ]\r\n      .unzip() // [ [ [ k, b ], ... ], [ [ k, s ], ... ] ]\r\n      .map((x) => _.object(x)) // [ { k: b, ... }, { k: s, ... } ]\r\n      .value();\r\n  }\r\n\r\n  /**\r\n   * Set up a new bus and stream for a conditional setting (i.e. one that can be\r\n   * canceled in the settings menu.\r\n   */\r\n  createSetting(name: string, initialValue: any, isConditional: boolean) {\r\n    // Set up the bus\r\n    const bus = new bacon.Bus();\r\n\r\n    // Make the event stream and conditionally accept changes\r\n    const stream = isConditional ?\r\n      convertToConditionalStream(bus, this.statusBus) :\r\n      bus.toEventStream();\r\n\r\n    // Make a stream for the accepted values only. First get the latest value\r\n    // after accepting. Also get a latest copy of the correct value if the data\r\n    // is abandoned.\r\n    const acceptedStream = stream.sampledBy(\r\n      this.statusBus.filter((status) => status === 'accept' || status === 'abandon')\r\n    ).merge(\r\n      // Then merge with all the other changes\r\n      stream.filter(\r\n        this.statusBus.map((status) => status === 'accept').toProperty(true)\r\n      )\r\n    );\r\n\r\n    // Get the latest\r\n    stream.onValue((v) => { this._options[name] = v; });\r\n\r\n    // Push the initial value\r\n    bus.push(initialValue);\r\n\r\n    return {bus, stream, acceptedStream};\r\n  }\r\n\r\n  /**\r\n   * Deprecated. Use `set` instead.\r\n   */\r\n  set_conditional(name: string, value: any) { // eslint-disable-line camelcase\r\n    console.warn('set_conditional is deprecated. Use Settings.set() instead');\r\n    return this.set(name, value);\r\n  }\r\n\r\n  /**\r\n   * Set the option. This should always be used instead of setting options\r\n   * directly. To set options that respect the Settings menu Accept/Abandon, use\r\n   * setConditional().\r\n   * @param {String} name - The option name\r\n   * @param {Any} value - The new value\r\n   * can check whether the change was made internally to avoid loops.\r\n   */\r\n  set<T extends keyof SettingsType>(name: T, value: SettingsType[T]): void;\r\n  set(name: keyof SettingsType | string, value: any): void;\r\n  set(name: string, value: any): void {\r\n    if (!(name in this.busses))\r\n      throw new Error(`Invalid setting name ${name}`);\r\n\r\n    this.busses[name].push(value);\r\n  }\r\n\r\n  /**\r\n   * Deprecated. Use `get` intead.\r\n   */\r\n  get_option(name: string) { // eslint-disable-line camelcase\r\n    console.warn('get_option is deprecated. Use Settings.get() instead');\r\n    return this.get(name);\r\n  }\r\n\r\n  /**\r\n   * Get an option with type inference\r\n   * @param name - The name of the setting to get\r\n   * @returns The value of the setting with its correct type\r\n   */\r\n  get<K extends keyof SettingsType>(name: K): SettingsType[K];\r\n  get(name: string): any;\r\n  get(name: keyof SettingsType | string): any {\r\n    return this._options[name];\r\n  }\r\n\r\n  holdChanges() {\r\n    this.statusBus.push('hold');\r\n  }\r\n\r\n  abandonChanges() {\r\n    this.statusBus.push('abandon');\r\n  }\r\n\r\n  acceptChanges() {\r\n    this.statusBus.push('accept');\r\n  }\r\n}\r\n","import {EscherMap} from './escherMap';\r\nimport PlacedDiv from './PlacedDiv';\r\nimport {Coord, D3Selection, TextLabel} from './types';\r\nimport ZoomContainer from './ZoomContainer';\r\n\r\n/**\r\n * TextEditInput\r\n */\r\nexport default class TextEditInput {\r\n  private placedDiv: PlacedDiv;\r\n  private input: D3Selection<HTMLInputElement>;\r\n  private map: EscherMap;\r\n  private zoomContainer: ZoomContainer;\r\n  private isNew: boolean;\r\n  private clearEscape: (() => void) | null = null;\r\n  private clearEnter: (() => void) | null = null;\r\n  private activeTarget: { target: D3Selection<SVGElement>, coords: { x: number, y: number } } | null = null;\r\n\r\n  constructor(selection: D3Selection, map: EscherMap, zoomContainer: ZoomContainer) {\r\n    const div = selection.append('div')\r\n      .attr('id', 'text-edit-input');\r\n    this.placedDiv = new PlacedDiv(div, map);\r\n    this.placedDiv.hide();\r\n    this.input = div.append('input');\r\n\r\n    this.map = map;\r\n    this.setUpMapCallbacks(map);\r\n    this.zoomContainer = zoomContainer;\r\n    this.setUpZoomCallbacks(zoomContainer);\r\n\r\n    this.isNew = false;\r\n  }\r\n\r\n  setUpMapCallbacks(map: EscherMap) {\r\n    // Input\r\n    map.callback_manager.set('edit_text_label.text_edit_input', (target: D3Selection<any>, coords: Coord) => {\r\n      this.show(target, coords);\r\n    });\r\n\r\n    // new text_label\r\n    map.callback_manager.set('new_text_label.text_edit_input', (coords: Coord) => {\r\n      if (this.activeTarget !== null)\r\n        this._acceptChanges(this.activeTarget.target);\r\n\r\n      this.hide();\r\n      this._addAndEdit(coords);\r\n    });\r\n\r\n    map.callback_manager.set('hide_text_label_editor.text_edit_input', () => {\r\n      this.hide();\r\n    });\r\n  }\r\n\r\n  setUpZoomCallbacks(zoomContainer: ZoomContainer) {\r\n    zoomContainer.callbackManager.set('zoom.text_edit_input', () => {\r\n      if (this.activeTarget)\r\n        this._acceptChanges(this.activeTarget.target);\r\n\r\n      if (this.is_visible())\r\n        this.hide();\r\n    });\r\n    zoomContainer.callbackManager.set('go_to.text_edit_input', () => {\r\n      if (this.activeTarget)\r\n        this._acceptChanges(this.activeTarget.target);\r\n\r\n      if (this.is_visible())\r\n        this.hide();\r\n    });\r\n  }\r\n\r\n  is_visible() { // eslint-disable-line camelcase\r\n    return this.placedDiv.is_visible();\r\n  }\r\n\r\n  show(target: D3Selection<any>, coords: { x: number, y: number }) {\r\n    // save any existing edit\r\n    if (this.activeTarget)\r\n      this._acceptChanges(this.activeTarget.target);\r\n\r\n\r\n    // set the current target\r\n    this.activeTarget = {target, coords};\r\n\r\n    // set the new value\r\n    target.each((d: any) => {\r\n      this.input.node()!.value = d.text;\r\n    });\r\n\r\n    // place the input\r\n    this.placedDiv.place(coords);\r\n    this.input.node()!.focus();\r\n\r\n    // escape key\r\n    this.clearEscape = this.map.key_manager.addEscapeListener(() => {\r\n      this._acceptChanges(target);\r\n      this.hide();\r\n    });\r\n    // enter key\r\n    this.clearEnter = this.map.key_manager.addEnterListener(() => {\r\n      this._acceptChanges(target);\r\n      this.hide();\r\n    }, true);\r\n  }\r\n\r\n  hide() {\r\n    this.isNew = false;\r\n\r\n    // hide the input\r\n    this.placedDiv.hide();\r\n\r\n    // clear the value\r\n    this.input.attr('value', '');\r\n    this.activeTarget = null;\r\n\r\n    // clear escape\r\n    if (this.clearEscape) this.clearEscape();\r\n    this.clearEscape = null;\r\n    // clear enter\r\n    if (this.clearEnter) this.clearEnter();\r\n    this.clearEnter = null;\r\n    // turn off click listener\r\n    // this.map.sel.on('click.', null)\r\n  }\r\n\r\n  _acceptChanges(target: D3Selection<SVGElement>) {\r\n    const value = this.input.node()!.value;\r\n    if (value === '') {\r\n      // Delete the label\r\n      target.each((d: any) => {\r\n        const selected: { [key: string]: TextLabel } = {};\r\n        selected[d.text_label_id] = this.map.text_labels[d.text_label_id];\r\n        this.map.delete_selectable({}, selected, true);\r\n      });\r\n    } else {\r\n      // Set the text\r\n      const textLabelIds = [];\r\n      target.each((d: any) => {\r\n        this.map.edit_text_label(d.text_label_id, value, true, this.isNew);\r\n        textLabelIds.push(d.text_label_id);\r\n      });\r\n    }\r\n  }\r\n\r\n  _addAndEdit(coords: Coord) {\r\n    this.isNew = true;\r\n\r\n    // Make an empty label\r\n    const textLabelId = this.map.new_text_label(coords, '');\r\n    // Apply the cursor to the new label\r\n    const sel = this.map.sel.select('#text-labels').selectAll('.text-label')\r\n      .filter((d: any) => d.text_label_id === textLabelId);\r\n    sel.select('text').classed('edit-text-cursor', true);\r\n    this.show(sel, coords);\r\n  }\r\n}\r\n","/** @jsx h */\r\nimport {h, Component, render, Ref} from 'preact';\r\n\r\nclass Wrapper extends Component {\r\n  state: {display?: boolean} = {display: false};\r\n  props: {component: any, connectSetStateFn: (props: any) => void, ref: any, refPassthrough: any};\r\n  constructor(props: {component: any, connectSetStateFn: (props: any) => void, ref: any, refPassthrough: any}) {\r\n    super(props);\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.connectSetStateFn((props) => this.setState(props));\r\n  }\r\n\r\n  is_visible() { // eslint-disable-line camelcase\r\n    return this.state.display;\r\n  }\r\n\r\n  render() {\r\n    if (!this.state.display) return null;\r\n\r\n    // Pass the new props, and always pass the ref\r\n    return (\r\n      <this.props.component\r\n        setDisplay={(display) => this.setState({display})}\r\n        ref={this.props.refPassthrough}\r\n        {...this.state}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\n/**\r\n * Wrapper for better integration of Preact components with Escher. The\r\n * component can be updated using the connectSetStateFn to set up a callback for\r\n * updates from other components.\r\n * @param {} component - A Preact component\r\n *\r\n * @param {} ref - A preact ref for the wrapper so that the \"display\" state can\r\n *                 be tracked.\r\n */\r\nfunction renderWrapper(\r\n  component: any,\r\n  ref: any,\r\n  connectSetStateFn: (props: any) => void,\r\n  divNode: Element,\r\n  refPassthrough: Ref<any> | null = null\r\n) {\r\n  render(\r\n    <Wrapper\r\n      component={component}\r\n      connectSetStateFn={connectSetStateFn}\r\n      ref={ref}\r\n      refPassthrough={refPassthrough}\r\n    />,\r\n    divNode,\r\n    // If there is already a div, re-render it. Otherwise make a new one\r\n    divNode.children.length > 0 ? divNode.firstChild as Element : undefined\r\n  );\r\n}\r\n\r\nexport default renderWrapper;\r\n","/** @jsx h */\r\n\r\nimport {h, Component} from 'preact';\r\n\r\nclass ScaleSelector extends Component<{\r\n  disabled: boolean;\r\n  children: any;\r\n}> {\r\n  state: {\r\n    visible: boolean;\r\n  };\r\n  wrapperRef: HTMLElement | null = null;\r\n\r\n  constructor(props: {disabled: boolean; children: any}) {\r\n    super(props);\r\n    this.setWrapperRef = this.setWrapperRef.bind(this);\r\n    this.handleClickOutside = this.handleClickOutside.bind(this);\r\n    this.state = {\r\n      visible: false\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    document.addEventListener('mouseup', this.handleClickOutside);\r\n  }\r\n\r\n  // Reference for hiding the menu when a mouse event happens outside\r\n  setWrapperRef(node: HTMLElement) {\r\n    this.wrapperRef = node;\r\n  }\r\n\r\n  handleClickOutside(event: MouseEvent) {\r\n    if (this.wrapperRef && !this.wrapperRef.contains(event.target as Node))\r\n      this.setState({visible: false});\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className='selector'>\r\n        <div\r\n          className={\r\n            [\r\n              'selectorTitle',\r\n              (this.props.disabled ? 'disabled' : '')\r\n            ].join(' ')\r\n          }\r\n          ref={this.setWrapperRef}\r\n          onClick={() => {\r\n            if (!this.props.disabled)\r\n              this.setState({visible: !this.state.visible});\r\n          }}\r\n        >\r\n          Preset Scale Selections\r\n          <i className='icon-sort-down' />\r\n        </div>\r\n        <div\r\n          className='selectorMenu'\r\n          style={\r\n            this.state.visible ?\r\n              {display: 'block'} :\r\n              {display: 'none'}}\r\n        >\r\n          {this.props.children.map((listItem: any) => {\r\n            return listItem;\r\n          })}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ScaleSelector;\r\n","\n      import API from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[0].use[1]!./Picker.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[0].use[1]!./Picker.css\";\n       export default content && content.locals ? content.locals : undefined;\n","/** @jsx h */\r\n\r\nimport {h, Component} from 'preact';\r\nimport {select as d3Select} from 'd3-selection';\r\nimport {drag as d3Drag} from 'd3-drag';\r\n//@ts-ignore\r\nimport {event} from 'd3-selection';\r\n\r\nimport './css/Picker.css';\r\n\r\nclass Picker extends Component<{\r\n  disabled?: boolean;\r\n  focus?: () => void;\r\n  type?: string;\r\n  onChange?: (key: string, value: any) => void;\r\n  value?: number;\r\n  trackWidth?: number;\r\n  min?: number;\r\n  max?: number;\r\n  location?: number;\r\n  zIndex?: number;\r\n  showTrash?: boolean;\r\n  remove?: () => void;\r\n  color?: string;\r\n  size?: number;\r\n}> {\r\n  setUpDrag() {\r\n    // Double check that the drag is not left over from a previous use of this\r\n    // node.\r\n    d3Select(this.base).select('.pickerBox').on('mousedown.drag', null);\r\n\r\n    if (!this.props.disabled) {\r\n      const drag = d3Drag()\r\n        .on('start', () => {\r\n          if (this.props.focus) this.props.focus();\r\n        })\r\n        .on('drag', () => {\r\n          // If it was not a value slider before, make it one\r\n          if (this.props.type !== 'value')\r\n            if (this.props.onChange) this.props.onChange('type', 'value');\r\n\r\n\r\n          // New location\r\n          const newValue = (\r\n            this.props.value + (\r\n              (event.dx / this.props.trackWidth) *\r\n              (this.props.max - this.props.min)\r\n            )\r\n          );\r\n\r\n          // Don't go outside bar\r\n          const newLimValue = Math.max(\r\n            this.props.min,\r\n            Math.min(\r\n              this.props.max,\r\n              newValue\r\n            )\r\n          );\r\n\r\n          this.props.onChange('value', newLimValue);\r\n        })\r\n        .container(() => this.base.parentNode.parentNode as HTMLElement);\r\n      d3Select(this.base).select('.pickerBox').call(drag);\r\n    }\r\n  }\r\n\r\n  componentDidUpdate() {\r\n    this.setUpDrag();\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.setUpDrag();\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div\r\n        className='picker'\r\n        style={{\r\n          left: `${this.props.location * this.props.trackWidth}px`,\r\n          zIndex: this.props.zIndex\r\n        }}\r\n      >\r\n        {this.props.showTrash &&\r\n          <div className='trashDiv'>\r\n            <i\r\n              className='icon-trash-empty'\r\n              aria-hidden='true'\r\n              onClick={() => {\r\n                if (this.props.remove) this.props.remove();\r\n              }}\r\n            />\r\n          </div>\r\n        }\r\n        <div\r\n          className='pickerBox'\r\n          onClick={() => {\r\n            if (this.props.focus) this.props.focus();\r\n          }}\r\n        />\r\n        <div\r\n          className={\r\n            [\r\n              'pickerOptions',\r\n              this.props.location > 0.8 ? 'rightOptions' : ''\r\n            ].join(' ')\r\n          }\r\n        >\r\n          <input\r\n            type='text'\r\n            className='option'\r\n            value={\r\n              this.props.disabled ? '' : (\r\n                this.props.type === 'value' ?\r\n                  parseFloat(this.props.value.toFixed(2)) :\r\n                  `${this.props.type} (${parseFloat(this.props.value.toFixed(2))})`\r\n              )\r\n            }\r\n            disabled={this.props.disabled}\r\n            onInput={(event) => {\r\n              const newVal = parseFloat((event.target as HTMLInputElement).value);\r\n              if (!isNaN(newVal)) this.props.onChange('value', newVal);\r\n            }}\r\n            onFocus={(event) => {\r\n              (event.target as HTMLInputElement).select();\r\n              if (this.props.focus) this.props.focus();\r\n            }}\r\n          />\r\n          <select\r\n            className='typePicker'\r\n            value={this.props.type}\r\n            onChange={(event) => {\r\n              if (this.props.onChange) this.props.onChange('type', (event.target as HTMLSelectElement).value);\r\n            }}\r\n            disabled={this.props.disabled}\r\n            onFocus={() => {\r\n              if (this.props.focus) this.props.focus();\r\n            }}\r\n          >\r\n            <option value='value'>Value</option>\r\n            <option value='min'>Min</option>\r\n            <option value='mean'>Mean</option>\r\n            <option value='Q1'>Q1</option>\r\n            <option value='median'>Median</option>\r\n            <option value='Q3'>Q3</option>\r\n            <option value='max'>Max</option>\r\n          </select>\r\n          <div className='colorOptions'>\r\n            <input\r\n              type='text'\r\n              className='colorText'\r\n              onInput={(event) => {\r\n                if (this.props.onChange) this.props.onChange('color', (event.target as HTMLInputElement).value);\r\n              }}\r\n              onFocus={(event) => {\r\n                (event.target as HTMLInputElement).select();\r\n                if (this.props.focus) this.props.focus();\r\n              }}\r\n              value={this.props.color || ''}\r\n              disabled={this.props.disabled}\r\n            />\r\n            <input\r\n              type='color'\r\n              className='colorWheel'\r\n              onInput={(event) => {\r\n                if (this.props.onChange) this.props.onChange('color', (event.target as HTMLInputElement).value);\r\n              }}\r\n              onFocus={(event) => {\r\n                (event.target as HTMLInputElement).select();\r\n                if (this.props.focus) this.props.focus();\r\n              }}\r\n              value={this.props.color || ''}\r\n              disabled={this.props.disabled}\r\n            />\r\n          </div>\r\n          <input\r\n            type='text'\r\n            className='option'\r\n            onInput={(event) => {\r\n              if (this.props.onChange) this.props.onChange('size', parseInt((event.target as HTMLInputElement).value));\r\n            }}\r\n            onFocus={(event) => {\r\n              (event.target as HTMLInputElement).select();\r\n              if (this.props.focus) this.props.focus();\r\n            }}\r\n            value={this.props.size}\r\n            disabled={this.props.disabled}\r\n          />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Picker;\r\n","\n      import API from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[0].use[1]!./ScaleSlider.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[0].use[1]!./ScaleSlider.css\";\n       export default content && content.locals ? content.locals : undefined;\n","/** @jsx h */\r\n\r\nimport {h, Component} from 'preact';\r\nimport Picker from './Picker';\r\nimport update from 'immutability-helper';\r\nimport _ from 'underscore';\r\n\r\nimport './css/ScaleSlider.css';\r\nimport Settings from './ts/Settings';\r\n\r\nconst TRACK_WIDTH = 400;\r\n\r\nclass ScaleSlider extends Component<{\r\n  scale?: any;\r\n  stats?: any;\r\n  onChange?: (scale: any) => void;\r\n  noDataColor?: string;\r\n  noDataSize?: number;\r\n  onNoDataColorChange?: (color: string) => void;\r\n  onNoDataSizeChange?: (size: number) => void;\r\n  type?: string;\r\n  abs?: boolean;\r\n  settings?: Settings;\r\n}> {\r\n  state: {\r\n    focusedPicker: number;\r\n  };\r\n  /**\r\n   * Sorts the color scale for makeGradient\r\n   */\r\n  sortScale() {\r\n    const newScale = _.sortBy(this.props.scale, (stop) => {\r\n      if (stop.type === 'value')\r\n        return stop.value;\r\n      else\r\n        return this.props.stats[stop.type];\r\n    });\r\n    return newScale;\r\n  }\r\n\r\n  /**\r\n   * Places the pickers as a percentage of the max\r\n   */\r\n  placePickers() {\r\n    const stats = this.props.stats;\r\n\r\n    // Get min and max from scale stops too\r\n    const [absoluteMin, absoluteMax] = this.props.scale.reduce(\r\n      ([curMin, curMax], stop) => {\r\n        if (stop.type === 'value')\r\n          return [Math.min(stop.value, curMin), Math.max(stop.value, curMax)];\r\n        else\r\n          return [curMin, curMax];\r\n      },\r\n      [stats.min, stats.max]\r\n    );\r\n\r\n    // Calculate positions\r\n    const pickerLocations = this.props.scale.map((stop) => {\r\n      const value = stop.type === 'value' ? stop.value : stats[stop.type];\r\n      // normalize within min/max\r\n      return (value - absoluteMin) / (absoluteMax - absoluteMin);\r\n    });\r\n\r\n    return {pickerLocations, absoluteMax, absoluteMin};\r\n  }\r\n\r\n  /**\r\n   * Function enabling modification of any color scale attribute\r\n   * @param {number} index - index of the scale object to be modified\r\n   * @param {string} parameter - the parameter to be replaced\r\n   * @param {(number|string)} value - the new value of the parameter\r\n   */\r\n  scaleChange(index: number, parameter: string, value: number | string) {\r\n    let newScale = null;\r\n    if (parameter === 'type' && value !== 'value') {\r\n      newScale = update(this.props.scale, {\r\n        [index]: {\r\n          [parameter]: {$set: value},\r\n          $unset: ['value']\r\n        }\r\n      });\r\n      this.props.onChange(newScale);\r\n    } else if (parameter === 'value' && this.props.scale[index].type !== 'value') {\r\n      newScale = update(this.props.scale, {\r\n        [index]: {\r\n          [parameter]: {$set: value},\r\n          'type': {$set: 'value'}\r\n        }\r\n      });\r\n      this.props.onChange(newScale);\r\n    } else if (value === 'value') {\r\n      newScale = update(this.props.scale, {\r\n        [index]: {\r\n          [parameter]: {$set: value},\r\n          $merge: {'value': this.props.stats[this.props.scale[index].type]}\r\n        }\r\n      });\r\n      this.props.onChange(newScale);\r\n    } else if (!isNaN(parseFloat(value as string)) || (value[0] === '#' && parameter === 'color')) {\r\n      newScale = update(this.props.scale, {\r\n        [index]: {\r\n          [parameter]: {$set: value}\r\n        }\r\n      });\r\n      this.props.onChange(newScale);\r\n    }\r\n  }\r\n\r\n  addColorStop(event: MouseEvent) {\r\n    const newScale = update(this.props.scale, {\r\n      $push: [{\r\n        type: 'value',\r\n        value: event.layerX / (event.target as HTMLElement).clientWidth * this.props.stats.max +\r\n            (1 - event.layerX / (event.target as HTMLElement).clientWidth) * this.props.stats.min,\r\n        color: '#9696ff',\r\n        size: 20\r\n      }]\r\n    });\r\n    this.props.onChange(newScale);\r\n  }\r\n\r\n  /**\r\n   * Sorts and then returns a string that can be fed into the HTML linear-gradient style\r\n   */\r\n  makeGradient(min: number, max: number) {\r\n    const sortedScale = this.sortScale();\r\n    // Fix for when there is one or zero stops\r\n    const sortedScaleFix = (\r\n      sortedScale.length < 2 ?\r\n        [{type: 'min', color: '#f1ecfa'}, {type: 'max', color: '#f1ecfa'}] :\r\n        sortedScale\r\n    );\r\n    return sortedScaleFix.map((stop) => {\r\n      const value = stop.type === 'value' ? stop.value : this.props.stats[stop.type];\r\n      return ` ${stop.color} ${(value - min) / (max - min) * 100}%`;\r\n    }).toString();\r\n  }\r\n\r\n  removeColorStop(index: number) {\r\n    // @ts-ignore\r\n    const newScale = update(this.props.scale, {$splice: [[[index], 1]]});\r\n    this.props.onChange(newScale);\r\n  }\r\n\r\n  render() {\r\n    // -------\r\n    // No data\r\n    // -------\r\n\r\n    // Check for data\r\n    if (!this.props.stats) {\r\n      return (\r\n        <div className='scaleEditor'>\r\n          <div>\r\n            <div\r\n              className='scaleTrack disabled'\r\n              style={{width: TRACK_WIDTH}}\r\n            >\r\n              {this.props.type} data not loaded\r\n              <Picker location={0} trackWidth={TRACK_WIDTH} disabled />\r\n              <Picker location={1} trackWidth={TRACK_WIDTH} disabled />\r\n            </div>\r\n          </div>\r\n          <div className='scaleLabels'>\r\n            <label>Value:</label><label>Color:</label><label>Size:</label>\r\n          </div>\r\n          <div className='noDataStyle'>\r\n            <label className='styleHeader'>Styles for reactions with no data</label>\r\n            <br />\r\n            <label>Color:</label>\r\n            <input type='text' className='colorInput' disabled />\r\n            <input type='color' className='colorWheel' disabled />\r\n            <label>Size:</label>\r\n            <input type='text' className='sizeInput' disabled />\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    // --------\r\n    // Has data\r\n    // --------\r\n\r\n    const {\r\n      pickerLocations,\r\n      absoluteMax,\r\n      absoluteMin\r\n    } = this.placePickers();\r\n\r\n    // Create the pickers\r\n    const pickers = this.props.scale.map((stop, i) => {\r\n      if (stop.type !== 'value') {\r\n        return (\r\n          <Picker\r\n            trackWidth={TRACK_WIDTH}\r\n            type={stop.type}\r\n            location={pickerLocations[i]}\r\n            onChange={\r\n              (parameter, value) => this.scaleChange(i, parameter, value)\r\n            }\r\n            focus={() => this.setState({focusedPicker: i})}\r\n            remove={() => this.removeColorStop(i)}\r\n            min={absoluteMin}\r\n            max={absoluteMax}\r\n            value={\r\n              this.props.stats[stop.type]\r\n            }\r\n            color={stop.color}\r\n            size={stop.size}\r\n            zIndex={this.state.focusedPicker === i ? 2 : 0}\r\n            showTrash={this.props.scale.length >= 3}\r\n          />\r\n        );\r\n      } else if (stop.value != null) { // Check for valid value type\r\n        return (\r\n          <Picker\r\n            trackWidth={TRACK_WIDTH}\r\n            type={stop.type}\r\n            location={pickerLocations[i]}\r\n            onChange={\r\n              (parameter, value) => this.scaleChange(i, parameter, value)\r\n            }\r\n            focus={() => this.setState({focusedPicker: i})}\r\n            remove={() => this.removeColorStop(i)}\r\n            min={absoluteMin}\r\n            max={absoluteMax}\r\n            value={stop.value}\r\n            color={stop.color}\r\n            size={stop.size}\r\n            zIndex={this.state.focusedPicker === i ? 2 : 0}\r\n            showTrash={this.props.scale.length >= 3}\r\n          />\r\n        );\r\n      }\r\n    });\r\n\r\n    // Render everything\r\n    return (\r\n      <div className='scaleEditor'>\r\n        <div>\r\n          <i className='settingsTip'>To add a color stop to the scale, click the gradient</i>\r\n          <div\r\n            className='scaleTrack'\r\n            style={{width: TRACK_WIDTH}}\r\n          >\r\n            <div\r\n              className='gradient'\r\n              onClick={(event) => this.addColorStop(event)}\r\n              style={{\r\n                background: `linear-gradient(to right,${this.makeGradient(absoluteMin, absoluteMax)})`\r\n              }}\r\n            />\r\n            {pickers}\r\n          </div>\r\n        </div>\r\n        <div className='scaleLabels'>\r\n          <label>Value:</label><label>Color:</label><label>Size:</label>\r\n        </div>\r\n        <div className='noDataStyle'>\r\n          <label className='styleHeader'>Styles for reactions with no data</label>\r\n          <br />\r\n          <label>\r\n            Color:\r\n          </label>\r\n          <input\r\n            type='text'\r\n            className='colorInput'\r\n            value={this.props.noDataColor}\r\n            onInput={(event) => this.props.onNoDataColorChange((event.target as HTMLInputElement).value)}\r\n          />\r\n          <input\r\n            type='color'\r\n            className='colorWheel'\r\n            value={this.props.noDataColor}\r\n            onInput={(event) => this.props.onNoDataColorChange((event.target as HTMLInputElement).value)}\r\n          />\r\n          <label>\r\n            Size:\r\n          </label>\r\n          <input\r\n            type='text'\r\n            className='sizeInput'\r\n            value={this.props.noDataSize}\r\n            onInput={(event) => this.props.onNoDataSizeChange(parseFloat((event.target as HTMLInputElement).value))}\r\n          />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ScaleSlider;\r\n","/** @jsx h */\r\nimport {h, Component} from 'preact';\r\n\r\nclass ScaleSelection extends Component<{\r\n  scale: {color: string}[];\r\n  onClick: () => void;\r\n  name: string;\r\n}> {\r\n  state: {\r\n    colors: string[];\r\n  };\r\n  constructor(props) {\r\n    super(props);\r\n    const colors = [];\r\n    if (props.scale) {\r\n      for (let i = 0; i < props.scale.length; i++)\r\n        colors.push(props.scale[i].color);\r\n    }\r\n    this.state = {\r\n      colors\r\n    };\r\n  }\r\n  render() {\r\n    return (\r\n      <div className='scaleSelection' onClick={() => this.props.onClick()}>\r\n        <div>\r\n          {this.props.name}\r\n        </div>\r\n        <div className='scaleColors'>\r\n          {this.state.colors.map((color) => {\r\n            return <i className='icon-blank' style={{color: color}} />;\r\n          })}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ScaleSelection;\r\n","\n      import API from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[0].use[1]!./SettingsMenu.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[0].use[1]!./SettingsMenu.css\";\n       export default content && content.locals ? content.locals : undefined;\n","/** @jsx h */\r\nimport {h, Component} from 'preact';\r\nimport ScaleSelector from './ScaleSelector';\r\nimport ScaleSlider from './ScaleSlider';\r\nimport ScaleSelection from './ScaleSelection';\r\nimport _ from 'underscore';\r\nimport './css/SettingsMenu.css';\r\nimport scalePresets from './ts/scalePresets';\r\nimport {EscherMap} from './ts/escherMap';\r\nimport Settings from './ts/Settings';\r\n\r\n/**\r\n * SettingsMenu. Handles the functions associated with the UI for changing\r\n * settings. Implements Settings.js but otherwise only uses\r\n * Preact.\r\n */\r\nclass SettingsMenu extends Component<{settings: Settings, map: EscherMap, setDisplay: (display: boolean) => void}> {\r\n  // // props: (typeof Component.props) & {settings: Settings, map: EscherMap, setDisplay: (display: boolean) => void};\r\n  // constructor(props: {settings: Settings, map: EscherMap, setDisplay: (display: boolean) => void}) {\r\n  //   super(props);\r\n  // }\r\n  state: {clearEscape: () => void, clearEnter: () => void} = {clearEscape: () => {}, clearEnter: () => {}};\r\n  componentWillMount() {\r\n    this.props.settings.holdChanges();\r\n    this.setState({\r\n      clearEscape: this.props.map.key_manager.addEscapeListener(\r\n        () => this.abandonChanges(),\r\n        // true\r\n      ),\r\n      clearEnter: this.props.map.key_manager.addKeyListener(\r\n        ['enter'],\r\n        () => this.saveChanges(),\r\n        true\r\n      )\r\n    });\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.state.clearEscape();\r\n    this.state.clearEnter();\r\n  }\r\n\r\n  abandonChanges() {\r\n    this.props.settings.abandonChanges();\r\n    this.props.setDisplay(false);\r\n  }\r\n\r\n  saveChanges() {\r\n    this.props.settings.acceptChanges();\r\n    this.props.setDisplay(false);\r\n  }\r\n\r\n  /**\r\n   * Function to toggle one option in the reaction or metabolite styling.\r\n   * @param {String} value - the style option to be added or removed\r\n   * @param {String} type - reaction_style or metabolite_style\r\n   */\r\n  handleStyle(value, type) {\r\n    const currentSetting = this.props.settings.get(type);\r\n    const index = currentSetting.indexOf(value);\r\n    if (index === -1)\r\n      this.props.settings.set(type, [...currentSetting, value]);\r\n    else {\r\n      this.props.settings.set(type, [\r\n        ...currentSetting.slice(0, index),\r\n        ...currentSetting.slice(index + 1)\r\n      ]);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const settings = this.props.settings;\r\n    const enableTooltips = settings.get('enable_tooltips') || [];\r\n    const dataStatistics = this.props.map.get_data_statistics();\r\n\r\n    return (\r\n      <div className='settingsBackground'>\r\n        <div className='settingsBoxContainer'>\r\n          <button className='discardChanges btn' onClick={() => this.abandonChanges()}>\r\n            <i className='icon-cancel' aria-hidden='true' />\r\n          </button>\r\n          <button className='saveChanges btn' onClick={() => this.saveChanges()}>\r\n            <i className='icon-ok' aria-hidden='true' />\r\n          </button>\r\n          <div className='settingsBox'>\r\n            <div className='settingsTip'>\r\n              <i>Tip: Hover over an option to see more details about it.</i>\r\n            </div>\r\n            <hr />\r\n            <div className='title'>\r\n              View and build options\r\n            </div>\r\n            <div className='settingsContainer'>\r\n              <table className='radioSelection'>\r\n                <tr title='The identifiers that are show in the reaction, gene, and metabolite labels on the map.'>\r\n                  <td className='optionLabel'>Identifiers:</td>\r\n                  <td className='singleLine'>\r\n                    <label className='optionGroup'>\r\n                      <input\r\n                        type='radio'\r\n                        name='identifiers'\r\n                        onClick={() => { settings.set('identifiers_on_map', 'bigg_id'); }}\r\n                        checked={settings.get('identifiers_on_map') === 'bigg_id'}\r\n                      />\r\n                      ID&apos;s\r\n                    </label>\r\n                    <label className='optionGroup'>\r\n                      <input\r\n                        type='radio'\r\n                        name='identifiers'\r\n                        onClick={() => { settings.set('identifiers_on_map', 'name'); }}\r\n                        checked={settings.get('identifiers_on_map') === 'name'}\r\n                      />\r\n                      Descriptive names\r\n                    </label>\r\n                  </td>\r\n                </tr>\r\n              </table>\r\n              <label title='If checked, then the scroll wheel and trackpad will control zoom rather than pan.'>\r\n                <input\r\n                  type='checkbox'\r\n                  onClick={() => {\r\n                    if (settings.get('scroll_behavior') === 'zoom')\r\n                      settings.set('scroll_behavior', 'pan');\r\n                    else\r\n                      settings.set('scroll_behavior', 'zoom');\r\n                  }}\r\n                  checked={settings.get('scroll_behavior') === 'zoom'}\r\n                />\r\n                Scroll to zoom (instead of scroll to pan)\r\n              </label>\r\n              <label title='If checked, then only the primary metabolites will be displayed.'>\r\n                <input\r\n                  type='checkbox'\r\n                  onClick={() =>\r\n                    settings.set(\r\n                      'hide_secondary_metabolites',\r\n                      !settings.get('hide_secondary_metabolites')\r\n                    )\r\n                  }\r\n                  checked={settings.get('hide_secondary_metabolites')}\r\n                />\r\n                Hide secondary metabolites\r\n              </label>\r\n              <label\r\n                title='If checked, then gene reaction rules will be displayed below each reaction label. (Gene reaction rules are always shown when gene data is loaded.)'\r\n              >\r\n                <input\r\n                  type='checkbox'\r\n                  onClick={() =>\r\n                    settings.set(\r\n                      'show_gene_reaction_rules',\r\n                      !settings.get('show_gene_reaction_rules')\r\n                    )\r\n                  }\r\n                  checked={settings.get('show_gene_reaction_rules')}\r\n                />\r\n                  Show gene reaction rules\r\n              </label>\r\n              <label title='If checked, hide all reaction, gene, and metabolite labels'>\r\n                <input\r\n                  type='checkbox'\r\n                  onClick={() =>\r\n                    settings.set(\r\n                      'hide_all_labels',\r\n                      !settings.get('hide_all_labels')\r\n                    )\r\n                  }\r\n                  checked={settings.get('hide_all_labels')}\r\n                />\r\n                Hide reaction, gene, and metabolite labels\r\n              </label>\r\n              <label title='If checked, then allow duplicate reactions during model building.'>\r\n                <input\r\n                  type='checkbox'\r\n                  onClick={() =>\r\n                    settings.set(\r\n                      'allow_building_duplicate_reactions',\r\n                      !settings.get('allow_building_duplicate_reactions')\r\n                    )\r\n                  }\r\n                  checked={settings.get('allow_building_duplicate_reactions')}\r\n                />\r\n                Allow duplicate reactions\r\n              </label>\r\n              <label title='If checked, then highlight in red all the reactions on the map that are not present in the loaded model.'>\r\n                <input\r\n                  type='checkbox'\r\n                  onClick={() => {\r\n                    settings.set(\r\n                      'highlight_missing',\r\n                      !settings.get('highlight_missing')\r\n                    );\r\n                  }}\r\n                  checked={settings.get('highlight_missing')}\r\n                />\r\n                Highlight reactions not in model\r\n              </label>\r\n              <label title='If true, then use CSS3 3D transforms to speed up panning and zooming.'>\r\n                <input\r\n                  type='checkbox'\r\n                  onClick={() => {\r\n                    settings.set(\r\n                      'use_3d_transform',\r\n                      !settings.get('use_3d_transform')\r\n                    );\r\n                  }}\r\n                  checked={settings.get('use_3d_transform')}\r\n                />\r\n                Use 3D transform for responsive panning and zooming\r\n              </label>\r\n              <label title='If true, highlights all nodes with the same BIGG id.'>\r\n                <input\r\n                  type='checkbox'\r\n                  onClick={() => {\r\n                    settings.set(\r\n                      'highlight_same_nodes',\r\n                      !settings.get('highlight_same_nodes')\r\n                    );\r\n                  }}\r\n                  checked={settings.get('highlight_same_nodes')}\r\n                />\r\n                Highlight all nodes with the same BIGG id\r\n              </label>\r\n              <table style={{marginTop: '5px'}}>\r\n                <tr title='Determines over which elements tooltips will display for reactions, metabolites, and genes'>\r\n                  <td>\r\n                      Show tooltips over:\r\n                  </td>\r\n                  <td className='singleLine' >\r\n                    <label className='tooltipOption' title='If checked, tooltips will display over the gene, reaction, and metabolite labels'>\r\n                      <input\r\n                        type='checkbox'\r\n                        onClick={() => {\r\n                          const type = 'label';\r\n                          const newEnableTooltips = _.contains(enableTooltips, type) ?\r\n                            _.filter(enableTooltips, (x) => x !== type) :\r\n                            [...enableTooltips, type];\r\n                          settings.set('enable_tooltips', newEnableTooltips);\r\n                        }}\r\n                        checked={_.contains(enableTooltips, 'label')}\r\n                      />\r\n                      Labels\r\n                    </label>\r\n                    <label className='tooltipOption' title='If checked, tooltips will display over the reaction line segments and metabolite circles'>\r\n                      <input\r\n                        type='checkbox'\r\n                        onClick={() => {\r\n                          const type = 'object';\r\n                          const newEnableTooltips = _.contains(enableTooltips, type) ?\r\n                            _.filter(enableTooltips, (x) => x !== type) :\r\n                            [...enableTooltips, type];\r\n                          settings.set('enable_tooltips', newEnableTooltips);\r\n                        }}\r\n                        checked={_.contains(enableTooltips, 'object')}\r\n                      />\r\n                      Objects\r\n                    </label>\r\n                  </td>\r\n                </tr>\r\n              </table>\r\n            </div>\r\n            <div className='settingsTip' style={{marginTop: '16px'}}>\r\n              <i>Tip: To increase map performance, turn off text boxes (i.e. labels and gene reaction rules).</i>\r\n            </div>\r\n            <hr />\r\n            <div className='scaleTitle'>\r\n              <div className='title'>\r\n                Reactions\r\n              </div>\r\n              <ScaleSelector disabled={dataStatistics.reaction == null}>\r\n                {Object.values(_.mapObject(scalePresets, (value, key) => {\r\n                  return (\r\n                    <ScaleSelection\r\n                      name={key}\r\n                      scale={value}\r\n                      onClick={() => {\r\n                        settings.set('reaction_scale_preset', key);\r\n                      }}\r\n                    />\r\n                  );\r\n                }))}\r\n              </ScaleSelector>\r\n            </div>\r\n            <ScaleSlider\r\n              scale={settings.get('reaction_scale')}\r\n              settings={settings}\r\n              type='Reaction'\r\n              stats={dataStatistics.reaction}\r\n              noDataColor={settings.get('reaction_no_data_color')}\r\n              noDataSize={settings.get('reaction_no_data_size')}\r\n              onChange={(scale) => {\r\n                settings.set('reaction_scale', scale);\r\n              }}\r\n              onNoDataColorChange={(val) => {\r\n                settings.set('reaction_no_data_color', val);\r\n              }}\r\n              onNoDataSizeChange={(val) => {\r\n                settings.set('reaction_no_data_size', val);\r\n              }}\r\n              abs={settings.get('reaction_styles').indexOf('abs') > -1}\r\n            />\r\n            <div className='subheading'>\r\n              Reaction or Gene data\r\n            </div>\r\n            <table className='radioSelection'>\r\n              <tr>\r\n                <td\r\n                  className='optionLabel'\r\n                  title='Options for reactions data'\r\n                >\r\n                Options:\r\n                </td>\r\n                <td>\r\n                  <label\r\n                    className='optionGroup'\r\n                    title='If checked, use the absolute value when calculating colors and sizes of reactions on the map'\r\n                  >\r\n                    <input\r\n                      type='checkbox'\r\n                      name='reactionStyle'\r\n                      onClick={() => this.handleStyle('abs', 'reaction_styles')}\r\n                      checked={_.contains(settings.get('reaction_styles'), 'abs')}\r\n                      disabled={dataStatistics.reaction == null}\r\n                    />\r\n                    Absolute value\r\n                  </label>\r\n                  <label\r\n                    className='optionGroup'\r\n                    title='If checked, then size the thickness of reaction lines according to the value of the reaction data'\r\n                  >\r\n                    <input\r\n                      type='checkbox'\r\n                      name='reactionStyle'\r\n                      onClick={() => this.handleStyle('size', 'reaction_styles')}\r\n                      checked={_.contains(settings.get('reaction_styles'), 'size')}\r\n                      disabled={dataStatistics.reaction == null}\r\n                    />\r\n                    Size\r\n                  </label>\r\n                  <label className='optionGroup' title='If checked, then color the reaction lines according to the value of the reaction data'>\r\n                    <input\r\n                      type='checkbox'\r\n                      name='reactionStyle'\r\n                      onClick={() => this.handleStyle('color', 'reaction_styles')}\r\n                      checked={_.contains(settings.get('reaction_styles'), 'color')}\r\n                      disabled={dataStatistics.reaction == null}\r\n                    />\r\n                    Color\r\n                  </label>\r\n                  <br />\r\n                  <label className='optionGroup' title='If checked, then show data values in the reaction labels'>\r\n                    <input\r\n                      type='checkbox'\r\n                      name='reactionStyle'\r\n                      onClick={() => this.handleStyle('text', 'reaction_styles')}\r\n                      checked={_.contains(settings.get('reaction_styles'), 'text')}\r\n                      disabled={dataStatistics.reaction == null}\r\n                    />\r\n                    Text (Show data in label)\r\n                  </label>\r\n                </td>\r\n              </tr>\r\n              <tr title='The function that will be used to compare datasets, when paired data is loaded'>\r\n                <td className='optionLabel'>Comparison:</td>\r\n                <td>\r\n                  <label className='optionGroup'>\r\n                    <input\r\n                      type='radio'\r\n                      name='reactionCompare'\r\n                      onClick={() => settings.set('reaction_compare_style', 'fold')}\r\n                      checked={settings.get('reaction_compare_style') === 'fold'}\r\n                      disabled={dataStatistics.reaction == null}\r\n                    />\r\n                    Fold Change\r\n                  </label>\r\n                  <label className='optionGroup'>\r\n                    <input\r\n                      type='radio'\r\n                      name='reactionCompare'\r\n                      onClick={() => settings.set('reaction_compare_style', 'log2_fold')}\r\n                      checked={settings.get('reaction_compare_style') === 'log2_fold'}\r\n                      disabled={dataStatistics.reaction == null}\r\n                    />\r\n                    Log2 (Fold Change)\r\n                  </label>\r\n                  <label className='optionGroup'>\r\n                    <input\r\n                      type='radio'\r\n                      name='reactionCompare'\r\n                      onClick={() => settings.set('reaction_compare_style', 'diff')}\r\n                      checked={settings.get('reaction_compare_style') === 'diff'}\r\n                      disabled={dataStatistics.reaction == null}\r\n                    />\r\n                    Difference\r\n                  </label>\r\n                </td>\r\n              </tr>\r\n            </table>\r\n            <table className='radioSelection'>\r\n              <tr\r\n                title='The function that will be used to evaluate AND connections in gene reaction rules (AND connections generally connect components of an enzyme complex)'\r\n              >\r\n                <td className='optionLabelWide'>Method for evaluating AND:</td>\r\n                <td>\r\n                  <label className='optionGroup'>\r\n                    <input\r\n                      type='radio'\r\n                      name='andMethod'\r\n                      onClick={() => settings.set('and_method_in_gene_reaction_rule', 'mean')}\r\n                      checked={settings.get('and_method_in_gene_reaction_rule') === 'mean'}\r\n                      disabled={dataStatistics.reaction == null}\r\n                    />\r\n                    Mean\r\n                  </label>\r\n                  <label className='optionGroup'>\r\n                    <input\r\n                      type='radio'\r\n                      name='andMethod'\r\n                      onClick={() => settings.set('and_method_in_gene_reaction_rule', 'min')}\r\n                      checked={settings.get('and_method_in_gene_reaction_rule') === 'min'}\r\n                      disabled={dataStatistics.reaction == null}\r\n                    />\r\n                    Min\r\n                  </label>\r\n                </td>\r\n              </tr>\r\n            </table>\r\n            <hr />\r\n            <div className='scaleTitle'>\r\n              <div className='title'>\r\n                Metabolites\r\n              </div>\r\n              <ScaleSelector disabled={dataStatistics.metabolite == null}>\r\n                {Object.values(_.mapObject(scalePresets, (value, key) => {\r\n                  return (\r\n                    <ScaleSelection\r\n                      name={key}\r\n                      scale={value}\r\n                      onClick={() => settings.set('metabolite_scale', value)}\r\n                    />\r\n                  );\r\n                }))}\r\n              </ScaleSelector>\r\n            </div>\r\n            <ScaleSlider\r\n              scale={settings.get('metabolite_scale')}\r\n              settings={settings}\r\n              type='Metabolite'\r\n              stats={dataStatistics.metabolite}\r\n              noDataColor={settings.get('metabolite_no_data_color')}\r\n              noDataSize={settings.get('metabolite_no_data_size')}\r\n              onChange={(scale) => {\r\n                settings.set('metabolite_scale', scale);\r\n              }}\r\n              onNoDataColorChange={(val) => {\r\n                settings.set('metabolite_no_data_color', val);\r\n              }}\r\n              onNoDataSizeChange={(val) => {\r\n                settings.set('metabolite_no_data_size', val);\r\n              }}\r\n              abs={_.contains(settings.get('metabolite_styles'), 'abs')}\r\n            />\r\n            <div className='subheading'>\r\n              Metabolite data\r\n            </div>\r\n            <table className='radioSelection'>\r\n              <tr>\r\n                <td\r\n                  className='optionLabel'\r\n                  title='Options for metabolite data'\r\n                >\r\n                Options:\r\n                </td>\r\n                <td>\r\n                  <label\r\n                    className='optionGroup'\r\n                    title='If checked, use the absolute value when calculating colors and sizes of metabolites on the map'\r\n                  >\r\n                    <input\r\n                      type='checkbox'\r\n                      name='metaboliteStyle'\r\n                      onClick={() => this.handleStyle('abs', 'metabolite_styles')}\r\n                      checked={_.contains(settings.get('metabolite_styles'), 'abs')}\r\n                      disabled={dataStatistics.metabolite == null}\r\n                    />\r\n                    Absolute value\r\n                  </label>\r\n                  <label\r\n                    className='optionGroup'\r\n                    title='If checked, then size the thickness of reaction lines according to the value of the metabolite data'\r\n                  >\r\n                    <input\r\n                      type='checkbox'\r\n                      name='metaboliteStyle'\r\n                      onClick={() => this.handleStyle('size', 'metabolite_styles')}\r\n                      checked={_.contains(settings.get('metabolite_styles'), 'size')}\r\n                      disabled={dataStatistics.metabolite == null}\r\n                    />\r\n                    Size\r\n                  </label>\r\n                  <label className='optionGroup' title='If checked, then color the reaction lines according to the value of the metabolite data'>\r\n                    <input\r\n                      type='checkbox'\r\n                      name='metaboliteStyle'\r\n                      onClick={() => this.handleStyle('color', 'metabolite_styles')}\r\n                      checked={_.contains(settings.get('metabolite_styles'), 'color')}\r\n                      disabled={dataStatistics.metabolite == null}\r\n                    />\r\n                    Color\r\n                  </label>\r\n                  <br />\r\n                  <label className='optionGroup' title='If checked, then show data values in the metabolite labels'>\r\n                    <input\r\n                      type='checkbox'\r\n                      name='metaboliteStyle'\r\n                      onClick={() => this.handleStyle('text', 'metabolite_styles')}\r\n                      checked={_.contains(settings.get('metabolite_styles'), 'text')}\r\n                      disabled={dataStatistics.metabolite == null}\r\n                    />\r\n                    Text (Show data in label)\r\n                  </label>\r\n                </td>\r\n              </tr>\r\n              <tr title='The function that will be used to compare datasets, when paired data is loaded'>\r\n                <td className='optionLabel'>Comparison:</td>\r\n                <td>\r\n                  <label className='optionGroup'>\r\n                    <input\r\n                      type='radio'\r\n                      name='metaboliteCompare'\r\n                      onClick={() => settings.set('metabolite_compare_style', 'fold')}\r\n                      checked={settings.get('metabolite_compare_style') === 'fold'}\r\n                      disabled={dataStatistics.metabolite == null}\r\n                    />\r\n                    Fold Change\r\n                  </label>\r\n                  <label className='optionGroup'>\r\n                    <input\r\n                      type='radio'\r\n                      name='metaboliteCompare'\r\n                      onClick={() => settings.set('metabolite_compare_style', 'log2_fold')}\r\n                      checked={settings.get('metabolite_compare_style') === 'log2_fold'}\r\n                      disabled={dataStatistics.metabolite == null}\r\n                    />\r\n                    Log2 (Fold Change)\r\n                  </label>\r\n                  <label className='optionGroup'>\r\n                    <input\r\n                      type='radio'\r\n                      name='metaboliteCompare'\r\n                      onClick={() => settings.set('metabolite_compare_style', 'diff')}\r\n                      checked={settings.get('metabolite_compare_style') === 'diff'}\r\n                      disabled={dataStatistics.metabolite == null}\r\n                    />\r\n                    Difference\r\n                  </label>\r\n                </td>\r\n              </tr>\r\n            </table>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\nexport default SettingsMenu;\r\n","\n      import API from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[0].use[1]!./Dropdown.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[0].use[1]!./Dropdown.css\";\n       export default content && content.locals ? content.locals : undefined;\n","/**\r\n * Dropdown. Handles the behavior of the menu bar and the dropdowns. Composed of\r\n * a menu button and a corresponding menu that displays when the button is\r\n * clicked.\r\n */\r\n\r\n/** @jsx h */\r\nimport {h, Component, ComponentChildren} from 'preact';\r\nimport './css/Dropdown.css';\r\n\r\nclass Dropdown extends Component<{\r\n  name?: string;\r\n  disabledEditing?: boolean;\r\n  rightMenu?: string;\r\n  children?: any;\r\n  visible?: boolean;\r\n  dropdownVisible?: boolean;\r\n}> {\r\n  state: {\r\n    visible: boolean;\r\n  };\r\n  wrapperRef: HTMLElement | null = null;\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      visible: null\r\n    };\r\n    this.setWrapperRef = this.setWrapperRef.bind(this);\r\n    this.handleClickOutside = this.handleClickOutside.bind(this);\r\n  }\r\n\r\n  componentWillMount() {\r\n    this.setState({\r\n      visible: false\r\n    });\r\n  }\r\n\r\n  componentDidMount() {\r\n    document.addEventListener('mouseup', this.handleClickOutside);\r\n  }\r\n\r\n  componentWillReceiveProps(nextProps: {visible: boolean}) {\r\n    this.setState({visible: nextProps.visible});\r\n  }\r\n\r\n  setWrapperRef(node: HTMLElement) {\r\n    this.wrapperRef = node;\r\n  }\r\n\r\n  handleClickOutside(event: MouseEvent) {\r\n    if (this.wrapperRef && !this.wrapperRef.contains(event.target as Node))\r\n      this.setState({visible: false});\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <li\r\n        className='dropdown'\r\n        style={this.props.disabledEditing ?\r\n          {display: 'none'} :\r\n          {display: 'block'}\r\n        }\r\n      >\r\n        <div\r\n          className='dropdownButton'\r\n          tabIndex={0}\r\n          ref={this.setWrapperRef}\r\n          onClick={() => this.setState({visible: !this.state.visible})}\r\n        >\r\n          {this.props.name}&nbsp;\r\n          <i className='icon-sort-down' />\r\n        </div>\r\n        <ul\r\n          className='menu'\r\n          style={this.state.visible ?\r\n            {display: 'block'} :\r\n            {display: 'none'}}\r\n          id={this.props.rightMenu === 'true' ? 'rightMenu' : ''}\r\n        >\r\n          {this.props.children.map((listItem: any) => {\r\n            if (listItem && listItem.attributes.name === 'divider') {\r\n              return (\r\n                <li\r\n                  style={{\r\n                    height: '1px',\r\n                    backgroundColor: '#e5e5e5',\r\n                    padding: '0',\r\n                    margin: '8px 0'\r\n                  }}\r\n                />\r\n              );\r\n            } else\r\n              return listItem;\r\n          })}\r\n        </ul>\r\n      </li>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Dropdown;\r\n","/**\r\n * MenuButton. Handles the individual menu items within the Dropdown menus.\r\n * Takes in a name and a function and binds the function to a button. If the\r\n * type prop is defined as 'load' will instead render a label with an attached\r\n * hidden input[file] element.\r\n */\r\n\r\n/** @jsx h */\r\nimport {h, Component} from 'preact';\r\nimport _ from 'underscore';\r\nimport * as utils from './ts/utils';\r\nimport * as dataStyles from './ts/dataStyles';\r\n\r\nclass MenuButton extends Component<\r\n{\r\n  name: string;\r\n  onClick: (data: any) => void;\r\n  assignKey?: (fn: () => void) => void;\r\n  type?: string;\r\n  disabledButtons?: string[];\r\n  checkMark?: boolean;\r\n}> {\r\n  constructor(props) {\r\n    super(props);\r\n    this.assignKeyForInput = this.assignKeyForInput.bind(this);\r\n  }\r\n\r\n  handleFileInput(target: HTMLInputElement) {\r\n    const file = target.files[0];\r\n    const reader = new window.FileReader();\r\n    reader.onload = () => {\r\n      utils.load_json_or_csv(file, dataStyles.csv_converter, (e, d) => this.props.onClick(d));\r\n    };\r\n    if (file !== undefined)\r\n      reader.readAsText(file);\r\n\r\n    // reset input\r\n    target.value = null;\r\n  }\r\n\r\n  assignKeyForInput(node) {\r\n    if (this.props.assignKey)\r\n      this.props.assignKey(() => node.click());\r\n  }\r\n\r\n  render() {\r\n    const disabled = _.contains(this.props.disabledButtons, this.props.name.replace(/ \\(.*\\)$/, ''));\r\n    if (this.props.type === 'load') {\r\n      return (\r\n        <label\r\n          className='menuButton'\r\n          tabIndex={disabled ? -1 : 0}\r\n          id={disabled ? 'disabled' : ''}\r\n        >\r\n          <input\r\n            type='file'\r\n            onChange={(event) => this.handleFileInput(event.target as HTMLInputElement)}\r\n            disabled={disabled}\r\n            ref={this.assignKeyForInput}\r\n          />\r\n          {this.props.name}\r\n        </label>\r\n      );\r\n    } else if (this.props.checkMark) {\r\n      return (\r\n        <li\r\n          className='menuButton'\r\n          tabIndex={disabled ? -1 : 0}\r\n          onClick={this.props.onClick}\r\n          id={disabled ? 'disabled' : ''}\r\n        >\r\n          <i className='icon-ok' aria-hidden='true'>&nbsp;</i>\r\n          {this.props.name}\r\n        </li>\r\n      );\r\n    } else {\r\n      return (\r\n        <li\r\n          className='menuButton'\r\n          tabIndex={disabled ? -1 : 0}\r\n          onClick={disabled ? null : this.props.onClick}\r\n          id={disabled ? 'disabled' : ''}\r\n        >\r\n          {this.props.name}\r\n        </li>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nexport default MenuButton;\r\n","/** @jsx h */\r\nimport {h, Component} from 'preact';\r\nimport Dropdown from './Dropdown';\r\nimport MenuButton from './MenuButton';\r\nimport Settings from './ts/Settings';\r\nimport {EscherMap} from './ts/escherMap';\r\nimport {D3Selection} from './ts/types';\r\n\r\n/**\r\n * MenuBar implements generic Dropdown and MenuButton objects to create the\r\n * Builder menu bar. Currently re-renders every time an edit mode is chosen.\r\n * This can be changed once Builder is ported to Preact.\r\n */\r\nclass MenuBar extends Component<{\r\n  settings: Settings;\r\n  map: EscherMap;\r\n  dropdownVisible: boolean;\r\n  saveMap: () => void;\r\n  loadMap: (file: File) => void;\r\n  loadModel: (file: File) => void;\r\n  updateRules: () => void;\r\n  clearModel: () => void;\r\n  setReactionData: (data: any) => void;\r\n  clearReactionData: () => void;\r\n  setGeneData: (data: any) => void;\r\n  clearGeneData: () => void;\r\n  setMetaboliteData: (data: any) => void;\r\n  clearMetaboliteData: () => void;\r\n  assignKeyLoadMap: () => void;\r\n  assignKeyLoadModel: () => void;\r\n  save_svg: () => void;\r\n  save_png: () => void;\r\n  clear_map: () => void;\r\n  saveAction: () => void;\r\n  loadAction: () => void;\r\n  align_vertical: () => void;\r\n  align_horizontal: () => void;\r\n  togglePrimary: () => void;\r\n  cyclePrimary: () => void;\r\n  selectAll: () => void;\r\n  selectNone: () => void;\r\n  invertSelection: () => void;\r\n  zoom_in: () => void;\r\n  zoom_out: () => void;\r\n  zoomExtentNodes: () => void;\r\n  zoomExtentCanvas: () => void;\r\n  search: () => void;\r\n  toggleBeziers: () => void;\r\n  full_screen: () => void;\r\n  renderSettingsMenu: () => void;\r\n  mode: string;\r\n  setMode: (mode: string) => void;\r\n  deleteSelected: () => void;\r\n  undo: () => void;\r\n  redo: () => void;\r\n  isFullScreen: boolean;\r\n  selection: D3Selection;\r\n  state: {\r\n    dropdownVisible: boolean;\r\n  };\r\n  sel: D3Selection;\r\n}> {\r\n  componentWillMount() {\r\n    this.props.sel.selectAll('.escher-zoom-container')\r\n      .on('touchend.menuBar', () => this.setState({dropdownVisible: false}))\r\n      .on('click.menuBar', () => this.setState({dropdownVisible: false}));\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.props.sel.selectAll('.escher-zoom-container')\r\n      .on('touchend.menuBar', null)\r\n      .on('click.menuBar', null);\r\n  }\r\n\r\n  render() {\r\n    const enableKeys = this.props.settings.get('enable_keys');\r\n    const disabledButtons = this.props.settings.get('disabled_buttons');\r\n    const beziersEnabled = this.props.map.beziers_enabled;\r\n    const fullScreenButtonEnabled = this.props.settings.get('full_screen_button');\r\n\r\n    return (\r\n      <div>\r\n        <div id = \"selection-info-container\"></div>\r\n\r\n        <ul className='menu-bar'>\r\n          <Dropdown name='Map' dropdownVisible={this.props.dropdownVisible}>\r\n            <MenuButton\r\n              name={'Save map JSON' + (enableKeys ? ' (Ctrl+S)' : '')}\r\n              onClick={() => this.props.saveMap()}\r\n              disabledButtons={disabledButtons}\r\n            />\r\n            <MenuButton\r\n              name={'Load map JSON' + (enableKeys ? ' (Ctrl+O)' : '')}\r\n              onClick={(file) => this.props.loadMap(file)}\r\n              assignKey={this.props.assignKeyLoadMap}\r\n              type='load'\r\n              disabledButtons={disabledButtons}\r\n            />\r\n            <MenuButton\r\n              name={'Export as SVG' + (enableKeys ? ' (Ctrl+Shift+S)' : '')}\r\n              onClick={() => this.props.save_svg()}\r\n              disabledButtons={disabledButtons}\r\n            />\r\n            <MenuButton\r\n              name={'Export as PNG' + (enableKeys ? ' (Ctrl+Shift+P)' : '')}\r\n              onClick={() => this.props.save_png()}\r\n              disabledButtons={disabledButtons}\r\n            />\r\n            <MenuButton\r\n              name='Clear map'\r\n              onClick={() => this.props.clear_map()}\r\n              disabledButtons={disabledButtons}\r\n            />\r\n\r\n            {(this.props.settings.get('saveAction') && <MenuButton\r\n              name='Save Analysis'\r\n              onClick={() => { const a = this.props.settings.get('saveAction'); a && a(); }}\r\n              disabledButtons={disabledButtons}\r\n            />)}\r\n\r\n            {(this.props.settings.get('loadAction') && <MenuButton\r\n              name='Load Analysis'\r\n              onClick={() => this.props.settings.get('loadAction')()}\r\n              disabledButtons={disabledButtons}\r\n            />)}\r\n\r\n\r\n          </Dropdown>\r\n          <Dropdown name='Model' dropdownVisible={this.props.dropdownVisible}>\r\n            <MenuButton\r\n              name={'Load COBRA model JSON' + (enableKeys ? ' (Ctrl+M)' : '')}\r\n              onClick={(file) => this.props.loadModel(file)}\r\n              assignKey={this.props.assignKeyLoadModel}\r\n              type='load'\r\n              disabledButtons={disabledButtons}\r\n            />\r\n            <MenuButton\r\n              name='Update names and gene reaction rules using model'\r\n              onClick={() => this.props.updateRules()}\r\n              disabledButtons={disabledButtons}\r\n            />\r\n            <MenuButton\r\n              name='Clear model'\r\n              onClick={() => this.props.clearModel()}\r\n              disabledButtons={disabledButtons}\r\n            />\r\n          </Dropdown>\r\n\r\n          <Dropdown name='Data' dropdownVisible={this.props.dropdownVisible}>\r\n            <MenuButton\r\n              name='Load reaction data'\r\n              onClick={(d) => this.props.setReactionData(d)}\r\n              type='load'\r\n              disabledButtons={disabledButtons}\r\n            />\r\n            <MenuButton\r\n              name='Clear reaction data'\r\n              onClick={() => this.props.clearReactionData()}\r\n              disabledButtons={disabledButtons}\r\n            />\r\n            <li name='divider' />\r\n            <MenuButton\r\n              name='Load gene data'\r\n              onClick={(d) => this.props.setGeneData(d)}\r\n              type='load'\r\n              disabledButtons={disabledButtons}\r\n            />\r\n            <MenuButton\r\n              name='Clear gene data'\r\n              onClick={() => this.props.clearGeneData()}\r\n              disabledButtons={disabledButtons}\r\n            />\r\n            <li name='divider' />\r\n            <MenuButton\r\n              name='Load metabolite data'\r\n              onClick={(d) => this.props.setMetaboliteData(d)}\r\n              type='load'\r\n              disabledButtons={disabledButtons}\r\n            />\r\n            <MenuButton\r\n              name='Clear metabolite data'\r\n              onClick={() => this.props.clearMetaboliteData()}\r\n              disabledButtons={disabledButtons}\r\n            />\r\n          </Dropdown>\r\n          <Dropdown\r\n            name='Edit'\r\n            rightMenu='true'\r\n            dropdownVisible={this.props.dropdownVisible}\r\n            disabledEditing={!this.props.settings.get('enable_editing')}\r\n          >\r\n            <MenuButton\r\n              name={'Pan mode' + (enableKeys ? ' (Z)' : '')}\r\n              checkMark={this.props.mode === 'zoom'}\r\n              onClick={() => this.props.setMode('zoom')}\r\n              disabledButtons={disabledButtons}\r\n            />\r\n            <MenuButton\r\n              name={'Select mode' + (enableKeys ? ' (V)' : '')}\r\n              checkMark={this.props.mode === 'brush'}\r\n              onClick={() => this.props.setMode('brush')}\r\n              disabledButtons={disabledButtons}\r\n            />\r\n            <MenuButton\r\n              name={'Add reaction mode' + (enableKeys ? ' (N)' : '')}\r\n              checkMark={this.props.mode === 'build'}\r\n              onClick={() => this.props.setMode('build')}\r\n              disabledButtons={disabledButtons}\r\n            />\r\n            <MenuButton\r\n              name={'Rotate mode' + (enableKeys ? ' (R)' : '')}\r\n              checkMark={this.props.mode === 'rotate'}\r\n              onClick={() => this.props.setMode('rotate')}\r\n              disabledButtons={disabledButtons}\r\n            />\r\n            <MenuButton\r\n              name={'Text mode' + (enableKeys ? ' (T)' : '')}\r\n              checkMark={this.props.mode === 'text'}\r\n              onClick={() => this.props.setMode('text')}\r\n              disabledButtons={disabledButtons}\r\n            />\r\n            <li name='divider' />\r\n            <MenuButton\r\n              name={'Delete' + (enableKeys ? ' (Del)' : '')}\r\n              onClick={() => this.props.deleteSelected()}\r\n              disabledButtons={disabledButtons}\r\n            />\r\n            <MenuButton\r\n              name={'Undo' + (enableKeys ? ' (Ctrl+Z)' : '')}\r\n              onClick={() => this.props.undo()}\r\n              disabledButtons={disabledButtons}\r\n            />\r\n            <MenuButton\r\n              name={'Redo' + (enableKeys ? ' (Ctrl+Shift+Z)' : '')}\r\n              onClick={() => this.props.redo()}\r\n              disabledButtons={disabledButtons}\r\n            />\r\n            <li name='divider' />\r\n            <MenuButton\r\n              name={`Align vertical${enableKeys ? ' (Alt+L)' : ''}`}\r\n              onClick={this.props.align_vertical}\r\n              disabledButtons={disabledButtons}\r\n            />\r\n            <MenuButton\r\n              name={`Align horizontal${enableKeys ? ' (Shift+Alt+L)' : ''}`}\r\n              onClick={this.props.align_horizontal}\r\n              disabledButtons={disabledButtons}\r\n            />\r\n            <MenuButton\r\n              name={'Toggle primary/secondary' + (enableKeys ? ' (P)' : '')}\r\n              onClick={() => this.props.togglePrimary()}\r\n              disabledButtons={disabledButtons}\r\n            />\r\n            <MenuButton\r\n              name={'Rotate reactant locations' + (enableKeys ? ' (C)' : '')}\r\n              onClick={() => this.props.cyclePrimary()}\r\n              disabledButtons={disabledButtons}\r\n            />\r\n            <li name='divider' />\r\n            <MenuButton\r\n              name={'Select all' + (enableKeys ? ' (Ctrl+A)' : '')}\r\n              onClick={() => this.props.selectAll()}\r\n              disabledButtons={disabledButtons}\r\n            />\r\n            <MenuButton\r\n              name={'Select none' + (enableKeys ? ' (Ctrl+Shift+A)' : '')}\r\n              onClick={() => this.props.selectNone()}\r\n              disabledButtons={disabledButtons}\r\n            />\r\n            <MenuButton\r\n              name='Invert selection'\r\n              onClick={() => this.props.invertSelection()}\r\n              disabledButtons={disabledButtons}\r\n            />\r\n          </Dropdown>\r\n          <Dropdown name='View' rightMenu='true' dropdownVisible={this.props.dropdownVisible}>\r\n            <MenuButton\r\n              name={`Zoom in${enableKeys ? ' (+)' : ''}`}\r\n              onClick={() => this.props.zoom_in()}\r\n              disabledButtons={disabledButtons}\r\n            />\r\n            <MenuButton\r\n              name={`Zoom out${enableKeys ? ' (-)' : ''}`}\r\n              onClick={() => this.props.zoom_out()}\r\n              disabledButtons={disabledButtons}\r\n            />\r\n            <MenuButton\r\n              name={`Zoom to nodes${enableKeys ? ' (0)' : ''}`}\r\n              onClick={() => this.props.zoomExtentNodes()}\r\n              disabledButtons={disabledButtons}\r\n            />\r\n            <MenuButton\r\n              name={`Zoom to canvas${enableKeys ? ' (1)' : ''}`}\r\n              onClick={() => this.props.zoomExtentCanvas()}\r\n              disabledButtons={disabledButtons}\r\n            />\r\n            <MenuButton\r\n              name={`Find${enableKeys ? ' (F)' : ''}`}\r\n              onClick={() => this.props.search()}\r\n              disabledButtons={disabledButtons}\r\n            />\r\n            <MenuButton\r\n              name={`${beziersEnabled ? 'Hide' : 'Show'} control points${enableKeys ? ' (B)' : ''}`}\r\n              onClick={() => this.props.toggleBeziers()}\r\n              disabledButtons={disabledButtons}\r\n            />\r\n            <li name='divider' />\r\n            {/* TODO use preact X to combine the following 2 blocks */}\r\n            {fullScreenButtonEnabled &&\r\n              <MenuButton\r\n                name={'Full screen'}\r\n                onClick={() => this.props.full_screen()}\r\n                checkMark={this.props.isFullScreen}\r\n                disabledButtons={disabledButtons}\r\n              />\r\n            }\r\n            {fullScreenButtonEnabled &&\r\n              <li name='divider' />\r\n            }\r\n            <MenuButton\r\n              name={`Settings${enableKeys ? ' (,)' : ''}`}\r\n              onClick={() => this.props.renderSettingsMenu()}\r\n              disabledButtons={disabledButtons}\r\n              type='settings'\r\n            />\r\n          </Dropdown>\r\n          <a className='helpButton' target='#' href='https://escher.readthedocs.org'>?</a>\r\n        </ul>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default MenuBar;\r\n","\n      import API from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[0].use[1]!./SearchBar.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[0].use[1]!./SearchBar.css\";\n       export default content && content.locals ? content.locals : undefined;\n","/** SearchBar */\r\n\r\n/** @jsx h */\r\nimport {h, Component} from 'preact';\r\nimport './css/SearchBar.css';\r\nimport _ from 'underscore';\r\nimport {EscherMap} from './ts/escherMap';\r\n\r\nclass SearchBar extends Component<{\r\n  searchItem: string;\r\n  map: EscherMap;\r\n  setDisplay: (display: boolean) => void;\r\n}> {\r\n  inputRef: HTMLInputElement | null = null;\r\n  state: {\r\n    current: number;\r\n    searchItem: string;\r\n    counter: string;\r\n    clearEscape?: () => void;\r\n    clearNext?: () => void;\r\n    clearPrevious?: () => void;\r\n    results?: any[];\r\n  };\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      current: 0,\r\n      searchItem: props.searchItem,\r\n      counter: ''\r\n    };\r\n  }\r\n\r\n  componentWillMount() {\r\n    this.setState({\r\n      clearEscape: this.props.map.key_manager.addEscapeListener(\r\n        () => this.close(),\r\n      ),\r\n      clearNext: this.props.map.key_manager.addKeyListener(\r\n        ['enter', 'ctrl+g'],\r\n        () => this.next(),\r\n        false\r\n      ),\r\n      clearPrevious: this.props.map.key_manager.addKeyListener(\r\n        ['shift+enter', 'shift+ctrl+g'],\r\n        () => this.previous(),\r\n        false\r\n      )\r\n    });\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.inputRef.focus();\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.state.clearEscape?.();\r\n    this.state.clearNext?.();\r\n    this.state.clearPrevious?.();\r\n    this.props.map.highlight(null);\r\n  }\r\n\r\n  /**\r\n   * Updates map focus and search bar counter when new search term is entered.\r\n   * @param {string} value - Search term\r\n   */\r\n  handleInput(value: string) {\r\n    const results = this.dropDuplicates(this.props.map.search_index.find(value));\r\n    let counter = '';\r\n    if (results == null || !value)\r\n      this.props.map.highlight(null);\r\n    else if (results.length === 0) {\r\n      counter = '0 / 0';\r\n      this.props.map.highlight(null);\r\n    } else {\r\n      // Catches case where new search term shortens results to less than current index\r\n      if (this.state.current >= results.length) {\r\n        this.setState({\r\n          current: 0\r\n        });\r\n      }\r\n      counter = `${this.state.current + 1}/${results.length}`;\r\n      const r = results[this.state.current];\r\n      if (r.type === 'reaction') {\r\n        this.props.map.zoom_to_reaction(r.reaction_id);\r\n        this.props.map.highlight_reaction(r.reaction_id);\r\n      } else if (r.type === 'metabolite') {\r\n        this.props.map.zoom_to_node(r.node_id);\r\n        this.props.map.highlight_node(r.node_id);\r\n      } else if (r.type === 'text_label') {\r\n        this.props.map.zoom_to_text_label(r.text_label_id);\r\n        this.props.map.highlight_text_label(r.text_label_id);\r\n      } else\r\n        throw new Error('Bad search index data type: ' + r.type);\r\n    }\r\n    this.setState({\r\n      searchItem: value,\r\n      current: 0,\r\n      counter,\r\n      results\r\n    });\r\n  }\r\n\r\n  dropDuplicates(results: {type: string, node_id: string, reaction_id: string, text_label_id: string}[]) {\r\n    const compKeys = {\r\n      metabolite: {\r\n        type: 'm',\r\n        key: 'node_id'\r\n      },\r\n      reaction: {\r\n        type: 'r',\r\n        key: 'reaction_id'\r\n      },\r\n      text_label: {\r\n        type: 't',\r\n        key: 'text_label_id'\r\n      }\r\n    };\r\n    return _.uniq(results, (item) => {\r\n      // make a string for fast comparison\r\n      const {type, key} = compKeys[item.type];\r\n      return `${type}${item[key]}`;\r\n    });\r\n  }\r\n\r\n  next() {\r\n    if (!(this.state.results && this.state.results.length > 0)) return;\r\n    this.update((this.state.current + 1) % this.state.results.length);\r\n  }\r\n\r\n  previous() {\r\n    if (!(this.state.results && this.state.results.length > 0)) return;\r\n    this.update(\r\n      (this.state.current + this.state.results.length - 1) %\r\n      this.state.results.length\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Updates the map focus and search bar counter for when buttons are clicked.\r\n   * @param {number} current - index of current search result\r\n   */\r\n  update(current: number) {\r\n    this.setState({\r\n      current,\r\n      counter: `${current + 1}/${this.state.results.length}`\r\n    });\r\n    const r = this.state.results[current];\r\n    if (r.type === 'reaction') {\r\n      this.props.map.zoom_to_reaction(r.reaction_id);\r\n      this.props.map.highlight_reaction(r.reaction_id);\r\n    } else if (r.type === 'metabolite') {\r\n      this.props.map.zoom_to_node(r.node_id);\r\n      this.props.map.highlight_node(r.node_id);\r\n    } else if (r.type === 'text_label') {\r\n      this.props.map.zoom_to_text_label(r.text_label_id);\r\n      this.props.map.highlight_text_label(r.text_label_id);\r\n    } else\r\n      throw new Error('Bad search index data type: ' + r.type);\r\n  }\r\n\r\n  close() {\r\n    this.props.setDisplay(false);\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className='search-container'>\r\n        <input\r\n          className='search-field'\r\n          value={this.state.searchItem}\r\n          onInput={(event) => this.handleInput((event.target as HTMLInputElement).value)}\r\n          ref={(input) => { this.inputRef = input; }}\r\n        />\r\n        <button className='search-bar-button left btn' onClick={() => this.previous()}>\r\n          <i className='icon-left-open' />\r\n        </button>\r\n        <button className='search-bar-button right btn' onClick={() => this.next()}>\r\n          <i className='icon-right-open' />\r\n        </button>\r\n        <div className='search-counter'>\r\n          {this.state.counter}\r\n        </div>\r\n        <button className='search-bar-button btn' onClick={() => this.close()}>\r\n          <i className='icon-cancel' />\r\n        </button>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default SearchBar;\r\n","\n      import API from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[0].use[1]!./ButtonPanel.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[0].use[1]!./ButtonPanel.css\";\n       export default content && content.locals ? content.locals : undefined;\n","/** @jsx h */\r\nimport {h, Component} from 'preact';\r\nimport './css/ButtonPanel.css';\r\nimport Settings from './ts/Settings';\r\nimport {EscherMap} from './ts/escherMap';\r\nimport ZoomContainer from './ts/ZoomContainer';\r\nimport BuildInput from './ts/BuildInput';\r\n\r\n/**\r\n * ButtonPanel. Sets up the button panel for Builder. Currently calls a\r\n * re-render on itself every time the mode is changed. This can be removed upon\r\n * porting Builder to Preact\r\n */\r\nclass ButtonPanel extends Component<{\r\n  settings: Settings;\r\n  map: EscherMap;\r\n  zoomContainer: ZoomContainer;\r\n  full_screen: () => void;\r\n  mode: string;\r\n  isFullScreen: boolean;\r\n  setMode: (mode: string) => void;\r\n  buildInput: BuildInput;\r\n}> {\r\n  render() {\r\n    const menuSetting = this.props.settings.get('menu');\r\n    const enableKeys = this.props.settings.get('enable_keys');\r\n    const enableEditing = this.props.settings.get('enable_editing');\r\n\r\n    return (\r\n      <ul className='button-panel'>\r\n        {!this.props.settings.get('pathFindingDisabled') && (\r\n          <li>\r\n            <button\r\n              className='button btn'\r\n              onClick={() => this.props.map.findAndHighlightShortest()}\r\n              title={'Find Shortest path'}\r\n            >\r\n              <i className='icon-shortest-path' />\r\n            </button>\r\n            <div className='kth-reaction-arrows'>\r\n              <button\r\n                className='buttonGroup btn'\r\n                title={`Previous shortest reaction`}\r\n                onClick={() => this.props.map.findAndHighlightShortest(-1)}\r\n              >\r\n                <i className='icon-left-big' />\r\n              </button>\r\n\r\n              <button\r\n                className='buttonGroup btn'\r\n                title={`Next shortest reaction`}\r\n                onClick={() => this.props.map.findAndHighlightShortest(1)}\r\n              >\r\n                <i className='icon-right-big' />\r\n              </button>\r\n\r\n            </div>\r\n\r\n          </li>)}\r\n\r\n        {!this.props.settings.get('pathFindingDisabled') && (\r\n          <li>\r\n            <button\r\n              className='button btn'\r\n              onClick={() => this.props.map.findKthOutOrIngoingReactions(0, true)}\r\n              title={'Highlight outgoing reactions'}\r\n            >\r\n              <i className='icon-arrows-outside' />\r\n            </button>\r\n            <div className='kth-reaction-arrows'>\r\n              <button\r\n                className='buttonGroup btn'\r\n                title={`Decrement outgoing reactions`}\r\n                onClick={() => this.props.map.findKthOutOrIngoingReactions(-1, true)}\r\n              >\r\n                <i className='icon-left-big' />\r\n              </button>\r\n\r\n              <button\r\n                className='buttonGroup btn'\r\n                title={`Increment outgoing reactions`}\r\n                onClick={() => this.props.map.findKthOutOrIngoingReactions(1, true)}\r\n              >\r\n                <i className='icon-right-big' />\r\n              </button>\r\n\r\n            </div>\r\n\r\n          </li>)}\r\n\r\n        {!this.props.settings.get('pathFindingDisabled') && (\r\n          <li>\r\n            <button\r\n              className='button btn'\r\n              onClick={() => this.props.map.findKthOutOrIngoingReactions(0, false)}\r\n              title={'Highlight ingoing reactions'}\r\n            >\r\n              <i className='icon-arrows-inside' />\r\n            </button>\r\n            <div className='kth-reaction-arrows'>\r\n              <button\r\n                className='buttonGroup btn'\r\n                title={`Decrement ingoing reactions`}\r\n                onClick={() => this.props.map.findKthOutOrIngoingReactions(-1, false)}\r\n              >\r\n                <i className='icon-left-big' />\r\n              </button>\r\n\r\n              <button\r\n                className='buttonGroup btn'\r\n                title={`Increment ingoing reactions`}\r\n                onClick={() => this.props.map.findKthOutOrIngoingReactions(1, false)}\r\n              >\r\n                <i className='icon-right-big' />\r\n              </button>\r\n\r\n            </div>\r\n\r\n          </li>)}\r\n\r\n        <li>\r\n          <button\r\n            className='button btn'\r\n            onClick={() => this.props.zoomContainer.zoom_in()}\r\n            title={`Zoom in${enableKeys ? ' (+)' : ''}`}\r\n          >\r\n            <i className='icon-zoom-in' />\r\n          </button>\r\n        </li>\r\n        <li>\r\n          <button\r\n            className='button btn'\r\n            onClick={() => this.props.zoomContainer.zoom_out()}\r\n            title={`Zoom out${enableKeys ? ' (-)' : ''}`}\r\n          >\r\n            <i className='icon-zoom-out' />\r\n          </button>\r\n        </li>\r\n        <li>\r\n          <button\r\n            className='button btn'\r\n            onClick={() => this.props.map.zoom_extent_canvas()}\r\n            title={`Zoom to canvas${enableKeys ? ' (1)' : ''}`}\r\n          >\r\n            <i className='icon-resize-full' />\r\n          </button>\r\n        </li>\r\n        <li style={{display: this.props.settings.get('full_screen_button') !== false ? 'block' : 'none'}}>\r\n          <button\r\n            className={`button btn ${this.props.isFullScreen ? 'active-button' : ''}`}\r\n            onClick={() => this.props.full_screen()}\r\n            title={'Toggle full screen'}\r\n          >\r\n            <i className='icon-resize-full-alt' />\r\n          </button>\r\n        </li>\r\n        <li\r\n          className='grouping'\r\n          style={{display: menuSetting === 'all' && enableEditing ? 'block' : 'none'}}\r\n        >\r\n          <button\r\n            className='buttonGroup btn'\r\n            title={`Pan mode${enableKeys ? ' (Z)' : ''}`}\r\n            for='zoom'\r\n            id={this.props.mode === 'zoom' ? 'currentMode' : null}\r\n            onClick={() => this.props.setMode('zoom')}\r\n          >\r\n            <i className='icon-move' />\r\n          </button>\r\n          <button\r\n            className='buttonGroup btn'\r\n            title={`Select mode${enableKeys ? ' (V)' : ''}`}\r\n            for='brush'\r\n            id={this.props.mode === 'brush' ? 'currentMode' : null}\r\n            onClick={() => this.props.setMode('brush')}\r\n          >\r\n            <i className='icon-mouse-pointer' />\r\n          </button>\r\n          <button\r\n            className='buttonGroup btn'\r\n            title={`Add reaction mode${enableKeys ? ' (N)' : ''}`}\r\n            for='build'\r\n            onClick={() => this.props.setMode('build')}\r\n            id={this.props.mode === 'build' ? 'currentMode' : null}>\r\n            <i className='icon-wrench' />\r\n          </button>\r\n          <button\r\n            className='buttonGroup btn'\r\n            title={`Rotate mode${enableKeys ? ' (R)' : ''}`}\r\n            for='rotate'\r\n            id={this.props.mode === 'rotate' ? 'currentMode' : null}\r\n            onClick={() => this.props.setMode('rotate')}\r\n          >\r\n            <i className='icon-cw' />\r\n          </button>\r\n          <button\r\n            className='buttonGroup btn'\r\n            title={`Text mode${enableKeys ? ' (T)' : ''}`}\r\n            for='text'\r\n            id={this.props.mode === 'text' ? 'currentMode' : null}\r\n            onClick={() => this.props.setMode('text')}\r\n          >\r\n            <i className='icon-font' />\r\n          </button>\r\n        </li>\r\n        <li\r\n          className='grouping'\r\n          style={{display: this.props.mode === 'build' && menuSetting === 'all' && enableEditing ? 'block' : 'none'}}\r\n        >\r\n          <button\r\n            className='buttonGroup btn'\r\n            title={`Direction arrow${enableKeys ? ' (←)' : ''}`}\r\n            onClick={() => this.props.buildInput.direction_arrow.left()}\r\n          >\r\n            <i className='icon-left-big' />\r\n          </button>\r\n          <button\r\n            className='buttonGroup btn'\r\n            title={`Direction arrow${enableKeys ? ' (→)' : ''}`}\r\n            onClick={() => this.props.buildInput.direction_arrow.right()}\r\n          >\r\n            <i className='icon-right-big' />\r\n          </button>\r\n          <button\r\n            className='buttonGroup btn'\r\n            title={`Direction arrow${enableKeys ? ' (↑)' : ''}`}\r\n            onClick={() => this.props.buildInput.direction_arrow.up()}\r\n          >\r\n            <i className='icon-up-big' />\r\n          </button>\r\n          <button\r\n            className='buttonGroup btn'\r\n            title={`Direction arrow${enableKeys ? ' (↓)' : ''}`}\r\n            onClick={() => this.props.buildInput.direction_arrow.down()}\r\n          >\r\n            <i className='icon-down-big' />\r\n          </button>\r\n        </li>\r\n      </ul>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ButtonPanel;\r\n","/** @jsx h */\r\nimport {Ref} from 'preact';\r\nimport CallbackManager from './ts/CallbackManager';\r\nimport PlacedDiv from './ts/PlacedDiv';\r\nimport renderWrapper from './renderWrapper';\r\nimport _ from 'underscore';\r\nimport ZoomContainer from './ts/ZoomContainer';\r\nimport {EscherMap} from './ts/escherMap';\r\nimport Settings from './ts/Settings';\r\nimport {D3Selection, TooltipComponentProps} from './ts/types';\r\n\r\n/**\r\n * Manage the tooltip that lives in a PlacedDiv.\r\n * @param selection\r\n * @param tooltipComponent\r\n * @param zoomContainer\r\n * @param map\r\n */\r\nexport default class TooltipContainer {\r\n  div: D3Selection;\r\n  tooltipRef: Ref<any>;\r\n  zoomContainer: ZoomContainer;\r\n  callbackManager: CallbackManager;\r\n  map: EscherMap;\r\n  settings: Settings;\r\n  delayHideTimeout: any;\r\n  currentTooltip: {type: string, id: string} | null;\r\n  placedDiv: PlacedDiv;\r\n  constructor(selection: D3Selection, TooltipComponent: any, zoomContainer: ZoomContainer, map: EscherMap, settings: Settings) {\r\n    this.div = selection.append('div').attr('id', 'tooltip-container');\r\n    this.tooltipRef = null;\r\n\r\n    this.zoomContainer = zoomContainer;\r\n    this.setUpZoomCallbacks(zoomContainer);\r\n\r\n    // Create callback manager\r\n    this.callbackManager = new CallbackManager();\r\n\r\n    this.div.on('mouseover', this.cancelHideTooltip.bind(this));\r\n    this.div.on('mouseleave', this.hide.bind(this));\r\n\r\n    this.map = map;\r\n    this.setUpMapCallbacks(map);\r\n\r\n    this.settings = settings;\r\n\r\n    this.delayHideTimeout = null;\r\n    this.currentTooltip = null;\r\n\r\n    renderWrapper(\r\n      TooltipComponent,\r\n      null,\r\n      (passProps) => this.callbackManager.set('pass_props', passProps),\r\n      this.div.node(),\r\n      (instance) => { this.tooltipRef = instance; }\r\n    );\r\n    this.passProps({\r\n      display: false,\r\n      disableTooltips: () => this.disableTooltips()\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Disable tooltips in the settings\r\n   */\r\n  disableTooltips() {\r\n    this.settings.set('enable_tooltips', false);\r\n    // draw to update tooltip settings\r\n    this.map.draw_everything();\r\n    this.hide();\r\n    this.map.set_status(`Tooltips disabled. You can enable them again in the\r\n                         settings menu.`, 3000);\r\n  }\r\n\r\n  /**\r\n    * Function to pass props for the tooltips. Run without an argument to\r\n    * rerender the component\r\n    * @param {Object} props - Props that the tooltip will use\r\n    */\r\n  passProps(props: Partial<TooltipComponentProps> = {}) {\r\n    this.callbackManager.run('pass_props', null, props);\r\n  }\r\n\r\n  /**\r\n   * Sets up the appropriate callbacks to show the input\r\n   * @param {object} map - map object\r\n   */\r\n  setUpMapCallbacks(map: EscherMap) {\r\n    this.placedDiv = new PlacedDiv(this.div, map, undefined, false);\r\n\r\n    // connect callbacks to show tooltip\r\n    map.callback_manager.set('show_tooltip.tooltip_container', (type: string, d: {bigg_id: string, name: string, data_string: string, xPos: number, yPos: number, label_x: number, label_y: number}) => {\r\n      this.show(type, d);\r\n    });\r\n\r\n    // callback to hide / delay hide tooltip\r\n    map.callback_manager.set('hide_tooltip.tooltip_container', () => this.hide());\r\n    map.callback_manager.set('delay_hide_tooltip.tooltip_container', () => this.delayHide());\r\n\r\n    // Hides the tooltip when the canvas is touched\r\n    map.sel.selectAll('.canvas-group').on('touchend', () => this.hide());\r\n  }\r\n\r\n  setUpZoomCallbacks(zoomContainer: ZoomContainer) {\r\n    zoomContainer.callbackManager.set('zoom.tooltip_container', function() {\r\n      if (this.is_visible())\r\n        this.hide();\r\n    }.bind(this));\r\n    zoomContainer.callbackManager.set('go_to.tooltip_container', function() {\r\n      if (this.is_visible())\r\n        this.hide();\r\n    }.bind(this));\r\n  }\r\n\r\n  /**\r\n   * Return visibility of tooltip container.\r\n   * @return {Boolean} Whether tooltip is visible.\r\n   */\r\n  is_visible() { // eslint-disable-line camelcase\r\n    return this.placedDiv.is_visible();\r\n  }\r\n\r\n  /**\r\n   * Show and place the input.\r\n   * @param {string} type - 'reaction_label', 'node_label', or 'gene_label'\r\n   * @param {Object} d - D3 data for DOM element\r\n   */\r\n  show(type: string, d: {bigg_id: string, name: string, data_string: string, xPos: number, yPos: number, label_x: number, label_y: number}) {\r\n    // get rid of a lingering delayed hide\r\n    this.cancelHideTooltip();\r\n\r\n    if (_.contains(['reaction_label', 'node_label', 'gene_label', 'reaction_object', 'node_object'], type)) {\r\n      // Use a default height if the ref hasn't been connected yet\r\n      const tooltipSize = (this.tooltipRef !== null && 'get_size' in this.tooltipRef && typeof this.tooltipRef.get_size === 'function') ?\r\n        this.tooltipRef.get_size() :\r\n        {width: 270, height: 100};\r\n      this.currentTooltip = {type, id: d[type.replace('_label', '_id').replace('_object', '_id')]};\r\n      const windowTranslate = this.zoomContainer.windowTranslate;\r\n      const windowScale = this.zoomContainer.windowScale;\r\n      const mapSize = this.map !== null ? this.map.get_size() : {width: 1000, height: 1000};\r\n      const offset = {x: 0, y: 0};\r\n      const startPosX = type === 'reaction_object' ? d.xPos : d.label_x;\r\n      const startPosY = type === 'reaction_object' ? d.yPos : d.label_y;\r\n      const rightEdge = windowScale * startPosX + windowTranslate.x + tooltipSize.width;\r\n      const bottomEdge = windowScale * startPosY + windowTranslate.y + tooltipSize.height;\r\n      if (mapSize.width < 500) {\r\n        if (rightEdge > mapSize.width)\r\n          offset.x = -(rightEdge - mapSize.width) / windowScale;\r\n\r\n        if (bottomEdge > mapSize.height - 74)\r\n          offset.y = -(bottomEdge - mapSize.height + 77) / windowScale;\r\n      } else {\r\n        if (windowScale * startPosX + windowTranslate.x + 0.5 * tooltipSize.width > mapSize.width)\r\n          offset.x = -tooltipSize.width / windowScale;\r\n        else if (rightEdge > mapSize.width)\r\n          offset.x = -(rightEdge - mapSize.width) / windowScale;\r\n\r\n        if (windowScale * startPosY + windowTranslate.y + 0.5 * tooltipSize.height > mapSize.height - 45)\r\n          offset.y = -(tooltipSize.height) / windowScale;\r\n        else if (bottomEdge > mapSize.height - 45)\r\n          offset.y = -(bottomEdge - mapSize.height + 47) / windowScale;\r\n      }\r\n      const coords = {x: startPosX + offset.x, y: startPosY + 10 + offset.y};\r\n      this.placedDiv.place(coords);\r\n      this.passProps({\r\n        display: true,\r\n        biggId: d.bigg_id,\r\n        name: d.name,\r\n        loc: coords,\r\n        data: d.data_string,\r\n        type: type.replace('_label', '').replace('node', 'metabolite').replace('_object', '')\r\n      });\r\n    } else\r\n      throw new Error('Tooltip not supported for object type ' + type);\r\n  }\r\n\r\n  /**\r\n   * Hide the input.\r\n   */\r\n  hide() {\r\n    this.placedDiv.hide();\r\n    this.currentTooltip = null;\r\n  }\r\n\r\n  /**\r\n   * Hide the input after a short delay, so that mousing onto the tooltip does not\r\n   * cause it to hide.\r\n   */\r\n  delayHide() {\r\n    this.delayHideTimeout = setTimeout(() => this.hide(), 100);\r\n  }\r\n\r\n  cancelHideTooltip() {\r\n    if (this.delayHideTimeout !== null)\r\n      clearTimeout(this.delayHideTimeout);\r\n  }\r\n}\r\n","\n      import API from \"!../../style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../css-loader/dist/cjs.js??ruleSet[1].rules[0].use[1]!./index.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../css-loader/dist/cjs.js??ruleSet[1].rules[0].use[1]!./index.css\";\n       export default content && content.locals ? content.locals : undefined;\n","\n      import API from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[0].use[1]!./DistributionTooltipComponent.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[0].use[1]!./DistributionTooltipComponent.css\";\n       export default content && content.locals ? content.locals : undefined;\n","/* eslint-disable camelcase */\r\n/** @jsx h */\r\nimport {h, Component} from 'preact';\r\nimport {Range} from 'rc-slider-preact';\r\nimport 'rc-slider-preact/lib/index.css';\r\nimport './css/DistributionTooltipComponent.css';\r\nimport * as utils from './ts/utils';\r\nimport CobraModel from './ts/CobraModel';\r\n\r\n// const utils = require('escher/src/utils.js')\r\nconst WIDTH = 320;\r\nconst HEIGHT = 175;\r\nconst NON_DIST_HEIGHT = 175;\r\n// or: import { WIDTH } from './constants'\r\n\r\nconst tooltipStyle = {\r\n  display: '-webkit-flex',\r\n  flexDirection: 'column',\r\n  boxSizing: 'border-box',\r\n  width: WIDTH + 'px',\r\n  borderRadius: '2px',\r\n  border: '1px solid #b58787',\r\n  padding: '1.5%',\r\n  backgroundColor: 'rgba(255, 255, 255, 1)',\r\n  textAlign: 'left',\r\n  fontSize: '16px',\r\n  fontFamily: 'sans-serif',\r\n  color: '#111',\r\n  boxShadow: '4px 6px 20px 0px rgba(0, 0, 0, 0.4)',\r\n  position: 'relative',\r\n  zIndex: '3'\r\n};\r\nconst fluxDisplayStyle = {\r\n  alignSelf: 'center',\r\n  color: 'black',\r\n  fontSize: '12px',\r\n  fontWeight: 'bold',\r\n  visibility: 'visible'\r\n};\r\nconst indicatorStyle = {\r\n  marginTop: '0.5%',\r\n  display: '-webkit-flex',\r\n  flexDirection: 'column',\r\n  alignSelf: 'center',\r\n  width: '14px',\r\n  height: '14px',\r\n  visibility: 'visible'\r\n};\r\n\r\nexport class HistogramComponent extends Component<{\r\n  data: number[];\r\n  upper_bound: number;\r\n  lower_bound: number;\r\n}> {\r\n  state: {\r\n    upper_bound: number;\r\n    lower_bound: number;\r\n    data: number[];\r\n  };\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      upper_bound: 25,\r\n      lower_bound: -25,\r\n      data: [],\r\n      ...props\r\n    };\r\n  }\r\n\r\n  componentWillReceiveProps(nextProps) {\r\n    this.setState({\r\n      ...this.state,\r\n      ...nextProps\r\n    });\r\n  }\r\n\r\n  render() {\r\n    const {data, upper_bound, lower_bound} = this.state;\r\n    const width = 100; // Width percentage\r\n    const height = 150; // Height in pixels\r\n    const padding = 20; // Padding for the axis labels\r\n    const barWidth = data.length > 0 ? (width / data.length) : 0;\r\n\r\n    // Find max value in data for scaling\r\n    const maxValue = data.length > 0 ? Math.max(...data) : 0;\r\n    const scale = maxValue > 0 ? (height - padding * 2) / maxValue : 0;\r\n\r\n    // Calculate midpoint\r\n    const midPoint = (upper_bound + lower_bound) / 2;\r\n\r\n    return (\r\n      <div className='escher-distribution-histogram' style={{\r\n        position: 'relative',\r\n        width: '100%',\r\n        height: `${height}px`,\r\n        paddingTop: `${padding}px`,\r\n\r\n      }}>\r\n        {/* Render bars */}\r\n        <div style={{display: 'flex', height: `${height - padding * 2}px`, alignItems: 'flex-end', width: '100%'}}>\r\n          {data.map((value, index) => {\r\n            const barHeight = value * scale;\r\n\r\n            return (\r\n              <div\r\n                key={`bar-${index}-${Math.random()}`}\r\n                style={{\r\n                  width: `${barWidth}%`,\r\n                  height: `${barHeight}px`,\r\n                  backgroundColor: '#2083D590',\r\n                  marginRight: index === data.length - 1 ? '0' : '1px',\r\n                  borderBottom: '1px solid black'\r\n                }}\r\n              />\r\n            );\r\n          })}\r\n        </div>\r\n\r\n        {/* X-axis labels */}\r\n        <div style={{\r\n          display: 'flex',\r\n          justifyContent: 'space-between',\r\n          width: '100%',\r\n          position: 'absolute',\r\n          left: '0'\r\n        }}>\r\n          <div style={{textAlign: 'left'}}>{lower_bound}</div>\r\n          <div>{midPoint}</div>\r\n          <div style={{textAlign: 'right'}}>{upper_bound}</div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport type DistributionTooltipProps = {\r\n  type: string;\r\n  name: string;\r\n  model: CobraModel;\r\n  oldModel: CobraModel;\r\n  biggId: string;\r\n  reactionData: { [key: string]: number };\r\n  upperRange: number;\r\n  lowerRange: number;\r\n  step: number;\r\n  fluxDistributions: {\r\n    upper_bound: number;\r\n    lower_bound: number;\r\n    data: Map<string, number[]>;\r\n  };\r\n  samplingFunction: () => void;\r\n  objectives: { [key: string]: number };\r\n  sliderChange: (bounds: number[], biggId: string) => void;\r\n}\r\n\r\nclass DistributionTooltipComponent extends Component<DistributionTooltipProps> {\r\n  state: {\r\n    lowerBound: number;\r\n    upperBound: number;\r\n    lowerBoundOld: number;\r\n    upperBoundOld: number;\r\n    currentFlux: number;\r\n    coefficient: number;\r\n    lowerBoundString: string;\r\n    upperBoundString: string;\r\n    type: string;\r\n    name: string;\r\n    reactionInModel: boolean;\r\n    indicatorStyle: { [key: string]: string };\r\n    fluxDisplayStyle: { [key: string]: string };\r\n    tooltipStyle: { [key: string]: string };\r\n    objectives: { [key: string]: number };\r\n    fluxDistributions: {\r\n      upper_bound: number;\r\n      lower_bound: number;\r\n      data: Map<string, number[]>;\r\n    };\r\n  };\r\n\r\n  constructor(props: DistributionTooltipProps) {\r\n    super(props);\r\n    this.state = {\r\n      lowerBound: 0,\r\n      upperBound: 0,\r\n      lowerBoundOld: 0,\r\n      upperBoundOld: 0,\r\n      currentFlux: 0,\r\n      coefficient: 0,\r\n      lowerBoundString: '',\r\n      upperBoundString: '',\r\n      type: 'reaction',\r\n      name: '',\r\n      reactionInModel: true,\r\n      indicatorStyle,\r\n      fluxDisplayStyle,\r\n      tooltipStyle,\r\n      objectives: {},\r\n      fluxDistributions: props.fluxDistributions // should be a Map\r\n    };\r\n    this.initState(props, {});\r\n  }\r\n\r\n  componentWillReceiveProps(nextProps) {\r\n    this.initState(nextProps, this.props);\r\n  }\r\n\r\n  initState(nextProps: DistributionTooltipProps, lastProps: Partial<DistributionTooltipProps>) {\r\n    // By default, reaction is not in model\r\n    let reactionInModel = false;\r\n\r\n    // If the selected map object is a reaction and there is a model, collect the necessary\r\n    // flux data and calculate placement of arrows and current flux label.\r\n    // Otherwise, only pass the type to the tooltip.\r\n    if (nextProps.type === 'reaction' &&\r\n        !(nextProps.model === undefined || nextProps.model == null)) {\r\n      const fluxData: Partial<typeof this.state> = {};\r\n\r\n      // Only updates all of the flux data when the reaction, model, or objective changes.\r\n      // Otherwise only updates the current flux.\r\n      if (nextProps.biggId !== lastProps.biggId ||\r\n        nextProps.model !== lastProps.model) {\r\n        //\r\n        for (let i = 0, l = nextProps.model.reactions.length; i < l; i++) {\r\n          //\r\n          if (nextProps.model.reactions[i].id === nextProps.biggId) {\r\n            reactionInModel = true;\r\n            fluxData.lowerBound = nextProps.model.reactions[i].lower_bound;\r\n            fluxData.upperBound = nextProps.model.reactions[i].upper_bound;\r\n            fluxData.lowerBoundString = nextProps.model.reactions[i].lower_bound.toString();\r\n            fluxData.upperBoundString = nextProps.model.reactions[i].upper_bound.toString();\r\n            fluxData.lowerBoundOld = nextProps.oldModel.reactions[i].lower_bound;\r\n            fluxData.upperBoundOld = nextProps.oldModel.reactions[i].upper_bound;\r\n            fluxData.name = nextProps.model.reactions[i].name;\r\n            fluxData.coefficient = nextProps.model.reactions[i].objective_coefficient;\r\n            if (nextProps.reactionData != null)\r\n              fluxData.currentFlux = nextProps.reactionData[nextProps.biggId];\r\n            else\r\n              fluxData.currentFlux = null;\r\n\r\n            break;\r\n          }\r\n        }\r\n      } else {\r\n        reactionInModel = true;\r\n        for (let i = 0, l = nextProps.model.reactions.length; i < l; i++) {\r\n          if (nextProps.model.reactions[i].id === nextProps.biggId) {\r\n            if (nextProps.reactionData != null)\r\n              fluxData.currentFlux = nextProps.reactionData[nextProps.biggId];\r\n\r\n            break;\r\n          }\r\n        }\r\n      }\r\n      // For calculating placement of the current flux indicator arrow and label\r\n      let textOffset = {};\r\n      let arrowPosition = {};\r\n      if (nextProps.reactionData != null) {\r\n        if (Math.abs(fluxData.currentFlux) > nextProps.upperRange) {\r\n          arrowPosition = {\r\n            marginLeft: fluxData.currentFlux / Math.abs(fluxData.currentFlux) * 100 + '%'\r\n          };\r\n        } else {\r\n          arrowPosition = {\r\n            marginLeft: fluxData.currentFlux / (nextProps.upperRange + 1) * 100 + '%'\r\n          };\r\n        }\r\n        if (fluxData.currentFlux > 0.65 * nextProps.upperRange)\r\n          textOffset = {alignSelf: 'flex-end'};\r\n        else if (fluxData.currentFlux < 0.65 * nextProps.lowerRange)\r\n          textOffset = {alignSelf: 'flex-start'};\r\n        else\r\n          textOffset = {marginLeft: fluxData.currentFlux / (nextProps.upperRange + 1) * 100 + '%'};\r\n      } else {\r\n        textOffset = {\r\n          visibility: 'hidden'\r\n        };\r\n        arrowPosition = {\r\n          visibility: 'hidden'\r\n        };\r\n      }\r\n      this.setState({\r\n        ...fluxData,\r\n        reactionInModel,\r\n        fluxDisplayStyle: {...fluxDisplayStyle, ...textOffset},\r\n        indicatorStyle: {...indicatorStyle, ...arrowPosition},\r\n        type: nextProps.type,\r\n        objectives: {}\r\n      });\r\n    } else {\r\n      this.setState({\r\n        type: nextProps.type,\r\n        reactionInModel: false\r\n      });\r\n    }\r\n  }\r\n\r\n  get_size() {\r\n    return {width: WIDTH, height: HEIGHT};\r\n  }\r\n\r\n  /**\r\n   * Due to bugs inherent in the slider, all values must be converted to fall\r\n   * somewhere onto the positive number line in order to be displayed correctly\r\n   * on the slider. This function takes a given value and converts it so that it\r\n   * will display on the number line correctly.\r\n   * @param {number} value - Physiologically relevant number to be displayed on\r\n   * slider.\r\n   */\r\n  fluxConverter(value: number) {\r\n    return value < this.props.lowerRange ? // Add parenthesis for better readability\r\n      -1000 :\r\n      value > this.props.upperRange ?\r\n        1000 :\r\n        value + this.props.upperRange + 1;\r\n  }\r\n\r\n  /**\r\n   * Due to bugs inherent in the slider, all values must be converted to fall\r\n   * somewhere onto the positive number line in order to be displayed correctly\r\n   * on the slider. This function takes values from the slider and converts them\r\n   * back to a physiologically relevant value.\r\n   * @param {number} value - Slider value to be converted to physiologically\r\n   * relevant value.\r\n   */\r\n  tipConverter(value: number): number {\r\n    let sigFig = 0;\r\n    if (this.props.step < 1)\r\n      sigFig = Math.ceil(-Math.log10(this.props.step));\r\n\r\n    return value < 1 ?\r\n      -1000 :\r\n      value > (2 * this.props.upperRange + 1) ?\r\n        1000 :\r\n        parseFloat((value - (this.props.upperRange + 1)).toFixed(sigFig));\r\n  }\r\n\r\n  /**\r\n   * Function for applying tipConverter to arrays of numbers.\r\n   * @param {number[]} array - Pair of values (lower and upper bounds,\r\n   * respectively) to be converted from slider values to physiologically\r\n   * relevant values.\r\n   */\r\n  boundConverter(array: (number | string)[]): number[] {\r\n    return array.map(this.tipConverter.bind(this));\r\n  }\r\n\r\n  onTouchStart() {\r\n    const dragStyle = {...this.state.tooltipStyle, backgroundColor: 'rgba(255, 255, 255, 0.8)'};\r\n    this.setState({\r\n      tooltipStyle: dragStyle\r\n    });\r\n  }\r\n\r\n  handleMarkerPosition(currentFlux: number) {\r\n    if (this.props.reactionData != null) {\r\n      return currentFlux < this.props.lowerRange ? // Add parenthesis for better readability\r\n        0 :\r\n        currentFlux > this.props.upperRange ?\r\n          2 * (this.props.upperRange + 1) :\r\n          currentFlux + this.props.upperRange + 1;\r\n    } else\r\n      return this.props.upperRange + 1;\r\n  }\r\n\r\n  handleKeyUp(event: Event, bounds: string[]) {\r\n    this.setState({\r\n      lowerBoundString: bounds[0],\r\n      upperBoundString: bounds[1]\r\n    });\r\n    if (parseFloat(bounds[0]) !== this.state.lowerBound || parseFloat(bounds[1]) !== this.state.upperBound) {\r\n      if (isNaN(parseFloat((event.target as HTMLInputElement).value)))\r\n        console.error('Invalid Bounds');\r\n      else\r\n        this.sliderChange([parseFloat(this.state.lowerBoundString), parseFloat(this.state.upperBoundString)]);\r\n    }\r\n  }\r\n\r\n  sliderChange(bounds: number[]) {\r\n    if (bounds[0] !== parseFloat(this.state.lowerBoundString) || bounds[1] !== parseFloat(this.state.upperBoundString)) {\r\n      this.setState({\r\n        lowerBound: bounds[0],\r\n        upperBound: bounds[1],\r\n        lowerBoundString: bounds[0].toString(),\r\n        upperBoundString: bounds[1].toString()\r\n      });\r\n    } else {\r\n      this.setState({\r\n        lowerBound: bounds[0],\r\n        upperBound: bounds[1]\r\n      });\r\n    }\r\n    this.props.sliderChange(bounds, this.props.biggId);\r\n  }\r\n\r\n  onTouchEnd(bounds: number[]) {\r\n    this.sliderChange(bounds);\r\n    this.setState({\r\n      tooltipStyle\r\n    });\r\n  }\r\n\r\n  resetReaction() {\r\n    this.sliderChange([this.state.lowerBoundOld, this.state.upperBoundOld]);\r\n  }\r\n\r\n  decompartmentalizeCheck(id: string, type: string) {\r\n  // ID without compartment, if metabolite.\r\n    return type === 'metabolite' ?\r\n      utils.decompartmentalize(id)[0] :\r\n      id;\r\n  }\r\n\r\n  openBigg() {\r\n    const type = this.props.type;\r\n    const biggId = this.props.biggId;\r\n    const pref = 'http://bigg.ucsd.edu/';\r\n    const url = (type === 'gene' ?\r\n      pref + 'search?query=' + biggId :\r\n      pref + 'universal/' + type + 's/' + this.decompartmentalizeCheck(biggId, type));\r\n    window.open(url);\r\n  }\r\n\r\n  render() {\r\n    if (this.state.type === 'reaction' && this.state.reactionInModel) {\r\n      // get state of max and min buttons\r\n      const minimizeActive = this.props.objectives[this.props.biggId] === -1;\r\n      const minimizeDisabled = Object.keys(this.props.objectives).length === 1 && minimizeActive;\r\n      const maximizeActive = this.props.objectives[this.props.biggId] === 1;\r\n      const maximizeDisabled = Object.keys(this.props.objectives).length === 1 && maximizeActive;\r\n      const hasFluxDistribution = this.props.fluxDistributions && this.props.fluxDistributions.upper_bound != null && this.props.fluxDistributions.lower_bound != null &&\r\n        this.props.fluxDistributions.data && !!this.props.fluxDistributions.data.get(this.props.biggId);\r\n\r\n      return (\r\n        <div className='escher-tooltip'\r\n          style={{\r\n            ...this.state.tooltipStyle,\r\n            touchAction: 'none'\r\n          }}\r\n        >\r\n          <div className='biggId'>\r\n            {this.props.biggId}\r\n          </div>\r\n          <div className='name'>\r\n            {this.props.name}\r\n          </div>\r\n          <div className='slider' style={{width: WIDTH - 22 + 'px'}}>\r\n            <Range\r\n              onBeforeChange={() => this.onTouchStart()}\r\n              style={{alignSelf: 'center'}}\r\n              min={0}\r\n              max={2 * (this.props.upperRange + 1)}\r\n              step={this.props.step}\r\n              value={[\r\n                this.fluxConverter(this.state.lowerBound),\r\n                this.fluxConverter(this.state.upperBound)\r\n              ]}\r\n              // marks={{[this.fluxConverter(this.state.currentFlux)]: ''}} // no current flux\r\n              tipFormatter={() => null}\r\n              allowCross={false}\r\n              pushable={0}\r\n              onChange={(f) => this.sliderChange(this.boundConverter(f as number[]))}\r\n              onAfterChange={(f) => this.onTouchEnd(this.boundConverter(f as number[]))}\r\n            />\r\n            <div className='indicator' style={this.state.indicatorStyle}>\r\n              <svg viewBox='0 0 100 100' height='100%' width='100%'>\r\n                <defs>\r\n                  <marker id='markerArrow1' viewBox='0 0 6 6' refX='4' refY='3' orient='auto'>\r\n                    <path d='M5,3 L3,5 L3,1 Z' fill='black' stroke='black' />\r\n                  </marker>\r\n                </defs>\r\n                <line x1='50' y1='75' x2='50' y2='20' stroke-width='25' stroke='black' marker-end={'url(#markerArrow1)'} />\r\n              </svg>\r\n            </div>\r\n            <div className='fluxDisplay' style={this.state.fluxDisplayStyle}>\r\n              Average Flux: {this.state.currentFlux == null ? '' : this.state.currentFlux.toFixed(2)}\r\n            </div>\r\n          </div>\r\n          {/* Kebab case for class names?  */}\r\n\r\n          <div className='interfacePanel'>\r\n            <div className='labels'>\r\n              <div\r\n                style={{\r\n                  //  float: 'left',\r\n                  fontSize: '12px'\r\n                }}\r\n              >\r\n              Lower bound\r\n              </div>\r\n              <div\r\n                style={{\r\n                  //  float: 'right',\r\n                  fontSize: '12px'\r\n                }}\r\n              >\r\n              Upper bound\r\n              </div>\r\n            </div>\r\n\r\n\r\n            <div className='inputPanel'>\r\n              <input\r\n                type='text'\r\n                className='input'\r\n                value={this.state.lowerBoundString}\r\n                onFocus={(event) => (event.target as HTMLInputElement).select()}\r\n                onKeyUp={\r\n                  (event) => this.handleKeyUp(event, [(event.target as HTMLInputElement).value, this.state.upperBoundString])\r\n                }\r\n              />\r\n              <input\r\n                type='text'\r\n                className='input'\r\n                value={this.state.upperBoundString}\r\n                onFocus={(event) => (event.target as HTMLInputElement).select()}\r\n                onKeyUp={\r\n                  (event) => this.handleKeyUp(event, [this.state.lowerBound.toString(), (event.target as HTMLInputElement).value?.toString()])\r\n                }\r\n              />\r\n            </div>\r\n            <div className='buttonBar'>\r\n              <button\r\n                className='button'\r\n                onClick={\r\n                  () => this.sliderChange([0, 0])\r\n                }\r\n              >\r\n                Knockout\r\n              </button>\r\n              <button\r\n                className='button'\r\n                onClick={() => this.resetReaction()}\r\n              >\r\n                Reset\r\n              </button>\r\n\r\n              {this.props.samplingFunction != null && (\r\n                <button\r\n                  className='button'\r\n                  onClick={() => this.props.samplingFunction()}\r\n                >\r\n                  Run Sampling\r\n                </button>\r\n              )\r\n\r\n              }\r\n\r\n              {/* <button\r\n                className={maximizeActive ? 'active' : ''}\r\n                onClick={() => this.props.setObjective(this.props.biggId, 1)}\r\n                disabled={maximizeDisabled}\r\n              >\r\n                Maximize\r\n              </button>\r\n              <button\r\n                className={minimizeActive ? 'active' : ''}\r\n                onClick={() => this.props.setObjective(this.props.biggId, -1)}\r\n                disabled={minimizeDisabled}\r\n              >\r\n                Minimize\r\n              </button> */}\r\n            </div>\r\n          </div>\r\n          { hasFluxDistribution && (\r\n            <div className=\"histogramPanel\">\r\n              <HistogramComponent data ={this.props.fluxDistributions.data.get(this.props.biggId)} upper_bound={this.props.fluxDistributions.upper_bound} lower_bound={this.props.fluxDistributions.lower_bound} />\r\n            </div>\r\n          )}\r\n        </div>\r\n      );\r\n    } else if (this.state.type === 'reaction' && !this.state.reactionInModel) {\r\n      return (\r\n        <div className='escher-tooltip'\r\n          style={{\r\n            ...tooltipStyle,\r\n            height: '50px',\r\n            width: '400px'\r\n          }}\r\n        >\r\n          <div className='biggId'>\r\n            {this.props.biggId} is not in the model\r\n          </div>\r\n        </div>\r\n      );\r\n    } else {\r\n      const decomp = this.decompartmentalizeCheck(this.props.biggId, this.props.type);\r\n      return (\r\n        <div\r\n          className='escher-tooltip'\r\n          style={{\r\n            ...this.state.tooltipStyle,\r\n            touchAction: 'none',\r\n            height: 'fit-content',\r\n            width: '250px'\r\n          }}\r\n        >\r\n          <div className='biggId'>\r\n            {this.props.biggId}\r\n          </div>\r\n          <div className='name'>\r\n            {this.props.name}\r\n          </div>\r\n          <button\r\n            className='button'\r\n            style={{width: 'fit-content', marginTop: '10px'}}\r\n            onClick={() => this.openBigg()}\r\n          >\r\n            Open {decomp} in BiGG Models\r\n          </button>\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nexport default DistributionTooltipComponent;\r\n","\n      import API from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[0].use[1]!./fontello.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[0].use[1]!./fontello.css\";\n       export default content && content.locals ? content.locals : undefined;\n","\n      import API from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[0].use[1]!./Builder.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[0].use[1]!./Builder.css\";\n       export default content && content.locals ? content.locals : undefined;\n","/* eslint-disable camelcase */\r\n/**\r\n * For documentation of this class, see docs/javascript_api.rst\r\n */\r\n\r\n/** @jsx h */\r\nimport * as utils from './ts/utils';\r\nimport BuildInput from './ts/BuildInput';\r\nimport ZoomContainer from './ts/ZoomContainer';\r\nimport {EscherMap} from './ts/escherMap';\r\nimport CobraModel from './ts/CobraModel';\r\nimport Brush from './ts/Brush';\r\nimport CallbackManager from './ts/CallbackManager';\r\nimport Settings from './ts/Settings';\r\nimport TextEditInput from './ts/TextEditInput';\r\nimport * as dataStyles from './ts/dataStyles';\r\nimport renderWrapper from './renderWrapper';\r\nimport SettingsMenu from './SettingsMenu';\r\nimport MenuBar from './MenuBar';\r\nimport SearchBar from './SearchBar';\r\nimport ButtonPanel from './ButtonPanel';\r\nimport TooltipContainer from './TooltipContainer';\r\nimport DistributionTooltipComponent from './DistributionTooltip';\r\nimport _ from 'underscore';\r\nimport {\r\n  select as d3Select,\r\n  selection as d3Selection\r\n} from 'd3-selection';\r\n\r\n// Include custom font set for icons\r\nimport '../icons/css/fontello.css';\r\n\r\n// Include GUI CSS normally with webpack\r\nimport './css/Builder.css';\r\n\r\n// Import CSS as a string to embed. This also works from lib because css/src get\r\n// uploaded to NPM.\r\n// @ts-ignore\r\nimport builderEmbed from '!!raw-loader!./css/Builder-embed.css';\r\nimport {CobraModelData, D3Selection, MapData, ReactionSamplingDistribution, SamplingFunctionResult, SettingsType} from './ts/types';\r\nimport {Ref} from 'preact';\r\n\r\nexport type BuilderType = Builder;\r\nexport type BuilderConstructor = typeof Builder;\r\nexport type BuilderSaveState = ReturnType<typeof Builder.prototype.getSavingState>\r\n\r\nclass Builder {\r\n  reaction_sampling_distribution?: ReactionSamplingDistribution | null = null;\r\n\r\n  map_data: MapData | null = null;\r\n  model_data: CobraModelData | null = null;\r\n  embeddedCss: string | null = null;\r\n  selection: D3Selection | null = null;\r\n  menu_div: D3Selection | null = null;\r\n  button_div: D3Selection | null = null;\r\n  search_bar_div: D3Selection | null = null;\r\n  searchBarRef: D3Selection | null = null;\r\n  semanticOptions: any | null = null;\r\n  mode: string | null = null;\r\n  settings: Settings | null = null;\r\n  isFullScreen: boolean | null = null;\r\n  savedFullScreenSettings: any | null = null;\r\n  savedFullScreenParent: any | null = null;\r\n  clearFullScreenEscape: any | null = null;\r\n  callback_manager: CallbackManager | null = null;\r\n  has_custom_reaction_styles: boolean;\r\n  map: EscherMap | null = null;\r\n  mapToolsContainer: D3Selection | null = null;\r\n  zoom_container: ZoomContainer | null = null;\r\n  tooltip_container: TooltipContainer | null = null;\r\n  cobra_model: CobraModel | null = null;\r\n  build_input: BuildInput;\r\n  text_edit_input: TextEditInput;\r\n  brush: Brush;\r\n  settingsMenuRef: Ref<SettingsMenu> | null = null;\r\n  menuBarRef: Ref<MenuBar> | null = null;\r\n  buttonPanelRef: Ref<ButtonPanel> | null = null;\r\n  update_model_timer: any;\r\n  status_bar: any;\r\n\r\n  constructor(mapData: MapData, modelData: CobraModelData | null, embeddedCss: string, selection: D3Selection, options: Partial<SettingsType>) {\r\n    // Defaults\r\n    if (!selection)\r\n      selection = d3Select('body').append('div');\r\n    else if (selection instanceof d3Selection) {\r\n      // D3 V4 selection\r\n    } else if ('node' in selection) {\r\n      // If user passes in a selection from an different d3 version/instance,\r\n      // then reselect.\r\n      selection = d3Select(selection.node());\r\n    } else {\r\n      // HTML Element\r\n      selection = d3Select(selection);\r\n    }\r\n    if (!options)\r\n      options = {};\r\n\r\n    if (!embeddedCss)\r\n      embeddedCss = builderEmbed;\r\n\r\n\r\n    this.reaction_sampling_distribution = {\r\n      lower_bound: -25,\r\n      upper_bound: 25,\r\n      data: new Map()\r\n    };\r\n\r\n    this.map_data = mapData;\r\n    this.model_data = modelData;\r\n    this.embeddedCss = embeddedCss;\r\n    this.selection = selection;\r\n    this.menu_div = null;\r\n    this.button_div = null;\r\n    this.search_bar_div = null;\r\n    this.searchBarRef = null;\r\n    this.semanticOptions = null;\r\n    this.mode = 'zoom';\r\n\r\n    // apply this object as data for the selection\r\n    this.selection.datum(this);\r\n    // @ts-ignore\r\n    this.selection.__builder__ = this;\r\n\r\n    // Remember if the user provided a custom value for reaction_styles\r\n    this.has_custom_reaction_styles = Boolean(options.reaction_styles);\r\n\r\n    // set defaults\r\n    const optionsWithDefaults: SettingsType = utils.set_options(options, {\r\n      // view options\r\n      menu: 'all',\r\n      pathFindingDisabled: false,\r\n      saveAction: null,\r\n      loadAction: null,\r\n      scroll_behavior: 'pan',\r\n      use_3d_transform: false,\r\n      highlight_same_nodes: false,\r\n      enable_editing: true,\r\n      enable_keys: true,\r\n      enable_search: true,\r\n      fill_screen: false,\r\n      zoom_to_element: null,\r\n      full_screen_button: false,\r\n      ignore_bootstrap: false,\r\n      disabled_buttons: null,\r\n      semantic_zoom: null,\r\n      // map, model, and styles\r\n      starting_reaction: null,\r\n      never_ask_before_quit: false,\r\n      unique_map_id: null, // deprecated\r\n      primary_metabolite_radius: 20,\r\n      secondary_metabolite_radius: 10,\r\n      marker_radius: 5,\r\n      gene_font_size: 18,\r\n      hide_secondary_metabolites: false,\r\n      show_gene_reaction_rules: false,\r\n      hide_all_labels: false,\r\n      canvas_size_and_loc: null,\r\n      // applied data\r\n      // reaction\r\n      reaction_data: null,\r\n      reaction_styles: ['color', 'size', 'text', 'abs'],\r\n      reaction_compare_style: 'log2_fold',\r\n      reaction_scale: null,\r\n      reaction_scale_preset: 'GaBuGeRd',\r\n      reaction_no_data_color: '#dcdcdc',\r\n      reaction_no_data_size: 8,\r\n      // samplingFunction\r\n      samplingFunction: null,\r\n      // gene\r\n      gene_data: null,\r\n      and_method_in_gene_reaction_rule: 'mean',\r\n      // metabolite\r\n      metabolite_data: null,\r\n      metabolite_styles: ['color', 'size', 'text'],\r\n      metabolite_compare_style: 'log2_fold',\r\n      metabolite_scale: null,\r\n      metabolite_scale_preset: 'WhYlRd',\r\n      metabolite_no_data_color: '#ffffff',\r\n      metabolite_no_data_size: 10,\r\n      // View and build options\r\n      identifiers_on_map: 'bigg_id',\r\n      highlight_missing: false,\r\n      allow_building_duplicate_reactions: false,\r\n      cofactors: [\r\n        'atp', 'adp', 'nad', 'nadh', 'nadp', 'nadph', 'gtp', 'gdp', 'h', 'coa',\r\n        'ump', 'h2o', 'ppi'\r\n      ],\r\n      // Extensions\r\n      tooltip_component: DistributionTooltipComponent,\r\n      enable_tooltips: ['label'],\r\n      enable_keys_with_tooltip: true,\r\n      // Callbacks\r\n      first_load_callback: null\r\n    } as SettingsType, {\r\n      primary_metabolite_radius: true,\r\n      secondary_metabolite_radius: true,\r\n      marker_radius: true,\r\n      gene_font_size: true,\r\n      reaction_no_data_size: true,\r\n      metabolite_no_data_size: true\r\n    });\r\n\r\n    // Check the location\r\n    if (utils.check_for_parent_tag(this.selection, 'svg')) {\r\n      throw new Error('Builder cannot be placed within an svg node ' +\r\n                      'because UI elements are html-based.');\r\n    }\r\n\r\n    // The options that are erased when the settings menu is canceled\r\n    const conditional = [\r\n      'identifiers_on_map',\r\n      'scroll_behavior',\r\n      'hide_secondary_metabolites',\r\n      'show_gene_reaction_rules',\r\n      'hide_all_labels',\r\n      'allow_building_duplicate_reactions',\r\n      'highlight_missing',\r\n      'enable_tooltips',\r\n      'reaction_scale_preset',\r\n      'reaction_no_data_color',\r\n      'reaction_no_data_size',\r\n      'reaction_scale',\r\n      'reaction_styles',\r\n      'reaction_compare_style',\r\n      'and_method_in_gene_reaction_rule',\r\n      'metabolite_scale_preset',\r\n      'metabolite_scale',\r\n      'metabolite_styles',\r\n      'metabolite_compare_style',\r\n      'metabolite_no_data_color',\r\n      'metabolite_no_data_size',\r\n      'samplingFunction',\r\n    ];\r\n    // this.options and this.settings used to have different functions, but now\r\n    // they are aliases\r\n    this.settings = new Settings(optionsWithDefaults, conditional as (keyof SettingsType)[]);\r\n\r\n    // Warn if full/fill screen options conflict\r\n    if (this.settings.get('fill_screen') && this.settings.get('full_screen_button')) {\r\n      this.settings.set('full_screen_button', false);\r\n      console.warn('The option full_screen_button has no effect when fill_screen is true');\r\n    }\r\n\r\n    // force full screen for fill_screen option\r\n    this.isFullScreen = false;\r\n    if (this.settings.get('fill_screen')) {\r\n      d3Select('html').classed('fill-screen', true);\r\n      d3Select('body').classed('fill-screen', true);\r\n      this.selection.classed('fill-screen-div', true);\r\n      this.isFullScreen = true;\r\n    }\r\n    this.savedFullScreenSettings = null;\r\n    this.savedFullScreenParent = null;\r\n    this.clearFullScreenEscape = null;\r\n\r\n    // Set up this callback manager\r\n    this.callback_manager = new CallbackManager();\r\n    const firstLoadCallback = this.settings.get('first_load_callback');\r\n    this.callback_manager.set('first_load', () => {\r\n      if (firstLoadCallback !== null)\r\n        firstLoadCallback(this);\r\n\r\n      let oldModel = JSON.parse(JSON.stringify(this.model_data)); // need to keep this for resetting\r\n      const getTooltipProps = () => {\r\n        const sliderChangeFunc = (a: number[], b: string) => {\r\n          if (!a || !b || !Array.isArray(a) || typeof b !== 'string' || !this.model_data || !this.model_data.reactions)\r\n            return;\r\n          const lower_bound = a[0];\r\n          const upper_bound = a[1];\r\n          const id = b;\r\n          for (let i = 0; i < this.model_data.reactions.length; i++) {\r\n            if (this.model_data.reactions[i].id === id) {\r\n              this.model_data.reactions[i].lower_bound = lower_bound;\r\n              this.model_data.reactions[i].upper_bound = upper_bound;\r\n              break;\r\n            }\r\n          }\r\n        };\r\n\r\n        const debouncedSliderAction = _.debounce(sliderChangeFunc, 300);\r\n\r\n\r\n        return {map: this.map, model: this.model_data, sliderChange: debouncedSliderAction, lowerRange: -25,\r\n          upperRange: 25, step: 0.01, oldModel: oldModel, objectives: {}, samplingFunction: this.settings.get('samplingFunction') ? this.sampleReactions.bind(this) : null,\r\n          fluxDistributions: this.reaction_sampling_distribution, reactionData: this.settings.get('reaction_data')\r\n        };\r\n      };\r\n      // Set up the tooltip container\r\n\r\n\r\n      this.tooltip_container.passProps(getTooltipProps()); // reactionData misssing\r\n      this.callback_manager.set('load_map', (mpData) => {\r\n        this.set_reaction_data(null);\r\n        oldModel = JSON.parse(JSON.stringify(this.model_data));\r\n        this.tooltip_container.passProps(getTooltipProps());\r\n      });\r\n      this.callback_manager.set('load_model', (modelData) => {\r\n        this.set_reaction_data(null);\r\n        oldModel = JSON.parse(JSON.stringify(this.model_data));\r\n        this.tooltip_container.passProps(getTooltipProps());\r\n      });\r\n    });\r\n\r\n\r\n    // Set up the zoom container\r\n    this.zoom_container = new ZoomContainer(this.selection,\r\n      this.settings.get('scroll_behavior'),\r\n      this.settings.get('use_3d_transform'));\r\n    // Zoom container status changes\r\n    // this.zoom_container.callbackManager.set('svg_start', () => {\r\n    //   if (this.map) this.map.set_status('Drawing ...')\r\n    // })\r\n    // this.zoom_container.callbackManager.set('svg_finish', () => {\r\n    //   if (this.map) this.map.set_status('')\r\n    // })\r\n    this.zoom_container.callbackManager.set('zoom_change', () => {\r\n      if (this.settings.get('semantic_zoom')) {\r\n        const scale = this.zoom_container.windowScale;\r\n        const optionObject = this.settings.get('semantic_zoom')\r\n          .sort((a, b) => a.zoomLevel - b.zoomLevel)\r\n          .find((a) => a.zoomLevel > scale);\r\n        if (optionObject) {\r\n          let didChange = false;\r\n          _.mapObject(optionObject.options, (value, key) => {\r\n            if (this.settings.get(key) !== value) {\r\n              this.settings.set(key, value);\r\n              didChange = true;\r\n            }\r\n          });\r\n          if (didChange) this._updateData(false, true);\r\n        }\r\n      }\r\n    });\r\n    this.settings.streams.use_3d_transform.onValue((val) => {\r\n      this.zoom_container.setUse3dTransform(val);\r\n    });\r\n    this.settings.streams.scroll_behavior.onValue((val) => {\r\n      this.zoom_container.setScrollBehavior(val);\r\n    });\r\n\r\n    // Reactive tooltip settings\r\n    this.settings.streams.enable_tooltips.onValue((val) => {\r\n      this._updateTooltipSetting(val);\r\n    });\r\n\r\n    // Make a container for other map-related tools that will be reset on map load\r\n    // TODO only create these once in the Builder constructor\r\n    this.mapToolsContainer = this.selection.append('div')\r\n      .attr('class', 'map-tools-container');\r\n\r\n    // Status in both modes\r\n    this._createStatus(this.selection);\r\n\r\n    // Load the model, map, and update data in both\r\n    this.load_model(this.model_data, false);\r\n\r\n    // Append the bars and menu divs to the document\r\n    const s = this.selection\r\n      .append('div').attr('class', 'search-menu-container')\r\n      .append('div').attr('class', 'search-menu-container-inline');\r\n    this.menu_div = s.append('div');\r\n    this.search_bar_div = s.append('div');\r\n    this.button_div = this.selection.append('div');\r\n\r\n    // Need to defer map loading to let webpack CSS load properly. Hack:\r\n    // Delaying 50ms to make sure the css calculations on map size take\r\n    // place.\r\n    _.delay(() => {\r\n      this.load_map(this.map_data, false);\r\n\r\n      const messageFn = this._reactionCheckAddAbs();\r\n      this._updateData(true, true);\r\n\r\n      // Setting callbacks. TODO enable atomic updates. Right now, every time the\r\n      // menu closes, everything is drawn.\r\n      this.settings.statusBus.onValue((x) => {\r\n        if (x === 'accept') {\r\n          this._updateData(true, true, ['reaction', 'metabolite'], false);\r\n          if (this.zoom_container !== null) {\r\n            // TODO make this automatic\r\n            const newBehavior = this.settings.get('scroll_behavior');\r\n            this.zoom_container.setScrollBehavior(newBehavior);\r\n          }\r\n          if (this.map !== null) {\r\n            this.map.draw_all_nodes(false);\r\n            this.map.draw_all_reactions(true, false);\r\n            this.map.select_none();\r\n          }\r\n        }\r\n      });\r\n\r\n      if (messageFn !== null) setTimeout(messageFn, 500);\r\n\r\n      // Finally run callback\r\n      _.defer(() => this.callback_manager.run('first_load', this));\r\n    }, 50);\r\n  }\r\n\r\n  sampleReactions() {\r\n    const samplingFunction = this.settings.get('samplingFunction');\r\n    if (samplingFunction) {\r\n      //  function should return same signature as this.reaction_sampling_distribution\r\n      const data = samplingFunction(this.model_data);\r\n\r\n      const dataReceived = (d: SamplingFunctionResult) => {\r\n        if (!d)\r\n          throw new Error('Sampling function did not return any data');\r\n        this.reaction_sampling_distribution.lower_bound = d.lower_bound;\r\n        this.reaction_sampling_distribution.upper_bound = d.upper_bound;\r\n        this.reaction_sampling_distribution.data.clear();\r\n        for (const [key, value] of d.data)\r\n          this.reaction_sampling_distribution.data.set(key, value);\r\n      };\r\n      const isPromise = data instanceof Promise;\r\n      if (isPromise)\r\n        data.then(dataReceived);\r\n      else\r\n        dataReceived(data);\r\n    }\r\n  }\r\n\r\n  // builder.options is deprecated\r\n  get options() {\r\n    throw new Error('builder.options is deprecated. Use builder.settings.get() ' +\r\n                    'and builder.settings.set() instead.');\r\n  }\r\n  set options(_) {\r\n    throw new Error('builder.options is deprecated. Use builder.settings.get() ' +\r\n                    'and builder.settings.set() instead.');\r\n  }\r\n\r\n  /**\r\n   * For documentation of this function, see docs/javascript_api.rst.\r\n   */\r\n  load_model(modelData, shouldUpdateData = true) { // eslint-disable-line camelcase\r\n    this.model_data = modelData;\r\n    this.reaction_sampling_distribution.data.clear();\r\n\r\n    // Check the cobra model\r\n    if (_.isNull(modelData))\r\n      this.cobra_model = null;\r\n    else\r\n      this.cobra_model = CobraModel.from_cobra_json(modelData);\r\n\r\n\r\n    if (this.map) {\r\n      this.map.cobra_model = this.cobra_model;\r\n      if (shouldUpdateData)\r\n        this._updateData(true, false);\r\n\r\n      if (this.settings.get('highlight_missing'))\r\n        this.map.draw_all_reactions(false, false);\r\n    }\r\n\r\n    this.callback_manager.run('load_model', null, modelData, shouldUpdateData);\r\n  }\r\n\r\n  /**\r\n   * For documentation of this function, see docs/javascript_api.rst\r\n   */\r\n  load_map(mapData, shouldUpdateData = true) { // eslint-disable-line camelcase\r\n    // Store map options that might be changed by semantic_zoom function\r\n    const tempSemanticOptions = {};\r\n    if (this.settings.get('semantic_zoom')) {\r\n      for (const level of this.settings.get('semantic_zoom')) {\r\n        Object.keys(level.options).map((option) => {\r\n          if (tempSemanticOptions[option] === undefined)\r\n            tempSemanticOptions[option] = this.settings.get(option);\r\n        });\r\n      }\r\n      this.semanticOptions = Object.assign({}, tempSemanticOptions);\r\n    }\r\n\r\n    // remove the old map and related divs\r\n    utils.remove_child_nodes(this.zoom_container.zoomedSel);\r\n    utils.remove_child_nodes(this.mapToolsContainer);\r\n\r\n    const zoomedSel = this.zoom_container.zoomedSel;\r\n    const svg = this.zoom_container.svg;\r\n\r\n    // remove the old map side effects\r\n    if (this.map)\r\n      this.map.key_manager.toggle(false);\r\n\r\n\r\n    if (mapData !== null) {\r\n      // import map\r\n      this.map = EscherMap.from_data(mapData,\r\n        svg,\r\n        this.embeddedCss,\r\n        zoomedSel,\r\n        this.zoom_container,\r\n        this.settings,\r\n        this.cobra_model,\r\n        this.settings.get('enable_search'));\r\n    } else {\r\n      // new map\r\n      this.map = new EscherMap(svg,\r\n        this.embeddedCss,\r\n        zoomedSel,\r\n        this.zoom_container,\r\n        this.settings,\r\n        this.cobra_model,\r\n        this.settings.get('canvas_size_and_loc'),\r\n        this.settings.get('enable_search'));\r\n    }\r\n\r\n    // Connect status bar\r\n    this._setupStatus(this.map);\r\n    this.map.set_status('Loading map ...');\r\n\r\n    // Connect tooltips\r\n    this._updateTooltipSetting(this.settings.get('enable_tooltips'));\r\n\r\n    // Set the data for the map\r\n    if (shouldUpdateData)\r\n      this._updateData(false, true);\r\n\r\n\r\n    // Set up the reaction input with complete.ly\r\n    this.build_input = new BuildInput(this.mapToolsContainer, this.map,\r\n      this.zoom_container, this.settings);\r\n\r\n    // Set up the text edit input\r\n    this.text_edit_input = new TextEditInput(this.mapToolsContainer, this.map,\r\n      this.zoom_container);\r\n\r\n    // Set up the Brush\r\n    this.brush = new Brush(zoomedSel, false, this.map, '.canvas-group');\r\n    // reset brush when canvas resizes in brush mode\r\n    this.map.canvas.callbackManager.set('resize', () => {\r\n      if (this.mode === 'brush') this.brush.toggle(true);\r\n    });\r\n\r\n    // Set up menus\r\n    this.setUpSettingsMenu(this.mapToolsContainer);\r\n    this.setUpButtonPanel(this.mapToolsContainer);\r\n\r\n    // share a parent container for menu bar and search bar\r\n    const sel = this.mapToolsContainer\r\n      .append('div').attr('class', 'search-menu-container')\r\n      .append('div').attr('class', 'search-menu-container-inline');\r\n    this.setUpMenuBar(sel);\r\n    this.setUpSearchBar(sel);\r\n\r\n    // Set up the tooltip container\r\n    this.tooltip_container = new TooltipContainer(\r\n      this.mapToolsContainer,\r\n      this.settings.get('tooltip_component'),\r\n      this.zoom_container,\r\n      this.map,\r\n      this.settings\r\n    );\r\n\r\n    // Set up key manager\r\n    this.map.key_manager.assignedKeys = this.getKeys();\r\n    // Tell the key manager about the reaction input and search bar\r\n    this.map.key_manager.inputList = [\r\n      this.build_input,\r\n      this.searchBarRef,\r\n      () => this.settingsMenuRef,\r\n      this.text_edit_input\r\n    ];\r\n    if (!this.settings.get('enable_keys_with_tooltip'))\r\n      this.map.key_manager.inputList.push(this.tooltip_container);\r\n\r\n    // Make sure the key manager remembers all those changes\r\n    this.map.key_manager.update();\r\n    // Turn it on/off\r\n    this.map.key_manager.toggle(this.settings.get('enable_keys'));\r\n    this.settings.streams.enable_keys.onValue((val) => {\r\n      // get keys given latest settings\r\n      this.map.key_manager.toggle(val);\r\n    });\r\n\r\n    // Disable clears\r\n    const newDisabledButtons = this.settings.get('disabled_buttons') || [];\r\n    if (!this.settings.get('reaction_data'))\r\n      newDisabledButtons.push('Clear reaction data');\r\n\r\n    if (!this.settings.get('gene_data'))\r\n      newDisabledButtons.push('Clear gene data');\r\n\r\n    if (!this.settings.get('metabolite_data'))\r\n      newDisabledButtons.push('Clear metabolite data');\r\n\r\n    if (!this.settings.get('enable_search'))\r\n      newDisabledButtons.push('Find');\r\n\r\n    if (!this.settings.get('enable_editing'))\r\n      newDisabledButtons.push('Show control points');\r\n\r\n    this.settings.set('disabled_buttons', newDisabledButtons);\r\n\r\n    // Set up selection box\r\n    if (this.settings.get('zoom_to_element')) {\r\n      const type = this.settings.get('zoom_to_element').type;\r\n      const elementId = this.settings.get('zoom_to_element').id;\r\n      if (_.isUndefined(type) || ['reaction', 'node'].indexOf(type) === -1)\r\n        throw new Error('zoom_to_element type must be \"reaction\" or \"node\"');\r\n\r\n      if (_.isUndefined(elementId))\r\n        throw new Error('zoom_to_element must include id');\r\n\r\n      if (type === 'reaction')\r\n        this.map.zoom_to_reaction(elementId);\r\n      else if (type === 'node')\r\n        this.map.zoom_to_node(elementId);\r\n    } else if (mapData)\r\n      this.map.zoom_extent_canvas();\r\n    else {\r\n      if (this.settings.get('starting_reaction') && this.cobra_model !== null) {\r\n        // Draw default reaction if no map is provided\r\n        const size = this.zoom_container.get_size();\r\n        const startCoords = {x: size.width / 2, y: size.height / 4};\r\n        this.map.new_reaction_from_scratch(this.settings.get('starting_reaction'),\r\n          startCoords, 90);\r\n        this.map.zoom_extent_nodes();\r\n      } else\r\n        this.map.zoom_extent_canvas();\r\n    }\r\n\r\n    // Start in zoom mode for builder, view mode for viewer\r\n    if (this.settings.get('enable_editing'))\r\n      this.zoom_mode();\r\n    else\r\n      this.view_mode();\r\n\r\n    // when enabled_editing changes, go to view mode\r\n    this.settings.streams.enable_editing.onValue((val) => {\r\n      if (val) this.zoom_mode();\r\n      else this.view_mode();\r\n    });\r\n\r\n    // confirm before leaving the page\r\n    if (this.settings.get('enable_editing'))\r\n      this._setupConfirmBeforeExit();\r\n\r\n\r\n    // draw\r\n    this.map.draw_everything();\r\n\r\n    this.map.set_status('');\r\n\r\n    this.callback_manager.run('load_map', null, mapData, shouldUpdateData);\r\n  }\r\n\r\n  /**\r\n   * Function to pass props for the settings menu. Run without an argument to\r\n   * rerender the component\r\n   * @param {Object} props - Props that the settings menu will use\r\n   */\r\n  passPropsSettingsMenu(props = {}) {\r\n    this.map.callback_manager.run('pass_props_settings_menu', null, props);\r\n  }\r\n\r\n  /**\r\n   * Initialize the settings menu\r\n   */\r\n  setUpSettingsMenu(sel) {\r\n    this.settingsMenuRef = null;\r\n    renderWrapper(\r\n      SettingsMenu,\r\n      (instance: Ref<SettingsMenu>) => { this.settingsMenuRef = instance; },\r\n      (passProps) => this.map.callback_manager.set('pass_props_settings_menu', passProps),\r\n      sel.append('div').node()\r\n    );\r\n    this.passPropsSettingsMenu({\r\n      display: false,\r\n      settings: this.settings,\r\n      map: this.map\r\n    });\r\n\r\n    // redraw menu when settings change\r\n    _.mapObject(this.settings.streams, (stream, key) => {\r\n      stream.onValue((value) => {\r\n        this.passPropsSettingsMenu();\r\n      });\r\n    });\r\n\r\n    // recalculate data when switching to/from absolute value\r\n    this.settings.streams.reaction_styles\r\n      .map((x) => _.contains(x, 'abs'))\r\n      .skipDuplicates()\r\n      .onValue(() => this._updateData(false, true));\r\n    this.settings.streams.metabolite_styles\r\n      .map((x) => _.contains(x, 'abs'))\r\n      .skipDuplicates()\r\n      .onValue(() => this._updateData(false, true));\r\n  }\r\n\r\n  /**\r\n   * Function to pass props for the menu bar\r\n   * @param {Object} props - Props that the menu bar will use\r\n   */\r\n  passPropsMenuBar(props = {}) {\r\n    this.map.callback_manager.run('pass_props_menu_bar', null, props);\r\n  }\r\n\r\n  /**\r\n   * Initialize the menu bar\r\n   * @param {D3 Selection} sel - The d3 selection to render in.\r\n   */\r\n  setUpMenuBar(sel) {\r\n    this.menuBarRef = null;\r\n    renderWrapper(\r\n      MenuBar,\r\n      (instance) => { this.menuBarRef = instance; },\r\n      (passProps) => this.map.callback_manager.set('pass_props_menu_bar', passProps),\r\n      sel.append('div').node()\r\n    );\r\n    this.passPropsMenuBar({\r\n      display: this.settings.get('menu') === 'all',\r\n      settings: this.settings,\r\n      sel: this.selection,\r\n      mode: this.mode,\r\n      map: this.map,\r\n      saveMap: () => {\r\n        // Revert options changed by semanticZoom to their original values if option is active\r\n        if (this.semanticOptions) {\r\n          Object.entries(this.semanticOptions).map(([key, value]) => {\r\n            this.settings.set(key, value);\r\n          });\r\n          this._updateData();\r\n        }\r\n        this.map.save();\r\n      },\r\n      loadMap: (file) => this.load_map(file),\r\n      assignKeyLoadMap: (fn) => {\r\n        // connect the key for this input\r\n        this.map.key_manager.assignedKeys.load_map.fn = fn;\r\n      },\r\n      save_svg: () => this.map.save_svg(),\r\n      save_png: () => this.map.save_png(),\r\n      clear_map: () => { this.clear_map(); },\r\n      loadModel: (file) => this.load_model(file, true),\r\n      assignKeyLoadModel: (fn) => {\r\n        // connect the key for this input\r\n        this.map.key_manager.assignedKeys.load_model.fn = fn;\r\n      },\r\n      clearModel: () => {\r\n        this.load_model(null);\r\n        this.callback_manager.run('clear_model');\r\n      },\r\n      updateRules: () => this.map.convert_map(),\r\n      setReactionData: (d: { [key: string]: (number | string | null) } | null) => this.set_reaction_data(d),\r\n      clearReactionData: () => this.set_reaction_data(null),\r\n      setGeneData: (d) => this.set_gene_data(d),\r\n      clearGeneData: () => this.set_gene_data(null, true),\r\n      setMetaboliteData: (d) => this.set_metabolite_data(d),\r\n      clearMetaboliteData: (d) => this.set_metabolite_data(null),\r\n      setMode: (mode: string) => this._setMode(mode),\r\n      deleteSelected: () => this.map.delete_selected(),\r\n      undo: () => this.map.undo_stack.undo(),\r\n      redo: () => this.map.undo_stack.redo(),\r\n      align_vertical: () => this.map.align_vertical(),\r\n      align_horizontal: () => this.map.align_horizontal(),\r\n      togglePrimary: () => this.map.toggle_selected_node_primary(),\r\n      cyclePrimary: () => this.map.cycle_primary_node(),\r\n      selectAll: () => this.map.select_all(),\r\n      selectNone: () => this.map.select_none(),\r\n      invertSelection: () => this.map.invert_selection(),\r\n      zoom_in: () => this.zoom_container.zoom_in(),\r\n      zoom_out: () => this.zoom_container.zoom_out(),\r\n      zoomExtentNodes: () => this.map.zoom_extent_nodes(),\r\n      zoomExtentCanvas: () => this.map.zoom_extent_canvas(),\r\n      full_screen: () => this.full_screen(),\r\n      search: () => this.passPropsSearchBar({display: true}),\r\n      toggleBeziers: () => this.map.toggle_beziers(),\r\n      renderSettingsMenu: () => this.passPropsSettingsMenu({display: true})\r\n    });\r\n\r\n    // redraw when beziers change\r\n    this.map.callback_manager.set('toggle_beziers', () => {\r\n      this.passPropsMenuBar();\r\n    });\r\n\r\n    // redraw when disabledButtons change\r\n    this.settings.streams.disabled_buttons.onValue((value) => {\r\n      this.passPropsMenuBar();\r\n    });\r\n\r\n    // redraw when mode changes\r\n    this.callback_manager.set('set_mode', (mode) => {\r\n      this.passPropsMenuBar({mode});\r\n    });\r\n\r\n    // redraw when menu option changes\r\n    this.settings.streams.menu.onValue((menu) => {\r\n      this.passPropsMenuBar({display: menu === 'all'});\r\n    });\r\n\r\n    this.settings.streams.saveAction?.onValue((value) => {\r\n      this.passPropsMenuBar();\r\n    });\r\n    this.settings.streams.loadAction?.onValue((value) => {\r\n      this.passPropsMenuBar();\r\n    });\r\n    this.settings.streams.pathFindingDisabled?.onValue((value) => {\r\n      this.passPropsButtonPanel();\r\n    });\r\n\r\n    // redraw when full screen button changes\r\n    this.settings.streams.full_screen_button.onValue((value) => {\r\n      this.passPropsMenuBar();\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Function to pass props for the search bar\r\n   * @param {Object} props - Props that the search bar will use\r\n   */\r\n  passPropsSearchBar(props = {}) {\r\n    this.map.callback_manager.run('pass_props_search_bar', null, props);\r\n  }\r\n\r\n  /**\r\n   * Initialize the search bar\r\n   * @param {D3 Selection} sel - The d3 selection to render in.\r\n   */\r\n  setUpSearchBar(sel: D3Selection) {\r\n    this.searchBarRef = null;\r\n    renderWrapper(\r\n      SearchBar,\r\n      (instance) => { this.searchBarRef = instance; },\r\n      (passProps) => this.map.callback_manager.set('pass_props_search_bar', passProps),\r\n      sel.append('div').node()\r\n    );\r\n    this.passPropsSearchBar({\r\n      display: false,\r\n      searchIndex: this.map.search_index,\r\n      map: this.map\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Function to pass props for the button panel\r\n   * @param {Object} props - Props that the tooltip will use\r\n   */\r\n  passPropsButtonPanel(props = {}) {\r\n    this.map.callback_manager.run('pass_props_button_panel', null, props);\r\n  }\r\n\r\n  /**\r\n   * Initialize the button panel\r\n   */\r\n  setUpButtonPanel(sel: D3Selection) {\r\n    renderWrapper(\r\n      ButtonPanel,\r\n      null,\r\n      (passProps) => this.map.callback_manager.set('pass_props_button_panel', passProps),\r\n      sel.append('div').node()\r\n    );\r\n    this.passPropsButtonPanel({\r\n      display: _.contains(['all', 'zoom'], this.settings.get('menu')),\r\n      mode: this.mode,\r\n      settings: this.settings,\r\n      setMode: (mode: string) => this._setMode(mode),\r\n      zoomContainer: this.zoom_container,\r\n      map: this.map,\r\n      buildInput: this.build_input,\r\n      full_screen: () => this.full_screen(),\r\n    });\r\n\r\n    // redraw when mode changes\r\n    this.callback_manager.set('set_mode', (mode) => {\r\n      this.passPropsButtonPanel({mode});\r\n    });\r\n\r\n    // redraw when full screen button changes\r\n    this.settings.streams.full_screen_button.onValue((value) => {\r\n      this.passPropsButtonPanel();\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Set the mode\r\n   */\r\n  _setMode(mode: string) {\r\n    this.mode = mode;\r\n\r\n    // input\r\n    this.build_input.toggle(mode === 'build');\r\n    this.build_input.direction_arrow.toggle(mode === 'build');\r\n    // brush\r\n    this.brush.toggle(mode === 'brush');\r\n    // zoom\r\n    this.zoom_container.togglePanDrag(mode === 'zoom' || mode === 'view');\r\n    // resize canvas\r\n    this.map.canvas.toggleResize(mode !== 'view');\r\n\r\n    // Behavior. Be careful of the order becuase rotation and\r\n    // toggle_selectable_drag both use Behavior.selectableDrag.\r\n    if (mode === 'rotate') {\r\n      this.map.behavior.toggleSelectableDrag(false); // before toggle_rotation_mode\r\n      this.map.behavior.toggleRotationMode(true); // XX\r\n    } else {\r\n      this.map.behavior.toggleRotationMode(mode === 'rotate'); // before toggleSelectableDrag\r\n      this.map.behavior.toggleSelectableDrag(mode === 'brush'); // XX\r\n    }\r\n    this.map.behavior.toggleSelectableClick(mode === 'build' || mode === 'brush'); // XX\r\n    this.map.behavior.toggleLabelDrag(mode === 'brush'); // XX\r\n    this.map.behavior.toggleTextLabelEdit(mode === 'text'); // XX\r\n    this.map.behavior.toggleBezierDrag(mode === 'brush'); // XX\r\n\r\n    // edit selections\r\n    if (mode === 'view' || mode === 'text')\r\n      this.map.select_none();\r\n\r\n    if (mode === 'rotate')\r\n      this.map.deselect_text_labels();\r\n\r\n\r\n    this.map.draw_everything();\r\n    // what's not allowing me to delete this? XX above\r\n\r\n    // callback\r\n    this.callback_manager.run('set_mode', null, mode);\r\n  }\r\n\r\n  /** For documentation of this function, see docs/javascript_api.rst. */\r\n  view_mode() { // eslint-disable-line camelcase\r\n    this.callback_manager.run('view_mode');\r\n    this._setMode('view');\r\n  }\r\n\r\n  /** For documentation of this function, see docs/javascript_api.rst. */\r\n  build_mode() { // eslint-disable-line camelcase\r\n    this.callback_manager.run('build_mode');\r\n    this._setMode('build');\r\n  }\r\n\r\n  /** For documentation of this function, see docs/javascript_api.rst. */\r\n  brush_mode() { // eslint-disable-line camelcase\r\n    this.callback_manager.run('brush_mode');\r\n    this._setMode('brush');\r\n  }\r\n\r\n  /** For documentation of this function, see docs/javascript_api.rst. */\r\n  zoom_mode() { // eslint-disable-line camelcase\r\n    this.callback_manager.run('zoom_mode');\r\n    this._setMode('zoom');\r\n  }\r\n\r\n  /** For documentation of this function, see docs/javascript_api.rst. */\r\n  rotate_mode() { // eslint-disable-line camelcase\r\n    this.callback_manager.run('rotate_mode');\r\n    this._setMode('rotate');\r\n  }\r\n\r\n  /** For documentation of this function, see docs/javascript_api.rst. */\r\n  text_mode() { // eslint-disable-line camelcase\r\n    this.callback_manager.run('text_mode');\r\n    this._setMode('text');\r\n  }\r\n\r\n  _reactionCheckAddAbs() {\r\n    const currStyle = this.settings.get('reaction_styles');\r\n    if (\r\n      this.settings.get('reaction_data') &&\r\n      !this.has_custom_reaction_styles &&\r\n      !_.contains(currStyle, 'abs')\r\n    ) {\r\n      this.settings.set('reaction_styles', currStyle.concat('abs'));\r\n      return () => {\r\n        this.map.set_status('Visualizing absolute value of reaction data. ' +\r\n                            'Change this option in Settings.', 5000);\r\n      };\r\n    }\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * For documentation of this function, see docs/javascript_api.rst.\r\n   */\r\n  set_reaction_data(data: { [key: string]: (number | string | null) } | null) { // eslint-disable-line camelcase\r\n    this.settings.set('reaction_data', data);\r\n\r\n    // clear gene data\r\n    if (data)\r\n      this.settings.options.gene_data = null;\r\n\r\n\r\n    const messageFn = this._reactionCheckAddAbs();\r\n\r\n    this._updateData(true, true, ['reaction']);\r\n\r\n    if (messageFn) messageFn();\r\n    else this.map.set_status('');\r\n\r\n    const disabledButtons = this.settings.get('disabled_buttons') || [];\r\n    const buttonName = 'Clear reaction data';\r\n    const geneButtonName = 'Clear gene data';\r\n    const index = disabledButtons.indexOf(buttonName);\r\n    if (data && index !== -1) {\r\n      disabledButtons.splice(index, 1);\r\n      const gInd = disabledButtons.indexOf(geneButtonName);\r\n      if (gInd === -1) disabledButtons.push(geneButtonName);\r\n      this.settings.set('disabled_buttons', disabledButtons);\r\n    } else if (!data && index === -1) {\r\n      disabledButtons.push(buttonName);\r\n      this.settings.set('disabled_buttons', disabledButtons);\r\n    }\r\n\r\n    this.tooltip_container.passProps({reactionData: data}); // pass new reaction props.\r\n  }\r\n\r\n  /**\r\n   * For documentation of this function, see docs/javascript_api.rst.\r\n   */\r\n  set_gene_data(data: any, clearGeneReactionRules: boolean = false) { // eslint-disable-line camelcase\r\n    this.settings.set('gene_data', data);\r\n\r\n    if (clearGeneReactionRules)\r\n      this.settings.set('show_gene_reaction_rules', false);\r\n\r\n\r\n    // clear reaction data; show gene reaction rules\r\n    if (data) {\r\n      this.settings.options.reaction_data = null;\r\n      this.settings.set('show_gene_reaction_rules', true);\r\n    }\r\n\r\n    this._updateData(true, true, ['reaction']);\r\n    this.map.set_status('');\r\n\r\n    const disabledButtons = this.settings.get('disabled_buttons') || [];\r\n    const index = disabledButtons.indexOf('Clear gene data');\r\n    const buttonName = 'Clear gene data';\r\n    const reactionButtonName = 'Clear reaction data';\r\n    if (index > -1 && data) {\r\n      disabledButtons.splice(index, 1);\r\n      const rInd = disabledButtons.indexOf('Clear reaction data');\r\n      if (rInd === -1) disabledButtons.push(reactionButtonName);\r\n      this.settings.set('disabled_buttons', disabledButtons);\r\n    } else if (index === -1 && !data) {\r\n      disabledButtons.push(buttonName);\r\n      this.settings.set('disabled_buttons', disabledButtons);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * For documentation of this function, see docs/javascript_api.rst.\r\n   */\r\n  set_metabolite_data(data: { [key: string]: (number | string | null)[] } | null) { // eslint-disable-line camelcase\r\n    this.settings.set('metabolite_data', data);\r\n\r\n    this._updateData(true, true, ['metabolite']);\r\n    this.map.set_status('');\r\n\r\n    const disabledButtons = this.settings.get('disabled_buttons') || [];\r\n    const buttonName = 'Clear metabolite data';\r\n    const index = disabledButtons.indexOf(buttonName);\r\n    if (index > -1 && data) {\r\n      disabledButtons.splice(index, 1);\r\n      this.settings.set('disabled_buttons', disabledButtons);\r\n    } else if (index === -1 && !data) {\r\n      disabledButtons.push(buttonName);\r\n      this.settings.set('disabled_buttons', disabledButtons);\r\n    }\r\n  }\r\n\r\n  _makeGeneDataObject(geneData: any, cobraModel: CobraModel, map: EscherMap) {\r\n    const allReactions = {};\r\n    if (cobraModel !== null)\r\n      utils.extend(allReactions, cobraModel.reactions);\r\n\r\n    // extend, overwrite\r\n    if (map !== null)\r\n      utils.extend(allReactions, map.reactions, true);\r\n\r\n\r\n    // this object has reaction keys and values containing associated genes\r\n    return dataStyles.importAndCheck(geneData, 'gene_data', allReactions);\r\n  }\r\n\r\n  /**\r\n   * Clear the map\r\n   */\r\n  clear_map() { // eslint-disable-line camelcase\r\n    this.callback_manager.run('clear_map');\r\n    this.map.clearMapData();\r\n    this._updateData(true, true, ['reaction', 'metabolite'], false);\r\n    this.map.draw_everything();\r\n  }\r\n\r\n  /**\r\n   * Set data and settings for the model.\r\n   * update_model: (Boolean) Update data for the model.\r\n   * update_map: (Boolean) Update data for the map.\r\n   * kind: (Optional, Default: all) An array defining which data is being updated\r\n   * that can include any of: ['reaction', 'metabolite'].\r\n   * should_draw: (Optional, Default: true) Whether to redraw the update sections\r\n   * of the map.\r\n   */\r\n  _updateData(\r\n    updateModel = false,\r\n    updateMap = false,\r\n    kind: string[] = ['reaction', 'metabolite'],\r\n    shouldDraw = true\r\n  ) {\r\n    const updateReactionData = _.contains(kind, 'reaction');\r\n    const updateMetaboliteData = _.contains(kind, 'metabolite');\r\n    let metaboliteDataObject: { [key: string]: (number | string | null)[] } | null = null;\r\n    let reactionDataObject: { [key: string]: (number | string | null)[] } | null = null;\r\n    let geneDataObject: { [key: string]: { [key: string]: (number | string | null)[] } } | null = null;\r\n\r\n    // -------------------\r\n    // First map, and draw\r\n    // -------------------\r\n\r\n    // metabolite data\r\n    if (updateMetaboliteData && updateMap && this.map !== null) {\r\n      metaboliteDataObject = dataStyles.importAndCheck(this.settings.get('metabolite_data'),\r\n        'metabolite_data');\r\n      this.map.apply_metabolite_data_to_map(metaboliteDataObject);\r\n      if (shouldDraw)\r\n        this.map.draw_all_nodes(false);\r\n    }\r\n\r\n    // reaction data\r\n    if (updateReactionData) {\r\n      if (this.settings.get('reaction_data') && updateMap && this.map !== null) {\r\n        reactionDataObject = dataStyles.importAndCheck(this.settings.get('reaction_data'),\r\n          'reaction_data');\r\n        this.map.apply_reaction_data_to_map(reactionDataObject);\r\n        if (shouldDraw)\r\n          this.map.draw_all_reactions(false, false);\r\n      } else if (this.settings.get('gene_data') && updateMap && this.map !== null) {\r\n        geneDataObject = this._makeGeneDataObject(this.settings.get('gene_data'),\r\n          this.cobra_model, this.map);\r\n        this.map.apply_gene_data_to_map(geneDataObject);\r\n        if (shouldDraw)\r\n          this.map.draw_all_reactions(false, false);\r\n      } else if (updateMap && this.map !== null) {\r\n        // clear the data\r\n        this.map.apply_reaction_data_to_map(null);\r\n        if (shouldDraw)\r\n          this.map.draw_all_reactions(false, false);\r\n      }\r\n    }\r\n\r\n    // ----------------------------------------------------------------\r\n    // Then the model, after drawing. Delay by 5ms so the the map draws\r\n    // first.\r\n    // ----------------------------------------------------------------\r\n\r\n    // If this function runs again, cancel the previous model update\r\n    if (this.update_model_timer)\r\n      clearTimeout(this.update_model_timer);\r\n\r\n\r\n    const delay = 5;\r\n    this.update_model_timer = setTimeout(() => {\r\n      // metabolite_data\r\n      if (updateMetaboliteData && updateModel && this.cobra_model !== null) {\r\n        // if we haven't already made this\r\n        if (!metaboliteDataObject) {\r\n          metaboliteDataObject = dataStyles.importAndCheck(this.settings.get('metabolite_data'),\r\n            'metabolite_data');\r\n        }\r\n        this.cobra_model.apply_metabolite_data(metaboliteDataObject,\r\n          this.settings.get('metabolite_styles'),\r\n          this.settings.get('metabolite_compare_style'));\r\n      }\r\n\r\n      // reaction data\r\n      if (updateReactionData) {\r\n        if (this.settings.get('reaction_data') && updateModel && this.cobra_model !== null) {\r\n          // if we haven't already made this\r\n          if (!reactionDataObject) {\r\n            reactionDataObject = dataStyles.importAndCheck(this.settings.get('reaction_data'),\r\n              'reaction_data');\r\n          }\r\n          this.cobra_model.apply_reaction_data(reactionDataObject,\r\n            this.settings.get('reaction_styles'),\r\n            this.settings.get('reaction_compare_style'));\r\n        } else if (this.settings.get('gene_data') && updateModel && this.cobra_model !== null) {\r\n          if (!geneDataObject) {\r\n            geneDataObject = this._makeGeneDataObject(this.settings.get('gene_data'),\r\n              this.cobra_model, this.map);\r\n          }\r\n          this.cobra_model.apply_gene_data(geneDataObject,\r\n            this.settings.get('reaction_styles'),\r\n            this.settings.get('identifiers_on_map'),\r\n            this.settings.get('reaction_compare_style'),\r\n            this.settings.get('and_method_in_gene_reaction_rule'));\r\n        } else if (updateModel && this.cobra_model !== null) {\r\n          // clear the data\r\n          this.cobra_model.apply_reaction_data(null,\r\n            this.settings.get('reaction_styles'),\r\n            this.settings.get('reaction_compare_style'));\r\n        }\r\n      }\r\n\r\n      // callback\r\n      this.callback_manager.run('update_data', null, updateModel, updateMap,\r\n        kind, shouldDraw);\r\n    }, delay);\r\n  }\r\n\r\n  _createStatus(selection: D3Selection) {\r\n    this.status_bar = selection.append('div').attr('id', 'status');\r\n  }\r\n\r\n  _setupStatus(map: EscherMap) {\r\n    map.callback_manager.set('set_status', (status) => this.status_bar.html(status));\r\n  }\r\n\r\n  _updateTooltipSetting(setting: string | string[]) {\r\n    this.map.behavior.toggleLabelMouseover(setting && setting.includes('label'));\r\n    this.map.behavior.toggleObjectMouseover(setting && setting.includes('object'));\r\n  }\r\n\r\n  /**\r\n   * Define keyboard shortcuts\r\n   */\r\n  getKeys() {\r\n    const map = this.map;\r\n    const zoom_container = this.zoom_container; // eslint-disable-line camelcase\r\n    return {\r\n      save: {\r\n        key: 'ctrl+s',\r\n        target: map,\r\n        fn: map.save\r\n      },\r\n      save_svg: {\r\n        key: 'ctrl+shift+s',\r\n        target: map,\r\n        fn: map.save_svg\r\n      },\r\n      save_png: {\r\n        key: 'ctrl+shift+p',\r\n        target: map,\r\n        fn: map.save_png\r\n      },\r\n      load_map: {\r\n        key: 'ctrl+o',\r\n        fn: null // defined by button\r\n      },\r\n      convert_map: {\r\n        target: map,\r\n        fn: map.convert_map\r\n      },\r\n      load_model: {\r\n        key: 'ctrl+m',\r\n        fn: null // defined by button\r\n      },\r\n      zoom_in_ctrl: {\r\n        key: 'ctrl+=',\r\n        target: zoom_container,\r\n        fn: zoom_container.zoom_in\r\n      },\r\n      zoom_in: {\r\n        key: '=',\r\n        target: zoom_container,\r\n        fn: zoom_container.zoom_in,\r\n        ignoreWithInput: true\r\n      },\r\n      zoom_out_ctrl: {\r\n        key: 'ctrl+-',\r\n        target: zoom_container,\r\n        fn: zoom_container.zoom_out\r\n      },\r\n      zoom_out: {\r\n        key: '-',\r\n        target: zoom_container,\r\n        fn: zoom_container.zoom_out,\r\n        ignoreWithInput: true\r\n      },\r\n      extent_nodes_ctrl: {\r\n        key: 'ctrl+0',\r\n        target: map,\r\n        fn: map.zoom_extent_nodes\r\n      },\r\n      extent_nodes: {\r\n        key: '0',\r\n        target: map,\r\n        fn: map.zoom_extent_nodes,\r\n        ignoreWithInput: true\r\n      },\r\n      extent_canvas_ctrl: {\r\n        key: 'ctrl+1',\r\n        target: map,\r\n        fn: map.zoom_extent_canvas\r\n      },\r\n      extent_canvas: {\r\n        key: '1',\r\n        target: map,\r\n        fn: map.zoom_extent_canvas,\r\n        ignoreWithInput: true\r\n      },\r\n      view_mode: {\r\n        target: this,\r\n        fn: this.view_mode,\r\n        ignoreWithInput: true\r\n      },\r\n      show_settings_ctrl: {\r\n        key: 'ctrl+,',\r\n        fn: () => this.passPropsSettingsMenu({display: true})\r\n      },\r\n      show_settings: {\r\n        key: ',',\r\n        fn: () => this.passPropsSettingsMenu({display: true}),\r\n        ignoreWithInput: true\r\n      },\r\n      build_mode: {\r\n        key: 'n',\r\n        target: this,\r\n        fn: this.build_mode,\r\n        ignoreWithInput: true,\r\n        requires: 'enable_editing'\r\n      },\r\n      zoom_mode: {\r\n        key: 'z',\r\n        target: this,\r\n        fn: this.zoom_mode,\r\n        ignoreWithInput: true,\r\n        requires: 'enable_editing'\r\n      },\r\n      brush_mode: {\r\n        key: 'v',\r\n        target: this,\r\n        fn: this.brush_mode,\r\n        ignoreWithInput: true,\r\n        requires: 'enable_editing'\r\n      },\r\n      rotate_mode: {\r\n        key: 'r',\r\n        target: this,\r\n        fn: this.rotate_mode,\r\n        ignoreWithInput: true,\r\n        requires: 'enable_editing'\r\n      },\r\n      text_mode: {\r\n        key: 't',\r\n        target: this,\r\n        fn: this.text_mode,\r\n        ignoreWithInput: true,\r\n        requires: 'enable_editing'\r\n      },\r\n      toggle_beziers: {\r\n        key: 'b',\r\n        target: map,\r\n        fn: map.toggle_beziers,\r\n        ignoreWithInput: true,\r\n        requires: 'enable_editing'\r\n      },\r\n      delete_ctrl: {\r\n        key: 'ctrl+backspace',\r\n        target: map,\r\n        fn: map.delete_selected,\r\n        ignoreWithInput: true,\r\n        requires: 'enable_editing'\r\n      },\r\n      delete: {\r\n        key: 'backspace',\r\n        target: map,\r\n        fn: map.delete_selected,\r\n        ignoreWithInput: true,\r\n        requires: 'enable_editing'\r\n      },\r\n      delete_del: {\r\n        key: 'del',\r\n        target: map,\r\n        fn: map.delete_selected,\r\n        ignoreWithInput: true,\r\n        requires: 'enable_editing'\r\n      },\r\n      align_vertical: {\r\n        key: 'alt+l',\r\n        target: map,\r\n        fn: map.align_vertical\r\n      },\r\n      align_horizontal: {\r\n        key: 'shift+alt+l',\r\n        target: map,\r\n        fn: map.align_horizontal\r\n      },\r\n      toggle_primary: {\r\n        key: 'p',\r\n        target: map,\r\n        fn: map.toggle_selected_node_primary,\r\n        ignoreWithInput: true,\r\n        requires: 'enable_editing'\r\n      },\r\n      cycle_primary: {\r\n        key: 'c',\r\n        target: map,\r\n        fn: map.cycle_primary_node,\r\n        ignoreWithInput: true,\r\n        requires: 'enable_editing'\r\n      },\r\n      direction_arrow_right: {\r\n        key: 'right',\r\n        target: this.build_input.direction_arrow,\r\n        fn: this.build_input.direction_arrow.right,\r\n        ignoreWithInput: true,\r\n        requires: 'enable_editing'\r\n      },\r\n      direction_arrow_down: {\r\n        key: 'down',\r\n        target: this.build_input.direction_arrow,\r\n        fn: this.build_input.direction_arrow.down,\r\n        ignoreWithInput: true,\r\n        requires: 'enable_editing'\r\n      },\r\n      direction_arrow_left: {\r\n        key: 'left',\r\n        target: this.build_input.direction_arrow,\r\n        fn: this.build_input.direction_arrow.left,\r\n        ignoreWithInput: true,\r\n        requires: 'enable_editing'\r\n      },\r\n      direction_arrow_up: {\r\n        key: 'up',\r\n        target: this.build_input.direction_arrow,\r\n        fn: this.build_input.direction_arrow.up,\r\n        ignoreWithInput: true,\r\n        requires: 'enable_editing'\r\n      },\r\n      undo: {\r\n        key: 'ctrl+z',\r\n        target: map.undo_stack,\r\n        fn: map.undo_stack.undo,\r\n        requires: 'enable_editing'\r\n      },\r\n      redo: {\r\n        key: 'ctrl+shift+z',\r\n        target: map.undo_stack,\r\n        fn: map.undo_stack.redo,\r\n        requires: 'enable_editing'\r\n      },\r\n      select_all: {\r\n        key: 'ctrl+a',\r\n        target: map,\r\n        fn: map.select_all,\r\n        ignoreWithInput: true,\r\n        requires: 'enable_editing'\r\n      },\r\n      select_none: {\r\n        key: 'ctrl+shift+a',\r\n        target: map,\r\n        fn: map.select_none,\r\n        ignoreWithInput: true,\r\n        requires: 'enable_editing'\r\n      },\r\n      invert_selection: {\r\n        target: map,\r\n        fn: map.invert_selection,\r\n        requires: 'enable_editing'\r\n      },\r\n      search_ctrl: {\r\n        key: 'ctrl+f',\r\n        fn: () => this.passPropsSearchBar({display: true}),\r\n        requires: 'enable_search'\r\n      },\r\n      search: {\r\n        key: 'f',\r\n        fn: () => this.passPropsSearchBar({display: true}),\r\n        ignoreWithInput: true,\r\n        requires: 'enable_search'\r\n      }\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Ask if the user wants to exit the page (to avoid unplanned refresh).\r\n   */\r\n  _setupConfirmBeforeExit() {\r\n    window.onbeforeunload = (_) => this.settings.get('never_ask_before_quit') ?\r\n      null :\r\n      'You will lose any unsaved changes.';\r\n  }\r\n\r\n  /**\r\n   * Toggle full screen mode.\r\n   */\r\n  full_screen() { // eslint-disable-line camelcase\r\n    // these settings can update in full screen if provided\r\n    const fullScreenSettings = [\r\n      'menu',\r\n      'scroll_behavior',\r\n      'enable_editing',\r\n      'enable_keys',\r\n      'enable_tooltips'\r\n    ];\r\n\r\n    if (this.isFullScreen) {\r\n      d3Select('html').classed('fill-screen', false);\r\n      d3Select('body').classed('fill-screen', false);\r\n      this.selection.classed('fill-screen-div', false);\r\n      this.isFullScreen = false;\r\n\r\n      // clear escape listener\r\n      if (this.clearFullScreenEscape) {\r\n        this.clearFullScreenEscape();\r\n        this.clearFullScreenEscape = null;\r\n      }\r\n\r\n      // hack for full screen in jupyterlab / notebook\r\n      if (this.savedFullScreenParent) {\r\n        const parentNode = this.savedFullScreenParent.node();\r\n        parentNode.insertBefore(this.selection.remove().node(), parentNode.firstChild);\r\n        this.savedFullScreenParent = null;\r\n      }\r\n\r\n      // apply the saved settings\r\n      if (this.savedFullScreenSettings !== null) {\r\n        _.mapObject(this.savedFullScreenSettings, (v, k) => {\r\n          this.settings.set(k, v);\r\n        });\r\n      }\r\n      this.savedFullScreenSettings = null;\r\n    } else {\r\n      // save current settings\r\n      const fullScreenButton = this.settings.get('full_screen_button');\r\n      if (_.isObject(fullScreenButton)) {\r\n        this.savedFullScreenSettings = (\r\n          _.chain(fullScreenButton)\r\n            .pairs()\r\n            .map(([k, v]) => {\r\n              if (_.contains(fullScreenSettings, k)) {\r\n                const currentSetting = this.settings.get(k);\r\n                this.settings.set(k, v);\r\n                return [k, currentSetting];\r\n              } else {\r\n                console.warn(`${k} not recognized as an option for full_screen_button`);\r\n                return [null, null];\r\n              }\r\n            })\r\n            .filter(([k, v]) => k)\r\n            .object()\r\n            .value()\r\n        );\r\n      }\r\n\r\n      d3Select('html').classed('fill-screen', true);\r\n      d3Select('body').classed('fill-screen', true);\r\n      this.selection.classed('fill-screen-div', true);\r\n      this.isFullScreen = true;\r\n\r\n      // hack for full screen in jupyterlab\r\n      this.savedFullScreenParent = d3Select(this.selection.node().parentNode as Element);\r\n      const bodyNode = d3Select('body').node() as Element;\r\n      bodyNode.insertBefore(this.selection.remove().node(), bodyNode.firstChild);\r\n\r\n      // set escape listener\r\n      this.clearFullScreenEscape = this.map.key_manager.addEscapeListener(\r\n        () => this.full_screen()\r\n      );\r\n    }\r\n    this.map.zoom_extent_canvas();\r\n    this.passPropsButtonPanel({isFullScreen: this.isFullScreen});\r\n    this.passPropsMenuBar({isFullScreen: this.isFullScreen});\r\n  }\r\n\r\n  getSavingState() {\r\n    return {\r\n      type: 'Datagrok metabolic network',\r\n      selectedNodes: Object.keys(this.map.getSelectedNodes()),\r\n      lastAction: this.map.last_action,\r\n      mapJson: this.map.map_for_export(),\r\n      cobraModel: this.model_data,\r\n      description: '',\r\n    };\r\n  }\r\n\r\n  // here, state is stringified JSON\r\n  loadSavingState(stateJSON: string | null) {\r\n    if (!stateJSON)\r\n      return;\r\n    const state: ReturnType<typeof this.getSavingState> = JSON.parse(stateJSON);\r\n    if (!state.mapJson)\r\n      return;\r\n    if (state.cobraModel)\r\n      this.load_model(state.cobraModel, true);\r\n\r\n    this.load_map(state.mapJson, true);\r\n\r\n    if (state.selectedNodes)\r\n      this.map.select_nodes(state.selectedNodes);\r\n\r\n\r\n    if (state.lastAction && state.lastAction.function && state.lastAction.args && state.lastAction.function in this.map) {\r\n      if (state.lastAction.args.length == 1)\r\n        this.map[state.lastAction.function](state.lastAction.args[0]);\r\n      else if (state.lastAction.args.length == 2)\r\n        this.map[state.lastAction.function](state.lastAction.args[0], state.lastAction.args[1]);\r\n    }\r\n\r\n    this.map.selectionChanged && this.map.selectionChanged();\r\n  }\r\n}\r\n\r\nexport default utils.class_with_optional_new(Builder);\r\n","export default \"svg.escher-svg #mouse-node {\\r\\n  fill: none;\\r\\n}\\r\\nsvg.escher-svg #canvas {\\r\\n  stroke: #ccc;\\r\\n  stroke-width: 7px;\\r\\n  fill: white;\\r\\n}\\r\\nsvg.escher-svg .resize-rect {\\r\\n  fill: black;\\r\\n  opacity: 0;\\r\\n  stroke: none;\\r\\n}\\r\\nsvg.escher-svg .label {\\r\\n  font-family: sans-serif;\\r\\n  font-style: italic;\\r\\n  font-weight: bold;\\r\\n  font-size: 8px;\\r\\n  fill: black;\\r\\n  stroke: none;\\r\\n  text-rendering: optimizelegibility;\\r\\n  cursor: default;\\r\\n}\\r\\nsvg.escher-svg .reaction-label {\\r\\n  font-size: 30px;\\r\\n  fill: rgb(32, 32, 120);\\r\\n  text-rendering: optimizelegibility;\\r\\n}\\r\\nsvg.escher-svg .node-label {\\r\\n  font-size: 20px;\\r\\n}\\r\\nsvg.escher-svg .gene-label {\\r\\n  font-size: 18px;\\r\\n  fill: rgb(32, 32, 120);\\r\\n  text-rendering: optimizelegibility;\\r\\n  cursor: default;\\r\\n}\\r\\nsvg.escher-svg .text-label .label {\\r\\n  font-size: 50px;\\r\\n}\\r\\nsvg.escher-svg .text-label-input {\\r\\n  font-size: 50px;\\r\\n}\\r\\nsvg.escher-svg .node-circle {\\r\\n  stroke-width: 2px;\\r\\n}\\r\\nsvg.escher-svg .midmarker-circle, svg.escher-svg .multimarker-circle {\\r\\n  fill: white;\\r\\n  fill-opacity: 0.2;\\r\\n  stroke: rgb(50, 50, 50);\\r\\n}\\r\\nsvg.escher-svg g.selected .node-circle{\\r\\n  stroke-width: 6px;\\r\\n  stroke: rgb(20, 113, 199);\\r\\n}\\r\\nsvg.escher-svg g.selected .label {\\r\\n  fill: rgb(20, 113, 199);\\r\\n}\\r\\nsvg.escher-svg .metabolite-circle {\\r\\n  stroke: rgb(162, 69, 16);\\r\\n  fill: rgb(255,116,0);\\r\\n}\\r\\nsvg.escher-svg g.selected .metabolite-circle {\\r\\n  stroke: rgb(0, 0, 0);\\r\\n  stroke-width: 12px;\\r\\n}\\r\\nsvg.escher-svg .segment {\\r\\n  stroke: #ab0c13;\\r\\n  stroke-width: 10px;\\r\\n  fill: none;\\r\\n}\\r\\nsvg.escher-svg .arrowhead {\\r\\n  fill: #ab0c13;\\r\\n}\\r\\nsvg.escher-svg .stoichiometry-label-rect {\\r\\n  fill: white;\\r\\n  opacity: 0.5;\\r\\n}\\r\\nsvg.escher-svg .stoichiometry-label {\\r\\n  fill: #ab0c13;\\r\\n  font-size: 17px;\\r\\n}\\r\\nsvg.escher-svg .membrane {\\r\\n  fill: none;\\r\\n  stroke: rgb(255, 187, 0);\\r\\n}\\r\\nsvg.escher-svg .brush .extent {\\r\\n  fill-opacity: 0.1;\\r\\n  fill: black;\\r\\n  stroke: #fff;\\r\\n  shape-rendering: crispEdges;\\r\\n}\\r\\nsvg.escher-svg #brush-container .background {\\r\\n  fill: none;\\r\\n}\\r\\nsvg.escher-svg .bezier-circle {\\r\\n  fill: rgb(255,255,255);\\r\\n}\\r\\nsvg.escher-svg .bezier-circle.b1 {\\r\\n  stroke: red;\\r\\n}\\r\\nsvg.escher-svg .bezier-circle.b2 {\\r\\n  stroke: blue;\\r\\n}\\r\\nsvg.escher-svg .connect-line{\\r\\n  stroke: rgb(200,200,200);\\r\\n}\\r\\nsvg.escher-svg .direction-arrow {\\r\\n  cursor: default;\\r\\n  stroke: black;\\r\\n  stroke-width: 1px;\\r\\n  fill: white;\\r\\n  opacity: 0.3;\\r\\n}\\r\\nsvg.escher-svg .start-reaction-target {\\r\\n  stroke: rgb(100,100,100);\\r\\n  fill: none;\\r\\n  opacity: 0.5;\\r\\n}\\r\\nsvg.escher-svg .rotation-center-line {\\r\\n  stroke: red;\\r\\n  stroke-width: 5px;\\r\\n}\\r\\nsvg.escher-svg .highlight {\\r\\n  fill: #D97000;\\r\\n  text-decoration: underline;\\r\\n}\\r\\nsvg.escher-svg .node-to-combine {\\r\\n  stroke-width: 12px !important;\\r\\n}\\r\\n\";","/* eslint-disable camelcase */\r\n/** DataMenu */\r\nimport * as utils from './utils';\r\nimport {json as d3_json} from 'd3-request';\r\nimport {D3Selection, SettingsType} from './types';\r\n\r\nexport default function DataMenu(options: {selection: D3Selection, data: any, datafiles: any, getdatafiles: any, update_callback: any, target: any}) {\r\n  const o: {selection: D3Selection, data: any, datafiles: any, getdatafiles: any, update_callback: any, target: any} = utils.set_options(options, {\r\n    selection: null,\r\n    getdatafiles: null,\r\n    datafiles: null,\r\n    update_callback: null,\r\n    target: null,\r\n    data: null});\r\n\r\n  if (o.selection == null)\r\n    throw new Error('No selection provided for DataMenu');\r\n\r\n  // setup dropdown menu\r\n  // Append menu if it doesn't exist\r\n  let menu = o.selection.select('.data-menu');\r\n  if (menu.empty()) {\r\n    menu = o.selection.append('div')\r\n      .attr('class', 'data-menu');\r\n  }\r\n  const select_sel = menu.append('form')\r\n    .append('select').attr('class', 'dropdown-menu');\r\n\r\n  if (o.getdatafiles) {\r\n    if (o.datafiles)\r\n      console.warn('DataMenu: getdatafiles option overrides datafiles');\r\n\r\n    d3_json(o.getdatafiles, function(error, d) {\r\n      // returns json object:  { data: [file0, file1, ...] }\r\n      if (error)\r\n        return console.warn(error);\r\n      else\r\n        load_with_files(o.target, d.data, select_sel, o.update_callback, o.selection);\r\n\r\n      return null;\r\n    });\r\n  } else if (o.datafiles)\r\n    load_with_files(o.target, o.datafiles, select_sel, o.update_callback, o.selection);\r\n  else\r\n    console.warn('DataMenu: No datafiles given');\r\n\r\n\r\n  return {update: update};\r\n\r\n  // definitions\r\n  function load_with_files(t: any, files: any, select_sel: any, update_callback: any, selection: any) {\r\n    //when it changes\r\n    select_sel.node().addEventListener('change', function() {\r\n      // @ts-ignore\r\n      // eslint-disable-next-line no-invalid-this\r\n      load_datafile(t, this.value, selection, update_callback);\r\n    }, false);\r\n\r\n    const file = files[0];\r\n\r\n    update(files, select_sel);\r\n    load_datafile(t, file, selection, update_callback);\r\n  };\r\n  function load_datafile(t: any, this_file: any, selection: any, callback: any) {\r\n    utils.load_the_file(t, this_file, function(error: any, data: any) {\r\n      if (error) {\r\n        selection.append('error loading');\r\n        o.data = null;\r\n        return console.warn(error);\r\n      } else {\r\n        o.data = data;\r\n        if (callback)\r\n          callback(data);\r\n      }\r\n    });\r\n  };\r\n\r\n  function update(list: any, select_sel: any) {\r\n    // update select element with d3 selection /select_sel/ to have options\r\n    // given by /list/\r\n    // TODO remove paths from file list\r\n    select_sel.selectAll('.menu-option')\r\n      .data(list)\r\n      .enter()\r\n      .append('option')\r\n      .attr('value', function(d: any) { return d; } )\r\n      .text(function(d: any) { return d; } );\r\n    // TODO set value to default_filename_index\r\n    select_sel.node().focus();\r\n  };\r\n\r\n  function get_data() {\r\n    return o.data;\r\n  };\r\n};\r\n","/* eslint-disable camelcase */\r\n/**\r\n* @license\r\n*\r\n* Escher\r\n* Author: Zachary King\r\n*\r\n* The MIT License (MIT)\r\n*\r\n* This software is Copyright © 2015 The Regents of the University of\r\n* California. All Rights Reserved.\r\n*\r\n* Permission is hereby granted, free of charge, to any person obtaining a copy\r\n* of this software and associated documentation files (the \"Software\"), to deal\r\n* in the Software without restriction, including without limitation the rights\r\n* to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n* copies of the Software, and to permit persons to whom the Software is\r\n* furnished to do so, subject to the following conditions:\r\n*\r\n* The above copyright notice and this permission notice shall be included in\r\n* all copies or substantial portions of the Software.\r\n*\r\n* THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n* OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n* THE SOFTWARE.\r\n*/\r\n\r\n// ESCHER_VERSION provided by webpack plugin or main-node\r\n/* global ESCHER_VERSION */\r\n\r\n// --JSX\r\n\r\nimport underscore from 'underscore';\r\nimport preact from 'preact';\r\nimport * as baconjs from 'baconjs';\r\nimport mousetrap from 'mousetrap';\r\nimport vkbeautify from 'vkbeautify';\r\nimport {select as d3_select, selection as d3_selection} from 'd3-selection';\r\nimport {json as d3_json} from 'd3-request';\r\n\r\nexport const version = '1.0.0';\r\n\r\n// @ts-ignore\r\nexport {default as Builder} from '../Builder';\r\nexport {EscherMap} from './escherMap';\r\nexport {default as Behavior} from './Behavior';\r\nexport {default as KeyManager} from './KeyManager';\r\nexport {default as DataMenu} from './DataMenu';\r\nexport {default as UndoStack} from './UndoStack';\r\nexport {default as CobraModel} from './CobraModel';\r\nexport * as utils from './utils';\r\nexport {default as SearchIndex} from './SearchIndex';\r\nexport {default as Settings} from './Settings';\r\nexport * as dataStyles from './dataStyles';\r\nexport {default as ZoomContainer} from './ZoomContainer';\r\n\r\n\r\nexport const libs = {\r\n  _: underscore,\r\n  underscore,\r\n  preact,\r\n  baconjs,\r\n  mousetrap,\r\n  vkbeautify,\r\n  d3_selection,\r\n  d3_select,\r\n  d3_json\r\n};\r\n"],"names":["root","factory","exports","module","define","amd","self","___CSS_LOADER_EXPORT___","push","id","__esModule","isEventFromHandle","e","handles","Object","keys","some","key","target","base","isValueOutOfRange","value","_ref","min","max","isNotTouchEvent","touches","length","type","toLowerCase","getClosestPoint","getPrecision","getMousePosition","vertical","clientY","pageX","getTouchPosition","getHandleCenterPosition","handle","coords","getBoundingClientRect","top","height","left","width","ensureValueInRange","val","_ref3","ensureValuePrecision","props","step","closestPoint","parseFloat","toFixed","pauseEvent","stopPropagation","preventDefault","getKeyboardValueMutator","keyCode","_KeyCode2","default","UP","RIGHT","DOWN","LEFT","END","HOME","PAGE_UP","PAGE_DOWN","obj","_ref2","marks","points","map","closestStep","Math","round","diffs","point","abs","indexOf","apply","stepString","toString","precision","_extends","assign","i","arguments","source","prototype","hasOwnProperty","call","_preact","className","included","offset","style","elStyle","visibility","bottom","h","styleElement","nonce","setAttribute","_Track2","_interopRequireDefault","_createSlider2","util","newObj","_interopRequireWildcard","Slider","_Component","instance","Constructor","TypeError","_classCallCheck","this","_this","ReferenceError","_possibleConstructorReturn","onEnd","setState","dragging","removeDocumentEvents","onAfterChange","getValue","defaultValue","undefined","state","trimAlignValue","subClass","superClass","create","constructor","enumerable","writable","configurable","setPrototypeOf","__proto__","_inherits","componentWillReceiveProps","nextProps","prevValue","nextValue","onChange","changedValue","onStart","position","onBeforeChange","calcValueByPos","startValue","startPosition","onMove","oldValue","onKeyboard","valueMutator","mutatedValue","getLowerBound","getUpperBound","v","mergedProps","render","_this2","_props","prefixCls","disabled","minimumTrackStyle","trackStyle","handleStyle","handleGenerator","_state","calcOffset","ref","saveHandle","_trackStyle","tracks","Component","stylesInDOM","getIndexByIdentifier","identifier","result","modulesToDom","list","options","idCountMap","identifiers","item","count","concat","indexByIdentifier","css","media","sourceMap","supports","layer","references","updater","addElementStyle","byIndex","splice","api","domAPI","update","remove","lastIdentifiers","newList","index","newLastIdentifiers","_i","_index","defineProperty","_EventBaseObject2","_objectAssign2","TRUE","FALSE","commonProps","isNullOrUndefined","w","eventNormalizers","reg","fix","event","nativeEvent","which","charCode","metaKey","ctrlKey","deltaX","deltaY","delta","wheelDelta","axis","wheelDeltaY","wheelDeltaX","detail","HORIZONTAL_AXIS","VERTICAL_AXIS","eventDoc","doc","body","button","clientX","ownerDocument","document","documentElement","scrollLeft","clientLeft","pageY","scrollTop","clientTop","relatedTarget","fromElement","toElement","retTrue","retFalse","DomEventObject","isNative","cancelBubble","isDefaultPrevented","defaultPrevented","getPreventDefault","returnValue","fixFns","l","prop","forEach","normalizer","match","srcElement","nodeType","parentNode","fixFn","timeStamp","Date","now","EventBaseObjectProto","styleSheet","cssText","firstChild","removeChild","appendChild","createTextNode","VNode","stack","EMPTY_CHILDREN","nodeName","attributes","lastSimple","child","simple","children","pop","String","p","vnode","extend","applyRef","current","defer","Promise","resolve","then","bind","setTimeout","cloneElement","slice","IS_NON_DIMENSIONAL","items","enqueueRender","component","_dirty","debounceRendering","rerender","renderComponent","isSameNodeType","node","hydrating","splitText","_componentConstructor","isNamedNode","normalizedNodeName","getNodeProps","defaultProps","removeNode","setAccessor","name","old","isSvg","test","innerHTML","__html","useCapture","replace","substring","addEventListener","eventProxy","removeEventListener","_listeners","removeAttribute","ns","removeAttributeNS","setAttributeNS","mounts","diffLevel","isSvgMode","flushMounts","c","shift","afterMount","componentDidMount","diff","dom","context","mountAll","parent","componentRoot","ownerSVGElement","ret","idiff","out","prevSvgMode","_component","nodeValue","replaceChild","recollectNodeTree","vnodeName","originalComponent","oldDom","isDirectOwner","isOwner","_parentComponent","setComponentProps","unmountComponent","createComponent","nextBase","buildComponentFromVNode","createElementNS","createElement","fc","vchildren","a","nextSibling","isHydrating","j","f","vchild","originalChildren","childNodes","keyed","keyedLen","len","childrenLen","vlen","_child","__key","trim","insertBefore","innerDiffNode","dangerouslySetInnerHTML","attrs","diffAttributes","unmountOnly","removeChildren","lastChild","next","previousSibling","recyclerComponents","Ctor","inst","doRender","renderMode","_disable","__ref","getDerivedStateFromProps","componentWillMount","prevContext","prevProps","syncComponentUpdates","isChild","rendered","cbase","previousProps","previousState","prevState","previousContext","isUpdate","initialBase","initialChildComponent","skip","snapshot","shouldComponentUpdate","componentWillUpdate","getChildContext","getSnapshotBeforeUpdate","toUnmount","childComponent","childProps","baseParent","componentRef","t","componentDidUpdate","afterUpdate","_renderCallbacks","beforeUnmount","componentWillUnmount","inner","merge","createRef","callback","forceUpdate","_typeof","Symbol","iterator","_classnames2","upperBound","lowerBound","marksKeys","marksCount","markWidth","range","elements","sort","b","_classNames","isActive","markClassName","marginBottom","marginLeft","markPoint","markPointIsObject","markLabel","label","markStyle","_Range","get","eventType","option","wrapCallback","ne","_EventObject2","_ret","capture","attachEvent","detachEvent","getOwnPropertySymbols","propIsEnumerable","propertyIsEnumerable","test1","getOwnPropertyNames","test2","fromCharCode","n","join","test3","split","letter","err","shouldUseNative","from","symbols","to","toObject","s","condition","format","d","error","Error","args","argIndex","framesToPop","cssWithMappingToString","content","needLayer","modules","dedupe","alreadyImportedModules","k","_k","cssMapping","btoa","base64","unescape","encodeURIComponent","JSON","stringify","data","sourceMapping","___CSS_LOADER_URL_IMPORT_0___","URL","___CSS_LOADER_URL_IMPORT_1___","___CSS_LOADER_URL_IMPORT_2___","___CSS_LOADER_URL_IMPORT_3___","___CSS_LOADER_URL_IMPORT_4___","___CSS_LOADER_URL_REPLACEMENT_0___","___CSS_LOADER_URL_REPLACEMENT_1___","hash","___CSS_LOADER_URL_REPLACEMENT_2___","___CSS_LOADER_URL_REPLACEMENT_3___","___CSS_LOADER_URL_REPLACEMENT_4___","___CSS_LOADER_URL_REPLACEMENT_5___","window","_REVERSE_MAP","_MAP","_KEYCODE_MAP","_SHIFT_MAP","_SPECIAL_ALIASES","navigator","platform","Mousetrap","action","Array","_bindMultiple","unbind","trigger","_directMap","reset","_callbacks","stopCallback","element","_belongsTo","composedPath","initialEventTarget","tagName","isContentEditable","handleKey","_handleKey","addKeycodes","object","init","documentMousetrap","method","charAt","_addEvent","_characterFromEvent","character","shiftKey","_isModifier","_pickBestAction","modifiers","_getReverseMap","_getKeyInfo","combination","_keysFromString","ancestor","targetElement","_resetTimer","_sequenceLevels","_ignoreNextKeyup","_ignoreNextKeypress","_nextExpectedAction","_resetSequences","doNotReset","activeSequences","_getMatches","sequenceName","level","modifiers1","modifiers2","matches","seq","deleteCombo","combo","deleteSequence","_fireCallback","sequence","_preventDefault","_stopPropagation","_handleKeyEvent","altKey","_eventModifiers","_bindSingle","info","_increaseSequence","nextAction","clearTimeout","_callbackAndReset","wrappedCallback","_bindSequence","callbacks","maxLevel","processedSequenceCallback","ignoreThisKeypress","combinations","url","needQuotes","setAttributes","insert","createShiftArr","space","isNaN","parseInt","ix","vkbeautify","isSubquery","str","parenthesisLevel","split_sql","tab","xml","text","ar","inComment","deep","search","exec","json","parse","sql","ar_by_quote","xmlmin","preserveComments","jsonmin","cssmin","sqlmin","_shallowequal2","Range","initialValue","bounds","recent","nextBounds","every","closestBound","getClosestBound","boundNeedMoving","getBoundNeedMoving","nextHandle","pushable","originalValue","pushSurroundingHandles","allowCross","_this3","handlesRefs","reduce","curr","activeElement","console","log","isAtTheSamePoint","getPoints","cache","_getPointsCache","pointsObject","threshold","direction","diffToNext","pushHandle","amount","currentValue","pushHandleOnePoint","nextPointIndex","valInRange","valNotConflict","ensureValueNotConflict","_this4","_state2","_props2","offsets","handleClassName","_","_classNames2","trackClassName","memo","styleTarget","querySelector","HTMLIFrameElement","contentDocument","head","getTarget","_class","_temp","ComponentEnhancer","onMouseDown","isVertical","handlePosition","dragOffset","addDocumentMouseEvents","onTouchStart","addDocumentTouchEvents","onFocus","onBlur","onMouseMove","sliderRef","onTouchMove","onKeyDown","saveSlider","slider","onTouchMoveListener","_addDomEventListener2","onTouchUpListener","onMouseMoveListener","onMouseUpListener","getSliderStart","rect","getSliderLength","calcValue","ratio","pixelOffset","_props3","dots","maximumTrackStyle","railStyle","dotStyle","activeDotStyle","_Component$prototype$","sliderClassName","noop","_Steps2","_Marks2","displayName","restProps","_objectWithoutProperties","_Handle2","returnFalse","returnTrue","EventBaseObject","currentTarget","isEventObject","isPropagationStopped","isImmediatePropagationStopped","stopImmediatePropagation","halt","immediate","insertStyleElement","styleTagTransform","removeStyleElement","Handle","ariaProps","role","tabIndex","objA","objB","compare","compareContext","keysA","keysB","bHasOwnProperty","idx","valueA","valueB","calcPoints","isActived","pointClassName","invariant","getAllKeys","copy","isArray","Map","Set","getPrototypeOf","newContext","commands","defaultCommands","directive","fn","isEquals","spec","$apply","nextObject","objectWasNextObject","nextValueForKey","nextObjectValue","set","$push","invariantPushAndUnshift","$unshift","$splice","originalObject","invariantSplice","invariantSplices","$set","invariantSet","$toggle","targets","invariantSpecArray","nextObjectCopy","$unset","$add","invariantMapOrSet","pair","has","add","$remove","delete","$merge","specValue","original","contextForExport","command","typeOfTarget","KeyCode","MAC_ENTER","BACKSPACE","TAB","NUM_CENTER","ENTER","SHIFT","CTRL","ALT","PAUSE","CAPS_LOCK","ESC","SPACE","PRINT_SCREEN","INSERT","DELETE","ZERO","ONE","TWO","THREE","FOUR","FIVE","SIX","SEVEN","EIGHT","NINE","QUESTION_MARK","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","META","WIN_KEY_RIGHT","CONTEXT_MENU","NUM_ZERO","NUM_ONE","NUM_TWO","NUM_THREE","NUM_FOUR","NUM_FIVE","NUM_SIX","NUM_SEVEN","NUM_EIGHT","NUM_NINE","NUM_MULTIPLY","NUM_PLUS","NUM_MINUS","NUM_PERIOD","NUM_DIVISION","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","NUMLOCK","SEMICOLON","DASH","EQUALS","COMMA","PERIOD","SLASH","APOSTROPHE","SINGLE_QUOTE","OPEN_SQUARE_BRACKET","BACKSLASH","CLOSE_SQUARE_BRACKET","WIN_KEY","MAC_FF_META","WIN_IME","F13","navigation","userAgent","saveAs","view","get_URL","webkitURL","save_link","can_use_save_link","is_safari","HTMLElement","safari","is_chrome_ios","throw_outside","ex","setImmediate","revoke","file","revokeObjectURL","auto_bom","blob","Blob","FileSaver","no_auto_bom","object_url","filesaver","force","dispatch_all","event_types","listener","dispatch","readyState","INIT","createObjectURL","href","download","MouseEvent","dispatchEvent","DONE","FileReader","reader","onloadend","open","location","readAsDataURL","fs_error","FS_proto","msSaveOrOpenBlob","abort","WRITING","onwritestart","onprogress","onwrite","onabort","onerror","onwriteend","hasOwn","classNames","classes","arg","appendClass","parseValue","includes","newClass","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","m","amdD","amdO","getter","definition","o","g","globalThis","Function","r","toStringTag","scriptUrl","importScripts","currentScript","toUpperCase","src","scripts","getElementsByTagName","baseURI","nc","VERSION","global","ArrayProto","ObjProto","SymbolProto","supportsArrayBuffer","ArrayBuffer","supportsDataView","DataView","nativeIsArray","nativeKeys","nativeCreate","nativeIsView","isView","_isNaN","_isFinite","isFinite","hasEnumBug","nonEnumerableProps","MAX_ARRAY_INDEX","pow","restArguments","func","startIndex","rest","isObject","isNull","isUndefined","isBoolean","isElement","tagTester","tag","isFunction","nodelist","Int8Array","hasDataViewBug","isIE11","isDataView","getInt8","isArrayBuffer","buffer","isArguments","isSymbol","isNumber","createSizePropertyCheck","getSizeProperty","collection","sizeProperty","shallowProperty","typedArrayPattern","collectNonEnumProps","contains","emulatedSet","nonEnumIdx","proto","isEmpty","isString","isMatch","_keys","_wrapped","toBufferView","bufferSource","Uint8Array","byteOffset","valueOf","toJSON","tagDataView","eq","aStack","bStack","deepEq","areArrays","aCtor","bCtor","isEqual","allKeys","ie11fingerprint","methods","weakMapMethods","forEachName","commonInit","mapTail","mapMethods","setMethods","values","pairs","invert","functions","names","createAssigner","keysFunc","defaults","baseCreate","extendOwn","clone","tap","interceptor","toPath","path","deepGet","matcher","property","optimizeCb","argCount","accumulator","baseIteratee","iteratee","Infinity","cb","mapObject","results","currentKey","propertyOf","times","accum","random","floor","getTime","createEscaper","escaper","testRegexp","RegExp","replaceRegexp","string","templateSettings","evaluate","interpolate","escape","noMatch","escapes","escapeRegExp","escapeChar","bareIdentifier","template","settings","oldSettings","argument","variable","fallback","idCounter","uniqueId","prefix","chain","_chain","executeBound","sourceFunc","boundFunc","callingContext","partial","boundArgs","placeholder","bound","callArgs","flatten","input","depth","strict","output","memoize","hasher","address","wait","delay","throttle","timeout","previous","later","leading","throttled","_now","remaining","trailing","cancel","debounce","passed","debounced","_args","wrap","wrapper","negate","predicate","compose","start","after","before","findKey","createPredicateIndexFinder","dir","array","sortedIndex","low","high","mid","createIndexFinder","predicateFind","findIndex","findLastIndex","find","findWhere","each","createReduce","initial","reducer","filter","reject","fromIndex","guard","contextPath","pluck","where","computed","lastComputed","reStrSymbol","toArray","sample","last","rand","temp","shuffle","sortBy","criteria","right","group","behavior","partition","pass","size","keyInObj","pick","first","compact","Boolean","otherArrays","difference","uniq","isSorted","seen","arrays","intersection","argsLength","unzip","stop","ceil","chunk","chainResult","mixin","nop","xs","isObservable","x","_isObservable","any","filtered","flip","fold","seed","tail","toFunction","indexWhere","always","empty","all","without","y","flatMap","ys","me","hasProp","recursionDepth","more","noMore","assert","message","assertFunction","defaultScheduler","setInterval","clearInterval","GlobalScheduler","scheduler","getScheduler","setScheduler","newScheduler","rootEvent","waiterObs","waiters","aftersStack","aftersStackHeight","flushed","processingAfters","ensureStackHeight","afterTransaction","obs","stackIndexForThisObs","containsObs","processAfters","aftersList","stackSizeAtStart","isRoot","topOfStack","topAfters","callSuccess","whenDoneWith","obsWaiters","flushWaiters","deps","obsId","flushDepsOf","dep","internalDeps","UpdateBarrier","hasWaiters","inTransaction","flush","currentEventId","wrappedSubscribe","subscribe","sink","unsubd","shouldUnsub","doUnsub","unsub","soonButNotYet","isInTransaction","Desc","_isDesc","cachedDeps","findDeps","describe","_isSource","nullSink","nullVoidSink","withStateMachine","initState","transform","fromF","newState","outputs","reply","withStateMachineT","Some","_isSome","isDefined","getOrElse","None","inspect","_isNone","none","eventIdCounter","Event","isEvent","_isEvent","isEnd","isInitial","isNext","isError","hasValue","toNext","Value","super","Error$1","fmap","Next","_isNext","Initial","_isInitial","NoValue","End","initialEvent","nextEvent","endEvent","toEvent","equals","take","desc","takeT","scan","resultProperty","acc","initHandled","Property","initSent","sendInit","subscribeInternal","CompositeUnsubscribe","ss","unsubscribed","unsubscribe","subscriptions","starting","subscription","ended","iterable","streamSubscribeToPropertySubscribe","initValue","streamSubscribe","subbed","propertyFromStreamSubscribe","EventStream","flatMap_","spawner","params","rootDep","childDeps","isProperty","_isProperty","initialSpawned","newEventStreamAllowSync","composite","queue","spawn","makeObservable","unsubAll","unsubMe","checkQueue","checkEnd","__","unsubRoot","mapError","firstOnly","limit","handleEventValueWith","flatMapEvent","Source","sync","markEnded","mayHave","DefaultSource","consume","hasAtLeast","ConsumingSource","BufferingSource","isTrigger","_isEventStream","fromObservable","never","when","patterns","when_","newEventStream","whenP","ctor","sources","ixPats","rawPatterns","pats","patSources","pat","ixs","triggerFound","processRawPatterns","extractRawPatterns","needsBarrier","observables","checkObservable","containsDuplicateDeps","resultStream","triggers","ends","cannotMatch","nonFlattened","flushLater","flushWhileTriggers","applied","cannotSync","valueEvent","extractLegacyPatterns","sourceArgs","isTypedOrRawPattern","pattern","isRawPattern","withLatestFromE","sampler","samplee","toProperty","withDesc","withLatestFromP","withLatestFrom","map$1","mapT","theF","argumentsToObservables","singleToObservables","argumentsToObservablesAndFunction","groupSimultaneous","streams","groupSimultaneous_","stream","combineAsArray","combineWith","combine","combineTwo","flatMapConcat","fromBinder","binder","eventTransformer","unbound","shouldUnbind","unbinder","value_","valueArray","fromPoll","poll","handler","interval","sampledByP","combinator","sampleP","samplingInterval","transformP","transformer","composeT","t1","t2","finalSink","sink2","withPredicate","predicateTransformer","tuple","toPredicate","filterT","not","flatMapFirst","concatAll","streams_","toEventStream","fold$1","endMarker","flatMap$1","flatMapError","spies","running","registerObs","spy","flatMapLatest","f_","allowSync","flatMapped","takeUntil","Dispatcher","observable","_subscribe","_handleEvent","pushing","prevError","unsubSrc","handleEvent","hasSubscribers","removeSub","pushIt","pushToSubscriptions","tmp","sub","unsubscribeFromSource","PropertyDispatcher","propertyEnded","currentValueRootId","maybeSubSource","dispatchingId","valId","flatMapWithConcurrencyLimit","bufferWithTimeOrCount","delayFunc","delayMs","toDelayFunction","flushOrSchedule","schedule","onInput","onFlush","Buffer","end","scheduled","valuesToPush","mergeAll","flattenedStreams","sinks","unsubBoth","takeWhileT","skipWhileT","started","keyF","limitF","firstValue","similarValues","changes","limited","nullMarker","zipAsArray","zipWith","combineTemplate","setValue","ctxStack","mkContext","containsObservables","compile","funcs","applyStreamValue","popContext","pushContext","compileTemplate","constantValue","rootContext","Observable","initialDesc","awaiting","other","skipDuplicates","bufferingThrottle","minimumInterval","transformChanges","errors","debounceImmediate","decode","cases","prevTuple","doAction","doActionT","doEnd","doEndT","doError","doErrorT","doLog","doLogT","endAsValue","endOnError","filter$1","firstToPromise","PromiseCtr","generator","onValue","holdWhen","valve","onHold","bufferedValues","srcIsEnded","subscribed","endIfBothEnded","toSend","lastEvent","mapEnd","mapEndT","mapErrorT","_name","onError","onValues","sampledBy","sampledByE","prev","isNone","skipErrors","skipUntil","starter","startWith","skipWhile","slidingWindow","maxValues","minValues","stopper","withEndMarker","takeWhile","bufferWithTime","toPromise","withDescription","zip","dispatcher","and","comboSink","transformedChanges","transformPropertyChanges","groupBy","or","startWithP","forceAsync","subscribing","asyncDeliveries","deliverAsync","toDeliverNow","asyncWrapSubscribe","Number","MAX_VALUE","bufferWithCount","unsubRight","unsubLeft","concatE","flatScan","updated","assertEventStream","startWithE","usedInitValue","disp","transformE","description","symbol","for","ESObservable","observerOrOnNext","onComplete","observer","complete","closed","lateBindFirst","fromArray","assertArray","pushNeeded","toESObservable","eventMethods","findHandlerMethods","methodPair","addListener","fromEvent","eventSource","repeat","flag","subscribeNext","repeatedly","silence","duration","retry","retries","retriesDone","isRetryable","finished","errorEvent","valueStream","pause","sequentially","valueAndEnd","fromPromise","promise","done","makeFunction_","wrapped","partiallyApplied","methodName","makeFunction","fromCallback","fromNodeCallback","fromESObservable","_observable","Bus","subscribeAll","pushQueue","plug","assertObservable","subscribeInput","unsubscribeInput","rootPush","newSink","guardedSink","tryF","$","asEventStream","eventName","selector","on","off","jQuery","version","querySelectorAll","EnterNode","datum","namespaceURI","_next","_parent","__data__","bindIndex","enter","exit","groupLength","dataLength","bindKey","keyValue","nodeByKeyValue","keyValues","NaN","xhtml","svg","xlink","xmlns","namespaces","local","attrRemove","attrRemoveNS","fullname","attrConstant","attrConstantNS","attrFunction","attrFunctionNS","defaultView","styleRemove","removeProperty","styleConstant","priority","setProperty","styleFunction","styleValue","getPropertyValue","getComputedStyle","propertyRemove","propertyConstant","propertyFunction","classArray","classList","ClassList","_node","_names","getAttribute","classedAdd","classedRemove","classedTrue","classedFalse","classedFunction","textRemove","textContent","textConstant","textFunction","htmlRemove","htmlConstant","htmlFunction","raise","lower","creatorInherit","uri","creatorFixed","namespace","constantNull","selection_cloneShallow","cloneNode","selection_cloneDeep","filterEvents","filterContextListener","contextListener","related","compareDocumentPosition","event1","event0","onRemove","typename","__on","onAdd","customEvent","that","sourceEvent","CustomEvent","createEvent","initEvent","bubbles","cancelable","dispatchConstant","dispatchFunction","mouseenter","mouseleave","Selection","groups","parents","_groups","_parents","selection","select","subgroups","subnode","subgroup","selectAll","selectorAll","enterGroup","updateGroup","i0","i1","_enter","_exit","sparse","onenter","onupdate","onexit","append","order","groups0","groups1","m0","m1","merges","group0","group1","compareNode","sortgroups","sortgroup","nodes","attr","getAttributeNS","classed","html","creator","typenames","parseTypenames","clear","entries","Dispatch","types","request","mimeType","response","responseType","headers","xhr","XMLHttpRequest","user","password","respond","status","responseText","hasResponse","XDomainRequest","onload","ontimeout","onreadystatechange","header","send","post","setRequestHeader","overrideMimeType","fixCallback","defaultMimeType","createRange","createContextualFragment","responseXML","EOL","EOF","objectConverter","columns","inferColumns","rows","columnSet","row","column","pad","delimiter","reFormat","DELIMITER","charCodeAt","parseRows","eof","eol","token","preformatBody","formatValue","formatRow","date","year","hours","getUTCHours","minutes","getUTCMinutes","seconds","getUTCSeconds","milliseconds","getUTCMilliseconds","getUTCFullYear","getUTCMonth","getUTCDate","formatDate","convert","customConverter","formatBody","formatRows","csv","dsv","csvParse","csvParseRows","responseOf","tsv","tsvParse","warn","_check_filesaver","alert","set_options","must_be_float","has_key","remove_child_nodes","hasChildNodes","load_css","css_path","_ends_with","suffix","load_the_file","load_files","files_to_load","final_callback","make_class","is_internal","class_with_optional_new","AClass","Proxy","Target","thisArg","setup_defs","defs","draw_an_object","container_sel","parent_node_selector","children_selector","id_key","create_function","update_function","exit_function","draw_object","sel","make_array_ref","update_sel","draw_a_nested_object","object_data_key","make_array","it","compare_arrays","a1","a2","arrayToObject","arr","nk","obj1","obj2","overwrite","attrname","uniqueConcat","newArray","unique_strings_array","callNow","object_slice_for_ids","ids","subset","object_slice_for_ids_ref","c_plus_c","coords1","coords2","c_minus_c","c_times_scalar","scalar","download_json","load_json","pre_fn","failure_fn","File","FileList","readAsText","load_json_or_csv","csv_converter","debug_event","onload_function","downloadSvg","svg_sel","do_beautify","XMLSerializer","serializeToString","downloadPng","canvas","getContext","svg_size","getBBox","svg_width","svg_height","base_image","Image","fillStyle","fillRect","drawImage","toBlob","rotate_coords_recursive","coords_array","angle","center","rotate_coords","cos","sin","get_angle","denominator","numerator","PI","atan","to_degrees","radians","angleNorm","to_radians","degrees","to_radians_norm","angle_for_event","displacement","gamma","atan2","distance","sqrt","check_undefined","compartmentalize","bigg_id","compartment_id","decompartmentalize","mean","median","half","random_characters","num","possible","generate_map_id","check_for_parent_tag","el","Element","name_to_url","download_url","get_document","get_window","d3_transform_catch","transform_attr","translate_res","tn","tx","ty","rotate_res","scale_res","translate","rotate","scale","PlacedDiv","div","shouldReposition","visible","hide","is_visible","place","window_translate","zoomContainer","windowTranslate","window_scale","windowScale","map_size","get_size","completely","container","config","thisDocument","thisWindow","fontSize","fontFamily","promptInnerHTML","color","hintColor","backgroundColor","dropDownBorderColor","dropDownZIndex","dropDownOnHoverBackgroundColor","txtInput","spellcheck","outline","border","margin","padding","txtHint","borderColor","boxShadow","verticalAlign","prompt","overflow","background","dropDown","textAlign","zIndex","cursor","borderStyle","borderWidth","overflowX","whiteSpace","overflowY","dropDownController","elem","oldIndex","current_row","onMouseOver","onMouseOut","onDblClick","onmouseselection","refresh","vph","innerHeight","clientHeight","distanceToTop","distanceToBottom","found","divRow","onmouseover","onmouseout","onmousedown","ondblclick","__hint","rs","display_limit","divRow2","highlight","maxHeight","move","get_current_row","createDropDownController","spacer","leftSide","onEnter","focus","get_hint","onArrowDown","onArrowUp","onTab","txt","repaint","startFrom","hint","setText","getText","hideDropDown","optionsLength","fontWeight","calculateWidthForText","registerOnTextChangeOldValue","registerOnTextChange","hasTextChanged","createSVGPoint","matrixTransform","getScreenCTM","inverse","changedTouches","touch","nopropagation","noevent","__noselect","MozUserSelect","yesdrag","noclick","DragEvent","subject","active","dx","dy","defaultFilter","defaultContainer","defaultSubject","defaultTouchable","maxTouchPoints","mousedownx","mousedowny","mousemoving","touchending","touchable","gestures","listeners","clickDistance2","drag","mousedowned","touchstarted","touchmoved","touchended","gesture","beforestart","mouse","mousemoved","mouseupped","nodrag","sublisteners","p0","clickDistance","DirectionArrow","arrowContainer","arrow","_setupDrag","isVisible","show","setLocation","setRotation","rotation","displaceRotation","dRotation","getRotation","toggle","onOff","down","up","dAngle","formatDecimalParts","toExponential","coefficient","prefixExponent","re","formatSpecifier","specifier","FormatSpecifier","fill","align","sign","zero","comma","exponent","toLocaleString","toPrecision","formatRounded","formatPrefix","prefixes","locale","grouping","thousands","reverse","currencyPrefix","currency","currencySuffix","decimal","numerals","formatNumerals","percent","minus","nan","newFormat","formatTypes","formatType","maybeSuffix","valuePrefix","valueSuffix","valueNegative","formatTrim","RETURN_ARG","ESCAPE_REG","EMPTY_LINES","TRAILING_NEWLINE","AND_OR","ALL_PARENS","EXCESS_PARENS","OR","AND","OR_EXPRESSION","AND_EXPRESSION","parseFloatOrNull","checkFinite","importAndCheck","allReactions","reactions","aligned","nullVal","firstGeneId","reactionId","reaction","biggId","thisGeneData","genes","gene","kind","existingD","pnt","alignGeneDataToReactions","floatForData","styles","compareStyle","takeAbs","fs","log2Fold","reverse_flux_for_data","gene_string_for_data","rule","gene_values","identifiers_on_map","compare_style","out_text","no_data","genes_found","g_obj","replace_gene_in_rule","null_or_d","new_str","text_for_data","csv_rows","converted","genes_for_gene_reaction_rule","evaluate_gene_reaction_rule","and_method_in_gene_reaction_rule","null_val","gene_id","curr_val","all_null","new_curr_val","p1","p2","p3","nums","escaped","escape_reg_exp","apply_reaction_data_to_reactions","segment_id","segment","reaction_id","data_string","segments","gene_string","reverse_flux","apply_metabolite_data_to_nodes","nodeId","apply_gene_data_to_reactions","gene_data_obj","gene_reaction_rule","r_data","CobraModel","metabolites","apply_reaction_data","reaction_data","apply_metabolite_data","metabolite_data","apply_gene_data","from_cobra_json","model_data","the_id","model","reversibility","lower_bound","upper_bound","met_id","met","build_reaction_string","stoichiometries","is_reversible","number","reactant_bits","product_bits","the_metabolite","reaction_string","selectedOrderCounter","BuildInput","start_reaction_listener","is_active","newSel","placed_div","hideDropdown","direction_arrow","setUpMapCallbacks","setUpZoomCallbacks","target_coords","callback_manager","selectedNode","reload","showDropdown","unhighlightShortestPaths","hideTarget","selectionOrder","highlightSameNodes","selectionChanged","toggleStartReactionListener","hasModelAndSelection","reloadAtSelected","set_status","clear_escape","key_manager","addEscapeListener","blur","deselect_text_labels","select_single_node","alreadyDrawn","drawnId","startingFromScratch","cobra_model","showNames","allowDuplicates","cobraReactions","cobraMetabolites","hasDataOnReactions","has_data_on_reactions","selectedMetName","boldMetsInStr","mets","reactionSuggestions","reactionName","showReactionName","metBiggId","showMetNames","metId","showGeneNames","reactionString","fromEntries","sortFn","checkAndBuild","new_reaction_from_scratch","node_id","new_reaction_for_metabolite","deselect_nodes","showTarget","CallbackManager","run","passArgs","aName","rho","SQRT2","cosh","exp","ux0","uy0","w0","ux1","uy1","w1","d2","d1","b0","b1","r0","r1","coshr0","u","sinh","taskHead","taskTail","clockLast","clockNow","clockSkew","clock","performance","setFrame","requestAnimationFrame","clearNow","Timer","_call","_time","timer","time","restart","wake","timerFlush","t0","sleep","nap","poke","elapsed","emptyOn","emptyTween","timing","schedules","__transition","tween","tick","ease","cssNode","cssRoot","cssView","svgNode","translateX","translateY","skewX","scaleX","scaleY","interpolateTransform","pxComma","pxParen","degParen","q","xa","ya","xb","yb","interpolateTransformCss","decompose","interpolateTransformSvg","baseVal","consolidate","matrix","tweenRemove","tween0","tween1","tweenFunction","tweenValue","transition","_id","Color","darker","brighter","reI","reN","reP","reHex","reRgbInteger","reRgbPercent","reRgbaInteger","reRgbaPercent","reHslPercent","reHslaPercent","named","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","color_formatHex","rgb","formatHex","color_formatRgb","formatRgb","rgbn","Rgb","rgba","hsla","rgbConvert","opacity","rgb_formatHex","hex","rgb_formatRgb","Hsl","hslConvert","hsl2rgb","m2","basis","v0","v1","v2","v3","t3","linear","nogamma","channels","displayable","formatHsl","rgbGamma","exponential","rgbSpline","spline","colors","reA","reB","am","bm","bs","bi","lastIndex","one","value1","string00","interpolate0","string1","string0","string10","attrTweenNS","attrInterpolateNS","_value","attrTween","attrInterpolate","delayFunction","delayConstant","durationFunction","durationConstant","newId","selection_prototype","inherit","id0","id1","on0","on1","sit","onFunction","styleTween","styleNull","listener0","styleMaybeRemove","styleInterpolate","textTween","textInterpolate","easeConstant","interrupt","defaultTiming","ZoomEvent","Transform","applyX","applyY","invertX","invertY","rescaleX","domain","rescaleY","defaultExtent","SVGElement","hasAttribute","viewBox","clientWidth","defaultTransform","__zoom","defaultWheelDelta","deltaMode","defaultConstrain","extent","translateExtent","dx0","dx1","dy0","dy1","ZoomContainer","scrollBehavior","use3dTransform","css3TransformContainer","zoomedSel","_scrollBehavior","_use3dTransform","_panDragOn","_zoomBehavior","_zoomTimeout","_svgScale","_svgTranslate","_3dTransform","_requestedFrame","callbackManager","_updateScroll","setScrollBehavior","setUse3dTransform","togglePanDrag","touchstarting","constrain","scaleExtent","zoom","wheeled","dblclicked","centroid","clean","__zooming","Gesture","taps","wheel","moved","x0","y0","k1","touch0","touch1","l0","l1","dp","dl","scaleBy","scaleTo","translateBy","translateTo","emit","_goToCallback","wheelFn","ev","getDirectionalDisp","newTranslate","goTo","newZoom","_goTo3d","_goToSvg","_goTo3dFrame","svgScale","svgTranslate","nScale","nTranslate","_clear3d","_goToSvgFrame","zoomBy","zoom_in","zoom_out","translateOffScreen","Draw","create_membrane","enter_selection","update_membrane","update_selection","create_reaction","create_reaction_label","update_reaction","drawn_nodes","update_reaction_label","create_segment","update_segment","tool","reaction_data_styles","show_gene_reaction_rules","hide_all_labels","gene_font_size","reactionLabelMouseover","reactionLabelMouseout","reactionLabelTouch","geneLabelMouseover","geneLabelMouseout","geneLabelTouch","label_x","label_y","turnOffDrag","reactionLabelDrag","add_gene_height","all_genes_g","show_gene_string","show_gene_reaction_rule","sd","td","gene_g","gene_update","should_size","should_color","no_data_size","no_data_color","highlight_missing","hide_secondary_metabolites","primary_r","secondary_r","objectMouseover","reactionObjectMouseover","objectMouseout","reactionObjectMouseout","get_arrow_size","reaction_size","get_disp","arrow_size","node_is_primary","arrow_height","from_node_id","to_node_id","b2","displacedCoords","from_node_coefficient","to_node_coefficient","curve","reaction_color","arrowheads","node_type","loc","show_arrowhead_flux","unconnected_segment_with_arrow","stoichiometry_labels","labels","create_bezier","bezier_id","bezier","update_bezier","show_beziers","drag_behavior","mouseover","mouseout","drawn_reactions","seg_data","segment_d","create_node","update_node","has_data_on_nodes","mousedown_fn","click_fn","mouseover_fn","mouseout_fn","label_drag_behavior","marker_r","metabolite_data_styles","no_data_style","labelMouseover","nodeLabelMouseover","labelMouseout","nodeLabelMouseout","labelTouch","nodeLabelTouch","nodeObjectMouseover","nodeObjectMouseout","node_label","hideNode","metabolite_size","metabolite_color","create_text_label","text_label_id","update_text_label","mousedown","textLabelMousedown","click","textLabelClick","selectableDrag","reactionArrowDisplacement","displace","hyp","getMetLabelLoc","angleRaw","isPrimary","primaryIndex","leftRight","rotateNodes","selectedNodes","beziers","rotateAround","coord","updatedNodeIds","updatedReactionIds","moveNodeAndLabels","connected_segments","segmentObj","segmentId","bezId","bezierIdForSegmentId","reaction_ids","node_ids","moveNodeAndDependents","bez","tbez","metIndexDisp","drawAtIndex","numSlots","metSecondaryDisp","secondaryW","secondaryDis","calculateNewMetaboliteCoordinates","mainAxis","dis","isReversed","b1Strength","b2Strength","ds","is_primary","reactionAxis","circle","newBeziersForSegments","segBez","bezierId","newBeziersForReactions","d3Select","d3Mouse","getD3Event","Behavior","undoStack","labelDrag","objectTouch","emptyBehavior","rotationModeEnabled","rotationDrag","selectableMousedown","bezierDrag","bezierMouseover","bezierMouseout","nodeLabelDrag","averageLocation","showCenter","enterSel","updateSel","cur","newLoc","hideCenter","toggleRotationMode","selectionNode","selectionBackground","getSelectedNodes","selectedNodeIds","startFn","dragFn","totalAngle","draw_these_nodes","draw_these_reactions","endFn","undoFn","theseNodes","redoFn","centerFn","getGenericAngularDrag","toggleSelectableClick","selectableClick","select_selectable","nodeMouseover","nodeMouseout","toggleTextLabelEdit","textEditMousedown","coordsA","toggleSelectableDrag","getSelectableDrag","getBezierDrag","toggleLabelDrag","getReactionLabelDrag","getNodeLabelDrag","toggleLabelMouseover","getMouseover","toggleObjectMouseover","mouseEvent","newD","xPos","yPos","toggleObjectTouch","toggleBezierDrag","combineNodesAndDraw","fixedNodeId","draggedNodeId","draggedNode","fixedNode","updatedSegmentObjs","delete_node_data","draw_everything","theTimeout","totalDisplacement","nodeIdsToDrag","reactionIds","textLabelIdsToDrag","moveLabel","textLabelId","textLabel","text_labels","setDragging","nodeGroup","grabbed","get_selected_node_ids","selectedTextLabelIds","get_selected_text_label_ids","draw_these_text_labels","nodeToCombineArray","savedDraggedNode","segmentObjsMovedToCombine","savedDisplacement","updatedReactions","savedNodeIds","savedTextLabelIds","savedReactionIds","moveBezier","getGenericDrag","draw_these_beziers","relativeToSelection","rel","savedD","savedLocation","getCenter","savedAngle","savedCenter","GaBuGeRd","GaBuRd","RdYlBu","GeGaRd","WhYlRd","lo","hi","e10","e5","e2","tickIncrement","power","LN10","genericArray","nb","na","setTime","unit","deinterpolateLinear","bimap","deinterpolate","reinterpolate","d0","polymap","ticks","tickFormat","step0","step1","precisionPrefix","precisionRound","precisionFixed","nice","piecewise","clamp","rescale","deinterpolateClamp","reinterpolateClamp","rangeRound","deg2rad","rad2deg","ED","EB","BC_DA","Cubehelix","bl","cubehelixConvert","cubehelix","hue","cubehelixGamma","cubehelixLong","ramp","Scale","x_size","y_size","connectToSettings","getDataStatistics","preset","presetVal","scaleVal","setScale","changed","sortScale","stats","sorted","color_range","size_range","setReactionScale","setMetaboliteScale","metabolite","incr","UndoStack","oldest","newest","endOfStack","undo","redo","do","addCmd","ctrlEqualsCmd","keyAr","newAr","KeyManager","assignedKeys","inputList","mousetrap","escapeQueue","removeEscapeListener","enabled","keyId","assignedKey","keyToBind","requires","inputBlocking","ignoreWithInput","thisInputVal","thisInput","addEnterListener","oneTime","addKeyListener","_tryDropEscapeListener","keyName","Canvas","sizeAndLocation","mouseNode","resizeEnabled","setup","toggleResize","dragbarWidth","mouseNodeMult","transformString","currentTransform","dragLeft","oldX","dragRight","dragX","dragTop","oldY","dragBottom","dragY","SearchIndex","record","checkRecord","recordId","pathSeparatorString","findOutGoing","nodeBiggId","reactionOrder","coef","graph","metaboliteReactionOrder","outGoings","otherMet","findInGoing","inGoing","reactionInfo","getReactionPathSegments","fromNodeBiggId","toNodeBiggId","fromNode","seg","toNode","fromNodeId","toNodeId","visited","neighborId","alt","unshift","_on_array","EscherMap","canvas_size_and_loc","enable_search","map_name","map_id","map_description","last_action","shortestPathInfo","outGoingInfo","inGoingInfo","setup_containers","largest_ids","undo_stack","draw","search_index","beziers_enabled","imported_reaction_data","imported_metabolite_data","imported_gene_data","apply_reaction_data_to_map","apply_metabolite_data_to_map","apply_gene_data_to_map","get_data_statistics","rotation_on","from_data","map_data","n_id","r_id","g_id","segments_to_delete","s_id","from_node","to_node","midpoint","label_id","get_largest_id","largest_segment_id","current_largest","reset_containers","_status_timer","clearMapData","has_cobra_model","draw_all_reactions","draw_all_nodes","draw_all_text_labels","draw_beziers","clear_deleted","draw_all_beziers","clear_deleted_reactions","reaction_subset","bezier_ids","bezierIds","clear_deleted_beziers","clear_deleted_nodes","node_subset","clear_deleted_text_labels","text_label_ids","text_label_subset","bezier_subset","toggle_beziers","hide_beziers","on_off","hasData","calc_data_stats","has_data","data_statistics","vals","wasNull","same","quartiles","new_val","get_coords_for_node","selected_node_ids","selected_nodes","selected_text_label_ids","get_selected_text_labels","selected_text_labels","select_all","select_none","invert_selection","select_metabolite_with_id","selected_node","selected","_d","shift_key_on","classable_selection","classable_node","node_count","select_text_label","align_vertical","_align","align_horizontal","isHorizontal","markersAndPrimary","alignByPrimary","toAlign","keysToAlign","displacements","bezierDisplacements","movedSecondaryNodes","segmentLink","isToNode","otherNodeId","otherNode","connected","_moveNodes","disps","bezDisps","delete_selected","delete_selectable","should_draw","segments_and_reactions_for_nodes","segment_objs_w_segments","saved_nodes","saved_segment_objs_w_segments","saved_reactions","saved_text_labels","delete_and_draw","segment_objs","delete_segment_data","delete_reaction_data","delete_text_label_data","changed_r_scale","changed_m_scale","extend_nodes","extend_reactions","reaction_ids_to_draw","segment_obj","seg_id","seg_o","scale_changed","nodeIds","so","bez_id","_extend_and_draw_metabolite","new_nodes","selected_node_id","starting_reaction","cobra_reaction","reactant_ids","coeff","metaboliteId","label_d","reaction_redo","reaction_undo","new_reactions","_extend_and_draw_reaction","new_beziers","node_keys","new_coords","reaction_bigg_id","apply_undo_redo","cobraReaction","selectedNodeId","largestIds","cofactors","newReactionId","selectedNodeCoords","labelD","getLabelLoc","newReactionCobra","reactantRanks","productRanks","reactantCount","productCount","reactionIsReversed","formula","newMetabolite","carbons","newReaction","maxRank","primaryReactantIndex","primaryProductIndex","newAnchors","anchorIds","generalNodeType","fromId","toId","newSegmentId","unconnectedSeg","newNodes","metLoc","newNodeId","metLabelD","metabolitesArray","newReactions","newBeziers","saved_beziers","undo_fn","redo_fn","cycle_primary_node","connected_anchor_ids","reactions_to_draw","segment_info","connected_anchor_id","related_node_ids","conn_met_id","a_selected_node_id","nodes_to_draw","last_i","last_node","last_is_primary","last_coords","last_segment_info","last_segment","primary_node_id","last_bezier","related_node_id","this_is_primary","these_coords","this_segment_info","this_segment","this_bezier","old_connected_segments","new_connected_segments","toggle_selected_node_primary","go","reaction_ids_to_draw_o","these_reactions","segment_ids_for_reactions","segment_obj_w_segment","these_ids","add_label_to_search_index","new_text_label","edit_text_label","new_value","is_new","edit_and_draw","record_id","saved_label","zoom_extent_nodes","_zoom_extent","zoom_extent_canvas","mode","new_zoom","new_pos","zoom_to_reaction","zoom_to_node","zoom_to_text_label","text_label","highlight_reaction","highlight_node","highlight_text_label","save","map_for_export","homepage","schema","new_reaction","new_segment","new_node","t_id","canvas_el","new_canvas_el","saveMap","callbackBefore","callbackAfter","mapType","canvasSizeAndLoc","mouseNodeSizeAndTrans","hidden_sel","save_svg","save_png","convert_map","reactions_not_found","reaction_attrs","met_nodes_not_found","metabolite_attrs","model_reaction_id","modelReaction","looksReversed","modelCoeff","mapMet","mapCoeff","model_metabolite_id","model_metabolite","n_reactions_not_found","n_met_nodes_not_found","status_delay","mergeSelectedNodes","selNodes","nodeObjs","nodeKeys","firstNodeId","secondNodeId","applicableNodeIds","findAndHighlightShortest","inc","node1","node2","reactionHash","dijkstra","neighbor","curReaction","curPath","getReactionPath","paths","shortestPath","shortestLength","candidates","lastPath","spurNode","rootPath","removedEdges","nextNode","spurPath","totalPath","totalLength","edgeData","existingPathHashes","bestCandidate","can","findKthShortestPath","firtNodeBiggId","secondNodeBiggId","function","findKthOutOrIngoingReactions","outGoingFlag","getSavedInfo","calcFunc","setSavedInfo","visitedMetabolites","visitedReactions","newMetabolites","iter","currentId","outGoing","reactionMets","fromMet","toMet","rId","select_nodes","getElementById","MODE_DRAG","MODE_SPACE","MODE_HANDLE","MODE_CENTER","xy","XY","cursors","overlay","nw","se","sw","flipX","flipY","signsX","signsY","__brush","brushSelection","dim","brush","handleSize","initialize","redraw","emitter","Emitter","n0","n1","e0","e1","s0","s1","moving","lockX","lockY","signX","signY","shifting","point0","point1","selection0","selection1","Brush","isEnabled","insertAfter","brushSel","insertBeforeNode","brushIsEnabled","setupSelectionBrush","turnOffCrosshair","selectableSelection","clearingFlag","shiftKeyOn","sx","sy","Settings","_options","optionsWithDefaults","conditionalOptions","statusBus","busses","acceptedStreams","isConditional","bus","acceptedStream","createSetting","statusStream","held","savedValue","lastStatus","newStatus","convertToConditionalStream","set_conditional","get_option","holdChanges","abandonChanges","acceptChanges","TextEditInput","clearEscape","clearEnter","activeTarget","placedDiv","isNew","_acceptChanges","_addAndEdit","textLabelIds","Wrapper","display","connectSetStateFn","setDisplay","refPassthrough","divNode","ScaleSelector","wrapperRef","setWrapperRef","handleClickOutside","onClick","listItem","locals","setUpDrag","newValue","trackWidth","newLimValue","showTrash","newVal","TRACK_WIDTH","placePickers","absoluteMin","absoluteMax","curMin","curMax","pickerLocations","scaleChange","parameter","newScale","addColorStop","layerX","makeGradient","sortedScale","removeColorStop","pickers","focusedPicker","noDataColor","onNoDataColorChange","noDataSize","onNoDataSizeChange","ScaleSelection","saveChanges","currentSetting","enableTooltips","dataStatistics","title","checked","marginTop","newEnableTooltips","disabledEditing","rightMenu","MenuButton","assignKeyForInput","handleFileInput","files","assignKey","disabledButtons","checkMark","MenuBar","dropdownVisible","enableKeys","beziersEnabled","fullScreenButtonEnabled","loadMap","assignKeyLoadMap","clear_map","loadModel","assignKeyLoadModel","updateRules","clearModel","setReactionData","clearReactionData","setGeneData","clearGeneData","setMetaboliteData","clearMetaboliteData","setMode","deleteSelected","togglePrimary","cyclePrimary","selectNone","invertSelection","zoomExtentNodes","zoomExtentCanvas","toggleBeziers","full_screen","isFullScreen","renderSettingsMenu","inputRef","searchItem","counter","close","clearNext","clearPrevious","handleInput","dropDuplicates","compKeys","menuSetting","enableEditing","buildInput","TooltipContainer","TooltipComponent","tooltipRef","cancelHideTooltip","delayHideTimeout","currentTooltip","passProps","disableTooltips","delayHide","tooltipSize","mapSize","startPosX","startPosY","rightEdge","bottomEdge","tooltipStyle","flexDirection","boxSizing","WIDTH","borderRadius","fluxDisplayStyle","alignSelf","indicatorStyle","HistogramComponent","barWidth","maxValue","midPoint","paddingTop","alignItems","barHeight","marginRight","borderBottom","justifyContent","lowerBoundOld","upperBoundOld","currentFlux","lowerBoundString","upperBoundString","reactionInModel","objectives","fluxDistributions","lastProps","fluxData","oldModel","objective_coefficient","reactionData","textOffset","arrowPosition","upperRange","lowerRange","fluxConverter","tipConverter","sigFig","log10","boundConverter","dragStyle","handleMarkerPosition","handleKeyUp","sliderChange","onTouchEnd","resetReaction","decompartmentalizeCheck","openBigg","pref","hasFluxDistribution","touchAction","tipFormatter","refX","refY","orient","stroke","x1","y1","x2","y2","onKeyUp","samplingFunction","decomp","mapData","modelData","embeddedCss","reaction_sampling_distribution","menu_div","button_div","search_bar_div","searchBarRef","semanticOptions","savedFullScreenSettings","savedFullScreenParent","clearFullScreenEscape","mapToolsContainer","zoom_container","tooltip_container","settingsMenuRef","menuBarRef","buttonPanelRef","__builder__","has_custom_reaction_styles","reaction_styles","menu","pathFindingDisabled","saveAction","loadAction","scroll_behavior","use_3d_transform","highlight_same_nodes","enable_editing","enable_keys","fill_screen","zoom_to_element","full_screen_button","ignore_bootstrap","disabled_buttons","semantic_zoom","never_ask_before_quit","unique_map_id","primary_metabolite_radius","secondary_metabolite_radius","marker_radius","reaction_compare_style","reaction_scale","reaction_scale_preset","reaction_no_data_color","reaction_no_data_size","gene_data","metabolite_styles","metabolite_compare_style","metabolite_scale","metabolite_scale_preset","metabolite_no_data_color","metabolite_no_data_size","allow_building_duplicate_reactions","tooltip_component","DistributionTooltip","enable_tooltips","enable_keys_with_tooltip","first_load_callback","firstLoadCallback","getTooltipProps","debouncedSliderAction","sampleReactions","mpData","set_reaction_data","optionObject","zoomLevel","didChange","_updateData","_updateTooltipSetting","_createStatus","load_model","load_map","messageFn","_reactionCheckAddAbs","newBehavior","dataReceived","shouldUpdateData","tempSemanticOptions","_setupStatus","build_input","text_edit_input","setUpSettingsMenu","setUpButtonPanel","setUpMenuBar","setUpSearchBar","getKeys","newDisabledButtons","elementId","startCoords","zoom_mode","view_mode","_setupConfirmBeforeExit","passPropsSettingsMenu","passPropsMenuBar","set_gene_data","set_metabolite_data","_setMode","passPropsSearchBar","passPropsButtonPanel","searchIndex","build_mode","brush_mode","rotate_mode","text_mode","currStyle","buttonName","geneButtonName","clearGeneReactionRules","_makeGeneDataObject","geneData","cobraModel","updateModel","updateMap","shouldDraw","updateReactionData","updateMetaboliteData","metaboliteDataObject","reactionDataObject","geneDataObject","update_model_timer","status_bar","setting","zoom_in_ctrl","zoom_out_ctrl","extent_nodes_ctrl","extent_nodes","extent_canvas_ctrl","extent_canvas","show_settings_ctrl","show_settings","delete_ctrl","delete_del","toggle_primary","cycle_primary","direction_arrow_right","direction_arrow_down","direction_arrow_left","direction_arrow_up","search_ctrl","onbeforeunload","fullScreenSettings","fullScreenButton","bodyNode","getSavingState","lastAction","mapJson","loadSavingState","stateJSON","DataMenu","getdatafiles","datafiles","update_callback","select_sel","load_with_files","load_datafile","this_file","libs","underscore","preact","baconjs","d3_selection","d3_select","d3_json"],"sourceRoot":""}